
<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>Simulador Eleitoral Global</title>
<style>
:root{ --bg:#c0c0c0; --primary:#000080; --green:#00ff00; --red:#ff0000; --gold:#ffcc00; --paper:#f4f1ea; }

.event-queue-indicator{ background:#ffe0e0; border:1px solid #cc0000; padding:3px 6px; font-size:10px; display:none; margin-bottom:4px; }
.spirit-badge{ background:linear-gradient(135deg,#000080,#4040cc); color:white; font-size:9px; padding:2px 5px; border-radius:3px; display:inline-block; margin:1px; }
.abstention-bar{ height:6px; background:#888; }
.tv-time-badge{ background:#gold; border:1px solid #888; padding:1px 4px; font-size:9px; }
*{ box-sizing:border-box; }
body{ font-family:"MS Sans Serif", Arial; background:#008080; margin:0; display:flex; justify-content:center; align-items:flex-start; min-height:100vh; overflow-x:hidden; }
#game-container{ width:100%; max-width:1200px; background:var(--bg); border:2px solid white; padding:4px; box-shadow:4px 4px black; }
.title-bar{ background:var(--primary); color:white; padding:4px 10px; font-weight:bold; display:flex; justify-content:space-between; align-items:center; }
.screen{ display:none; } .active{ display:block; }
.btn{ padding:6px; border:2px solid; border-color:white black black white; background:var(--bg); cursor:pointer; font-weight:bold; font-size:11px; width: 100%; margin-bottom: 5px; touch-action:manipulation; }
.btn:active{ border-color:black white white black; }
.btn:disabled{ color: #888; cursor: default; background: #aaa; }
.grid-main{ display:grid; grid-template-columns:250px 1fr 280px; gap:10px; height:550px; margin-top:10px; }
.card{ background:white; border:2px inset #888; padding:8px; overflow-y:auto; }
.polling-table{ width:100%; border-collapse:collapse; }
.polling-table td, .polling-table th{ border:1px solid #444; padding:4px; font-size:11px; }
.player-row{ background:#ffffaa; font-weight:bold; }
.brazil-map{ position:relative; width:100%; height:400px; background:#004d00; border: 2px inset gray; overflow: hidden; }
.state-node{ position:absolute; width:22px; height:16px; background:#eee; border:1px solid black; font-size:9px; display:flex; align-items:center; justify-content:center; cursor:pointer; font-weight: bold; color: white; text-shadow: 1px 1px 1px black; opacity:1; }
#terminal-log{ background:black; color:lime; height:90px; font-family: 'Courier New', monospace; font-size:11px; overflow-y:auto; padding:8px; border: 2px inset #444; margin-top:5px; }
#modal-overlay{ display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); z-index:1000; justify-content:center; align-items:center; padding:10px; }
.modal{ background:var(--bg); padding:15px; border:2px outset white; width:400px; max-width:95vw; max-height:90vh; overflow-y:auto; box-shadow: 5px 5px 0 black; }
.party-tag { font-size: 9px; padding: 2px 4px; background: #eee; border: 1px solid #999; margin: 2px; display: inline-block; color: black; text-shadow: none; }
.tab-btn { width: 23%; display: inline-block; margin-bottom: 10px; font-size: 9px; }
#tab-jornal { background: var(--paper); padding: 10px; border: 1px solid #dcd7c9; }
.news-header { font-family: "Times New Roman", serif; text-align: center; border-bottom: 2px solid black; margin-bottom: 10px; }
.news-header h1 { margin: 0; font-size: 24px; text-transform: uppercase; letter-spacing: -1px; }
.news-entry { font-family: "Times New Roman", serif; border-bottom: 1px solid #ccc; padding: 8px 0; color: #222; }
.news-entry b { display: block; font-size: 14px; line-height: 1.1; margin-bottom: 3px; }
.region-card { background: #f0f0f0; border: 1px solid #999; padding: 5px; margin-bottom: 5px; font-size: 11px; }
.newspaper-wrap { background: var(--paper); padding: 20px; border: 1px solid #999; text-align: left; line-height: 1.4; color: #111; }
.ideology-bar { display:flex; align-items:center; gap:4px; font-size:10px; margin:2px 0; }
.ideology-bar label { width:60px; text-align:right; font-size:9px; }
.ideology-track { width:80px; height:8px; background:#ddd; border:1px solid #999; position:relative; }
.ideology-fill { height:100%; position:absolute; }
.scandal-bar { height:8px; background:linear-gradient(to right, #ff0, #f00); border:1px solid #999; margin-top:2px; }
.momentum-badge { background:var(--gold); border:1px solid #888; padding:1px 4px; font-size:9px; font-weight:bold; display:inline-block; }
#chart-container { background:black; color:lime; padding:5px; border:2px inset #444; margin-top:5px; }
#poll-chart { width:100%; height:120px; }
.congress-bar { display:flex; height:20px; width:100%; margin-top:5px; overflow:hidden; border:1px solid #888; }
.congress-segment { height:100%; display:flex; align-items:center; justify-content:center; font-size:9px; font-weight:bold; color:white; text-shadow:1px 1px black; }
.approval-row { font-size:10px; display:flex; gap:4px; align-items:center; }
.approve-fill { background:#00aa00; height:6px; }
.reject-fill { background:#cc0000; height:6px; }
.mini-bar { width:60px; height:6px; background:#ddd; border:1px solid #999; overflow:hidden; display:inline-block; vertical-align:middle; }
#ranking-screen .rank-item { font-family:'Times New Roman'; font-size:14px; margin:5px 0; }
.fatigue-bar { height:8px; background:linear-gradient(to right,#4caf50,#ff9800,#f44336); border:1px solid #999; margin:3px 0; position:relative; }
.fatigue-pointer { position:absolute; top:-2px; width:3px; height:12px; background:#000080; }
.scenario-card { background:white; border:2px inset #888; padding:10px; text-align:center; cursor:pointer; transition:background 0.1s; }
.scenario-card:hover { background:#ffffcc; }
.scenario-card.locked { background:#ddd; cursor:not-allowed; color:#999; }
.scenario-card.indirect { background:#f5e8e8; cursor:pointer; border:2px inset #aa4444; }
.scenario-card.indirect:hover { background:#ffe0e0; }
.scenario-card h3 { margin:5px 0; font-size:13px; }
.scenario-card .year { font-size:20px; font-weight:bold; color:#000080; }
.scenario-card .desc { font-size:10px; color:#555; margin-top:4px; }
.pivot-badge { background:var(--gold); color:#000; font-size:8px; padding:1px 3px; border:1px solid #888; }
.action-card { background:#f9f9f9; border:1px solid #ccc; padding:6px; margin-bottom:4px; font-size:11px; }
.debate-option { background:#e8f4e8; border:1px solid #999; padding:5px; margin:3px 0; cursor:pointer; font-size:11px; }
.debate-option:hover { background:#d0ecd0; }
.state-trait-badge { font-size:8px; padding:1px 3px; border-radius:2px; display:inline-block; margin:1px; font-weight:bold; }
.base-class-card { border:1px solid #ccc; padding:6px; margin-bottom:6px; border-radius:3px; font-size:11px; }
.base-class-bar { height:10px; background:#ddd; border:1px solid #999; border-radius:3px; overflow:hidden; margin:3px 0; }
.base-class-fill { height:100%; border-radius:3px; transition:width 0.4s; }
.coalition-party-card { border:1px solid #888; padding:6px; margin-bottom:5px; border-radius:3px; font-size:11px; background:#f9f9f9; }
.coalition-loyalty-bar { height:8px; background:#ddd; border:1px solid #999; overflow:hidden; margin:3px 0; }
.coalition-loyalty-fill { height:100%; transition:width 0.4s; }
/* INDIRECT ELECTION STYLES */
.hemicycle-container { background:#1a1a2e; border:2px inset #444; padding:10px; margin:5px 0; border-radius:4px; }
.hemicycle-canvas { display:block; margin:0 auto; }
.deputy-dot { display:inline-block; border-radius:50%; margin:1px; }
.vote-counter { font-family:'Courier New',monospace; font-size:13px; background:#000; color:#0f0; padding:5px 10px; border:1px solid #333; display:inline-block; margin:3px; }
.indirect-action { background:#2a1a0a; color:#f4d03f; border:2px solid #8b6914; padding:8px; margin:3px 0; cursor:pointer; font-size:11px; font-weight:bold; display:block; width:100%; text-align:left; }
.indirect-action:hover { background:#3a2a1a; }
.faction-bar { height:16px; display:flex; width:100%; border:1px solid #666; overflow:hidden; margin:3px 0; border-radius:2px; }
.faction-seg { height:100%; display:flex; align-items:center; justify-content:center; font-size:8px; color:white; font-weight:bold; text-shadow:1px 1px black; }
/* ‚îÄ‚îÄ MOBILE RESPONSIVE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
@media (max-width: 900px) {
  /* Grid vira coluna √∫nica */
  .grid-main {
    display:flex !important;
    flex-direction:column !important;
    height:auto !important;
    gap:6px !important;
    margin-top:6px !important;
  }
  /* Reordena: A√ß√µes (1) ‚Üí Pesquisa (2) ‚Üí Mapa (3) */
  .grid-main > div:nth-child(1) { order:1; }
  .grid-main > div:nth-child(3) { order:2; }
  .grid-main > div:nth-child(2) { order:3; }

  /* Container geral sem borda desnecess√°ria */
  #game-container { border:none; box-shadow:none; padding:2px; }
  .modal { width:96vw !important; max-height:88vh !important; padding:10px !important; }

  /* Abas: 3 por linha */
  .tab-btn {
    width:30% !important;
    font-size:8px !important;
    padding:5px 2px !important;
    margin-bottom:3px !important;
  }

  /* Mapa Brasil: vis√≠vel e escalado */
  .brazil-map {
    height:300px !important;
    touch-action:manipulation;
    overflow:hidden;
  }
  .state-node {
    width:24px !important;
    height:17px !important;
    font-size:8px !important;
  }
  #state-details {
    height:auto !important;
    min-height:60px;
  }

  /* Barra de status no topo */
  #game-screen > div:first-child {
    font-size:9px !important;
    flex-wrap:wrap;
    gap:3px;
  }

  /* Setup: coluna √∫nica */
  #setup-screen > div:nth-child(2) { grid-template-columns:1fr !important; }

  /* Cen√°rios: 2 colunas */
  #scenario-screen > div:nth-child(2) { gap:3px !important; padding:4px !important; }
  #scenario-screen > div:nth-child(2) .btn { padding:4px 8px !important; font-size:9px !important; }

  /* Polling table compacta */
  .polling-table td, .polling-table th { font-size:9px !important; padding:2px !important; }

  /* Terminal menor */
  #terminal-log { height:55px !important; font-size:10px !important; }

  /* Cards mais compactos */
  .card { padding:6px !important; }
  .coalition-party-card, .base-class-card { font-size:10px !important; padding:5px !important; }

  /* Indiretas */
  #indirect-grid { grid-template-columns:1fr !important; }
  #indirect-grid > div:nth-child(3) { display:none; }

  /* Scenario cards: 2 colunas */
  #scenario-list > div > div:nth-child(2) { grid-template-columns:repeat(2,1fr) !important; }
  .scenario-card .year { font-size:15px; }
  .scenario-card h3 { font-size:11px; }
}

@media (max-width: 480px) {
  .tab-btn { width:30% !important; font-size:7px !important; }
  .brazil-map { height:240px !important; }
  .state-node { width:20px !important; height:14px !important; font-size:7px !important; }
  #scenario-list > div > div:nth-child(2) { grid-template-columns:1fr !important; }
  .grid-main > div:nth-child(2) { order:3; }
}
</style>
</head>
<body>

<div id="game-container">
    <div class="title-bar">
        <span>üåé SIMULADOR ELEITORAL GLOBAL</span>
        <div style="display:flex;gap:8px;align-items:center">
            <span style="font-size:10px;cursor:pointer;opacity:0.8" onclick="showCredits()">üëë Cr√©ditos</span>
            <span style="font-size:10px;cursor:pointer;opacity:0.8" onclick="showChangelog()">üìã v14</span>
            <span onclick="location.reload()" style="cursor:pointer">[X]</span>
        </div>
    </div>

    <!-- TELA DE SELE√á√ÉO DE CEN√ÅRIO -->
    <div id="scenario-screen" class="screen active">
        <h2 style="text-align:center;margin:8px 0">üåé SIMULADOR ELEITORAL GLOBAL</h2>
        <div style="display:flex;justify-content:center;gap:4px;padding:6px;background:#d4d0c8;border-bottom:2px inset #888;flex-wrap:wrap;">
            <button class="btn" id="tab-btn-pres" style="width:auto;padding:5px 14px;background:#000080;color:white;font-size:11px" onclick="switchScenarioTab('pres')">üèõÔ∏è PRESIDENCIAIS BR</button>
            <button class="btn" id="tab-btn-gov" style="width:auto;padding:5px 14px;font-size:11px" onclick="switchScenarioTab('gov')">üó∫Ô∏è GOVERNADORES</button>
            <button class="btn" id="tab-btn-mun" style="width:auto;padding:5px 14px;font-size:11px" onclick="switchScenarioTab('mun')">üèôÔ∏è MUNICIPAIS</button>
            <button class="btn" id="tab-btn-ind" style="width:auto;padding:5px 14px;font-size:11px" onclick="switchScenarioTab('ind')">‚öôÔ∏è INDIRETAS</button>
            <button class="btn" id="tab-btn-pais" style="width:auto;padding:5px 14px;font-size:11px" onclick="switchScenarioTab('pais')">üåç PA√çSES</button>
            <button class="btn" id="tab-btn-conq" style="width:auto;padding:5px 14px;font-size:11px" onclick="switchScenarioTab('conq')">üèÜ CONQUISTAS</button>
        </div>
        <div style="padding:8px;max-height:460px;overflow-y:auto;" id="scenario-list"></div>
        <div style="text-align:center;padding:5px;font-size:10px;color:#666;display:flex;gap:5px;justify-content:center;flex-wrap:wrap;">
            <button class="btn" style="width:auto;background:#d4d0c8;font-size:10px" onclick="showPlannedContent()">üìã Planejado</button>
            <button class="btn" style="width:auto;background:#d4d0c8;font-size:10px" onclick="showChangelog()">üìù Changelog</button>
        </div>
    </div>

    <!-- TELA DE ELEI√á√ÉO INDIRETA -->
    <div id="indirect-screen" class="screen">
        <div id="indirect-title" style="background:#1a1a2e;color:#f4d03f;padding:8px;text-align:center;font-weight:bold;font-size:14px;border-bottom:2px solid #8b6914;display:flex;justify-content:space-between;align-items:center;">
            <button onclick="goToScenarios()" style="background:#8b6914;color:white;border:1px solid #aa8822;padding:3px 8px;cursor:pointer;font-size:10px">‚Üê Voltar</button>
            <span id="indirect-title-text">üèõÔ∏è COL√âGIO ELEITORAL ‚Äî 1934</span>
            <span style="font-size:10px;opacity:0.7">Sistema Indiret–æ</span>
        </div>
        <div style="display:grid;grid-template-columns:260px 1fr 260px;gap:8px;padding:8px;min-height:500px;" id="indirect-grid">
            <!-- Coluna Esquerda: A√ß√µes -->
            <div class="card" style="background:#1a1a0a;color:#f4d03f;border-color:#8b6914;">
                <b style="color:#f4d03f">‚öôÔ∏è A√á√ïES POL√çTICAS</b><hr style="border-color:#8b6914">
                <div style="font-size:10px;color:#aaa;margin-bottom:8px">Rodada: <span id="ind-turn">1</span>/10 | Influ√™ncia: <span id="ind-points" style="color:#f4d03f">5</span>p</div>
                <div id="indirect-actions"></div>
                <hr style="border-color:#8b6914">
                <button class="btn" style="background:#8b6914;color:white;margin-top:5px" onclick="indirectNextTurn()">‚è© AVAN√áAR RODADA</button>
                <button class="btn" style="background:#333366;color:white;margin-top:3px;font-size:10px" onclick="indirectAutoSimulate()">‚è©‚è© SIMULAR TUDO</button>
                <label style="font-size:10px;color:#f4d03f;display:block;margin-top:4px">
                    <input type="checkbox" id="indirect-spectator" onchange="indirectSpectatorMode=this.checked"> Modo Espectador
                </label>
                <div id="indirect-log" style="background:#000;color:#0f0;font-family:'Courier New';font-size:10px;height:80px;overflow-y:auto;padding:5px;margin-top:5px;border:1px solid #333;"></div>
            </div>
            <!-- Coluna Central: Hemiciclo + Placar -->
            <div class="card" style="background:#0d0d1a;padding:5px;">
                <div style="text-align:center;color:#f4d03f;font-size:11px;font-weight:bold;margin-bottom:5px">INTEN√á√ïES DE VOTO NO CONGRESSO</div>
                <canvas id="hemicycle-canvas" width="380" height="200" style="display:block;margin:0 auto;background:#1a1a2e;border-radius:4px;max-width:100%;"></canvas>
                <div id="indirect-scoreboard" style="margin-top:8px;"></div>
                <div style="color:#888;font-size:9px;text-align:center;margin-top:5px" id="indirect-context"></div>
            </div>
            <!-- Coluna Direita: Fac√ß√µes -->
            <div class="card" style="background:#0a0a1a;color:#ccc;border-color:#333;">
                <b style="color:#f4d03f">üèõÔ∏è FAC√á√ïES DO CONGRESSO</b><hr style="border-color:#444">
                <div id="faction-list"></div>
                <hr style="border-color:#444">
                <div style="font-size:10px;color:#888">
                    <b style="color:#f4d03f">üì∞ DI√ÅRIO OFICIAL</b>
                    <div id="indirect-news" style="height:120px;overflow-y:auto;font-size:10px;"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="setup-screen" class="screen">
        <div id="setup-title" style="text-align:center"><h2 style="margin:5px 0">ELEI√á√ïES 1994: SIMULADOR</h2></div>
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 10px;">
            <div class="card">
                <b>CANDIDATOS REAIS</b><hr>
                <div id="setup-candidates" style="display:grid;grid-template-columns:1fr 1fr;gap:5px;"></div>
            </div>
            <div class="card" style="background:#d4d0c8">
                <b>CRIAR PERSONAGEM (OPCIONAL)</b><hr>
                <input type="text" id="custom-name" placeholder="Nome do Candidato" style="width:90%"><br><br>
                <label>Cor do candidato:</label><br>
                <div style="display:flex;align-items:center;gap:8px;margin:4px 0 8px 0;flex-wrap:wrap">
                    <input type="color" id="custom-color" value="#cc0000" style="width:36px;height:28px;border:1px solid #888;cursor:pointer;padding:1px">
                    <div style="display:flex;gap:4px;flex-wrap:wrap">
                        <div onclick="setCustomColor('#cc0000')" style="width:20px;height:20px;background:#cc0000;border:1px solid #888;cursor:pointer;border-radius:3px" title="Vermelho"></div>
                        <div onclick="setCustomColor('#0044cc')" style="width:20px;height:20px;background:#0044cc;border:1px solid #888;cursor:pointer;border-radius:3px" title="Azul"></div>
                        <div onclick="setCustomColor('#006600')" style="width:20px;height:20px;background:#006600;border:1px solid #888;cursor:pointer;border-radius:3px" title="Verde"></div>
                        <div onclick="setCustomColor('#cc6600')" style="width:20px;height:20px;background:#cc6600;border:1px solid #888;cursor:pointer;border-radius:3px" title="Laranja"></div>
                        <div onclick="setCustomColor('#660066')" style="width:20px;height:20px;background:#660066;border:1px solid #888;cursor:pointer;border-radius:3px" title="Roxo"></div>
                        <div onclick="setCustomColor('#003366')" style="width:20px;height:20px;background:#003366;border:1px solid #888;cursor:pointer;border-radius:3px" title="Azul Marinho"></div>
                        <div onclick="setCustomColor('#663300')" style="width:20px;height:20px;background:#663300;border:1px solid #888;cursor:pointer;border-radius:3px" title="Marrom"></div>
                        <div onclick="setCustomColor('#006666')" style="width:20px;height:20px;background:#006666;border:1px solid #888;cursor:pointer;border-radius:3px" title="Teal"></div>
                    </div>
                </div>
                <label>Partido:</label>
                <select id="custom-party" style="width:100%" onchange="toggleCustomPartyInput(this.value)">
                    <option value="PV">PV (Ambientalista - E)</option>
                    <option value="PSC">PSC (Conservador - D)</option>
                    <option value="PRTB">PRTB (Nacionalista - D)</option>
                    <option value="PSTU">PSTU (Radical - E)</option>
                    <option value="__custom__">‚úèÔ∏è Criar meu pr√≥prio partido...</option>
                </select>
                <div id="custom-party-fields" style="display:none;margin-top:6px;border:1px solid #888;padding:8px;background:#f0f0f0">
                    <b style="font-size:11px">CRIAR PARTIDO</b><br>
                    <input type="text" id="custom-party-name" placeholder="Nome do Partido" style="width:90%;margin:3px 0"><br>
                    <label style="font-size:11px">Espectro:</label>
                    <select id="custom-party-side" style="width:90%">
                        <option value="E">Esquerda (E)</option>
                        <option value="C">Centro (C)</option>
                        <option value="D">Direita (D)</option>
                    </select><br>
                    <input type="text" id="custom-party-ideology" placeholder="Ideologia (ex: Socialismo)" style="width:90%;margin:3px 0">
                </div><br><br>
                <button class="btn" style="background:var(--gold)" onclick="startCustomGame()">JOGAR COM MEU PERSONAGEM</button>
                <button class="btn" style="margin-top:5px" onclick="goToScenarios()">‚Üê Voltar</button>
            </div>
        </div>
        <div class="card" style="margin: 10px; text-align: center;">
            <b>DIFICULDADE:</b> 
            <select id="difficulty-level">
                <option value="1">F√°cil</option>
                <option value="2" selected>Normal</option>
                <option value="3">Dif√≠cil</option>
            </select>
            &nbsp;&nbsp;&nbsp;
            <b>MODO:</b>
            <select id="game-mode">
                <option value="historico">Hist√≥rico</option>
                <option value="caotico">Ca√≥tico üî•</option>
                <option value="sandbox">Sandbox ‚ôæÔ∏è</option>
            </select>
        </div>
    </div>

    <div id="game-screen" class="screen">
        <div style="display:flex;justify-content:space-between;background:#d4d0c8;border:2px inset white;padding:6px;font-weight:bold;flex-wrap:wrap;gap:4px">
            <span id="fase-label">1¬∫ TURNO</span>
            <span id="date-display" style="color:#8b0000;font-size:10px"></span>
            <span>DIA: <span id="turn-display">1</span>/<span id="turn-max-display">15</span></span>
            <span style="color:navy">PONTOS: <span id="points-display">2</span>p</span>
            <span style="color:darkgreen">VERBA: R$ <span id="money-display">0</span>M</span>
            <span style="display:flex;align-items:center;gap:4px;font-size:10px" title="N√≠vel de Radicaliza√ß√£o: alto = partidos radicais ganham popularidade">
                <span style="color:#8b0000;font-weight:bold">üìä RADICAL.:</span>
                <div style="width:60px;height:10px;background:#ddd;border:1px solid #999;position:relative;display:inline-block;vertical-align:middle">
                    <div id="radical-bar-fill" style="height:100%;background:#cc6600;width:30%;transition:width 0.3s"></div>
                </div>
                <span id="radical-bar-label" style="color:#cc6600;font-size:9px">30</span>
            </span>
        </div>

        <div class="grid-main">
            <div class="card" style="background:var(--bg)">
                <button class="btn tab-btn" onclick="showTab('campanha')" style="width:11%">A√á√ïES</button>
                <button class="btn tab-btn" onclick="showTab('regioes')" style="width:11%">REGI√ïES</button>
                <button class="btn tab-btn" onclick="showTab('debate')" style="width:11%">üé§ DEBATE</button>
                <button class="btn tab-btn" onclick="showTab('jornal')" style="width:11%">JORNAL</button>
                <button class="btn tab-btn" onclick="showTab('espiritos')" style="width:11%">‚ö°ESP√çR.</button>
                <button class="btn tab-btn" onclick="showTab('base')" style="width:11%;background:#e8f0ff">üó≥Ô∏è BASE</button>
                <button class="btn tab-btn" onclick="showTab('coligacoes')" style="width:11%;background:#f0ffe8">ü§ù COLIG.</button>
                <button class="btn tab-btn" onclick="showTab('corrupcao')" style="width:11%;background:#ffe8e8">ü§ë CORRUP.</button>
                <button class="btn tab-btn" onclick="showTab('crises')" style="width:11%;background:#ff6600;color:white">üî• CRISES</button>
                <button class="btn tab-btn" onclick="showTab('inteligencia')" style="width:11%;background:#003366;color:white">üß† INTELIG.</button>
                <button id="tab-btn-vice" class="btn tab-btn" onclick="showTab('vice')" style="width:11%;background:#1a5c2a;color:white;display:none">üëî VICE</button>
                <button class="btn tab-btn" onclick="showTab('opcoes')" style="width:11%">‚öôÔ∏è OP√á.</button>
                
                <div id="tab-campanha">

                    <b>M√çDIA & COMUNICA√á√ÉO</b>
                    <button class="btn" onclick="actionTV()">üì∫ Hor√°rio Eleitoral Nacional (6p, R$12M)</button>
                    <button class="btn" onclick="actionRadio()">üìª Inser√ß√µes de R√°dio (3p, R$6M)</button>
                    <button class="btn" onclick="actionEntrevista()">üéôÔ∏è Entrevista em Rede (4p)</button>
                    <button class="btn" onclick="actionDocumentario()">üé¨ Document√°rio Eleitoral (4p, R$5M)</button>
                    <button class="btn" onclick="actionInfluenciadores()">ü§≥ Influenciadores Digitais (3p, R$3M)</button>
                    <button class="btn" onclick="actionCriseMediatica()">üõ°Ô∏è Gerenciar Crise Midi√°tica (3p)</button>
                    <b>FINANCEIRO</b>
                    <button class="btn" onclick="actionCaixaEmpresarial()">üè≠ Arrecadar: Empres√°rios (2p, risco)</button>
                    <button class="btn" onclick="actionCaixaSindical()">‚öíÔ∏è Arrecadar: Sindicatos (2p, esq)</button>
                    <button class="btn" onclick="actionCaixaPopular()">üèòÔ∏è Arrecadar: Vaquinha Popular (1p)</button>
                    <button class="btn" onclick="actionCrowdfunding()">üí≥ Crowdfunding Digital (2p)</button>
                    <button class="btn" onclick="actionONGParcerias()">üå± Parcerias ONGs/Igrejas (2p)</button>
                    <button class="btn" onclick="actionLeilaoArte()">üñºÔ∏è Leil√£o Beneficente (3p, R$3M)</button>
                    <button class="btn" onclick="actionEventoGala()">üé© Jantar de Gala (3p, R$5M)</button>
                    <b>ESTRAT√âGIA</b>
                    <button class="btn" id="btn-alliance" onclick="openAllianceMenu()">ü§ù Negociar Alian√ßas (4p)</button>
                    <button class="btn" onclick="openPartyManagement()">üèõÔ∏è Gerenciar Partido (2p)</button>
                    <button class="btn" onclick="actionDebateRegional()">üó∫Ô∏è Tour Regional (3p, R$5M)</button>
                    <button class="btn" id="btn-vice-in-actions" style="background:#1a5c2a;color:white;font-size:10px" onclick="openViceNegotiation()">üëî Negociar Vice-Presidente (6p)</button>
                    <button class="btn" style="background:#ff6600;color:white" onclick="showTab('crises')">üî• Ver Crises & Esc√¢ndalos</button>
                    <button class="btn" style="background:#eee" onclick="showTab('estrategia')">‚öîÔ∏è Ataque & Apoio</button>
                </div>

                <div id="tab-estrategia" style="display:none">
                    <button class="btn" onclick="showTab('campanha')"><- Voltar</button>
                    <b>ATAQUE & APOIO</b><hr>
                    <div id="adversary-list"></div>
                </div>

                <div id="tab-regioes" style="display:none">
                    <b>L√çDERES POR REGI√ÉO</b><hr>
                    <div id="region-list"></div>
                </div>

                <div id="tab-debate" style="display:none">
                    <b>üé§ CENTRAL DE DEBATES</b><hr>
                    <div id="debate-stats" style="font-size:10px;margin-bottom:6px;background:#f0f0f0;padding:6px;border:1px solid #ccc;border-radius:2px"></div>
                    <div id="debate-actions"></div>
                </div>

                <div id="tab-espiritos" style="display:none">
                    <b>‚ö° ESP√çRITOS NACIONAIS</b><hr>
                    <div style="background:#fff8e8;border:1px solid #cc9900;padding:8px;margin-bottom:8px;border-radius:2px">
                        <b>Ativos agora:</b>
                        <div id="spirits-display" style="font-size:10px;margin-top:4px">Nenhum esp√≠rito ativo.</div>
                    </div>
                    <b style="font-size:10px">Esp√≠ritos dispon√≠veis:</b>
                    <div id="spirits-legend" style="font-size:10px;margin-top:4px"></div>
                </div>


                <div id="tab-radical" style="display:none">
                    <b>üìä N√çVEL DE RADICALIZA√á√ÉO</b><hr>
                    <div id="radical-content" style="font-size:10px"></div>
                </div>

                <div id="tab-crises" style="display:none">
                    <b>üî• CRISES, ESC√ÇNDALOS & OPERA√á√ïES</b><hr>
                    <div style="background:#330000;color:#ffcc00;padding:6px;border-radius:2px;font-size:10px;margin-bottom:8px">
                        ‚ö†Ô∏è Central de opera√ß√µes ofensivas e defensivas. Gerencie esc√¢ndalos e ataque rivais.
                    </div>
                    <div id="crises-content"></div>
                </div>

                <div id="tab-inteligencia" style="display:none">
                    <b>üß† INTELIG√äNCIA & AN√ÅLISE ELEITORAL</b><hr>
                    <div style="background:#001a33;color:#88ccff;padding:6px;border-radius:2px;font-size:10px;margin-bottom:8px">
                        üî≠ Centro de an√°lise estrat√©gica. Pesquise estados, identifique oportunidades e planeje campanhas.
                    </div>
                    <div id="inteligencia-content"></div>
                </div>

                <div id="tab-jornal" style="display:none">
                    <div class="news-header">
                        <h1>Folha de S. Pol√≠tica</h1>
                        <small>EDI√á√ÉO NACIONAL - <span id="news-date">OUTUBRO 1994</span></small>
                    </div>
                    <div id="news-feed"></div>
                </div>

                <div id="tab-vice" style="display:none">
                    <b>üëî VICE-PRESID√äNCIA</b><hr>
                    <div id="vice-content"></div>
                </div>

                <div id="tab-base" style="display:none">
                    <b>üó≥Ô∏è BASE ELEITORAL</b><hr>
                    <div id="base-content"></div>
                </div>

                <div id="tab-coligacoes" style="display:none">
                    <b>ü§ù COLIGA√á√ïES E ALIAN√áAS</b><hr>
                    <div id="coligacoes-content"></div>
                </div>

                <div id="tab-corrupcao" style="display:none">
                    <b>ü§ë GABINETE DA SOMBRA</b><hr>
                    <div style="background:#330000;color:#ffcc00;padding:6px;border-radius:2px;font-size:10px;margin-bottom:8px">
                        ‚ö†Ô∏è A√ß√µes clandestinas ‚Äî alto risco, alto retorno. Se descoberto: <b>GAME OVER</b>
                    </div>
                    <div id="corrupcao-content"></div>
                </div>

                <div id="tab-opcoes" style="display:none">
                    <b>‚öôÔ∏è OP√á√ïES DE JOGO</b><hr>
                    <div style="background:#ffffcc;border:1px solid #999;padding:8px;margin-bottom:8px;">
                        <b>üé≠ MODO ESPECTADOR</b><br>
                        <small style="color:#555">Desativa eventos e avan√ßa turnos sem intera√ß√£o.</small><br><br>
                        <label style="font-size:12px">
                            <input type="checkbox" id="spectator-mode" onchange="toggleSpectatorMode(this.checked)"> 
                            Ativar Modo Espectador
                        </label>
                    </div>
                    <div style="background:#e8f4e8;border:1px solid #999;padding:8px;margin-bottom:8px;">
                        <b>üì∞ VISIBILIDADE DE EVENTOS</b><br>
                        <label style="font-size:12px"><input type="checkbox" id="hide-hist-events" checked> Exibir eventos hist√≥ricos</label><br>
                        <label style="font-size:12px"><input type="checkbox" id="hide-rand-events" checked> Exibir eventos aleat√≥rios</label><br>
                        <label style="font-size:12px"><input type="checkbox" id="hide-debates" checked> Exibir debates ao vivo</label>
                    </div>

                    <div style="background:#e8f4ff;border:1px solid #5588aa;padding:8px;margin-bottom:8px;">
                        <b>üó≥Ô∏è ABSTEN√á√ÉO / VOTO NULO</b><hr style="margin:4px 0">
                        <div id="abstention-display" style="font-size:10px">
                            <span id="abstention-pct">Abstens√£o: 20%</span><br>
                            <span id="null-vote-pct">Voto Nulo: 3%</span><br>
                            <small style="color:#666">Alta absten√ß√£o = menos votos em jogo. Votos nulos n√£o contam.</small>
                        </div>
                    </div>
                    <div style="background:#e8e8ff;border:1px solid #999;padding:8px;">
                        <b>üöÄ AVAN√áO AUTOM√ÅTICO</b><br>
                        <small>Simula todos os turnos restantes instantaneamente.</small><br><br>
                        <button class="btn" style="background:#000080;color:white" onclick="autoSimulateAll()">‚è© Simular Restante</button>
                    </div>
                </div>

                <div id="terminal-log"></div>
                <button class="btn" style="background:var(--gold); margin-top:10px" onclick="nextTurn()">ENCERRAR DIA</button>
                <div style="margin-top:5px; font-size:10px"><b>SUA COLIGA√á√ÉO:</b><br><div id="my-coalition"></div></div>
            </div>

            <div class="card" style="padding:0">
                <div class="brazil-map" id="map-container"></div>
                <div id="state-details" style="padding:8px;background:#eee;border-top:2px solid #888;font-size:12px; height: 130px;">
                    Selecione um estado no mapa.
                </div>
            </div>

            <div class="card">
                <b>PESQUISA NACIONAL</b> <button class="btn" style="width:auto;font-size:9px;padding:2px 5px;float:right" onclick="showChart()">üìä GR√ÅFICO</button><hr>
                <table class="polling-table" id="polling-body"></table>
                <div id="abstention-mini" style="font-size:9px;color:#888;margin-top:4px;padding:2px;border-top:1px solid #ddd;">üìä <span id="abstention-mini-text">Absten√ß√£o: ~20%</span></div>
                <div id="approval-section" style="margin-top:8px;font-size:10px;"><b>APROVA√á√ÉO / REJEI√á√ÉO</b><div id="approval-bars"></div></div>
                <div id="tv-time-section" style="margin-top:6px;font-size:10px;border-top:2px solid #888;padding-top:6px">
                    <b>üì∫ TEMPO DE TV</b> <span id="player-tv-label" style="color:#cc8800;font-weight:bold"></span>
                    <div id="tv-time-bars"></div>
                    <div id="tv-time-effect" style="font-size:9px;color:#666;margin-top:2px"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="end-screen" class="screen">
        <div class="card" style="padding:20px; text-align:center; background: #999;">
            <div class="newspaper-wrap">
                <div class="news-header">
                    <h1 id="result-title">BRASIL TEM NOVO PRESIDENTE</h1>
                    <small id="result-subtitle">EDI√á√ÉO EXTRA</small>
                </div>
                <div id="result-desc" style="font-family:'Times New Roman'; font-size:16px; margin: 20px 0;"></div>
                <hr>
                <div id="candidate-bio" style="font-family:'Times New Roman'; font-size:14px; text-align: justify;"></div>
            </div>
            <br>
            <button class="btn" style="width:200px" onclick="location.reload()">REINICIAR SIMULA√á√ÉO</button>
        </div>
        <div class="card" style="margin-top:10px; padding:15px;" id="congress-section">
            <b>üèõÔ∏è COMPOSI√á√ÉO DO CONGRESSO</b><hr>
            <div id="congress-bars"></div>
            <div id="congress-gov" style="margin-top:8px; font-size:12px;"></div>
        </div>
        <div class="card" style="margin-top:10px; padding:15px;" id="ranking-section">
            <b>üèÜ AVALIA√á√ÉO FINAL</b><hr>
            <div id="ranking-content"></div>
        </div>
</div>

<!-- GR√ÅFICO TEMPORAL MODAL -->
<div id="chart-modal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.85);z-index:2000;justify-content:center;align-items:center;">
    <div style="background:#111;border:2px solid lime;padding:15px;width:700px;max-width:95vw;">
        <div style="display:flex;justify-content:space-between;color:lime;margin-bottom:10px;">
            <b>üìä HIST√ìRICO DE PESQUISAS - EVOLU√á√ÉO</b>
            <span onclick="document.getElementById('chart-modal').style.display='none'" style="cursor:pointer;color:#f00">[X]</span>
        </div>
        <canvas id="poll-chart" width="660" height="200" style="background:#000;border:1px solid #333;display:block;"></canvas>
        <div id="chart-legend" style="margin-top:8px;font-size:10px;color:#aaa;display:flex;gap:10px;flex-wrap:wrap;"></div>
    </div>
</div>

<div id="modal-overlay">
    <div class="modal">
        <h3 id="modal-title" style="margin-top:0"></h3>
        <div id="modal-text" style="font-size:12px; margin-bottom:10px"></div>
        <div id="modal-buttons"></div>
    </div>
</div>

<script>
const allStates = [
    {id:'AC', n:'Acre', x:5, y:35, p:1, r:'Norte', econ:-1, soc:0, nat:1}, {id:'AL', n:'Alagoas', x:92, y:40, p:2, r:'Nordeste', econ:-2, soc:1, nat:0}, {id:'AP', n:'Amap√°', x:55, y:5, p:1, r:'Norte', econ:0, soc:0, nat:1},
    {id:'AM', n:'Amazonas', x:20, y:20, p:4, r:'Norte', econ:-1, soc:0, nat:1}, {id:'BA', n:'Bahia', x:78, y:48, p:8, r:'Nordeste', econ:-2, soc:1, nat:0}, {id:'CE', n:'Cear√°', x:82, y:22, p:5, r:'Nordeste', econ:-1, soc:1, nat:0},
    {id:'DF', n:'Dist. Federal', x:58, y:50, p:2, r:'Centro-Oeste', econ:1, soc:0, nat:0}, {id:'ES', n:'Esp. Santo', x:75, y:65, p:2, r:'Sudeste', econ:1, soc:-1, nat:0}, {id:'GO', n:'Goi√°s', x:52, y:52, p:4, r:'Centro-Oeste', econ:1, soc:-1, nat:1},
    {id:'MA', n:'Maranh√£o', x:70, y:22, p:3, r:'Nordeste', econ:-2, soc:1, nat:0}, {id:'MT', n:'Mato Grosso', x:40, y:45, p:3, r:'Centro-Oeste', econ:1, soc:-2, nat:1}, {id:'MS', n:'Mato G. Sul', x:42, y:65, p:2, r:'Centro-Oeste', econ:1, soc:-1, nat:1},
    {id:'MG', n:'Minas Gerais', x:65, y:60, p:11, r:'Sudeste', econ:0, soc:0, nat:0}, {id:'PA', n:'Par√°', x:48, y:22, p:5, r:'Norte', econ:-1, soc:0, nat:1}, {id:'PB', n:'Para√≠ba', x:90, y:28, p:2, r:'Nordeste', econ:-1, soc:1, nat:0},
    {id:'PR', n:'Paran√°', x:50, y:75, p:6, r:'Sul', econ:1, soc:-1, nat:0}, {id:'PE', n:'Pernambuco', x:88, y:33, p:5, r:'Nordeste', econ:-1, soc:2, nat:0}, {id:'PI', n:'Piau√≠', x:75, y:30, p:2, r:'Nordeste', econ:-2, soc:1, nat:0},
    {id:'RJ', n:'Rio de Janeiro', x:72, y:72, p:9, r:'Sudeste', econ:0, soc:1, nat:0}, {id:'RN', n:'Rio G. Norte', x:90, y:20, p:2, r:'Nordeste', econ:-1, soc:1, nat:0}, {id:'RS', n:'Rio G. do Sul', x:45, y:88, p:7, r:'Sul', econ:0, soc:-1, nat:-1},
    {id:'RO', n:'Rond√¥nia', x:25, y:45, p:1, r:'Norte', econ:0, soc:-1, nat:1}, {id:'RR', n:'Roraima', x:25, y:5, p:1, r:'Norte', econ:0, soc:-1, nat:1}, {id:'SC', n:'S. Catarina', x:52, y:82, p:4, r:'Sul', econ:1, soc:-2, nat:0},
    {id:'SP', n:'S√£o Paulo', x:58, y:72, p:23, r:'Sudeste', econ:2, soc:0, nat:-1}, {id:'SE', n:'Sergipe', x:88, y:45, p:1, r:'Nordeste', econ:-1, soc:1, nat:0}, {id:'TO', n:'Tocantins', x:58, y:35, p:1, r:'Norte', econ:-1, soc:0, nat:1}
];

// ===== STATE TRAITS =====
// Cada estado tem traits que afetam b√¥nus de campanhas
const stateTraits = {
    // === NORDESTE ‚Äî Base hist√≥rica do PT/Esquerda ===
    'AL': [{id:'nordeste_base', label:'‚òÄÔ∏è Base PT',      desc:'Reduto hist√≥rico do PT; esquerda tem vantagem s√≥lida', side:'E', bonus:8},{id:'pobreza', label:'üìâ Alta Pobreza', desc:'Estado muito pobre; candidatos de transfer√™ncia de renda ganham', side:'E', bonus:4}],
    'BA': [{id:'nordeste_base', label:'‚òÄÔ∏è Basti√£o NE',   desc:'Maior estado do NE; PT domina desde Lula', side:'E', bonus:9},{id:'industrial_ne', label:'‚öôÔ∏è Polo Industrial', desc:'Cama√ßari; voto oper√°rio favorece esquerda', side:'E', bonus:3}],
    'CE': [{id:'nordeste_base', label:'‚òÄÔ∏è Base NE',      desc:'Fortaleza progressista; esquerda forte', side:'E', bonus:7},{id:'linhagem_cid', label:'ü§ù PDT/Cid Gomes', desc:'M√°quina pol√≠tica local; favorece centro-esquerda', side:'C', bonus:3}],
    'MA': [{id:'nordeste_base', label:'‚òÄÔ∏è Base NE',      desc:'Estado pobre; esquerda favorecida', side:'E', bonus:6},{id:'sarney', label:'üèõÔ∏è M√°quina Sarney', desc:'Oligarquia hist√≥rica; centro tem influ√™ncia', side:'C', bonus:4}],
    'PB': [{id:'nordeste_base', label:'‚òÄÔ∏è Base NE',      desc:'B√¥nus para esquerda', side:'E', bonus:7}],
    'PE': [{id:'nordeste_base', label:'‚òÄÔ∏è Base NE',      desc:'Recife tem forte voto de esquerda', side:'E', bonus:7},{id:'trabalhista', label:'‚úä Trabalhismo',   desc:'Tradi√ß√£o sindical forte no Grande Recife', side:'E', bonus:4}],
    'PI': [{id:'nordeste_base', label:'‚òÄÔ∏è Base NE',      desc:'Um dos estados mais pobres; voto de esquerda forte', side:'E', bonus:8}],
    'RN': [{id:'nordeste_base', label:'‚òÄÔ∏è Base NE',      desc:'B√¥nus para esquerda', side:'E', bonus:7}],
    'SE': [{id:'nordeste_base', label:'‚òÄÔ∏è Base NE',      desc:'B√¥nus para esquerda', side:'E', bonus:7}],
    
    // === SUL ‚Äî Conservador / Direita ===
    'PR': [{id:'sul_conservador', label:'üåæ Sul Conservador', desc:'Interior conservador; coloniza√ß√£o europeia', side:'D', bonus:6},{id:'agro', label:'üåæ Agroneg√≥cio', desc:'Forte produ√ß√£o agr√≠cola no interior', side:'D', bonus:4}],
    'SC': [{id:'sul_conservador', label:'üåæ Mais Conservador', desc:'Estado mais conservador do Brasil; direita domina', side:'D', bonus:10},{id:'evangelico', label:'‚úùÔ∏è Evang√©lico', desc:'Alto % de evang√©licos', side:'D', bonus:3}],
    'RS': [{id:'gaucho_independente', label:'üê¥ Ga√∫cho Independente', desc:'Eleitorado independente; centro-esquerda tradicional compete', side:'C', bonus:3},{id:'sul_conservador', label:'üåæ Interior Conservador', desc:'Interior conservador; direita tem base s√≥lida', side:'D', bonus:5}],
    
    // === CENTRO-OESTE ‚Äî Agro / Direita ===
    'GO': [{id:'agro', label:'üåæ Agroneg√≥cio',   desc:'B√¥nus para candidatos pr√≥-agroneg√≥cio', side:'D', bonus:7},{id:'evangelico', label:'‚úùÔ∏è Evang√©lico', desc:'Alto % de evang√©licos; conservadores ganham', side:'D', bonus:4}],
    'MT': [{id:'agro', label:'üåæ Rei do Agro',   desc:'Maior produtor de soja; direita ruralista domina', side:'D', bonus:9},{id:'evangelico', label:'‚úùÔ∏è Evang√©lico', desc:'Forte presen√ßa evang√©lica', side:'D', bonus:3}],
    'MS': [{id:'agro', label:'üåæ Agroneg√≥cio',   desc:'Estado do boi e da soja; direita favorecida', side:'D', bonus:7}],
    'DF': [{id:'funcionalismo', label:'üìã Funcionalismo', desc:'Capital; candidatos que defendem servidores ganham', side:'C', bonus:4},{id:'classe_media_alta', label:'üíº Elite Bras√≠lia', desc:'Alta concentra√ß√£o de renda; direita tem base', side:'D', bonus:5}],
    'TO': [{id:'agro', label:'üåæ Agroneg√≥cio',   desc:'Fronteira agr√≠cola; direita favorecida', side:'D', bonus:6}],
    
    // === NORTE ‚Äî Diverso / Amaz√¥nia ===
    'AC': [{id:'amazonia', label:'üåø Amaz√¥nia',   desc:'B√¥nus para candidatos ambientalistas e de esquerda', side:'E', bonus:5}],
    'AP': [{id:'fronteira', label:'üó∫Ô∏è Fronteira', desc:'Estado pequeno; campanhas nacionais t√™m menos impacto', side:null, bonus:0}],
    'AM': [{id:'amazonia', label:'üåø Amaz√¥nia',   desc:'B√¥nus para candidatos ambientalistas e de esquerda', side:'E', bonus:5},{id:'indigena', label:'üèπ Ind√≠gena', desc:'Grande popula√ß√£o ind√≠gena; pr√≥-demarca√ß√£o ganham b√¥nus', side:'E', bonus:3}],
    'PA': [{id:'amazonia', label:'üåø Amaz√¥nia',   desc:'B√¥nus para candidatos ambientalistas', side:'E', bonus:4},{id:'garimpo', label:'‚õèÔ∏è Garimpo', desc:'Presen√ßa miner√°ria; candidatos pr√≥-desenvolvimento favorecidos', side:'D', bonus:4}],
    'RO': [{id:'fronteira_agro', label:'üåæ Fronteira Agr√≠cola', desc:'Direita ruralista domina', side:'D', bonus:6}],
    'RR': [{id:'militares', label:'üéñÔ∏è Presen√ßa Militar', desc:'Forte presen√ßa das for√ßas armadas; direita favorecida', side:'D', bonus:6}],
    
    // === SUDESTE ‚Äî Diverso / Disputado ===
    'MG': [{id:'equilibrio', label:'‚öñÔ∏è Equil√≠brio', desc:'Estado mais disputado; candidatos de centro t√™m vantagem relativa', side:'C', bonus:4},{id:'industria', label:'üè≠ Industrial', desc:'Setor metal√∫rgico em BH; esquerda tem base', side:'E', bonus:3}],
    'ES': [{id:'espirito_empreendedor', label:'üè≠ Empreendedor', desc:'Forte cultura empresarial; direita favorecida', side:'D', bonus:6}],
    'RJ': [{id:'volatil', label:'üé≤ Vol√°til', desc:'Eleitorado imprevis√≠vel ‚Äî requer investimento pesado', side:null, bonus:0},{id:'milicia', label:'‚ö†Ô∏è Mil√≠cia', desc:'Crime organizado influente; seguran√ßa p√∫blica tem apelo', side:'D', bonus:4},{id:'classe_trabalhadora', label:'‚úä Operariado', desc:'Grande classe trabalhadora urbana; esquerda tem base', side:'E', bonus:4}],
    'SP': [{id:'financeiro', label:'üí∞ Centro Financeiro', desc:'Maior eleitorado; candidatos de direita econ√¥mica favorecidos', side:'D', bonus:4},{id:'industria', label:'üè≠ ABC Industrial', desc:'ABC paulista tem forte base sindical e petista', side:'E', bonus:5},{id:'disputado', label:'üéØ Disputado', desc:'Estado mais disputado do Brasil ‚Äî crucial para a vit√≥ria', side:null, bonus:0}],
};

// ===== BASE ELEITORAL SYSTEM =====
// Rastreia satisfa√ß√£o de cada classe social
function initBaseEleitoral() {
    game.baseEleitoral = {
        baixa:  { satisfacao: 50, desc: 'Classe Baixa', icon: 'üèòÔ∏è', color: '#cc4444' },
        media:  { satisfacao: 50, desc: 'Classe M√©dia', icon: 'üè†', color: '#cc8800' },
        alta:   { satisfacao: 50, desc: 'Classe Alta',  icon: 'üè¢', color: '#4444cc' },
    };
}

const newsArchive = [
    {t: "Economy", d: "Markets react with optimism to the latest electoral polls."},
    {t: "Labor Strike", d: "Workers in key industries announce a 48-hour strike."},
    {t: "Economic Growth", d: "GDP figures show stronger-than-expected growth this quarter."},
    {t: "Inflation", d: "Consumer price indexes show record stability ‚Äî a campaign issue."},
    {t: "Leaked Dossier", d: "An anonymous dossier targeting a candidate shakes up the race."},
    {t: "World News", d: "Global economic uncertainty affects domestic campaign debate."},
    {t: "Culture", d: "A popular TV show breaks viewership records, dominating national conversation."},
    {t: "Infrastructure", d: "Road and rail projects are fast-tracked amid campaign promises."},
    {t: "Education", d: "Literacy rates improve ‚Äî candidates debate who deserves credit."},
    {t: "Public Health", d: "Government announces emergency vaccination drive."},
    {t: "Drought Crisis", d: "Agricultural regions hit by drought; candidates promise aid."},
    {t: "Unemployment", d: "Jobless rate reaches highest level in years ‚Äî economy dominates debate."},
    {t: "Security", d: "Urban crime statistics fuel public safety debate on the campaign trail."},
    {t: "Agriculture", d: "Farmers protest rising credit costs and import competition."},
    {t: "Social Media", d: "Candidates invest heavily in influencer campaigns targeting young voters."},
    {t: "New Poll", d: "Latest survey confirms a statistical dead heat between the two frontrunners."},
    {t: "Energy", d: "Fuel prices spike, becoming a central campaign flashpoint."},
    {t: "Faith Vote", d: "Religious leaders divide their endorsements; faith community mobilizes."},
    {t: "Corruption", d: "Audit report reveals irregularities in public contracts."},
    {t: "Youth Vote", d: "First-time voter registrations surge to record levels."},
    {t: "International", d: "Foreign markets closely watching this election outcome."},
    {t: "Fact Check", d: "Fact-checkers work overtime as misinformation spreads in final weeks."},
    {t: "Regional Debate", d: "Candidates hold regional debates addressing local concerns."},
    {t: "Climate Event", d: "Major weather disaster shifts the environmental debate to center stage."},
    {t: "Court Ruling", d: "High court decision stirs the electoral landscape and divides public opinion."},
    {t: "Parliament", d: "Legislature passes measure directly affecting campaign finance rules."},
    {t: "Scandal Recording", d: "Leaked recording of a campaign aide causes political uproar."},
    {t: "Electoral Authority", d: "Electoral commission orders removal of misleading campaign materials."},
    {t: "Trade Balance", d: "Favorable trade figures bolster incumbent's economic narrative."},
    {t: "Exports", d: "Strong export numbers sustain government's economic messaging."}
];

// Eventos hist√≥ricos reais por cen√°rio
const historicalEvents = {
    "1945": [
        {turn:2, t:"FIM DO ESTADO NOVO", d:"Get√∫lio Vargas √© deposto. A ditadura acaba. O Brasil vai √†s urnas pela primeira vez desde 1930. O povo mal sabe como votar. Candidatos precisam explicar a democracia.", b:[{n:"√änfase na liberdade democr√°tica", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=5; }},{n:"Criticar o legado varguista", f:()=>{ updateNationalVotes(game.player, game.player==='dutra'?-1:2.5); }}]},
        {turn:4, t:"VARGAS LAN√áA O PTB", d:"Embora deposto, Vargas lan√ßa o PTB e apoia o General Dutra. O trabalhismo vira for√ßa eleitoral. Candidatos precisam se posicionar sobre o legado getulista.", b:[{n:"Endossar o legado trabalhista", f:()=>{ updateNationalVotes(game.player, game.player==='dutra'?2:0.5); game.approvals[game.player].app+=3; }},{n:"Opor-se: 'Queremos democracia pura'", f:()=>{ updateNationalVotes(game.player, game.player==='brigadeiro'?2.5:1); }}]},
        {turn:6, t:"SEGUNDA GUERRA TERMINA", d:"Com a vit√≥ria aliada, a FEB (For√ßa Expedicion√°ria Brasileira) volta do front. Soldados s√£o vistos como her√≥is. O General Dutra, ex-ministro da Guerra, se beneficia da aura militar.", b:[{n:"Homenagear a FEB", f:()=>{ updateNationalVotes(game.player, game.player==='dutra'?2.5:1.5); game.approvals[game.player].app+=4; }},{n:"Focar no retorno √† vida civil", f:()=>{ updateNationalVotes(game.player,1.5); game.money+=5; }}]},
        {turn:8, t:"CAMPANHA EM VIAS RURAIS", d:"O Brasil √© majoritariamente rural. Coron√©is controlam o voto de fazendeiros e trabalhadores rurais. Quem conquista os coron√©is do Nordeste e do interior de MG e SP, conquista a elei√ß√£o.", b:[{n:"Negociar com coron√©is (R$10M)", f:()=>{ if(game.money>=10){game.money-=10; updateNationalVotes(game.player,3); }}},{n:"Discurso modernizador para as cidades", f:()=>{ updateNationalVotes(game.player, game.player==='brigadeiro'?2:1.5); game.approvals[game.player].app+=3; }}]},
        {turn:10, t:"DEBATE SOBRE RELA√á√ïES COM EUA", d:"Fim da Segunda Guerra. O Brasil precisa decidir seu alinhamento geopol√≠tico. Os EUA pressionam por alinhamento anticomunista. Como voc√™ se posiciona?", b:[{n:"Alinhamento com os EUA", f:()=>{ updateNationalVotes(game.player,2); game.money+=10; }},{n:"Independ√™ncia nacional soberana", f:()=>{ updateNationalVotes(game.player, game.player==='yedo'?2.5:1.5); game.approvals[game.player].app+=3; }}]},
    ],
    "1950": [
        {turn:2, t:"VARGAS VOLTA ‚Äî 'EU VOLTO'", d:"Get√∫lio Vargas, deposto em 1945, retorna candidato. Seu slogan 'Eu Volto' ressoa com os trabalhadores urbanos. Como voc√™ responde ao maior pol√≠tico do s√©culo XX?", b:[{n:"Atacar Vargas como o ditador", f:()=>{ updateNationalVotes(game.player, game.player!=='getuliopr'?2.5:0); }},{n:"Propor alternativa modernizadora", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=4; }},{n:"Tentar captar o voto trabalhista", f:()=>{ updateNationalVotes(game.player, game.player==='gomes50'?1:2); }}]},
        {turn:4, t:"PESO DO TRABALHISMO URBANO", d:"As cidades crescem. Industri√°rios, ferrovi√°rios, servidores p√∫blicos. Get√∫lio fala direto a eles pela r√°dio. O r√°dio √© a internet da √©poca ‚Äî quem domina o r√°dio, domina a elei√ß√£o.", b:[{n:"Investir pesado no r√°dio (R$15M)", f:()=>{ if(game.money>=15){game.money-=15; updateNationalVotes(game.player,3.5); }}},{n:"M√≠tings e com√≠cios populares", f:()=>{ updateNationalVotes(game.player,2); }}]},
        {turn:6, t:"ACUSA√á√ïES DE DEMAGOGO", d:"A UDN e a imprensa acusam Vargas de demagogo e de tentar ressuscitar o Estado Novo. A classe m√©dia de SP e RJ reage mal ao varguismo. Como voc√™ capitaliza?", b:[{n:"Explorar o medo da ditadura", f:()=>{ updateNationalVotes(game.player, game.player!=='getuliopr'?2.5:-1); }},{n:"Defender que o trabalhismo √© democr√°tico", f:()=>{ updateNationalVotes(game.player, game.player==='getuliopr'?2:1); game.approvals[game.player].app+=3; }}]},
        {turn:9, t:"NORDESTE E S√ÉO FRANCISCO", d:"As secas do Nordeste voltam √† pauta. Get√∫lio promete a CHESF (hidrel√©trica de Paulo Afonso). A promessa de luz el√©trica para o NE √© um divisor de √°guas.", b:[{n:"Prometer infraestrutura para o NE", f:()=>{ updateNationalVotes(game.player,2.5); game.approvals[game.player].app+=4; }},{n:"Focar na ind√∫stria sulista", f:()=>{ updateNationalVotes(game.player, game.player==='gomes50'?2:1); game.money+=8; }}]},
    ],
    "1955": [
        {turn:2, t:"CRISE P√ìS-VARGAS: SUIC√çDIO DO PRESIDENTE", d:"O suic√≠dio de Vargas em 1954 ainda d√≥i na mem√≥ria nacional. JK herda o legado trabalhista do PTB. A UDN tenta capitalizar o trauma. Como voc√™ aborda o assunto?", b:[{n:"Honrar a mem√≥ria de Vargas", f:()=>{ updateNationalVotes(game.player, game.player==='jk'?2.5:0.5); game.approvals[game.player].app+=4; }},{n:"Superar o varguismo com modernidade", f:()=>{ updateNationalVotes(game.player, game.player==='jk'?2:1.5); }},{n:"Culpar o PTB pela instabilidade", f:()=>{ updateNationalVotes(game.player, game.player==='juarez'?2.5:-1); }}]},
        {turn:4, t:"50 ANOS EM 5 ‚Äî PLANO DE METAS DE JK", d:"Juscelino Kubitschek promete 'Cinquenta Anos em Cinco': Bras√≠lia, rodovias, ind√∫stria automobil√≠stica. O programa de metas √© audacioso. Candidatos precisam responder.", b:[{n:"Endossar o desenvolvimentismo", f:()=>{ updateNationalVotes(game.player, game.player==='jk'?3:-0.5); game.approvals[game.player].app+=4; }},{n:"Questionar: 'De onde vem o dinheiro?'", f:()=>{ updateNationalVotes(game.player, game.player==='juarez'||game.player==='plinio55'?2.5:0.5); game.points+=2; }},{n:"Proposta alternativa de austeridade", f:()=>{ updateNationalVotes(game.player,1.5); game.money+=10; }}]},
        {turn:6, t:"TENTATIVA DE GOLPE CONTRA JK", d:"Militares da linha dura tentam impedir a posse de JK. O general Teixeira Lott d√° um 'contragolpe' para garantir a democracia. A UDN fica desmoralizada.", b:[{n:"Defender a democracia e Lott", f:()=>{ updateNationalVotes(game.player, game.player==='jk'?3:1.5); game.approvals[game.player].app+=5; }},{n:"Criticar a interven√ß√£o militar", f:()=>{ updateNationalVotes(game.player, game.player==='juarez'?2:1); }}]},
        {turn:9, t:"INTEGRALISMO E ANTICOMUNISMO", d:"Pl√≠nio Salgado acusa comunistas de infiltrarem os partidos. O integralismo ressurge no PRP. Candidatos precisam definir posi√ß√£o no espectro anticomunista.", b:[{n:"Anticomunismo firme mas democr√°tico", f:()=>{ updateNationalVotes(game.player, game.player==='juarez'?2.5:1); }},{n:"Ignorar e focar no desenvolvimento", f:()=>{ updateNationalVotes(game.player, game.player==='jk'?2:1); }},{n:"Endossar posi√ß√µes integralistas", f:()=>{ updateNationalVotes(game.player, game.player==='plinio55'?3:-2); }}]},
    ],
    "1960": [
        {turn:2, t:"J√ÇNIO QUADROS: O VARREDOR DE VASSOURA", d:"J√¢nio usa uma vassoura como s√≠mbolo ‚Äî vai 'varrer a corrup√ß√£o'. Seu estilo exc√™ntrico diverte e preocupa. JQ domina as pesquisas com apelo popular √∫nico.", b:[{n:"Usar s√≠mbolo pr√≥prio anti-corrup√ß√£o", f:()=>{ updateNationalVotes(game.player,2.5); }},{n:"Atacar o estilo populista de J√¢nio", f:()=>{ updateNationalVotes(game.player, game.player!=='janio'?2:0.5); }}]},
        {turn:4, t:"INAUGURA√á√ÉO DE BRAS√çLIA", d:"Juscelino inaugura Bras√≠lia em abril de 1960, menos de 4 anos ap√≥s o in√≠cio das obras. A proeza √© imensa. JK tenta transferir o capital pol√≠tico de seu governo para Lott.", b:[{n:"Celebrar: 'JK mostrou que o Brasil pode'", f:()=>{ updateNationalVotes(game.player, game.player==='lott'?2:1); game.approvals[game.player].app+=4; }},{n:"Criticar o endividamento de Bras√≠lia", f:()=>{ updateNationalVotes(game.player, game.player==='janio'?2.5:1.5); }}]},
        {turn:7, t:"DEBATE SOBRE CUBA E COMUNISMO", d:"A Revolu√ß√£o Cubana de 1959 assusta a direita. A quest√£o comunista domina o debate. J√¢nio tenta posi√ß√£o amb√≠gua; Lott √© mais claro.", b:[{n:"Anticomunismo veemente", f:()=>{ updateNationalVotes(game.player, game.player==='janio'||game.player==='adhemar'?2:0.5); }},{n:"Rela√ß√µes independentes e soberanas", f:()=>{ updateNationalVotes(game.player, game.player==='lott'?2.5:1.5); game.approvals[game.player].app+=3; }}]},
        {turn:10, t:"CAMPANHA NACIONAL DE R√ÅDIO", d:"O r√°dio ainda domina. J√¢nio √© carism√°tico no microfone. Lott √© formal e militar. A comunica√ß√£o define a elei√ß√£o.", b:[{n:"Campanha emocional no r√°dio (R$15M)", f:()=>{ if(game.money>=15){game.money-=15; updateNationalVotes(game.player,3); }}},{n:"Programa t√©cnico de TV (R$12M)", f:()=>{ if(game.money>=12){game.money-=12; updateNationalVotes(game.player,2); game.approvals[game.player].app+=4; }}}]},
    ],
    "1965_s": [
        {turn:2, t:"GOLPE DE 1964 ‚Äî ELEI√á√ÉO SIMULADA", d:"Em 1965, se houvesse elei√ß√µes diretas, Lacerda e Kubitschek seriam os favoritos. Os militares, no poder, cancelaram as elei√ß√µes. Este √© um cen√°rio alternativo.", b:[{n:"Defender o retorno √† democracia", f:()=>{ updateNationalVotes(game.player,2.5); game.approvals[game.player].app+=5; }},{n:"Apelo ao desenvolvimentismo de JK", f:()=>{ updateNationalVotes(game.player, game.player==='jk65'?3:1); }}]},
    ],
    "2026": [],
    "1994": [
        {turn:2, t:"AYRTON SENNA MORRE EM √çMOLA", d:"O maior piloto brasileiro falece. O pa√≠s inteiro para. Candidatos precisam se posicionar com cuidado.", b:[{n:"Homenagem solene (sem campanha)", f:()=>{ updateNationalVotes(game.player,1.5); game.approvals[game.player].app+=5; }},{n:"Manter agenda normal", f:()=>{ game.approvals[game.player].rej+=3; }}], historical:true},
        {turn:4, t:"PLANO REAL LAN√áADO", d:"Em 1 de julho, o Real entra em circula√ß√£o. Infla√ß√£o despenca. FHC aparece como her√≥i, Lula precisa recalcular estrat√©gia.", b:[{n:"Elogiar estabilidade", f:()=>{ updateNationalVotes(game.player,2); }},{n:"Criticar: '√â eleitoreiro!'", f:()=>{ game.points+=3; updateNationalVotes(game.player,-1); }}], historical:true},
        {turn:6, t:"BRASIL TETRACAMPE√ÉO!", d:"O Brasil vence a Copa do Mundo nos EUA. Euforia nacional. Todos os candidatos tentam surfar a onda.", b:[{n:"Festa e palanque", f:()=>{ updateNationalVotes(game.player,3); }},{n:"Falar de futebol e pol√≠tica", f:()=>{ updateNationalVotes(game.player,1.5); }}], historical:true},
        {turn:9, t:"PESQUISA DATAFOLHA BOMB√ÅSTICA", d:"Nova pesquisa mostra FHC com mais de 40%. Lula em 22%. En√©as surpreende com 7%.", b:[{n:"Contratar pesquisa pr√≥pria (R$8M)", f:()=>{ game.money-=8; updateNationalVotes(game.player,1); }},{n:"Ignorar e focar base", f:()=>{ game.points+=2; }}], historical:true},
        {turn:12, t:"DEBATE NA BAND", d:"Debate entre os principais candidatos. Clima tenso. Troca de acusa√ß√µes sobre o Plano Real.", b:[{n:"Atacar advers√°rio", f:()=>{ updateNationalVotes(game.player,2.5); game.approvals[game.player].rej+=4; }},{n:"Propor programa de governo", f:()=>{ updateNationalVotes(game.player,1.5); game.approvals[game.player].app+=5; }},{n:"Defender Plano Real", f:()=>{ updateNationalVotes('fhc'?game.player==='fhc'?game.player:'fhc':game.player,2); }}], historical:true},
    ],
    "1989": [
        {turn:2, t:"CONSTITUI√á√ÉO DE 1988 ENTRA EM VIGOR", d:"A nova Carta Magna est√° em vigor h√° menos de um ano. O discurso sobre democracia e cidadania domina o debate eleitoral.", b:[{n:"Defender a Constitui√ß√£o", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=4; }},{n:"Criticar excessos", f:()=>{ game.points+=3; updateNationalVotes(game.player,0.5); }}], historical:true},
        {turn:3, t:"CASO DOS AN√ïES DO OR√áAMENTO", d:"Corrup√ß√£o no Congresso abala a confian√ßa. Collor capitaliza no discurso anti-establishment.", b:[{n:"Atacar o sistema pol√≠tico", f:()=>{ updateNationalVotes(game.player,3); }},{n:"Propor reforma pol√≠tica", f:()=>{ updateNationalVotes(game.player,1.5); game.approvals[game.player].app+=3; }}], historical:true},
        {turn:5, t:"HIPERINFLA√á√ÉO BATE RECORDE", d:"Infla√ß√£o mensal ultrapassa 50%. O Brasil est√° com a economia em colapso. Quem prometer solu√ß√£o concreta ganha pontos.", b:[{n:"Plano de choque econ√¥mico", f:()=>{ updateNationalVotes(game.player,3.5); game.approvals[game.player].app+=6; }},{n:"Denunciar concentra√ß√£o de renda", f:()=>{ updateNationalVotes(game.player,2); }},{n:"Propor congelamento de pre√ßos", f:()=>{ updateNationalVotes(game.player,1.5); game.points+=2; }}], historical:true},
        {turn:7, t:"CA√áA AOS MARAJ√ÅS DE COLLOR", d:"Collor promete demitir servidores com sal√°rios absurdos. O slogan 'ca√ßa aos maraj√°s' explode nas pesquisas. Como voc√™ responde?", b:[{n:"Endossar o discurso (arriscado)", f:()=>{ updateNationalVotes(game.player,3); }},{n:"Defender servidores p√∫blicos", f:()=>{ game.approvals[game.player].app+=5; updateNationalVotes(game.player,1); }},{n:"Propor revis√£o salarial t√©cnica", f:()=>{ game.points+=3; }}], historical:true},
        {turn:9, t:"PESQUISA IBOPE: BRIZOLA CAI", d:"Brizola que liderava perde espa√ßo para Lula e Collor. O voto √∫til come√ßa a migrar. Momento decisivo para candidatos menores.", b:[{n:"Campanha agressiva de tv (R$20M)", f:()=>{ if(game.money>=20){game.money-=20; updateNationalVotes(game.player,4);} }},{n:"Discurso de resist√™ncia", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=3; }}], historical:true},
        {turn:11, t:"DEBATE HIST√ìRICO: COLLOR X LULA", d:"O debate mais assistido da hist√≥ria brasileira. Tens√£o m√°xima. Collor ataca o passado pessoal de Lula. Lula responde com dados sobre desigualdade.", b:[{n:"Atacar com dados e n√∫meros", f:()=>{ updateNationalVotes(game.player,3); game.approvals[game.player].rej+=3; }},{n:"Discurso emocional da cidadania", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=6; }},{n:"Ser t√©cnico e moderado", f:()=>{ game.points+=3; updateNationalVotes(game.player,1); }}], historical:true},
        {turn:13, t:"SEGUNDO TURNO SE APROXIMA", d:"Collor e Lula parecem ser os finalistas. Candidatos menores precisam definir posi√ß√£o para o 2¬∫ turno.", b:[{n:"Declarar apoio antecipado", f:()=>{ updateNationalVotes(game.player,2); }},{n:"Manter candidatura firme", f:()=>{ game.approvals[game.player].app+=4; updateNationalVotes(game.player,1); }}], historical:true},
    ],
    "2014": [
        {turn:2, t:"PROTESTOS DE JUNHO DE 2013: LEGADO", d:"As manifesta√ß√µes do ano anterior ainda ecoam. 'N√£o √© pelos 20 centavos' virou s√≠mbolo. O antipetismo cresce, mas o PT ainda tem base s√≥lida.", b:[{n:"Reconhecer as demandas", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=4; }},{n:"Focar nas conquistas sociais", f:()=>{ updateNationalVotes(game.player,1.5); }},{n:"Criticar os manifestantes", f:()=>{ game.approvals[game.player].rej+=5; updateNationalVotes(game.player,-1); }}], historical:true},
        {turn:4, t:"MORTE DE EDUARDO CAMPOS", d:"O candidato do PSB morre em acidente de avi√£o em Santos. Marina Silva assume a candidatura e explode nas pesquisas, amea√ßando o segundo turno.", b:[{n:"Homenagem respeitosa", f:()=>{ game.approvals[game.player].app+=5; }},{n:"Accelerar campanha enquanto o rival reorganiza", f:()=>{ updateNationalVotes(game.player,2); }}], historical:true},
        {turn:5, t:"MARINA ULTRAPASSA A√âCIO NAS PESQUISAS", d:"O fen√¥meno Marina amea√ßa o segundo turno. Por alguns dias ela aparece liderando contra Dilma. O PT entra em modo de guerra.", b:[{n:"Atacar o programa de Marina", f:()=>{ updateNationalVotes(game.player,2.5); game.approvals[game.player].rej+=3; }},{n:"Refor√ßar propostas pr√≥prias", f:()=>{ updateNationalVotes(game.player,1.5); game.approvals[game.player].app+=3; }}], historical:true},
        {turn:7, t:"PETROBRAS E A LAVA-JATO", d:"Investiga√ß√µes da Opera√ß√£o Lava-Jato come√ßam a vazar para a m√≠dia. Suspeitas de desvio bilion√°rio na Petrobras amea√ßam o PT.", b:[{n:"Negar e contra-atacar", f:()=>{ game.scandalLevels['dilma']=(game.scandalLevels['dilma']||0)+2; updateNationalVotes(game.player, game.player==='dilma'?-1:2); }},{n:"Prometer investiga√ß√£o independente", f:()=>{ game.approvals[game.player].app+=3; updateNationalVotes(game.player,1); }}], historical:true},
        {turn:9, t:"DEBATE NA GLOBO ‚Äî 1¬∫ TURNO", d:"Debate acirrado. Dilma e A√©cio trocam farpas sobre economia. Marina tenta se firmar no centro. Luciana acusa todos de defender o capital.", b:[{n:"Ataque direto ao rival principal", f:()=>{ updateNationalVotes(game.player,2.5); game.approvals[game.player].rej+=3; }},{n:"Proposta concreta e t√©cnica", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=4; }},{n:"Discurso de renova√ß√£o pol√≠tica", f:()=>{ updateNationalVotes(game.player,1.5); }}], historical:true},
        {turn:11, t:"CRISE DO D√ìLAR E ECONOMIA", d:"O d√≥lar dispara. O mercado prefere A√©cio. Dilma defende o 'Brasil que n√£o pode voltar atr√°s'. A polariza√ß√£o esquenta.", b:[{n:"Defender o modelo econ√¥mico atual", f:()=>{ updateNationalVotes(game.player, game.player==='dilma'?2:-1); }},{n:"Prometer ajuste fiscal respons√°vel", f:()=>{ updateNationalVotes(game.player, game.player==='aecio'?3:0.5); game.money+=10; }}], historical:true},
        {turn:13, t:"SEGUNDO TURNO: DILMA X A√âCIO", d:"O segundo turno mais disputado da hist√≥ria recente. Brasil dividido ao meio. Cada voto conta.", b:[{n:"Mobiliza√ß√£o total da base", f:()=>{ updateNationalVotes(game.player,3); }},{n:"Campanha no hor√°rio eleitoral (R$15M)", f:()=>{ if(game.money>=15){game.money-=15; updateNationalVotes(game.player,2.5);} }},{n:"Apelar ao voto √∫til", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=3; }}], historical:true},
    ],
    "1998": [
        {turn:2, t:"CRISE ASI√ÅTICA CHEGA AO BRASIL", d:"Bolsas despencam no mundo inteiro. O real sofre press√£o especulativa. FHC anuncia pacote de austeridade. Quem vai colher os frutos da crise?", b:[{n:"Defender austeridade e o Real", f:()=>{ updateNationalVotes(game.player, game.player==='fhc98'?2.5:0.5); game.approvals[game.player].app+=3; }},{n:"Criticar vulnerabilidade externa", f:()=>{ updateNationalVotes(game.player, game.player==='fhc98'?-1:2.5); game.points+=2; }},{n:"Propor controle de capitais", f:()=>{ updateNationalVotes(game.player, game.player==='lula98'||game.player==='ciro98'?2:0.5); }}], historical:true},
        {turn:4, t:"COPA DO MUNDO: BRASIL PERDE A FINAL PARA A FRAN√áA", d:"3x0. Ronaldo entra em colapso antes da partida. O pa√≠s em choque. FHC √© visto no est√°dio. Como usar (ou n√£o) o momento?", b:[{n:"Solidariedade e luto nacional", f:()=>{ game.approvals[game.player].app+=4; updateNationalVotes(game.player,1.5); }},{n:"Prometer investimento no esporte", f:()=>{ updateNationalVotes(game.player,1.5); game.money-=5; }},{n:"Focar na campanha, ignorar Copa", f:()=>{ updateNationalVotes(game.player,0.5); game.points+=2; }}], historical:true},
        {turn:6, t:"FHC DEFENDE REELEI√á√ÉO: 'QUEM FAZ PRECISA CONTINUAR'", d:"FHC martela que s√≥ ele pode garantir a continuidade do Plano Real. Lula e Ciro tentam mostrar que estabilidade n√£o √© suficiente.", b:[{n:"Defender legado do Plano Real", f:()=>{ updateNationalVotes(game.player, game.player==='fhc98'?3:0.5); }},{n:"Atacar a reelei√ß√£o como concentra√ß√£o de poder", f:()=>{ updateNationalVotes(game.player,2.5); game.approvals[game.player].rej+=2; }},{n:"Propor terceira via econ√¥mica", f:()=>{ updateNationalVotes(game.player, game.player==='ciro98'?3:1.5); game.approvals[game.player].app+=3; }}], historical:true},
        {turn:8, t:"ATAQUE ESPECULATIVO AO REAL", d:"Bilh√µes saem do pa√≠s. Reservas caem. O governo eleva os juros para 40% ao ano. A bomba explodir√° depois das elei√ß√µes ‚Äî mas os candidatos precisam se posicionar agora.", b:[{n:"Apoiar medidas emergenciais", f:()=>{ updateNationalVotes(game.player, game.player==='fhc98'?2:-0.5); }},{n:"Denunciar: arrocho recai sobre os pobres", f:()=>{ updateNationalVotes(game.player, game.player==='lula98'?3:2); game.approvals[game.player].app+=4; }},{n:"Propor renegocia√ß√£o da d√≠vida externa", f:()=>{ updateNationalVotes(game.player, game.player==='ciro98'?3:1.5); game.approvals[game.player].rej+=2; }}], historical:true},
        {turn:10, t:"PESQUISAS: FHC PODE VENCER NO 1¬∫ TURNO", d:"Datafolha mostra FHC com 54% das inten√ß√µes de voto. O voto √∫til corr√≥i Ciro e En√©as. Candidatos menores entram em desespero.", b:[{n:"Investir forte em campanha (R$15M)", f:()=>{ if(game.money>=15){game.money-=15; updateNationalVotes(game.player,3);} }},{n:"Atacar por flancos alternativos", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].rej+=2; }},{n:"Apelar ao voto √∫til progressista", f:()=>{ updateNationalVotes(game.player, game.player!=='fhc98'?2.5:0.5); }}], historical:true},
        {turn:12, t:"DEBATE FINAL NA GLOBO", d:"√öltimo grande embate. FHC sereno. Lula agressivo. Ciro afiado nos n√∫meros. En√©as com o bord√£o de sempre. O Brasil decide.", b:[{n:"Ataque pesado ao favorito", f:()=>{ updateNationalVotes(game.player,3); game.approvals[game.player].rej+=4; }},{n:"Apresentar plano econ√¥mico detalhado", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=5; }},{n:"Discurso de soberania nacional", f:()=>{ updateNationalVotes(game.player, game.player==='ciro98'||game.player==='eneas98'?3:1.5); }}], historical:true},
    ],
    "2002": [
        {turn:2, t:"LULA LIDERA COM VANTAGEM HIST√ìRICA", d:"Pesquisas colocam Lula com 40%. O mercado financeiro em p√¢nico: risco-Brasil dispara. D√≥lar sobe. O PT precisa convencer que n√£o vai dar calote na d√≠vida.", b:[{n:"Moderar discurso para acalmar mercado", f:()=>{ updateNationalVotes(game.player, game.player==='lula02'?2:0.5); game.money+=10; }},{n:"Manter postura progressista firme", f:()=>{ updateNationalVotes(game.player, game.player==='lula02'?1.5:2); game.approvals[game.player].app+=3; }},{n:"Atacar o p√¢nico como manipula√ß√£o", f:()=>{ updateNationalVotes(game.player,2.5); game.approvals[game.player].rej+=3; }}], historical:true},
        {turn:4, t:"APAG√ÉO EL√âTRICO: CULPA DE QUEM?", d:"O racionamento de 2001 ainda d√≥i. A infraestrutura privatizada falhou. Candidatos disputam a narrativa da crise energ√©tica.", b:[{n:"Culpar as privatiza√ß√µes do governo FHC", f:()=>{ updateNationalVotes(game.player, game.player!=='serra'?2.5:0.5); }},{n:"Prometer plano energ√©tico robusto", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=3; }},{n:"Defender o modelo atual com ajustes", f:()=>{ updateNationalVotes(game.player, game.player==='serra'?2:-0.5); }}], historical:true},
        {turn:5, t:"CIRO EXPLODE NAS PESQUISAS", d:"Ciro Gomes sobe para 20% e amea√ßa disputar o 2¬∫ turno. Garotinho cresce no Nordeste com apelo evang√©lico. A corrida pelo 2¬∫ lugar est√° aberta.", b:[{n:"Atacar Ciro diretamente", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].rej+=3; updateNationalVotes(game.player==='ciro02'?game.player:'ciro02', game.player==='ciro02'?0:-1); }},{n:"Focar no pr√≥prio crescimento", f:()=>{ updateNationalVotes(game.player,2.5); game.approvals[game.player].app+=2; }},{n:"Proposta bomb√°stica de governo", f:()=>{ updateNationalVotes(game.player,2); }}], historical:true},
        {turn:7, t:"CARTA AO POVO BRASILEIRO", d:"Lula assina a hist√≥rica carta comprometendo-se a honrar contratos, manter super√°vit prim√°rio e combater a infla√ß√£o. O mercado respira. √â um divisor de √°guas na hist√≥ria do PT.", b:[{n:"Assinar carta similar de compromisso", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=5; game.money+=8; }},{n:"Criticar: '√â capitula√ß√£o ao mercado!'", f:()=>{ updateNationalVotes(game.player, game.player==='zemaria'||game.player==='pimenta'?3:-1); }},{n:"Aproveitar para apresentar plano pr√≥prio", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=3; }}], historical:true},
        {turn:9, t:"CIRO CHAMA ROSA DO PT DE ESPI√ÉO", d:"Em gafe hist√≥rica, Ciro Gomes implode sua candidatura ao chamar um assessor do PT de espi√£o. Queda nas pesquisas. Eleitores migram.", b:[{n:"Absorver eleitores de Ciro", f:()=>{ updateNationalVotes(game.player, game.player==='lula02'||game.player==='garotinho'?2.5:1.5); }},{n:"Manter foco e n√£o comentar", f:()=>{ updateNationalVotes(game.player,1.5); game.approvals[game.player].app+=3; }},{n:"Atacar comportamento de Ciro", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].rej+=2; }}], historical:true},
        {turn:12, t:"DEBATE FINAL: POLARIZA√á√ÉO LULA X SERRA", d:"Serra parte para cima de Lula com dados sobre renegocia√ß√£o da d√≠vida. Lula fala de paz, amor e emprego. Garotinho fala de Deus. Ciro tenta se recuperar.", b:[{n:"Ataque pesado: 'Chega de mentira!'", f:()=>{ updateNationalVotes(game.player,3); game.approvals[game.player].rej+=4; }},{n:"'Lulinha paz e amor': conciliador", f:()=>{ updateNationalVotes(game.player, game.player==='lula02'?3:1.5); game.approvals[game.player].app+=6; }},{n:"Proposta t√©cnica e detalhada", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=3; }}], historical:true},
    ],
    "2006": [
        {turn:2, t:"MENSAL√ÉO: O STF JULGA O PT", d:"O esc√¢ndalo do Mensal√£o domina a m√≠dia. Lula diz que n√£o sabia de nada. A oposi√ß√£o grita 'fora PT'. A base petista no Nordeste permanece fiel.", b:[{n:"Distanciar-se do esc√¢ndalo publicamente", f:()=>{ game.approvals[game.player].rej-=3; updateNationalVotes(game.player, game.player==='lula06'?1:2.5); }},{n:"Atacar: 'PT traiu seus eleitores!'", f:()=>{ updateNationalVotes(game.player, game.player!=='lula06'?3:-2); game.scandalLevels['lula06']=(game.scandalLevels['lula06']||0)+2; }},{n:"Reconhecer erros e prometer mudan√ßa", f:()=>{ updateNationalVotes(game.player, game.player==='lula06'?1.5:1); game.approvals[game.player].app+=4; }}], historical:true},
        {turn:3, t:"BOLSA FAM√çLIA: 11 MILH√ïES DE FAM√çLIAS", d:"O Bolsa Fam√≠lia beneficia 11 milh√µes de lares. O Nordeste vira terra de Lula. A oposi√ß√£o tenta desqualificar como 'assistencialismo eleitoral'. Como voc√™ responde?", b:[{n:"Defender como direito social permanente", f:()=>{ updateNationalVotes(game.player, game.player==='lula06'?3.5:0.5); game.approvals[game.player].app+=4; }},{n:"Propor 'Bolsa Fam√≠lia melhorado'", f:()=>{ updateNationalVotes(game.player, game.player==='alckmin'?2:1.5); }},{n:"Criticar como clientelismo eleitoreiro", f:()=>{ updateNationalVotes(game.player, game.player==='lula06'?-2.5:2); game.approvals[game.player].rej+=3; }}], historical:true},
        {turn:5, t:"HELO√çSA HELENA CRESCE: ESQUERDA DIVIDIDA", d:"A candidata do PSOL bate 8% nas pesquisas, roubando votos da esquerda de Lula. O PT entra em modo de alerta. Cristovam tamb√©m cresce no eleitorado educado.", b:[{n:"Atacar o PSOL pela esquerda", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].rej+=3; }},{n:"Ignorar e focar no duelo com Alckmin", f:()=>{ updateNationalVotes(game.player,1.5); game.approvals[game.player].app+=2; }},{n:"Radicalizar discurso para recuperar base", f:()=>{ updateNationalVotes(game.player,2.5); }}], historical:true},
        {turn:7, t:"DOSSI√ä DOS ALOPRADOS: CRISE INTERNA NO PT", d:"Assessores do PT s√£o pegos com R$1,7 milh√£o tentando comprar dossi√™ contra Serra. Lula chama os envolvidos de 'aloprados' e os demite. Nova crise.", b:[{n:"Distanciar-se imediatamente", f:()=>{ game.approvals[game.player].rej-=3; updateNationalVotes(game.player, game.player==='lula06'?1:2); }},{n:"Explorar o esc√¢ndalo do PT para crescer", f:()=>{ updateNationalVotes(game.player, game.player!=='lula06'?3:-2); game.scandalLevels['lula06']=(game.scandalLevels['lula06']||0)+2; }},{n:"Prometer reforma √©tica da pol√≠tica", f:()=>{ updateNationalVotes(game.player,1.5); game.approvals[game.player].app+=4; }}], historical:true},
        {turn:9, t:"DEBATE NA BAND: ALCKMIN PARTE PARA CIMA", d:"Alckmin ataca Lula com dureza nos debates. Lula parece cansado e sem preparo. A imprensa questiona se haver√° segundo turno. En√©as, Helo√≠sa e Cristovam tentam se destacar.", b:[{n:"Defesa firme: 'Fiz o que prometi'", f:()=>{ updateNationalVotes(game.player, game.player==='lula06'?2:1); game.approvals[game.player].app+=3; }},{n:"Ataque t√©cnico com dados de governo", f:()=>{ updateNationalVotes(game.player,2.5); game.approvals[game.player].rej+=2; }},{n:"Discurso emocional da cidadania", f:()=>{ updateNationalVotes(game.player, game.player==='heloisa'||game.player==='cristovam'?3:1.5); }}], historical:true},
        {turn:11, t:"LULA VAI AO 2¬∫ TURNO COM 48,6%", d:"Faltou pouco para o 1¬∫ turno. Alckmin com 41,6%. Helo√≠sa com 6,8% e Cristovam com 2,6%. A migra√ß√£o de votos da esquerda decide o 2¬∫ turno.", b:[{n:"Apelar diretamente a eleitores de Helo√≠sa", f:()=>{ updateNationalVotes(game.player, game.player==='lula06'?3:1); }},{n:"Campanha intensa no hor√°rio eleitoral (R$15M)", f:()=>{ if(game.money>=15){game.money-=15; updateNationalVotes(game.player,2.5);} }},{n:"Debates regionais nas afiliadas", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=3; }}], historical:true},
    ],
    "2010": [
        {turn:2, t:"LEGADO DO LULA: APROVA√á√ÉO DE 83%", d:"Lula deixa o governo com 83% de aprova√ß√£o ‚Äî recorde hist√≥rico. Dilma, sua candidata, herda essa popularidade. Os advers√°rios precisam descolar do governo sem atacar Lula diretamente.", b:[{n:"Usar Lula como cabo eleitoral central", f:()=>{ updateNationalVotes(game.player, game.player==='dilma10'?3.5:0.5); game.approvals[game.player].app+=5; }},{n:"Atacar o governo Lula indiretamente", f:()=>{ updateNationalVotes(game.player, game.player!=='dilma10'?2.5:-2); }},{n:"Falar do futuro, n√£o do passado", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=3; }}], historical:true},
        {turn:3, t:"ESC√ÇNDALO DOS CART√ïES CORPORATIVOS", d:"Reportagem exp√µe uso de cart√µes corporativos do governo Lula em hot√©is e bares. A oposi√ß√£o grita 'maraj√°s do PT'. O governo tenta minimizar.", b:[{n:"Defender: 'Foi para o trabalho!'", f:()=>{ updateNationalVotes(game.player, game.player==='dilma10'?0.5:-2); game.approvals[game.player].rej+=3; }},{n:"Exigir explica√ß√µes e investiga√ß√£o", f:()=>{ updateNationalVotes(game.player, game.player!=='dilma10'?3:0.5); }},{n:"Propor lei de transpar√™ncia total", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=4; }}], historical:true},
        {turn:5, t:"MARINA SILVA CRESCE: FEN√îMENO AMBIENTAL", d:"Marina Silva, ex-ministra que saiu do PT, cresce forte com o discurso verde e de renova√ß√£o. Eleitores jovens e urbanos se identificam. Ela pode roubar votos suficientes para for√ßar o 2¬∫ turno.", b:[{n:"Atacar o programa de Marina", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].rej+=2; updateNationalVotes('marina10',-1); }},{n:"Absorver pauta ambiental", f:()=>{ updateNationalVotes(game.player,1.5); game.approvals[game.player].app+=3; }},{n:"Ignorar e manter foco na base", f:()=>{ updateNationalVotes(game.player,1); game.points+=2; }}], historical:true},
        {turn:7, t:"BRASIL: OITAVA ECONOMIA DO MUNDO", d:"O Brasil ultrapassa a It√°lia e se torna a 8¬™ maior economia do planeta. Dilma capitaliza o crescimento. Serra acusa de 'voo de galinha'.", b:[{n:"Celebrar: 'Brasil chegou l√°!'", f:()=>{ updateNationalVotes(game.player, game.player==='dilma10'?3:0.5); game.approvals[game.player].app+=4; }},{n:"Apontar desigualdades que persistem", f:()=>{ updateNationalVotes(game.player, game.player==='plinio'||game.player==='marina10'?2.5:1.5); }},{n:"Propor acelerar com reformas liberais", f:()=>{ updateNationalVotes(game.player, game.player==='serra10'?2.5:1); game.money+=10; }}], historical:true},
        {turn:9, t:"DEBATE NA GLOBO: DILMA SEM EXPERI√äNCIA?", d:"Serra ataca Dilma por nunca ter disputado uma elei√ß√£o antes. Dilma se defende com compet√™ncia t√©cnica. Marina cobra do PT as promessas n√£o cumpridas da gest√£o Lula.", b:[{n:"Rebater com firmeza: 'Administra√ß√£o √© experi√™ncia'", f:()=>{ updateNationalVotes(game.player, game.player==='dilma10'?2.5:1); game.approvals[game.player].app+=4; }},{n:"Atacar o advers√°rio com estat√≠sticas", f:()=>{ updateNationalVotes(game.player,2.5); game.approvals[game.player].rej+=3; }},{n:"Discurso de renova√ß√£o e moralidade", f:()=>{ updateNationalVotes(game.player, game.player==='marina10'?3.5:1.5); }}], historical:true},
        {turn:11, t:"PESQUISA: DILMA PERTO DO 1¬∫ TURNO", d:"Datafolha coloca Dilma com 49%! Um ponto do 1¬∫ turno. Serra estacionou em 32%. Marina com 14% e Pl√≠nio com 2%. A esquerda teme o voto √∫til.", b:[{n:"Mobiliza√ß√£o m√°xima para fechar no 1T", f:()=>{ updateNationalVotes(game.player, game.player==='dilma10'?2.5:1); }},{n:"Explorar insatisfa√ß√£o para crescer", f:()=>{ updateNationalVotes(game.player, game.player==='marina10'||game.player==='plinio'?3:1); }},{n:"Campanha final de TV (R$15M)", f:()=>{ if(game.money>=15){game.money-=15; updateNationalVotes(game.player,2.5);} }}], historical:true},
        {turn:13, t:"SEGUNDO TURNO: DILMA X SERRA", d:"Dilma obteve 46,9% no 1T, Serra 32,6% e Marina 19,3%. No 2T, a batalha pelo eleitorado verde e liberal √© decisiva.", b:[{n:"Apelar a eleitores de Marina diretamente", f:()=>{ updateNationalVotes(game.player,2.5); game.approvals[game.player].app+=3; }},{n:"Mobilizar base do Nordeste", f:()=>{ updateNationalVotes(game.player, game.player==='dilma10'?3.5:1); }},{n:"Debater economia e emprego", f:()=>{ updateNationalVotes(game.player,2); game.money+=5; }}], historical:true},
    ],
    "2018": [
        {turn:2, t:"LULA PRESO EM CURITIBA", d:"O ex-presidente Lula se entrega √† Pol√≠cia Federal em Curitiba. Entra para a cadeia. O PT mant√©m sua candidatura viva. O pa√≠s se divide em 'Lula livre' vs 'bandido n√£o tem direito'. Jair Bolsonaro dispara nas pesquisas.", b:[{n:"Explorar: 'PT √© partido de ladr√µes'", f:()=>{ updateNationalVotes(game.player, game.player==='bolsonaro'||game.player==='alckmin18'||game.player==='meirelles'?3:-2); updateNationalVotes('haddad',-2); }},{n:"Defender Lula e o PT", f:()=>{ updateNationalVotes(game.player, game.player==='haddad'?3.5:-2); game.approvals[game.player].app+=4; }},{n:"Falar de renova√ß√£o e novo Brasil", f:()=>{ updateNationalVotes(game.player, game.player==='amedo'||game.player==='ciro18'?3:1.5); }}], historical:true},
        {turn:3, t:"BOLSONARO √â ESFAQUEADO EM JUIZ DE FORA", d:"Durante com√≠cio em Minas Gerais, Jair Bolsonaro √© atacado a faca por Ad√©lio Bispo. Fica gravemente ferido. O ataque domina o notici√°rio e gera onda de solidariedade. Sua fam√≠lia assume a campanha nas redes.", b:[{n:"Solidariedade pol√≠tica respeitosa", f:()=>{ game.approvals[game.player].app+=4; updateNationalVotes(game.player,1.5); }},{n:"Manter campanha normal com discri√ß√£o", f:()=>{ updateNationalVotes(game.player,1); game.points+=2; }},{n:"Questionar o epis√≥dio publicamente", f:()=>{ game.approvals[game.player].rej+=6; updateNationalVotes(game.player,-2); }}], historical:true},
        {turn:5, t:"HADDAD SUBSTITUI LULA NA CANDIDATURA", d:"O TSE torna Lula ineleg√≠vel. Fernando Haddad, ex-prefeito de SP, assume como candidato do PT. Lula grava v√≠deos da pris√£o e transfere votos. Haddad sobe de 9% para 23% em dias.", b:[{n:"Atacar a 'candidatura laranja' do PT", f:()=>{ updateNationalVotes(game.player, game.player!=='haddad'?2:-1); game.approvals[game.player].rej+=2; }},{n:"Celebrar a for√ßa do PT sem Lula", f:()=>{ updateNationalVotes(game.player, game.player==='haddad'?3.5:-1); }},{n:"Focar na polariza√ß√£o para crescer", f:()=>{ updateNationalVotes(game.player, game.player==='bolsonaro'||game.player==='haddad'?2.5:0.5); }}], historical:true},
        {turn:7, t:"BOLSONARO DOMINA WHATSAPP E YOUTUBE", d:"Campanha de Bolsonaro usa redes sociais como nunca visto. Disparos em massa de WhatsApp. V√≠deos virais no YouTube. A grande m√≠dia perde influ√™ncia. √â uma nova era eleitoral.", b:[{n:"Investir pesado em redes sociais (R$15M)", f:()=>{ game.money-=15; updateNationalVotes(game.player,3.5); }},{n:"Manter estrat√©gia tradicional de TV", f:()=>{ updateNationalVotes(game.player,1.5); game.approvals[game.player].app+=2; }},{n:"Atacar as fake news nas redes", f:()=>{ updateNationalVotes(game.player, game.player==='haddad'||game.player==='ciro18'?2:1); }}], historical:true},
        {turn:9, t:"DEBATE: BOLSONARO N√ÉO APARECE", d:"Bolsonaro falta aos debates das grandes TVs. Seus apoiadores dizem que ele est√° acima disso. Os demais candidatos debatem entre si. Ciro e Haddad trocam farpas. Alckmin tenta modera√ß√£o.", b:[{n:"Atacar o ausente ferozmente", f:()=>{ updateNationalVotes(game.player,2.5); game.approvals[game.player].rej+=3; }},{n:"Focar em proposta pr√≥pria sem Bolsonaro", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=5; }},{n:"Apelar ao voto √∫til anti-PT", f:()=>{ updateNationalVotes(game.player, game.player==='alckmin18'?3:1); }}], historical:true},
        {turn:11, t:"PESQUISA: POLARIZA√á√ÉO EXTREMA", d:"Bolsonaro chega a 35% e Haddad a 23%. Ciro em 12%, Alckmin em 8%. O voto √∫til come√ßa a matar candidaturas. Daciolo e Eymael somam menos de 2%.", b:[{n:"Apelar ao voto √∫til contra PT", f:()=>{ updateNationalVotes(game.player, game.player==='bolsonaro'?2.5:1); updateNationalVotes('haddad',-1); }},{n:"Apelar ao voto √∫til anti-Bolsonaro", f:()=>{ updateNationalVotes(game.player, game.player==='haddad'?2.5:1.5); updateNationalVotes('bolsonaro',-1); }},{n:"Resistir ao voto √∫til com identidade pr√≥pria", f:()=>{ updateNationalVotes(game.player,1.5); game.approvals[game.player].app+=4; }}], historical:true},
        {turn:13, t:"2T: BOLSONARO X HADDAD ‚Äî BRAZIL DIVIDIDO", d:"Bolsonaro com 46% no 1T, Haddad 29%. No 2T, toda a direita e centro migram para Bolsonaro. A esquerda se une em torno de Haddad. Resultado hist√≥rico.", b:[{n:"Mobilizar base ideol√≥gica com for√ßa", f:()=>{ updateNationalVotes(game.player,3); }},{n:"Buscar eleitores descontentes do centro", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=3; }},{n:"Campanha final de redes sociais (R$10M)", f:()=>{ if(game.money>=10){game.money-=10; updateNationalVotes(game.player,2.5);} }}], historical:true},
    ],
    "2022": [
        {turn:2, t:"BOLSONARO QUESTIONA AS URNAS ELETR√îNICAS", d:"O presidente Bolsonaro convoca embaixadores estrangeiros e defende um golpe caso perca. Generais ouvem sem protestar. A imprensa e o STF reagem com dureza. A democracia em risco vira o tema central.", b:[{n:"Defender a urna: 'N√£o tem fraude!'", f:()=>{ updateNationalVotes(game.player, game.player==='lula22'||game.player==='tebet'||game.player==='ciro22'?2.5:-1); game.approvals[game.player].app+=5; }},{n:"Semear d√∫vida sobre o sistema", f:()=>{ updateNationalVotes(game.player, game.player==='bolsonaro22'?3:-3); game.approvals[game.player].rej+=4; }},{n:"Propor comiss√£o independente de auditoria", f:()=>{ updateNationalVotes(game.player,1.5); game.points+=2; }}], historical:true},
        {turn:3, t:"LULA √â LIBERADO E LIDERA PESQUISAS", d:"Depois da decis√£o do STF que anulou condena√ß√µes por suspei√ß√£o de Moro, Lula volta candidat√°vel. Pesquisas mostram Lula com 47% e Bolsonaro com 32%. O campo da oposi√ß√£o est√° dominado.", b:[{n:"Atacar a decis√£o do STF", f:()=>{ updateNationalVotes(game.player, game.player==='bolsonaro22'?2.5:-1.5); game.approvals[game.player].rej+=3; }},{n:"Celebrar retorno da democracia", f:()=>{ updateNationalVotes(game.player, game.player==='lula22'||game.player==='tebet'?2.5:-0.5); }},{n:"Propor agenda de reconstru√ß√£o", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=3; }}], historical:true},
        {turn:5, t:"AUX√çLIO BRASIL E A COMPRA DE VOTOS", d:"Bolsonaro eleva o Aux√≠lio Brasil para R$600 e prop√µe outros benef√≠cios √†s v√©speras da elei√ß√£o. O TCU questiona. Lula acusa de 'compra de votos com dinheiro p√∫blico'. O Nordeste fica em disputa.", b:[{n:"Atacar: 'Populismo eleitoral descarado!'", f:()=>{ updateNationalVotes(game.player, game.player!=='bolsonaro22'?2.5:-1.5); }},{n:"Propor benef√≠cio ainda maior se eleito", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=3; }},{n:"Focar em combate √† fome como pauta", f:()=>{ updateNationalVotes(game.player, game.player==='lula22'||game.player==='tebet'?3:1.5); }}], historical:true},
        {turn:7, t:"MORO MIGRA PARA UNION E DESISTE DA CANDIDATURA", d:"Sergio Moro desiste da candidatura ao desmoronar nas pesquisas. Parte de seus votos migra para Bolsonaro, parte para Tebet. Simone Tebet vira esperan√ßa da terceira via moderada.", b:[{n:"Absorver eleitores de Moro pela direita", f:()=>{ updateNationalVotes(game.player, game.player==='bolsonaro22'?2.5:0.5); }},{n:"Absorver moderados descontentes do PT/PL", f:()=>{ updateNationalVotes(game.player, game.player==='tebet'?3:1); }},{n:"Manter base e ignorar migra√ß√£o", f:()=>{ updateNationalVotes(game.player,1); game.points+=2; }}], historical:true},
        {turn:9, t:"DEBATE NA GLOBO: LULA X BOLSONARO", d:"Debate mais tenso da hist√≥ria recente. Bolsonaro ataca o passado de Lula. Lula ataca o desemprego e a fome. Tebet surpreende com performance superior. Ciro ataca os dois.", b:[{n:"Ataque frontal: 'Corrup√ß√£o e mentira!'", f:()=>{ updateNationalVotes(game.player,2.5); game.approvals[game.player].rej+=4; }},{n:"Apresentar plano de governo detalhado", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=5; }},{n:"Discurso emocional: fome, emprego, dignidade", f:()=>{ updateNationalVotes(game.player, game.player==='lula22'||game.player==='tebet'?3:1.5); }}], historical:true},
        {turn:11, t:"BOLSONARO SURPREENDE NO 1T: APENAS 1,8% DE DIFEREN√áA", d:"Lula obt√©m 48,4% e Bolsonaro 43,2% no 1T. Surpreendente! A oposi√ß√£o celebra. Tebet com 4,2% e Ciro com 3,1% ‚Äî ambas candidaturas declaradas para Lula no 2T.", b:[{n:"Apelar urgentemente a eleitores de Tebet e Ciro", f:()=>{ updateNationalVotes(game.player, game.player==='lula22'?3:1.5); }},{n:"Intensificar campanha com Lula de volta", f:()=>{ updateNationalVotes(game.player, game.player==='bolsonaro22'?3:1); }},{n:"Buscar apoio de governadores aliados", f:()=>{ updateNationalVotes(game.player,2.5); game.money-=10; }}], historical:true},
        {turn:13, t:"2T HIST√ìRICO: DIFEREN√áA DE APENAS 2,1%", d:"O 2T mais apertado da hist√≥ria: Lula 50,9% e Bolsonaro 49,1%. Brasil dividido ao extremo. Eleitores na fila √†s 20h. Tens√£o m√°xima.", b:[{n:"Mobiliza√ß√£o total: 'Cada voto conta!'", f:()=>{ updateNationalVotes(game.player,3); }},{n:"Press√£o judicial contra irregularidades", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=3; }},{n:"Campanha final nas redes e TV (R$15M)", f:()=>{ if(game.money>=15){game.money-=15; updateNationalVotes(game.player,2.5);} }}], historical:true},
    ],
    "2026": [
        {turn:2, t:"LULA NO HOSPITAL: OPERA√á√ÉO E RECUPERA√á√ÉO", d:"O presidente Lula enfrenta problemas de sa√∫de e passa por cirurgia. A oposi√ß√£o questiona sua capacidade de governar. A base petista fecha fileiras. O pa√≠s acompanha tenso.", b:[{n:"Atacar a sa√∫de do presidente", f:()=>{ updateNationalVotes(game.player, game.player!=='lula26'?2.5:-3); game.approvals[game.player].rej+=5; }},{n:"Proposta de governo s√≥lida sem falar do rival", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=4; }},{n:"Solidariedade humana + cr√≠tica ao governo", f:()=>{ updateNationalVotes(game.player,1.5); game.approvals[game.player].app+=3; }}], historical:true},
        {turn:4, t:"FL√ÅVIO BOLSONARO: HERDEIRO DO BOLSONARISMO", d:"O senador Fl√°vio Bolsonaro lan√ßa candidatura com apoio direto do pai, que gravou v√≠deo da pris√£o nos EUA. O movimento bolsonarista √© mobilizado. Zema e Caiado perdem espa√ßo.", b:[{n:"Atacar a 'candidatura herdeira'", f:()=>{ updateNationalVotes(game.player, game.player!=='flavio'?1.5:-1); }},{n:"Apelar ao eleitorado bolsonarista moderado", f:()=>{ updateNationalVotes(game.player, game.player==='flavio'||game.player==='zema'||game.player==='caiado'?3:0.5); }},{n:"Focar nas diferen√ßas program√°ticas", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=3; }}], historical:true},
        {turn:6, t:"TRAG√âDIA AMBIENTAL: ENCHENTES NO RS/ES", d:"Enchentes massivas no Sul e Sudeste matam centenas. O governo federal √© cobrado por falta de preparo. A crise clim√°tica domina o debate eleitoral.", b:[{n:"Cobrar responsabilidade do governo federal", f:()=>{ updateNationalVotes(game.player, game.player!=='lula26'?2.5:-2); }},{n:"Proposta ambiciosa de reconstru√ß√£o clim√°tica", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=4; }},{n:"Ir pessoalmente √†s √°reas afetadas", f:()=>{ updateNationalVotes(game.player,2.5); }}], historical:true},
        {turn:8, t:"ELEI√á√ïES NOS EUA E IMPACTO NO BRASIL", d:"O novo governo americano aumenta tarifas sobre produtos brasileiros. A economia desacelera. O c√¢mbio sobe. Candidatos debatem soberania econ√¥mica vs alinhamento com o mercado global.", b:[{n:"Defender soberania e renegocia√ß√£o", f:()=>{ updateNationalVotes(game.player, game.player==='lula26'||game.player==='aldo'?2.5:1); }},{n:"Propor abertura e parceria com EUA", f:()=>{ updateNationalVotes(game.player, game.player==='zema'||game.player==='flavio'?2.5:1); game.money+=10; }},{n:"Atacar governo pelo desempenho econ√¥mico", f:()=>{ updateNationalVotes(game.player, game.player!=='lula26'?2:-1.5); }}], historical:true},
        {turn:10, t:"RENAN SANTOS E O MOVIMENTO MISS√ÉO", d:"O candidato do MISS√ÉO realiza com√≠cio gigantesco em Bras√≠lia, surpreendendo os analistas. O movimento evang-libert√°rio galvaniza uma nova fatia do eleitorado jovem e religioso.", b:[{n:"Atacar o extremismo do movimento", f:()=>{ updateNationalVotes(game.player, game.player!=='renan'?1.5:-1); }},{n:"Apelar √† modera√ß√£o e democracia", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=4; }},{n:"Tentar absorver pauta religiosa", f:()=>{ updateNationalVotes(game.player, game.player==='caiado'||game.player==='zema'?2.5:0.5); }}], historical:true},
        {turn:12, t:"DEBATE FINAL: TODOS CONTRA TODOS", d:"Debate com os seis candidatos explode em confus√£o. Lula e Fl√°vio trocam acusa√ß√µes pesadas. Zema e Caiado disputam o mesmo espa√ßo. Tebet modera. Renan Santos diz que 'Deus vai dar o resultado'.", b:[{n:"Ataque pesado ao principal rival", f:()=>{ updateNationalVotes(game.player,2.5); game.approvals[game.player].rej+=4; }},{n:"Discurso de proposta e futuro do Brasil", f:()=>{ updateNationalVotes(game.player,2); game.approvals[game.player].app+=5; }},{n:"Momento viral nas redes sociais (R$8M)", f:()=>{ if(game.money>=8){game.money-=8; updateNationalVotes(game.player,3); } }}], historical:true},
    ]
};

// Dados dos cen√°rios dispon√≠veis
const scenariosData = {
    "1994": {
        title:"Elei√ß√µes 1994", year:"1994", emoji:"üí∞",
        desc:"FHC vs Lula. O Plano Real muda tudo.",
        available:true,
        newsHeader:"Folha de S. Pol√≠tica ‚Äî OUTUBRO 1994",
        endYear:"1994",
        partyPoolOverride: [
            {n:"PRN", side:"D", owner: null}, {n:"PSC", side:"D", owner: null}, 
            {n:"PL", side:"D", owner: null}, {n:"PST", side:"C", owner: null},
            {n:"PTdoB", side:"C", owner: null}, {n:"PTR", side:"E", owner: null}, {n:"PV", side:"E", owner: null}
        ],
        candidates: {
            fhc: {name:"FHC", party:"PSDB", start:34, money:50, side:"D", color:"#3366ff", econ:1, soc:0, nat:-1, bio:"Fernando Henrique Cardoso, o arquiteto do Plano Real. Com uma coliga√ß√£o de centro-direita (PSDB-PFL-PTB), sua campanha focou na estabilidade econ√¥mica e no fim da hiperinfla√ß√£o.", ideologia:"Social-Democracia Neoliberal"},
            lula: {name:"LULA", party:"PT", start:26, money:20, side:"E", color:"#ff3333", econ:-2, soc:2, nat:1, bio:"Luiz In√°cio Lula da Silva, a voz do operariado. Liderando a Frente Brasil Popular, resistindo ao Plano Real e focando nas desigualdades sociais.", ideologia:"Socialismo Democr√°tico"},
            quercia: {name:"QU√âRCIA", party:"PMDB", start:10, money:45, side:"C", color:"#15a015", econ:0, soc:0, nat:0, bio:"Orestes Qu√©rcia, a for√ßa da m√°quina do PMDB. Ex-governador de SP, tentou viabilizar uma terceira via.", ideologia:"Centro-Populismo"},
            eneas: {name:"EN√âAS", party:"PRONA", start:7, money:8, side:"X", color:"#555555", econ:-1, soc:-2, nat:2, bio:"En√©as Carneiro, o fen√¥meno do PRONA. 'Meu nome √© En√©as!' Defendia a bomba at√¥mica e o protecionismo.", ideologia:"Nacionalismo Conservador"},
            brizola: {name:"BRIZOLA", party:"PDT", start:9, money:15, side:"E", color:"#ff9900", econ:-1, soc:1, nat:1, bio:"Leonel Brizola, o √∫ltimo herdeiro do Trabalhismo. Veterano da legalidade, focando na educa√ß√£o e na defesa dos interesses nacionais.", ideologia:"Trabalhismo"},
            amin: {name:"AMIN", party:"PPR", start:5, money:30, side:"D", color:"#8b0000", econ:1, soc:-1, nat:1, bio:"Esperidi√£o Amin, ex-governador de Santa Catarina e senador pelo PPR. Representava o conservadorismo sulista, com forte base no Sul do pa√≠s e discurso de ordem e desenvolvimento regional.", ideologia:"Conservadorismo Regional"}
        }
    },
    "1989": {
        title:"Elei√ß√µes 1989", year:"1989", emoji:"üî¥",
        desc:"Primeira elei√ß√£o direta p√≥s-ditadura. Collor x Lula.",
        available:true,
        newsHeader:"Folha de S. Pol√≠tica ‚Äî NOVEMBRO 1989",
        endYear:"1989",
        partyPoolOverride: [
            {n:"PCdoB", side:"E", owner:null},
            {n:"PSB", side:"E", owner:null},
            {n:"PCB",  side:"E", owner:null},
            {n:"PTB",  side:"C", owner:null},
            {n:"PSD",  side:"C", owner:null},
            {n:"PRN",  side:"D", owner:null},
            {n:"PL",   side:"D", owner:null},
            {n:"PJ",   side:"D", owner:null},
            {n:"PRP",  side:"D", owner:null},
        ],
        candidates: {
            collor:    {name:"COLLOR",  party:"PRN",  start:28, money:60, side:"D", color:"#005bbb", econ:2,  soc:-1, nat:0,  bio:"Fernando Collor de Mello, jovem governador de Alagoas. Com o discurso anti-corrup√ß√£o e o slogan 'ca√ßa aos maraj√°s', conquistou o imagin√°rio popular.", ideologia:"Neoliberalismo"},
            lula89:    {name:"LULA",    party:"PT",   start:16, money:15, side:"E", color:"#ff3333", econ:-2, soc:2,  nat:1,  bio:"Luiz In√°cio Lula da Silva em sua primeira grande disputa presidencial, representando o PT e os trabalhadores do ABC paulista.", ideologia:"Socialismo Democr√°tico"},
            brizola89: {name:"BRIZOLA", party:"PDT",  start:14, money:25, side:"E", color:"#ff9900", econ:-1, soc:1,  nat:1,  bio:"Leonel Brizola, o grande favorito inicial. Acabou sendo ultrapassado por Lula para o segundo turno numa das maiores surpresas.", ideologia:"Trabalhismo"},
            maluf:     {name:"MALUF",   party:"PDS",  start:9,  money:55, side:"D", color:"#6600cc", econ:1,  soc:-2, nat:1,  bio:"Paulo Maluf, s√≠mbolo da direita cl√°ssica e da m√°quina pol√≠tica paulista. 'Rouba mas faz' tornaria-se slogan associado ao seu estilo.", ideologia:"Conservadorismo"},
            ulysses:   {name:"ULYSSES", party:"PMDB", start:8,  money:40, side:"C", color:"#15a015", econ:0,  soc:0,  nat:0,  bio:"Ulysses Guimar√£es, presidente da Constituinte. O 'Senhor Diretas' esperava colher os frutos da redemocratiza√ß√£o.", ideologia:"Centro-Democr√°tico"},
            eneas89:   {name:"EN√âAS",   party:"PRONA",start:4,  money:5,  side:"X", color:"#555555", econ:-1, soc:-2, nat:2,  bio:"En√©as Carneiro em sua primeira grande campanha presidencial. J√° defendia a bomba at√¥mica e o nacionalismo radical, com tempo m√≠nimo de TV mas presen√ßa marcante.", ideologia:"Nacionalismo Radical"},
            covas:     {name:"COVAS",   party:"PSDB", start:7,  money:30, side:"D", color:"#0099cc", econ:1,  soc:1,  nat:-1, bio:"M√°rio Covas, fundador do PSDB e senador por S√£o Paulo. Representava a social-democracia moderna num cen√°rio de polariza√ß√£o crescente.", ideologia:"Social-Democracia"},
            caiado:    {name:"CAIADO",  party:"PSD",  start:3,  money:20, side:"D", color:"#cc6600", econ:1,  soc:-2, nat:1,  bio:"Ronaldo Caiado, l√≠der ruralista e fundador da UDR. Candidatura de 1989 representava os interesses do agroneg√≥cio e da direita tradicional.", ideologia:"Ruralismo Conservador"},
            aureliano: {name:"AURELIANO",party:"PFL", start:5,  money:35, side:"D", color:"#990099", econ:1,  soc:-1, nat:0,  bio:"Aureliano Chaves, ex-vice-presidente da rep√∫blica e l√≠der do PFL em Minas Gerais. Candidatura moderada da direita liberal mineira.", ideologia:"Liberalismo Conservador"}
        }
    },
    "2014": {
        title:"Elei√ß√µes 2014", year:"2014", emoji:"üåø",
        desc:"Dilma vs A√©cio. Brasil dividido ao meio.",
        available:true,
        newsHeader:"Folha de S. Pol√≠tica ‚Äî OUTUBRO 2014",
        endYear:"2014",
        partyPoolOverride: [
            {n:"PMDB",  side:"C", owner:null},
            {n:"PP",    side:"D", owner:null},
            {n:"PR",    side:"C", owner:null},
            {n:"PDT",   side:"E", owner:null},
            {n:"PCdoB", side:"E", owner:null},
            {n:"SD",    side:"D", owner:null},
            {n:"PRB",   side:"D", owner:null},
            {n:"PSD",   side:"C", owner:null},
            {n:"PTB",   side:"C", owner:null},
            {n:"DEM",   side:"D", owner:null},
        ],
        candidates: {
            dilma:   {name:"DILMA",   party:"PT",   start:36, money:55, side:"E", color:"#cc0000", econ:-1, soc:2,  nat:1,  bio:"Dilma Rousseff, presidente em exerc√≠cio e candidata √† reelei√ß√£o. Sob ataque pela desacelera√ß√£o econ√¥mica e pelos protestos de 2013, lutava para manter a base petista unida.", ideologia:"Social-Desenvolvimentismo"},
            aecio:   {name:"A√âCIO",   party:"PSDB", start:28, money:50, side:"D", color:"#0044cc", econ:2,  soc:-1, nat:-1, bio:"A√©cio Neves, senador e ex-governador de Minas Gerais. Liderou a oposi√ß√£o tucana prometendo retomar as reformas econ√¥micas e combater a corrup√ß√£o do PT.", ideologia:"Social-Democracia Liberal"},
            marina:  {name:"MARINA",  party:"PSB",  start:22, money:30, side:"C", color:"#33aa33", econ:0,  soc:1,  nat:0,  bio:"Marina Silva, ex-ministra do Meio Ambiente. Ap√≥s a morte de Eduardo Campos, assumiu a candidatura do PSB e surpreendeu com crescimento explosivo nas pesquisas.", ideologia:"Ambientalismo Progressista"},
            luciana: {name:"LUCIANA", party:"PSOL", start:3,  money:8,  side:"E", color:"#ff00aa", econ:-2, soc:2,  nat:1,  bio:"Luciana Genro, deputada federal ga√∫cha e fundadora do PSOL. Representava a esquerda cr√≠tica ao PT, acusando Dilma de capitular ao mercado financeiro.", ideologia:"Socialismo Radical"}
        }
    },
    "2002": {
        title:"Elei√ß√µes 2002", year:"2002", emoji:"üåü",
        desc:"Lula finalmente vence. A Carta ao Povo Brasileiro.",
        available:true,
        newsHeader:"Folha de S. Pol√≠tica ‚Äî OUTUBRO 2002",
        endYear:"2002",
        partyPoolOverride: [
            {n:"PL",    side:"D", owner:null},
            {n:"PTB",   side:"C", owner:null},
            {n:"PMDB",  side:"C", owner:null},
            {n:"PDT",   side:"E", owner:null},
            {n:"PCdoB", side:"E", owner:null},
            {n:"PSB",   side:"E", owner:null},
            {n:"PV",    side:"E", owner:null},
            {n:"PHS",   side:"D", owner:null},
        ],
        candidates: {
            lula02:    {name:"LULA",      party:"PT",   start:33, money:25, side:"E", color:"#ff3333", econ:-1, soc:2,  nat:1,  bio:"Luiz In√°cio Lula da Silva em sua quarta candidatura, desta vez vencedora. Com o slogan 'Lulinha Paz e Amor' e a Carta ao Povo Brasileiro, moderou o discurso e foi eleito com 61% no 2¬∫ turno.", ideologia:"Socialismo Democr√°tico Moderado"},
            serra:     {name:"SERRA",     party:"PSDB", start:20, money:45, side:"D", color:"#3366ff", econ:2,  soc:0,  nat:-1, bio:"Jos√© Serra, ex-ministro da Sa√∫de do governo FHC. Chegou ao 2¬∫ turno mas perdeu para Lula, carregando o peso do desgaste do governo anterior.", ideologia:"Social-Democracia Liberal"},
            garotinho: {name:"GAROTINHO", party:"PSB",  start:15, money:18, side:"C", color:"#cc6600", econ:-1, soc:1,  nat:0,  bio:"Anthony Garotinho, ex-governador do Rio de Janeiro. Com forte apelo evang√©lico e populista, disputou o 3¬∫ lugar com Ciro Gomes ao longo de toda a campanha.", ideologia:"Centro-Crist√£o Popular"},
            ciro02:    {name:"CIRO",      party:"PPS",  start:12, money:22, side:"C", color:"#009900", econ:0,  soc:1,  nat:2,  bio:"Ciro Gomes, ex-governador do Cear√°. Propunha o 'choque de capitalismo' e renegocia√ß√£o da d√≠vida externa. Implodiu a pr√≥pria candidatura com a gafe do 'espi√£o Rosa'.", ideologia:"Nacional-Desenvolvimentismo"},
            zemaria:   {name:"Z√â MARIA",  party:"PSTU", start:0.5,money:3,  side:"E", color:"#8b0000", econ:-2, soc:2,  nat:1,  bio:"Z√© Maria, l√≠der sindical e candidato do PSTU. Representava a esquerda radical cr√≠tica ao PT por ter abandonado suas origens socialistas.", ideologia:"Socialismo Revolucion√°rio"},
            pimenta:   {name:"PIMENTA",   party:"PCO",  start:0.3,money:1,  side:"E", color:"#550000", econ:-2, soc:2,  nat:1,  bio:"Rui Costa Pimenta, candidato do PCO. Defendia o marxismo cl√°ssico e a tomada do poder pela classe trabalhadora. Vota√ß√£o irris√≥ria mas participa√ß√£o em todos os debates.", ideologia:"Comunismo"}
        }
    },
    "2006": {
        title:"Elei√ß√µes 2006", year:"2006", emoji:"‚≠ê",
        desc:"Lula reeleito. Mensal√£o vs Bolsa Fam√≠lia.",
        available:true,
        newsHeader:"Folha de S. Pol√≠tica ‚Äî OUTUBRO 2006",
        endYear:"2006",
        partyPoolOverride: [
            {n:"PP",    side:"D", owner:null},
            {n:"PR",    side:"C", owner:null},
            {n:"PTB",   side:"C", owner:null},
            {n:"PMDB",  side:"C", owner:null},
            {n:"PSB",   side:"E", owner:null},
            {n:"PCdoB", side:"E", owner:null},
            {n:"PV",    side:"E", owner:null},
            {n:"PRB",   side:"D", owner:null},
        ],
        candidates: {
            lula06:    {name:"LULA",      party:"PT",   start:37, money:40, side:"E", color:"#ff3333", econ:-1, soc:2,  nat:1,  bio:"Lula buscava a reelei√ß√£o com o Bolsa Fam√≠lia como escudo e o Mensal√£o como peso. Venceu o 2¬∫ turno com 60,8%, esmagando Alckmin gra√ßas ao eleitorado nordestino.", ideologia:"Social-Desenvolvimentismo"},
            alckmin:   {name:"ALCKMIN",   party:"PSDB", start:30, money:50, side:"D", color:"#0044cc", econ:2,  soc:-1, nat:-1, bio:"Geraldo Alckmin, ex-governador de S√£o Paulo. Candidato competente e agressivo nos debates, mas sem carisma para superar a aprova√ß√£o pessoal de Lula no Nordeste.", ideologia:"Social-Democracia Liberal"},
            heloisa:   {name:"HELO√çSA",   party:"PSOL", start:6,  money:8,  side:"E", color:"#ff00aa", econ:-2, soc:2,  nat:1,  bio:"Helo√≠sa Helena, senadora alagoana do PSOL. Representava a esquerda que n√£o perdoou o PT pelo Mensal√£o. Obteve hist√≥ricos 6,85% no 1¬∫ turno.", ideologia:"Socialismo Radical"},
            cristovam: {name:"CRISTOVAM", party:"PDT",  start:3,  money:10, side:"E", color:"#ff9900", econ:-1, soc:1,  nat:0,  bio:"Cristovam Buarque, senador do DF. Idealizador do Bolsa Escola, precursor do Bolsa Fam√≠lia. Disputou votos com Lula entre o eleitorado educado e progressista.", ideologia:"Social-Democracia Progressista"},
            rangel:    {name:"RANGEL",    party:"PRP",  start:0.5,money:5,  side:"D", color:"#888800", econ:1,  soc:-1, nat:1,  bio:"Ana Maria Rangel, candidata conservadora de pequeno partido. Participou dos debates com discurso de valores tradicionais e fam√≠lia.", ideologia:"Conservadorismo Familiar"},
            eymael:    {name:"EYMAEL",    party:"DC",   start:0.5,money:4,  side:"C", color:"#006633", econ:0,  soc:-1, nat:0,  bio:"Jos√© Maria Eymael, candidato veterano da Democracia Crist√£. Conhecido pelo jingle musical marcante e pelo discurso humanista crist√£o.", ideologia:"Democracia Crist√£"}
        }
    },
    "2018": {
        title:"Elei√ß√µes 2018", year:"2018", emoji:"‚ö°",
        desc:"Bolsonaro x PT. A elei√ß√£o que dividiu o Brasil.",
        available:true,
        newsHeader:"Folha de S. Pol√≠tica ‚Äî OUTUBRO 2018",
        endYear:"2018",
        partyPoolOverride: [
            {n:"PP",      side:"D", owner:null},
            {n:"DEM",     side:"D", owner:null},
            {n:"PRB",     side:"D", owner:null},
            {n:"SD",      side:"D", owner:null},
            {n:"PROS",    side:"C", owner:null},
            {n:"PCdoB",   side:"E", owner:null},
            {n:"PDT",     side:"E", owner:null},
        ],
        candidates: {
            bolsonaro:  {name:"BOLSONARO", party:"PSL",       start:22, money:20, side:"D", color:"#22bb22", econ:2,  soc:-2, nat:2,  bio:"Jair Bolsonaro, deputado federal por 27 anos, nunca antes t√£o popular. Capitalizou o antipetismo, o conservadorismo moral e o discurso anti-sistema para chegar √† presid√™ncia com apoio massivo das redes sociais.", ideologia:"Conservadorismo Nacional-Populista"},
            haddad:     {name:"HADDAD",    party:"PT",        start:20, money:50, side:"E", color:"#ff3333", econ:-1, soc:2,  nat:1,  bio:"Fernando Haddad, ex-prefeito de S√£o Paulo e ex-ministro da Educa√ß√£o. Herdeiro de Lula preso, carregou o peso do PT no momento de maior rejei√ß√£o da sigla.", ideologia:"Social-Desenvolvimentismo"},
            ciro18:     {name:"CIRO",      party:"PDT",       start:11, money:20, side:"C", color:"#ff9900", econ:-1, soc:1,  nat:2,  bio:"Ciro Gomes, governador do Cear√°. Propunha uma terceira via soberanista, cr√≠tico tanto do PT quanto do neoliberalismo. Dono de grandes momentos nos debates mas incapaz de romper a polariza√ß√£o.", ideologia:"Nacional-Desenvolvimentismo"},
            alckmin18:  {name:"ALCKMIN",   party:"PSDB",      start:8,  money:55, side:"D", color:"#0044cc", econ:2,  soc:0,  nat:-1, bio:"Geraldo Alckmin, ex-governador de S√£o Paulo. Candidato da grande m√≠dia e dos grandes empres√°rios, sufocado pela polariza√ß√£o Bolsonaro x PT e pela falta de carisma para furar a bolha.", ideologia:"Social-Democracia Liberal"},
            amedo:      {name:"AM√îEDO",    party:"NOVO",      start:3,  money:15, side:"D", color:"#ff6600", econ:2,  soc:-1, nat:-1, bio:"Jo√£o Am√¥edo, empres√°rio e fundador do Novo. Candidato liberal cl√°ssico que fez da privatiza√ß√£o e do Estado m√≠nimo seu programa de governo.", ideologia:"Liberalismo Cl√°ssico"},
            daciolo:    {name:"DACIOLO",   party:"PATRIOTA",  start:1,  money:5,  side:"D", color:"#336633", econ:0,  soc:-2, nat:2,  bio:"Cabo Daciolo, ex-bombeiro e pastor. Candidato que pregou contra a Nova Ordem Mundial nos debates, tornando-se meme mas atingindo a base militar-religiosa.", ideologia:"Conservadorismo Crist√£o"},
            meirelles:  {name:"MEIRELLES", party:"MDB",       start:2,  money:35, side:"C", color:"#006699", econ:2,  soc:0,  nat:-1, bio:"Henrique Meirelles, ex-ministro da Fazenda de Lula e FHC. Candidato t√©cnico e sem apelo emocional, n√£o conseguiu emplacar como candidato do establishment moderado.", ideologia:"Tecnocracia Liberal"}
        }
    },
    "1998": {
        title:"Elei√ß√µes 1998", year:"1998", emoji:"üìâ",
        desc:"FHC reelei√ß√£o. Crise asi√°tica e Lula vs Ciro.",
        available:true,
        newsHeader:"Folha de S. Pol√≠tica ‚Äî OUTUBRO 1998",
        endYear:"1998",
        partyPoolOverride: [
            {n:"PTB",   side:"C", owner:null},
            {n:"PMDB",  side:"C", owner:null},
            {n:"PPB",   side:"D", owner:null},
            {n:"PL",    side:"D", owner:null},
            {n:"PFL",   side:"D", owner:null},
            {n:"PDT",   side:"E", owner:null},
            {n:"PSB",   side:"E", owner:null},
            {n:"PCdoB", side:"E", owner:null},
        ],
        candidates: {
            fhc98:   {name:"FHC",   party:"PSDB", start:40, money:60, side:"D", color:"#3366ff", econ:2,  soc:0,  nat:-1, bio:"Fernando Henrique Cardoso buscava sua reelei√ß√£o com o Plano Real como trunfo central. Mesmo com a crise asi√°tica pressionando o real, venceu no 1¬∫ turno com 53,1%.", ideologia:"Social-Democracia Liberal"},
            lula98:  {name:"LULA",  party:"PT",   start:23, money:20, side:"E", color:"#ff3333", econ:-2, soc:2,  nat:1,  bio:"Lula em sua terceira candidatura presidencial. Critica a vulnerabilidade externa da economia e defende os trabalhadores, mas o Plano Real limita seu avan√ßo nas pesquisas.", ideologia:"Socialismo Democr√°tico"},
            ciro98:  {name:"CIRO",  party:"PPS",  start:11, money:25, side:"C", color:"#009900", econ:0,  soc:1,  nat:2,  bio:"Ciro Gomes, ex-governador do Cear√° e ex-ministro da Fazenda. Propunha uma terceira via soberanista entre FHC e Lula, com renegocia√ß√£o da d√≠vida externa.", ideologia:"Nacional-Desenvolvimentismo"},
            eneas98: {name:"EN√âAS", party:"PRONA",start:4,  money:5,  side:"X", color:"#555555", econ:-1, soc:-2, nat:2,  bio:"En√©as Carneiro em nova disputa, mantendo o bord√£o 'Meu nome √© En√©as!' e a defesa intransigente do programa nuclear nacional.", ideologia:"Nacionalismo Radical"}
        }
    },
    "2022": {
        title:"Elei√ß√µes 2022", year:"2022", emoji:"üó≥Ô∏è",
        desc:"Lula x Bolsonaro: a disputa mais polarizada.",
        available:true,
        newsHeader:"Folha de S. Pol√≠tica ‚Äî OUTUBRO 2022",
        endYear:"2022",
        partyPoolOverride: [
            {n:"PP",      side:"D", owner:null},
            {n:"PSD",     side:"C", owner:null},
            {n:"REPUBLICANOS", side:"D", owner:null},
            {n:"PCdoB",   side:"E", owner:null},
            {n:"PSOL",    side:"E", owner:null},
            {n:"AVANTE",  side:"C", owner:null},
            {n:"SOLIDARIEDADE", side:"C", owner:null},
        ],
        candidates: {
            bolsonaro22: {name:"BOLSONARO", party:"PL",     start:34, money:55, side:"D", color:"#22bb22", econ:2,  soc:-2, nat:2,  bio:"Jair Bolsonaro buscava a reelei√ß√£o como presidente incumbente. Atacado pela crise econ√¥mica, pandemia e pela guerra √†s urnas, manteve sua base fiel e quase venceu no 2T.", ideologia:"Conservadorismo Nacional-Populista"},
            lula22:      {name:"LULA",      party:"PT",     start:36, money:60, side:"E", color:"#ff3333", econ:-1, soc:2,  nat:1,  bio:"Luiz In√°cio Lula da Silva em sua sexta candidatura presidencial. Voltou da pris√£o, formou ampla coliga√ß√£o da esquerda ao centro e venceu Bolsonaro por 2,1% ‚Äî a margem mais apertada da hist√≥ria.", ideologia:"Social-Desenvolvimentismo"},
            tebet:       {name:"TEBET",     party:"MDB",    start:5,  money:25, side:"C", color:"#006699", econ:0,  soc:1,  nat:-1, bio:"Simone Tebet, senadora do Mato Grosso do Sul. Candidata da terceira via, surpreendeu nos debates com compet√™ncia t√©cnica. Seus 4,2% no 1T foram decisivos para Lula no 2T.", ideologia:"Centro-Democracia Liberal"},
            ciro22:      {name:"CIRO",      party:"PDT",    start:4,  money:18, side:"C", color:"#ff9900", econ:-1, soc:1,  nat:2,  bio:"Ciro Gomes em quarta tentativa. Amargurado com as pesquisas, atacou Lula e Bolsonaro com igual virul√™ncia, viajou √† Europa durante o 2T e decepcionou apoiadores.", ideologia:"Nacional-Desenvolvimentismo"},
            soraya:      {name:"SORAYA",    party:"UNI√ÉO",  start:2,  money:15, side:"D", color:"#cc6600", econ:1,  soc:-1, nat:1,  bio:"Soraya Thronicke, senadora do Mato Grosso do Sul. Candidata de direita com discurso firme contra corrup√ß√£o, mas sem espa√ßo numa elei√ß√£o de polariza√ß√£o extrema.", ideologia:"Direita Liberal Conservadora"},
            davila:      {name:"D'√ÅVILA",   party:"NOVO",   start:1,  money:10, side:"D", color:"#ff6600", econ:2,  soc:-1, nat:-1, bio:"Felipe D'√Åvila, representante do Novo. Candidato liberal cl√°ssico com programa de privatiza√ß√µes abrangente.", ideologia:"Liberalismo Cl√°ssico"},
            kelmon:      {name:"KELMON",    party:"PTB",    start:0.5,money:5,  side:"D", color:"#8b4500", econ:0,  soc:-2, nat:1,  bio:"Padre Kelmon, candidato bolsonarista infiltrado no PTB para atacar Lula nos debates. Tornou-se s√≠mbolo do debate televisionado de 2022 ao fazer ataques coordenados ao PT.", ideologia:"Conservadorismo Crist√£o"},
            pericles:    {name:"P√âRICLES",  party:"UP",     start:0.2,money:3,  side:"E", color:"#8b0000", econ:-2, soc:2,  nat:1,  bio:"L√©o P√©ricles, ativista e candidato da Unidade Popular. Representava a esquerda radical que recusou apoiar Lula no 1T, defendendo uma alternativa socialista.", ideologia:"Socialismo Revolucion√°rio"}
        }
    },
    "2010": {
        title:"Elei√ß√µes 2010", year:"2010", emoji:"üå±",
        desc:"Dilma estreia. Heran√ßa de Lula vs Serra.",
        available:true,
        newsHeader:"Folha de S. Pol√≠tica ‚Äî OUTUBRO 2010",
        endYear:"2010",
        partyPoolOverride: [
            {n:"PMDB",  side:"C", owner:null},
            {n:"PP",    side:"D", owner:null},
            {n:"PR",    side:"C", owner:null},
            {n:"PCdoB", side:"E", owner:null},
            {n:"PRB",   side:"D", owner:null},
            {n:"PSB",   side:"E", owner:null},
            {n:"PDT",   side:"E", owner:null},
        ],
        candidates: {
            dilma10:  {name:"DILMA",   party:"PT",   start:33, money:55, side:"E", color:"#cc0000", econ:-1, soc:2,  nat:1,  bio:"Dilma Rousseff, ex-ministra e candidata de Lula. Nunca antes disputara uma elei√ß√£o. Aprovada pela popularidade de Lula, venceu no 2T com 56% e tornou-se a primeira presidente mulher do Brasil.", ideologia:"Social-Desenvolvimentismo"},
            serra10:  {name:"SERRA",   party:"PSDB", start:28, money:50, side:"D", color:"#0044cc", econ:2,  soc:0,  nat:-1, bio:"Jos√© Serra, ex-governador de S√£o Paulo. Em sua segunda tentativa presidencial, foi incapaz de superar o capital pol√≠tico do governo Lula e perdeu para Dilma no 2T.", ideologia:"Social-Democracia Liberal"},
            marina10: {name:"MARINA",  party:"PV",   start:10, money:15, side:"C", color:"#33aa33", econ:0,  soc:1,  nat:0,  bio:"Marina Silva, ex-ministra e senadora. Com o discurso verde e de renova√ß√£o pol√≠tica, obteve hist√≥ricos 19,3% no 1T ‚Äî at√© ent√£o o maior resultado de um candidato de terceira via.", ideologia:"Ambientalismo Progressista"},
            plinio:   {name:"PL√çNIO",  party:"PSOL", start:2,  money:6,  side:"E", color:"#ff00aa", econ:-2, soc:2,  nat:1,  bio:"Pl√≠nio de Arruda Sampaio, advogado e te√≥logo. Representava a esquerda socialista que se recusou a compactuar com o 'PT de cal√ßas'.", ideologia:"Socialismo Crist√£o"},
            eymael10: {name:"EYMAEL",  party:"DC",   start:0.3,money:4,  side:"C", color:"#006633", econ:0,  soc:-1, nat:0,  bio:"Jos√© Maria Eymael, candidato veterano da Democracia Crist√£. Conhecido pelo jingle e pelo discurso humanista crist√£o em mais uma candidatura.", ideologia:"Democracia Crist√£"}
        }
    },
    "2026": {
        title:"Elei√ß√µes 2026", year:"2026", emoji:"üîÆ",
        desc:"O futuro em disputa. Lula x nova direita.",
        available:true,
        newsHeader:"Folha de S. Pol√≠tica ‚Äî OUTUBRO 2026",
        endYear:"2026",
        partyPoolOverride: [
            {n:"PP",        side:"D", owner:null},
            {n:"REPUBLICANOS", side:"D", owner:null},
            {n:"PCdoB",     side:"E", owner:null},
            {n:"PSOL",      side:"E", owner:null},
            {n:"AVANTE",    side:"C", owner:null},
            {n:"MDB",       side:"C", owner:null},
        ],
        candidates: {
            lula26:   {name:"LULA",    party:"PT",     start:31, money:60, side:"E", color:"#ff3333", econ:-1, soc:2,  nat:1,  bio:"Luiz In√°cio Lula da Silva em sua s√©tima candidatura presidencial. Presidente em exerc√≠cio, buscando reelei√ß√£o com o programa Fome Zero 2.0 e a retomada industrial.", ideologia:"Social-Desenvolvimentismo"},
            flavio:   {name:"FL√ÅVIO",  party:"PL",     start:27, money:50, side:"D", color:"#22bb22", econ:2,  soc:-2, nat:2,  bio:"Fl√°vio Bolsonaro, senador do Rio de Janeiro. Herdeiro direto do bolsonarismo, candidato com apoio do pai via grava√ß√µes dos EUA. Polariza com Lula a disputa principal.", ideologia:"Conservadorismo Nacional-Populista"},
            zema:     {name:"ZEMA",    party:"NOVO",   start:10, money:35, side:"D", color:"#ff6600", econ:2,  soc:-1, nat:-1, bio:"Romeu Zema, ex-governador de Minas Gerais. Candidato do Novo com proposta de Estado m√≠nimo, privatiza√ß√µes amplas e corte de impostos. Tenta ser a alternativa liberal √† polariza√ß√£o.", ideologia:"Liberalismo Cl√°ssico"},
            caiado:   {name:"CAIADO",  party:"PSD",    start:9,  money:30, side:"D", color:"#cc6600", econ:1,  soc:-1, nat:1,  bio:"Ronaldo Caiado, ex-governador de Goi√°s. Candidato da direita tradicional, com forte base ruralista e evang√©lica. Tenta distinguir-se do bolsonarismo sem perder a base.", ideologia:"Conservadorismo Ruralista"},
            renan:    {name:"RENAN S.", party:"MISS√ÉO", start:4, money:10, side:"D", color:"#8b0000", econ:1,  soc:-2, nat:2,  bio:"Renan Santos, l√≠der do movimento MBL e fundador do MISS√ÉO. Candidato jovem libert√°rio-crist√£o que mobiliza universit√°rios direitistas e evang√©licos nas redes sociais.", ideologia:"Libertarianismo Crist√£o"},
            aldo:     {name:"ALDO",    party:"DC",     start:1,  money:5,  side:"C", color:"#006633", econ:0,  soc:-1, nat:1,  bio:"Aldo Rebelo, ex-ministro e parlamentar hist√≥rico da esquerda que migrou para posi√ß√µes nacional-soberanistas. Candidato da Democracia Crist√£ no campo do centro-nacional.", ideologia:"Nacional-Democracia Crist√£"}
        }
    },
    "1934_i": {
        title:"Constituinte 1934", year:"1934", emoji:"üèõÔ∏è", indirect:true,
        desc:"Elei√ß√£o indireta pela Assembleia Constituinte. Get√∫lio Vargas x oposi√ß√£o.",
        available:true,
        context:"A Revolu√ß√£o de 1930 deu origem √† Constitui√ß√£o de 1934. O presidente ser√° escolhido pelos 254 deputados constituintes. Get√∫lio Vargas √© o candidato do governo. A oposi√ß√£o tenta articular alternativas.",
        totalVotes: 254,
        candidates: {
            getulio34: {name:"GET√öLIO VARGAS", party:"Sem Partido", start:140, color:"#cc0000", bio:"L√≠der da Revolu√ß√£o de 1930, presidente provis√≥rio. Controla a m√°quina do governo e tem apoio dos tenentes revolucion√°rios e de v√°rias bancadas estaduais.", ideologia:"Trabalhismo/Populismo"},
            borges:    {name:"BORGES DE MEDEIROS", party:"PRR", start:35, color:"#0044cc", bio:"Veterano pol√≠tico ga√∫cho, ex-aliado de Vargas. Representa a ala conservadora republicana do Rio Grande do Sul.", ideologia:"Republicanismo Conservador"},
            goes:      {name:"G√ìIS MONTEIRO", party:"Sem Partido", start:28, color:"#228800", bio:"General e l√≠der militar da Revolu√ß√£o de 1930. Tem apoio das For√ßas Armadas mas concorre contra seu pr√≥prio aliado.", ideologia:"Militarismo Revolucion√°rio"},
            protogenes:{name:"PROT√ìGENES", party:"Sem Partido", start:18, color:"#886600", bio:"Almirante e pol√≠tico, candidato de setores navais e da oposi√ß√£o moderada.", ideologia:"Moderatismo Naval"},
            plinio34:  {name:"PL√çNIO SALGADO", party:"AIB", start:9, color:"#008888", bio:"L√≠der integralista, o 'Anau√™'. Defensor de ideias fascistas adaptadas ao Brasil. Tem suporte de deputados conservadores antiliberais.", ideologia:"Integralismo"}
        },
        factions: [
            {name:"Bancada Tenentista", votes:52, leans:"getulio34", color:"#cc4444", desc:"Jovens oficiais da Revolu√ß√£o. Apoiam Vargas incondicionalmente."},
            {name:"Bancada Ga√∫cha", votes:28, leans:"borges", color:"#4444cc", desc:"Deputados do RS divididos entre Vargas e Borges."},
            {name:"Bancada Paulista", votes:35, leans:"protogenes", color:"#aa8800", desc:"Oposi√ß√£o ao centralismo varguista ap√≥s a Revolu√ß√£o Constitucionalista de 1932."},
            {name:"Bancada Militar", votes:30, leans:"goes", color:"#228800", desc:"Militares que acompanham G√≥is Monteiro."},
            {name:"Integralistas", votes:18, leans:"plinio34", color:"#008888", desc:"Deputados simp√°ticos ao sigma integralista de Pl√≠nio Salgado."},
            {name:"Indecisos", votes:91, leans:null, color:"#888888", desc:"Bancadas estaduais sem posi√ß√£o definida. Alvo principal das articula√ß√µes."}
        ],
        events: [
            {turn:2, t:"REVOLU√á√ÉO CONSTITUCIONALISTA", d:"Paulistas exigem constitui√ß√£o. Vargas concedeu ‚Äî a Constituinte est√° reunida. Mas a desconfian√ßa dos paulistas persiste. Como voc√™ se posiciona?", b:[{n:"Reconcilia√ß√£o com S√£o Paulo",f:()=>indirectShiftVotes('getulio34',8)},{n:"Ignorar; manter base do Norte/NE",f:()=>indirectShiftVotes('getulio34',4)}]},
            {turn:4, t:"MANIFESTO DOS TENENTES", d:"Os tenentes revolucion√°rios lan√ßam manifesto de apoio a Vargas. Deputados indecisos ficam com medo de desagradar os militares.", b:[{n:"Usar o manifesto politicamente",f:()=>indirectShiftVotes('getulio34',10)},{n:"Recusar o militarismo",f:()=>indirectShiftFaction('Indecisos',6,'getulio34')}]},
            {turn:6, t:"DEBATE SOBRE VOTO FEMININO", d:"A nova Constitui√ß√£o incluir√° voto feminino pela 1¬™ vez. Deputados progressistas e conservadores dividem opini√µes.", b:[{n:"Defender o voto feminino",f:()=>indirectShiftVotes('getulio34',5)},{n:"Manter tradi√ß√£o",f:()=>indirectShiftVotes('plinio34',4)}]},
            {turn:8, t:"ARTICULA√á√ÉO DOS ESTADOS", d:"Governadores dos estados do Norte e Nordeste re√∫nem bancadas em favor do candidato do governo federal.", b:[{n:"Confirmar compromissos regionais",f:()=>indirectShiftVotes('getulio34',12)},{n:"Propor autonomia estadual ampla",f:()=>indirectShiftFaction('Indecisos',8,'getulio34')}]}
        ]
    },
    "1964_i": {
        title:"Golpe de 1964", year:"1964", emoji:"‚öîÔ∏è", indirect:true,
        desc:"Ap√≥s o golpe, o Congresso escolhe o presidente. Militares controlam o processo.",
        available:true,
        context:"Jo√£o Goulart foi deposto em 1¬∫ de abril de 1964. O Congresso mutilado pelo AI-1 deve escolher um presidente. Os militares imp√µem Castelo Branco. A oposi√ß√£o tenta resistir mas est√° enfraquecida.",
        totalVotes: 326,
        candidates: {
            castelo:   {name:"CASTELO BRANCO", party:"Sem Partido", start:180, color:"#004488", bio:"General e l√≠der do golpe. Candidato dos militares 'linha dura'. Prometeu uma transi√ß√£o r√°pida, mas governou por 3 anos.", ideologia:"Militarismo Moderado"},
            tavora:    {name:"JU√ÅREZ T√ÅVORA", party:"PDC", start:80, color:"#338833", bio:"General rival de Castelo. Candidato de setores da oposi√ß√£o democr√°tico-crist√£ que tentou viabilizar uma alternativa civil-militar ao golpe.", ideologia:"Democracia Crist√£ Militar"},
            dutra:     {name:"DUTRA", party:"PSD", start:40, color:"#aa6600", bio:"Ex-presidente Eurico Gaspar Dutra, veterano do PSD. Representava a ala mais conservadora e fisiol√≥gica que queria manter influ√™ncia no novo regime.", ideologia:"Conservadorismo Fisiol√≥gico"}
        },
        factions: [
            {name:"Militares Linha Dura", votes:120, leans:"castelo", color:"#004488", desc:"Generais e coron√©is golpistas. Imp√µem Castelo como presidente."},
            {name:"Bloco da UDN", votes:90, leans:"castelo", color:"#0066aa", desc:"Uni√£o Democr√°tica Nacional. Principal partido apoiador do golpe."},
            {name:"PSD Conservador", votes:60, leans:"dutra", color:"#aa6600", desc:"Partido Social Democr√°tico. Fisiol√≥gico, apoia quem vencer."},
            {name:"PTB Resistente", votes:35, leans:"tavora", color:"#cc4400", desc:"Partido Trabalhista Brasileiro. Enfraquecido ap√≥s queda de Jango."},
            {name:"PDC e Aliados", votes:21, leans:"tavora", color:"#338833", desc:"Partido Democr√°tico Crist√£o e outros pequenos partidos."}
        ],
        events: [
            {turn:2, t:"AI-1: CASSA√á√ÉO DE MANDATOS", d:"O Ato Institucional N¬∫1 cassa mandatos de 40 parlamentares. O Congresso fica mais control√°vel pelos militares. Como voc√™ age?", b:[{n:"Apoiar as cassa√ß√µes",f:()=>indirectShiftVotes('castelo',15)},{n:"Protestar nos limites do permitido",f:()=>indirectShiftVotes('tavora',8)}]},
            {turn:3, t:"IP√äS E IBAD: FINANCIAMENTO DO GOLPE", d:"O Instituto de Pesquisas e Estudos Sociais revela que financiou a campanha antigolpista. O empresariado apoia os militares.", b:[{n:"Alinhar com o empresariado",f:()=>indirectShiftVotes('castelo',12)},{n:"Denunciar o financiamento",f:()=>indirectShiftVotes('tavora',5)}]},
            {turn:5, t:"PRESS√ÉO DOS GENERAIS", d:"Os generais reunidos pressionam o Congresso: votem em Castelo Branco ou sofrer√£o consequ√™ncias. Deputados com medo.", b:[{n:"Ceder √† press√£o",f:()=>indirectShiftFaction('PTB Resistente',15,'castelo')},{n:"Resistir simbolicamente",f:()=>indirectShiftVotes('tavora',4)}]},
            {turn:7, t:"JANGO NO EX√çLIO APELA AO CONGRESSO", d:"Jo√£o Goulart, do Uruguai, manda mensagem pedindo resist√™ncia constitucional. Poucos ousam seguir.", b:[{n:"Homenagem a Jango",f:()=>indirectShiftVotes('tavora',6)},{n:"Sil√™ncio pragm√°tico",f:()=>indirectShiftVotes('dutra',5)}]}
        ]
    },
    "1974_i": {
        title:"Col√©gio Eleitoral 1974", year:"1974", emoji:"üéñÔ∏è", indirect:true,
        desc:"ARENA vs MDB. Geisel deve ser eleito pelo Col√©gio Eleitoral.",
        available:true,
        context:"O regime militar est√° no auge. O presidente M√©dici escolheu Ernesto Geisel como seu sucessor. O Col√©gio Eleitoral, dominado pela ARENA, eleger√° o pr√≥ximo presidente. O MDB lan√ßa Ulysses como candidato simb√≥lico.",
        totalVotes: 503,
        candidates: {
            geisel:    {name:"GEISEL", party:"ARENA", start:310, color:"#004488", bio:"General ga√∫cho escolhido pelo presidente M√©dici. Prometeu uma abertura 'lenta, gradual e segura'. Acabou extinguindo o AI-5.", ideologia:"Militarismo Moderado ‚Äî Abertura"},
            ulysses74: {name:"ULYSSES", party:"MDB", start:140, color:"#cc2200", bio:"Ulysses Guimar√£es, presidente do MDB. Chamou sua candidatura de 'anticandidata', sabendo que perderia. Transformou a campanha em manifesto pela democracia.", ideologia:"Social-Democracia Oposicionista"}
        },
        factions: [
            {name:"ARENA Nacional", votes:240, leans:"geisel", color:"#0044cc", desc:"Partido do governo. Voto obrigat√≥rio em Geisel."},
            {name:"ARENA Dissidentes", votes:40, leans:"geisel", color:"#6688cc", desc:"Ala da ARENA que questionava a escolha de Geisel mas cedia √† disciplina partid√°ria."},
            {name:"MDB Oposi√ß√£o", votes:160, leans:"ulysses74", color:"#cc2200", desc:"Bancada do MDB. Vota em Ulysses por princ√≠pio, sem esperan√ßa de vit√≥ria."},
            {name:"Indecisos", votes:63, leans:null, color:"#888888", desc:"Senadores e deputados sem partido definido ou com lealdades cruzadas."}
        ],
        events: [
            {turn:2, t:"M√âDICI INDICA GEISEL OFICIALMENTE", d:"Presidente M√©dici anuncia Geisel como candidato da ARENA. Os parlamentares da ARENA recebem 'orienta√ß√µes' sobre o voto.", b:[{n:"Refor√ßar disciplina partid√°ria",f:()=>indirectShiftFaction('ARENA Dissidentes',15,'geisel')},{n:"Abrir espa√ßo para debate",f:()=>indirectShiftVotes('ulysses74',8)}]},
            {turn:3, t:"MILAGRE ECON√îMICO: CRESCIMENTO DE 11%", d:"O PIB cresceu 11% em 1973. O regime usa o crescimento como argumento para manter o poder.", b:[{n:"Celebrar o milagre",f:()=>indirectShiftVotes('geisel',15)},{n:"Denunciar: 'Milagre para quem?'",f:()=>indirectShiftVotes('ulysses74',10)}]},
            {turn:5, t:"CAMPANHA 'ANTICANDIDATA' DE ULYSSES", d:"Ulysses percorre o Brasil dizendo que vai perder mas quer mostrar que h√° oposi√ß√£o viva. Mobiliza a sociedade civil.", b:[{n:"Acompanhar Ulysses pelo Brasil",f:()=>indirectShiftVotes('ulysses74',12)},{n:"Boicotar a campanha opositora",f:()=>indirectShiftVotes('geisel',6)}]},
            {turn:7, t:"SNI MONITORA PARLAMENTARES", d:"O Servi√ßo Nacional de Informa√ß√µes monitora e intimida parlamentares da oposi√ß√£o. Clima de medo no Congresso.", b:[{n:"Resistir √† intimida√ß√£o",f:()=>indirectShiftVotes('ulysses74',8)},{n:"Ceder √† press√£o do regime",f:()=>indirectShiftFaction('Indecisos',20,'geisel')}]}
        ]
    },
    "1978_i": {
        title:"Col√©gio Eleitoral 1978", year:"1978", emoji:"üîì", indirect:true,
        desc:"√öltimo presidente do regime militar eleito pelo Col√©gio Eleitoral.",
        available:true,
        context:"Geisel conduz a abertura. O Col√©gio Eleitoral eleger√° o general Jo√£o Figueiredo, o √∫ltimo presidente militar. O MDB lan√ßa Euler Bentes Monteiro como candidato real, com alguma chance ‚Äî a abertura j√° permite mais debate.",
        totalVotes: 503,
        candidates: {
            figueiredo:{name:"FIGUEIREDO", party:"ARENA", start:300, color:"#334499", bio:"General do SNI, escolhido por Geisel como seu sucessor. Prometeu 'fazer desse pa√≠s uma democracia'. Governou at√© 1985, decretou a Anistia e a redemocratiza√ß√£o.", ideologia:"Militarismo Liberal ‚Äî Abertura"},
            euler:     {name:"EULER BENTES", party:"MDB", start:170, color:"#cc3300", bio:"General dissidente e candidato do MDB. Diferente de Ulysses em 1974, Euler tinha apoio real de setores militares descontentes com a escolha de Figueiredo.", ideologia:"Militarismo Democr√°tico ‚Äî Oposi√ß√£o"}
        },
        factions: [
            {name:"ARENA Governista", votes:220, leans:"figueiredo", color:"#334499", desc:"Bloco fiel ao candidato de Geisel."},
            {name:"ARENA Moderada", votes:60, leans:"figueiredo", color:"#6677bb", desc:"ARENA que simpatizava com a abertura mas votava no candidato oficial."},
            {name:"MDB Oposi√ß√£o", votes:170, leans:"euler", color:"#cc3300", desc:"Todo o MDB unido em torno de Euler Bentes."},
            {name:"Militares Dissidentes", votes:30, leans:"euler", color:"#8b2200", desc:"Generais que preferiam Euler a Figueiredo por quest√µes pessoais."},
            {name:"Indecisos", votes:23, leans:null, color:"#888888", desc:"Pequeno grupo de parlamentares sem posi√ß√£o definida."}
        ],
        events: [
            {turn:2, t:"PACOTE DE ABRIL: GEISEL AUMENTA PODER", d:"Geisel edita o 'Pacote de Abril' que altera a composi√ß√£o do Congresso para garantir maioria da ARENA.", b:[{n:"Denunciar o Pacote de Abril",f:()=>indirectShiftVotes('euler',15)},{n:"Aceitar como parte da abertura",f:()=>indirectShiftVotes('figueiredo',8)}]},
            {turn:3, t:"ANISTIA EM DEBATE", d:"O MDB pressiona por Anistia ampla e irrestrita. O governo quer uma anistia limitada. Ambos os candidatos se posicionam.", b:[{n:"Defender Anistia ampla",f:()=>indirectShiftVotes('euler',12)},{n:"Apoiar Anistia restrita governista",f:()=>indirectShiftVotes('figueiredo',8)}]},
            {turn:5, t:"MOVIMENTO GREVISTA DO ABC PAULISTA", d:"Lula e o sindicato dos metal√∫rgicos deflagam greve hist√≥rica. O governo usa a Lei de Seguran√ßa Nacional.", b:[{n:"Apoiar os trabalhadores em greve",f:()=>indirectShiftVotes('euler',10)},{n:"Defender a ordem",f:()=>indirectShiftVotes('figueiredo',6)}]},
            {turn:7, t:"FIGUEIREDO SOFRE PRESS√ÉO DOS DUROS", d:"A 'linha dura' militar questiona a abertura de Geisel/Figueiredo. Atentados terroristas de direita complicam o quadro.", b:[{n:"Recusar a linha dura",f:()=>indirectShiftVotes('euler',8)},{n:"Manter unidade militar",f:()=>indirectShiftFaction('ARENA Governista',10,'figueiredo')}]}
        ]
    },
    "1985_i": {
        title:"Diretas J√°! ‚Äî 1985", year:"1985", emoji:"üåü", indirect:true,
        desc:"Fim da ditadura. Tancredo x Maluf no Col√©gio Eleitoral.",
        available:true,
        context:"O Brasil inteiro saiu √†s ruas pedindo elei√ß√µes diretas ‚Äî mas a emenda Dante de Oliveira foi rejeitada. O Col√©gio Eleitoral decidir√°. Tancredo Neves, da PMDB, em alian√ßa com o PDS dissidente de Jos√© Sarney, enfrenta Paulo Maluf.",
        totalVotes: 686,
        candidates: {
            tancredo:  {name:"TANCREDO NEVES", party:"PMDB", start:360, color:"#009933", bio:"Mineiro moderado, ex-primeiro-ministro. S√≠mbolo da redemocratiza√ß√£o. Ganhou o Col√©gio Eleitoral mas adoeceu antes da posse ‚Äî nunca tomou posse como presidente. Morreu em 21 de abril de 1985.", ideologia:"Centro-Democr√°tico"},
            maluf85:   {name:"PAULO MALUF", party:"PDS", start:290, color:"#6600cc", bio:"Ex-governador de S√£o Paulo, o candidato do regime militar. 'Rouba mas faz'. Perdeu pela primeira vez na vida, mas negou at√© o fim.", ideologia:"Conservadorismo Fisiol√≥gico"}
        },
        factions: [
            {name:"PMDB + Alian√ßa Democr√°tica", votes:300, leans:"tancredo", color:"#009933", desc:"Grande base peemedebista e aliados da oposi√ß√£o democr√°tica."},
            {name:"PDS Dissidente (Frente Liberal)", votes:80, leans:"tancredo", color:"#55aa44", desc:"Ala do PDS que rompeu com Maluf e formou a Frente Liberal com Sarney como vice."},
            {name:"PDS Malufista", votes:240, leans:"maluf85", color:"#6600cc", desc:"A m√°quina do PDS leal a Maluf. Disciplinada mas j√° minoria."},
            {name:"Indecisos PDS", votes:50, leans:null, color:"#aa66cc", desc:"Parlamentares do PDS em d√∫vida entre a lealdade partid√°ria e a press√£o popular."},
            {name:"Pequenos Partidos", votes:16, leans:"tancredo", color:"#888888", desc:"PTB, PP e outros pequenos partidos que apoiaram Tancredo."}
        ],
        events: [
            {turn:2, t:"DIRETAS J√Å! ‚Äî MULTID√ïES NAS RUAS", d:"Mais de 1 milh√£o de pessoas na Candel√°ria e no Vale do Anhangaba√∫ pedem elei√ß√µes diretas. O Col√©gio Eleitoral sob press√£o moral.", b:[{n:"Capitalizar as Diretas para pressionar PDS",f:()=>indirectShiftFaction('Indecisos PDS',20,'tancredo')},{n:"Propor acordo de transi√ß√£o",f:()=>indirectShiftVotes('tancredo',15)}]},
            {turn:3, t:"SARNEY ROMPE COM MALUF E SE UNE A TANCREDO", d:"Jos√© Sarney, presidente do PDS, abandona Maluf e aceita ser vice de Tancredo. A Frente Liberal nasce. A m√°quina do PDS racha.", b:[{n:"Absorver o PDS dissidente",f:()=>indirectShiftFaction('PDS Dissidente (Frente Liberal)',15,'tancredo')},{n:"Garantir programa democr√°tico s√≥lido",f:()=>indirectShiftVotes('tancredo',12)}]},
            {turn:5, t:"FIGUEIREDO RECUSA TRANSMITIR A MALUF", d:"Figueiredo declara que prefere n√£o transmitir a faixa a Maluf. Sinal de que o regime n√£o apoia mais seu candidato.", b:[{n:"Usar declara√ß√£o para conquistar indecisos",f:()=>indirectShiftFaction('Indecisos PDS',25,'tancredo')},{n:"Pressionar Figueiredo a apoiar Tancredo",f:()=>indirectShiftVotes('tancredo',8)}]},
            {turn:7, t:"√öLTIMA HORA: MALUF TENTA BARGANHAS", d:"Maluf oferece minist√©rios e cargos em troca de votos. √öltima tentativa desesperada antes da vota√ß√£o.", b:[{n:"Denunciar a compra de votos",f:()=>indirectShiftVotes('tancredo',10)},{n:"Ceder √†s barganhas (jogo sujo)",f:()=>indirectShiftVotes('maluf85',15)}]},
            {turn:9, t:"VOTA√á√ÉO FINAL NO COL√âGIO", d:"15 de janeiro de 1985. O momento hist√≥rico. O Col√©gio vota. A democracia retorna?", b:[{n:"Discurso hist√≥rico pela democracia",f:()=>indirectShiftFaction('Indecisos PDS',18,'tancredo')},{n:"Garantir votos com articula√ß√£o final",f:()=>indirectShiftVotes('tancredo',20)}]}
        ]
    },
    "1938_nc": {
        title:"Elei√ß√µes 1938 (Cancelada)", year:"1938", emoji:"üö´", cancelled:true,
        desc:"Vargas deu golpe do Estado Novo e cancelou as elei√ß√µes.",
        available:true,
        newsHeader:"Folha de S. Pol√≠tica ‚Äî JANEIRO 1938",
        endYear:"1938",
        context:"As elei√ß√µes de 1938 foram canceladas quando Vargas decretou o Estado Novo em novembro de 1937, transformando o Brasil em ditadura. A simula√ß√£o reconstitui como teria sido a disputa.",
        partyPoolOverride: [
            {n:"PSP", side:"C", owner:null},
            {n:"PRR", side:"D", owner:null},
            {n:"PRC", side:"C", owner:null},
        ],
        candidates: {
            armando:  {name:"ARMANDO SALLES",  party:"UDB",           start:30, money:40, side:"D", color:"#0044cc", econ:1,  soc:-1, nat:0,  bio:"Armando de Salles Oliveira, ex-governador de SP. Candidato liberal-constitucionalista, maior amea√ßa ao getulismo. Foi exilado quando Vargas decretou o Estado Novo.", ideologia:"Liberalismo Constitucional"},
            jose_am:  {name:"JOS√â AM√âRICO",    party:"Sem Partido",   start:28, money:30, side:"C", color:"#cc6600", econ:-1, soc:1,  nat:1,  bio:"Jos√© Am√©rico de Almeida, ex-ministro e escritor nordestino. Candidato da situa√ß√£o que rompeu com Vargas. Sua censura pela imprensa getulista foi sinal do fim da democracia.", ideologia:"Populismo Nordestino"},
            plinio38: {name:"PL√çNIO SALGADO",  party:"AIB",           start:20, money:20, side:"X", color:"#008888", econ:0,  soc:-2, nat:2,  bio:"L√≠der integralista. Ap√≥s o Estado Novo, tentou um golpe integralista em 1938 e foi preso. O AIB foi o √∫nico movimento de massa de direita radical do Brasil.", ideologia:"Integralismo Fascista"}
        }
    },
    "1945": {
        title:"Elei√ß√µes 1945", year:"1945", emoji:"üïäÔ∏è",
        desc:"Redemocratiza√ß√£o. Dutra vs Eduardo Gomes.",
        available:true,
        newsHeader:"Folha de S. Pol√≠tica ‚Äî DEZEMBRO 1945",
        endYear:"1945",
        partyPoolOverride: [
            {n:"PTB", side:"C", owner:null},
            {n:"PSP", side:"C", owner:null},
            {n:"PST", side:"C", owner:null},
        ],
        candidates: {
            dutra:    {name:"DUTRA",          party:"PSD", start:35, money:45, side:"D", color:"#0044cc", econ:1,  soc:-1, nat:0,  bio:"General Eurico Gaspar Dutra, ex-ministro de Vargas. Apesar de ser do regime, venceu com apoio do PTB de Vargas. Governa de forma conservadora e alinha o Brasil com os EUA na Guerra Fria.", ideologia:"Conservadorismo Liberal"},
            eduardo45:{name:"EDUARDO GOMES",  party:"UDN", start:30, money:35, side:"D", color:"#cc3300", econ:2,  soc:-1, nat:-1, bio:"Brigadeiro Eduardo Gomes, her√≥i dos 18 do Forte. Candidato da UDN, partido dos liberais anti-Vargas. Derrotado por Dutra, ficou marcado pela frase ap√≥crifa 'n√£o preciso de votos de ot√°rios'.", ideologia:"Liberalismo Anti-getulista"},
            yedo:     {name:"YEDO FI√öZA",     party:"PCB", start:10, money:10, side:"E", color:"#cc0000", econ:-2, soc:2,  nat:1,  bio:"Yedo Fi√∫za, engenheiro. O candidato comunista obteve 9,7% ‚Äî o maior resultado do PCB na hist√≥ria. Foi logo cassado quando o PCB foi declarado ilegal em 1947.", ideologia:"Comunismo"}
        }
    },
    "1950": {
        title:"Elei√ß√µes 1950", year:"1950", emoji:"üî•",
        desc:"Vargas retorna pelo voto. 'Eu voltarei!'",
        available:true,
        newsHeader:"Folha de S. Pol√≠tica ‚Äî OUTUBRO 1950",
        endYear:"1950",
        partyPoolOverride: [
            {n:"PSD", side:"C", owner:null},
            {n:"PSP", side:"C", owner:null},
            {n:"PL",  side:"D", owner:null},
        ],
        candidates: {
            getulio50:{name:"GET√öLIO",    party:"PTB", start:40, money:50, side:"C", color:"#cc0000", econ:-1, soc:2,  nat:1,  bio:"Get√∫lio Vargas, o 'pai dos pobres'. Retornou ao poder pelo voto direto, cumpriu sua promessa. Governa at√© 1954, quando se suicida com carta-testamento hist√≥rica.", ideologia:"Trabalhismo Nacional-Populista"},
            ed_gomes: {name:"GOMES",      party:"UDN", start:28, money:35, side:"D", color:"#0044cc", econ:2,  soc:-1, nat:-1, bio:"Eduardo Gomes em sua segunda candidatura presidencial. A UDN perdeu novamente para Vargas, mantendo sua postura de oposi√ß√£o intransigente ao getulismo.", ideologia:"Liberalismo Conservador"},
            cristiano:{name:"CRISTIANO",  party:"PSD", start:18, money:25, side:"D", color:"#886600", econ:1,  soc:0,  nat:0,  bio:"Cristiano Machado, candidato do PSD que foi t√£o fraco que os pr√≥prios peeessedebistas votaram em Vargas ‚Äî fen√¥meno chamado de 'cristianiza√ß√£o'. Obteve apenas 10%.", ideologia:"Conservadorismo Fisiol√≥gico"}
        }
    },
    "1955": {
        title:"Elei√ß√µes 1955", year:"1955", emoji:"üöÇ",
        desc:"JK e Cinquenta Anos em Cinco.",
        available:true,
        newsHeader:"Folha de S. Pol√≠tica ‚Äî OUTUBRO 1955",
        endYear:"1955",
        partyPoolOverride: [
            {n:"PTB", side:"C", owner:null},
            {n:"PST", side:"C", owner:null},
            {n:"PL",  side:"D", owner:null},
        ],
        candidates: {
            jk:       {name:"JK",          party:"PSD",  start:33, money:50, side:"C", color:"#3477eb", econ:0,  soc:1,  nat:1,  bio:"Juscelino Kubitschek, ex-governador de Minas Gerais. Venceu com apenas 36% dos votos gra√ßas √† divis√£o da direita. Construiu Bras√≠lia, trouxe a ind√∫stria automobil√≠stica e governou com democracia.", ideologia:"Desenvolvimentismo Democr√°tico"},
            tavora55: {name:"T√ÅVORA",       party:"UDN",  start:28, money:40, side:"D", color:"#0044cc", econ:2,  soc:-1, nat:0,  bio:"Juarez T√°vora, o 'cabo eleitoral de Deus'. Candidato da UDN, perdeu para JK por diferen√ßa pequena. Apoiou a tentativa de golpe militar para impedir a posse de JK.", ideologia:"Militar Liberal"},
            adhemar55:{name:"ADHEMAR",      party:"PSP",  start:22, money:30, side:"C", color:"#8b0000", econ:-1, soc:1,  nat:1,  bio:"Adhemar de Barros, ex-governador de SP e pioneiro do populismo paulista. O slogan 'rouba mas faz' √© frequentemente associado a ele. Ficou em terceiro.", ideologia:"Populismo Paulista"},
            plinio55: {name:"PL√çNIO",       party:"PRP",  start:9,  money:15, side:"D", color:"#006666", econ:0,  soc:-2, nat:2,  bio:"Pl√≠nio Salgado, l√≠der integralista e fundador do Partido da Representa√ß√£o Popular. Candidato anticomunista ferrenho, recebeu 714 mil votos (8,3%) em sua √∫nica candidatura presidencial direta.", ideologia:"Integralismo"}
        }
    },
    "1960": {
        title:"Elei√ß√µes 1960", year:"1960", emoji:"üßπ",
        desc:"J√¢nio Quadros varre a corrup√ß√£o.",
        available:true,
        newsHeader:"Folha de S. Pol√≠tica ‚Äî OUTUBRO 1960",
        endYear:"1960",
        partyPoolOverride: [
            {n:"PTB", side:"C", owner:null},
            {n:"PDC", side:"C", owner:null},
            {n:"PRT", side:"E", owner:null},
        ],
        candidates: {
            janio:    {name:"J√ÇNIO",      party:"PTN",  start:40, money:45, side:"C", color:"#006600", econ:1,  soc:0,  nat:1,  bio:"J√¢nio Quadros, ex-governador de SP. Venceu com 48% usando a vassoura como s√≠mbolo de limpeza. Renunciou misteriosamente em agosto de 1961 ap√≥s apenas 7 meses de mandato.", ideologia:"Moralismo Liberal"},
            lott:     {name:"LOTT",       party:"PSD",  start:28, money:35, side:"C", color:"#0044cc", econ:0,  soc:1,  nat:0,  bio:"Henrique Teixeira Lott, general legalista. Candidato do PSD+PTB (JK+Jango). Perdeu para J√¢nio, mas como vice de Jango assumiu a presid√™ncia ap√≥s a ren√∫ncia de J√¢nio.", ideologia:"Militarismo Democr√°tico"},
            adhemar60:{name:"ADHEMAR",    party:"PSP",  start:18, money:25, side:"C", color:"#8b0000", econ:-1, soc:1,  nat:1,  bio:"Adhemar de Barros em terceiro lugar novamente. Sempre amea√ßa, nunca vence. O populismo paulista encontrava seus limites no plano nacional.", ideologia:"Populismo Paulista"}
        }
    },
    "1965_nc": {
        title:"Elei√ß√µes 1965 (Cancelada)", year:"1965", emoji:"üö´", cancelled:true,
        desc:"Elei√ß√µes canceladas pelo AI-2 ap√≥s o golpe de 1964.",
        available:true,
        newsHeader:"Folha de S. Pol√≠tica ‚Äî OUTUBRO 1965",
        endYear:"1965",
        context:"As elei√ß√µes presidenciais de 1965 nunca ocorreram. O golpe de 1964 e o AI-2 extinguiram os partidos pol√≠ticos e institu√≠ram o bipartidarismo ARENA x MDB. Esta simula√ß√£o reconstitui como teria sido a disputa.",
        partyPoolOverride: [
            {n:"PSB", side:"E", owner:null},
            {n:"PDC", side:"C", owner:null},
            {n:"PRT", side:"C", owner:null},
        ],
        candidates: {
            lacerda:  {name:"LACERDA",    party:"UDN",  start:25, money:40, side:"D", color:"#0044cc", econ:2,  soc:-1, nat:-1, bio:"Carlos Lacerda, jornalista e ex-governador do Rio. Apoiou o golpe de 1964 mas depois rompeu com os militares. Fundou a Frente Ampla com JK e Jango.", ideologia:"Liberalismo Anti-getulista"},
            janio65:  {name:"J√ÇNIO",      party:"PTN",  start:20, money:30, side:"C", color:"#006600", econ:1,  soc:0,  nat:1,  bio:"J√¢nio Quadros tentaria retornar √† presid√™ncia. Nunca conseguiu ‚Äî o golpe encerrou essa possibilidade, e sua ren√∫ncia de 1961 era uma mancha irrepar√°vel.", ideologia:"Moralismo Liberal"},
            jk65:     {name:"JK",         party:"PSD",  start:22, money:35, side:"C", color:"#cc6600", econ:0,  soc:1,  nat:1,  bio:"Juscelino Kubitschek, ex-presidente. Tinha o prest√≠gio de Bras√≠lia mas seu mandato de cassa√ß√£o pelo AI-1 o mantinha afastado da pol√≠tica. Nunca p√¥de disputar.", ideologia:"Desenvolvimentismo Democr√°tico"},
            brizola:  {name:"BRIZOLA",    party:"PTB",  start:18, money:20, side:"E", color:"#cc0000", econ:-1, soc:2,  nat:1,  bio:"Leonel Brizola, ex-governador do RS. Radical da esquerda trabalhista, cunhado de Jango. Foi um dos mais perseguidos pelo regime militar, exilado por anos.", ideologia:"Trabalhismo Radical"},
            arraes:   {name:"ARRAES",     party:"PST",  start:10, money:15, side:"E", color:"#aa0033", econ:-2, soc:2,  nat:1,  bio:"Miguel Arraes, governador de Pernambuco preso no golpe de 1964. Representava a esquerda nordestina e o movimento das Ligas Camponesas.", ideologia:"Socialismo Nordestino"}
        }
    },
    "1945_l": {title:"Elei√ß√µes 1938", year:"1938", emoji:"üîí", desc:"Estado Novo cancelou elei√ß√µes", available:false, desc_locked:"Adicionado ‚Äî ver aba Presidenciais"},
    // ============================================================
    // REP√öBLICA VELHA (1894‚Äì1930) ‚Äî integradas nas presidenciais BR
    // ============================================================
    "RV1894": {
        title:"Elei√ß√µes 1894", year:"1894", emoji:"‚òï",
        desc:"Prudente de Moraes vs Afonso Pena. 1¬™ elei√ß√£o civil da Rep√∫blica.",
        available:true, noSecondRound:true, isRepVelha:true,
        newsHeader:"Gazeta de Not√≠cias ‚Äî MAR√áO 1894",
        endYear:"1894",
        partyPoolOverride:[{n:"PRP",side:"D",owner:null},{n:"PRM",side:"D",owner:null}],
        candidates:{
            prudente: {name:"PRUDENTE",      party:"PRP", start:84, money:40, side:"D", color:"#cc6600", econ:1, soc:-1, nat:0, bio:"Prudente de Moraes, l√≠der republicano paulista. Primeiro presidente civil do Brasil. Venceu com 84% por ser o candidato da m√°quina republicana paulista.", ideologia:"Republicanismo Paulista"},
            afonso94: {name:"AFONSO PENA",   party:"PRM", start:10, money:20, side:"D", color:"#004488", econ:0, soc:0, nat:1, bio:"Afonso Pena, representante mineiro. Candidato da oposi√ß√£o simb√≥lica, ainda sem for√ßa eleitoral suficiente para rivalizar com o PRP.", ideologia:"Republicanismo Mineiro"}
        },
        regions:[
            {id:'SP', n:'S√£o Paulo',     x:55,y:70, p:22, econ:2,  soc:-1, nat:0},
            {id:'MG', n:'Minas Gerais',   x:60,y:55, p:18, econ:0,  soc:0,  nat:0},
            {id:'RJ', n:'Rio de Janeiro', x:70,y:68, p:13, econ:0,  soc:1,  nat:0},
            {id:'RS', n:'Rio G. do Sul',  x:50,y:88, p:9,  econ:0,  soc:-1, nat:1},
            {id:'BA', n:'Bahia',          x:78,y:48, p:10, econ:-1, soc:0,  nat:0},
            {id:'PE', n:'Pernambuco',     x:88,y:33, p:7,  econ:-1, soc:1,  nat:0},
            {id:'CE', n:'Cear√°',          x:82,y:22, p:5,  econ:-1, soc:1,  nat:0},
            {id:'AM', n:'Amazonas/Norte', x:20,y:20, p:4,  econ:-1, soc:0,  nat:1},
            {id:'PR', n:'Paran√°',         x:50,y:75, p:4,  econ:1,  soc:-1, nat:0},
            {id:'SC', n:'S. Catarina',    x:52,y:82, p:3,  econ:1,  soc:-1, nat:0},
            {id:'OUTROS',n:'Demais Estados',x:30,y:35,p:5, econ:-1, soc:0,  nat:1}
        ]
    },
    "RV1898": {
        title:"Elei√ß√µes 1898", year:"1898", emoji:"‚òï",
        desc:"Campos Sales vs Lauro Sodr√©. A pol√≠tica dos governadores toma forma.",
        available:true, noSecondRound:true, isRepVelha:true,
        newsHeader:"Jornal do Brasil ‚Äî MAR√áO 1898",
        endYear:"1898",
        partyPoolOverride:[{n:"PRP",side:"D",owner:null},{n:"PRF",side:"D",owner:null}],
        candidates:{
            camposSales: {name:"CAMPOS SALES", party:"PRP", start:90, money:50, side:"D", color:"#cc6600", econ:2, soc:-1, nat:-1, bio:"Manuel Ferraz de Campos Sales, paulista. Venceu com cerca de 90%. Seu governo seria marcado pela 'pol√≠tica dos governadores', consolidando o poder das oligarquias estaduais.", ideologia:"Oligarquismo Paulista"},
            lauro98:     {name:"LAURO SODR√â",  party:"PRF", start:8,  money:20, side:"D", color:"#004488", econ:-1, soc:1, nat:1, bio:"Lauro Sodr√©, governador do Par√°. Candidato dissidente da oposi√ß√£o republicana federal, representava os estados do Norte.", ideologia:"Republicanismo Federal"}
        },
        regions:[
            {id:'SP', n:'S√£o Paulo',     x:55,y:70, p:22, econ:2,  soc:-1, nat:0},
            {id:'MG', n:'Minas Gerais',   x:60,y:55, p:18, econ:0,  soc:0,  nat:0},
            {id:'RJ', n:'Rio de Janeiro', x:70,y:68, p:13, econ:0,  soc:1,  nat:0},
            {id:'RS', n:'Rio G. do Sul',  x:50,y:88, p:9,  econ:0,  soc:-1, nat:1},
            {id:'BA', n:'Bahia',          x:78,y:48, p:10, econ:-1, soc:0,  nat:0},
            {id:'PE', n:'Pernambuco',     x:88,y:33, p:7,  econ:-1, soc:1,  nat:0},
            {id:'CE', n:'Cear√°',          x:82,y:22, p:5,  econ:-1, soc:1,  nat:0},
            {id:'AM', n:'Amazonas/Norte', x:20,y:20, p:4,  econ:-1, soc:0,  nat:1},
            {id:'PR', n:'Paran√°',         x:50,y:75, p:4,  econ:1,  soc:-1, nat:0},
            {id:'SC', n:'S. Catarina',    x:52,y:82, p:3,  econ:1,  soc:-1, nat:0},
            {id:'OUTROS',n:'Demais Estados',x:30,y:35,p:5, econ:-1, soc:0,  nat:1}
        ]
    },
    "RV1902": {
        title:"Elei√ß√µes 1902", year:"1902", emoji:"‚òï",
        desc:"Rodrigues Alves vs Quintino Bocai√∫va. O Brasil na Belle √âpoque.",
        available:true, noSecondRound:true, isRepVelha:true,
        newsHeader:"O Pa√≠s ‚Äî MAR√áO 1902",
        endYear:"1902",
        partyPoolOverride:[{n:"PRP",side:"D",owner:null},{n:"PRC",side:"D",owner:null}],
        candidates:{
            rodriguesAlves: {name:"RODRIGUES ALVES", party:"PRP", start:91, money:55, side:"D", color:"#cc6600", econ:2, soc:-1, nat:0, bio:"Francisco de Paula Rodrigues Alves, paulista. Presidente 1902-1906. Seu governo promoveu a moderniza√ß√£o do Rio de Janeiro (Pereira Passos) e o combate √† febre amarela (Oswaldo Cruz).", ideologia:"Liberalismo Olig√°rquico"},
            quintino:       {name:"QUINTINO BOCAI√öVA",party:"PRC", start:7,  money:20, side:"D", color:"#004488", econ:0, soc:1, nat:1, bio:"Quintino Bocai√∫va, jornalista e um dos fundadores da Rep√∫blica. Candidato do Partido Republicano Conservador, representava dissid√™ncia olig√°rquica.", ideologia:"Republicanismo Conservador"}
        },
        regions:[
            {id:'SP', n:'S√£o Paulo',     x:55,y:70, p:22, econ:2,  soc:-1, nat:0},
            {id:'MG', n:'Minas Gerais',   x:60,y:55, p:18, econ:0,  soc:0,  nat:0},
            {id:'RJ', n:'Rio de Janeiro', x:70,y:68, p:13, econ:0,  soc:1,  nat:0},
            {id:'RS', n:'Rio G. do Sul',  x:50,y:88, p:9,  econ:0,  soc:-1, nat:1},
            {id:'BA', n:'Bahia',          x:78,y:48, p:10, econ:-1, soc:0,  nat:0},
            {id:'PE', n:'Pernambuco',     x:88,y:33, p:7,  econ:-1, soc:1,  nat:0},
            {id:'CE', n:'Cear√°',          x:82,y:22, p:5,  econ:-1, soc:1,  nat:0},
            {id:'AM', n:'Amazonas/Norte', x:20,y:20, p:4,  econ:-1, soc:0,  nat:1},
            {id:'PR', n:'Paran√°',         x:50,y:75, p:4,  econ:1,  soc:-1, nat:0},
            {id:'SC', n:'S. Catarina',    x:52,y:82, p:3,  econ:1,  soc:-1, nat:0},
            {id:'OUTROS',n:'Demais Estados',x:30,y:35,p:5, econ:-1, soc:0,  nat:1}
        ]
    },
    "RV1906": {
        title:"Elei√ß√µes 1906", year:"1906", emoji:"‚òï",
        desc:"Afonso Pena vs Lauro Sodr√©. Caf√©-com-leite se consolida.",
        available:true, noSecondRound:true, isRepVelha:true,
        newsHeader:"O Estado de S. Paulo ‚Äî MAR√áO 1906",
        endYear:"1906",
        partyPoolOverride:[{n:"PRM",side:"D",owner:null},{n:"PRF",side:"D",owner:null}],
        candidates:{
            afonso06: {name:"AFONSO PENA", party:"PRM", start:97, money:50, side:"D", color:"#cc6600", econ:1, soc:0, nat:0, bio:"Afonso Pena, mineiro, presidente 1906-1909. Beneficiou-se do acordo olig√°rquico caf√©-com-leite entre SP e MG. Praticamente candidato √∫nico, venceu com esmagadora maioria.", ideologia:"Oligarquismo Mineiro"},
            lauro06:  {name:"LAURO SODR√â", party:"PRF", start:2,  money:15, side:"D", color:"#004488", econ:-1,soc:1, nat:1, bio:"Lauro Sodr√©, segundo candidato do Par√°. Oposi√ß√£o simb√≥lica ao dom√≠nio caf√©-com-leite.", ideologia:"Republicanismo Federal"}
        },
        regions:[
            {id:'SP', n:'S√£o Paulo',     x:55,y:70, p:22, econ:2,  soc:-1, nat:0},
            {id:'MG', n:'Minas Gerais',   x:60,y:55, p:18, econ:0,  soc:0,  nat:0},
            {id:'RJ', n:'Rio de Janeiro', x:70,y:68, p:13, econ:0,  soc:1,  nat:0},
            {id:'RS', n:'Rio G. do Sul',  x:50,y:88, p:9,  econ:0,  soc:-1, nat:1},
            {id:'BA', n:'Bahia',          x:78,y:48, p:10, econ:-1, soc:0,  nat:0},
            {id:'PE', n:'Pernambuco',     x:88,y:33, p:7,  econ:-1, soc:1,  nat:0},
            {id:'CE', n:'Cear√°',          x:82,y:22, p:5,  econ:-1, soc:1,  nat:0},
            {id:'AM', n:'Amazonas/Norte', x:20,y:20, p:4,  econ:-1, soc:0,  nat:1},
            {id:'PR', n:'Paran√°',         x:50,y:75, p:4,  econ:1,  soc:-1, nat:0},
            {id:'SC', n:'S. Catarina',    x:52,y:82, p:3,  econ:1,  soc:-1, nat:0},
            {id:'OUTROS',n:'Demais Estados',x:30,y:35,p:5, econ:-1, soc:0,  nat:1}
        ]
    },
    "RV1910": {
        title:"Elei√ß√µes 1910", year:"1910", emoji:"‚öîÔ∏è",
        desc:"Hermes da Fonseca vs Rui Barbosa ‚Äî a Campanha Civilista.",
        available:true, noSecondRound:true, isRepVelha:true,
        newsHeader:"Correio da Manh√£ ‚Äî MAR√áO 1910",
        endYear:"1910",
        partyPoolOverride:[{n:"PRC",side:"D",owner:null},{n:"PRP",side:"D",owner:null}],
        candidates:{
            hermes10: {name:"HERMES",      party:"PRC", start:57, money:45, side:"D", color:"#004488", econ:0, soc:-1,nat:2, bio:"Marechal Hermes da Fonseca. Apoiado pelas oligarquias ga√∫cha e nordestinas, venceu com 57%. Candidato militar-conservador contra o civilismo de Rui.", ideologia:"Militarismo Republicano"},
            rui10:    {name:"RUI BARBOSA", party:"PRP", start:42, money:40, side:"D", color:"#cc6600", econ:2, soc:0, nat:-1,bio:"Rui Barbosa, jurista e parlamentar baiano. Candidato da 'Campanha Civilista' em defesa do governo civil e do liberalismo. A mais vibrante campanha da Rep√∫blica Velha.", ideologia:"Liberalismo Civilista"}
        },
        regions:[
            {id:'SP', n:'S√£o Paulo',     x:55,y:70, p:21, econ:2,  soc:-1, nat:0},
            {id:'MG', n:'Minas Gerais',   x:60,y:55, p:17, econ:0,  soc:0,  nat:0},
            {id:'RJ', n:'Rio de Janeiro', x:70,y:68, p:12, econ:0,  soc:1,  nat:0},
            {id:'RS', n:'Rio G. do Sul',  x:50,y:88, p:9,  econ:0,  soc:-1, nat:2},
            {id:'BA', n:'Bahia',          x:78,y:48, p:10, econ:-1, soc:1,  nat:0},
            {id:'PE', n:'Pernambuco',     x:88,y:33, p:7,  econ:-1, soc:1,  nat:0},
            {id:'CE', n:'Cear√°',          x:82,y:22, p:5,  econ:-1, soc:1,  nat:0},
            {id:'NE', n:'Nordeste (demais)',x:85,y:30,p:8, econ:-2, soc:1,  nat:1},
            {id:'AM', n:'Amazonas/Norte', x:20,y:20, p:4,  econ:-1, soc:0,  nat:1},
            {id:'PR', n:'Paran√°/Sul',     x:50,y:78, p:4,  econ:1,  soc:-1, nat:0},
            {id:'OUTROS',n:'Demais',      x:30,y:35, p:3,  econ:-1, soc:0,  nat:1}
        ]
    },
    "RV1914": {
        title:"Elei√ß√µes 1914", year:"1914", emoji:"üìú",
        desc:"Venceslau Br√°s vs Rui Barbosa. A Grande Guerra come√ßa.",
        available:true, noSecondRound:true, isRepVelha:true,
        newsHeader:"Gazeta de Not√≠cias ‚Äî MAR√áO 1914",
        endYear:"1914",
        partyPoolOverride:[{n:"PRM",side:"D",owner:null},{n:"PRL",side:"D",owner:null}],
        candidates:{
            venceslau: {name:"VENCESLAU BR√ÅS",party:"PRM", start:91, money:50, side:"D", color:"#004488", econ:0, soc:0, nat:0, bio:"Venceslau Br√°s, mineiro. Venceu com esmagadora maioria, fruto do acordo olig√°rquico. Seu governo enfrentou os anos da Primeira Guerra Mundial.", ideologia:"Oligarquismo Mineiro"},
            rui14:     {name:"RUI BARBOSA",  party:"PRL", start:8,  money:35, side:"D", color:"#cc6600", econ:2, soc:0, nat:-1,bio:"Rui Barbosa, na sua terceira candidatura presidencial. Representava o Partido Republicano Liberal, continuando sua bandeira civilista e liberal.", ideologia:"Liberalismo Civilista"}
        },
        regions:[
            {id:'SP', n:'S√£o Paulo',     x:55,y:70, p:21, econ:2,  soc:-1, nat:0},
            {id:'MG', n:'Minas Gerais',   x:60,y:55, p:17, econ:0,  soc:0,  nat:0},
            {id:'RJ', n:'Rio de Janeiro', x:70,y:68, p:12, econ:0,  soc:1,  nat:0},
            {id:'RS', n:'Rio G. do Sul',  x:50,y:88, p:9,  econ:0,  soc:-1, nat:1},
            {id:'BA', n:'Bahia',          x:78,y:48, p:10, econ:-1, soc:0,  nat:0},
            {id:'PE', n:'Pernambuco',     x:88,y:33, p:6,  econ:-1, soc:1,  nat:0},
            {id:'CE', n:'Cear√°',          x:82,y:22, p:5,  econ:-1, soc:1,  nat:0},
            {id:'NE', n:'Nordeste (demais)',x:85,y:30,p:7, econ:-2, soc:1,  nat:1},
            {id:'AM', n:'Amazonas/Norte', x:20,y:20, p:5,  econ:-1, soc:0,  nat:1},
            {id:'PR', n:'Paran√°/Sul',     x:50,y:78, p:5,  econ:1,  soc:-1, nat:0},
            {id:'OUTROS',n:'Demais',      x:30,y:35, p:3,  econ:-1, soc:0,  nat:1}
        ]
    },
    "RV1918": {
        title:"Elei√ß√µes 1918", year:"1918", emoji:"üåê",
        desc:"Rodrigues Alves vs Nilo Pe√ßanha. Gripe espanhola muda tudo.",
        available:true, noSecondRound:true, isRepVelha:true,
        newsHeader:"O Pa√≠s ‚Äî MAR√áO 1918",
        endYear:"1918",
        partyPoolOverride:[{n:"PRP",side:"D",owner:null},{n:"PRF",side:"D",owner:null}],
        candidates:{
            rodrigues18:{name:"RODRIGUES ALVES",party:"PRP", start:99, money:50, side:"D", color:"#cc6600", econ:2, soc:-1, nat:0, bio:"Rodrigues Alves, paulista, eleito pela segunda vez. Morreu antes de tomar posse, v√≠tima da gripe espanhola em 1919 ‚Äî a maior pandemia do s√©culo XX. Delfim Moreira assumiu interinamente.", ideologia:"Liberalismo Olig√°rquico"},
            nilo18:     {name:"NILO PE√áANHA",  party:"PRF", start:0.5,money:15, side:"D", color:"#004488", econ:-1,soc:1, nat:1, bio:"Nilo Pe√ßanha, fluminense. Oposi√ß√£o quase inexistente nessa elei√ß√£o ‚Äî Rodrigues Alves venceu com quase 99% dos votos computados.", ideologia:"Republicanismo Federal"}
        },
        regions:[
            {id:'SP', n:'S√£o Paulo',     x:55,y:70, p:21, econ:2,  soc:-1, nat:0},
            {id:'MG', n:'Minas Gerais',   x:60,y:55, p:17, econ:0,  soc:0,  nat:0},
            {id:'RJ', n:'Rio de Janeiro', x:70,y:68, p:12, econ:0,  soc:1,  nat:0},
            {id:'RS', n:'Rio G. do Sul',  x:50,y:88, p:9,  econ:0,  soc:-1, nat:1},
            {id:'BA', n:'Bahia',          x:78,y:48, p:10, econ:-1, soc:0,  nat:0},
            {id:'PE', n:'Pernambuco',     x:88,y:33, p:6,  econ:-1, soc:1,  nat:0},
            {id:'CE', n:'Cear√°',          x:82,y:22, p:5,  econ:-1, soc:1,  nat:0},
            {id:'NE', n:'Nordeste (demais)',x:85,y:30,p:7, econ:-2, soc:1,  nat:1},
            {id:'AM', n:'Amazonas/Norte', x:20,y:20, p:5,  econ:-1, soc:0,  nat:1},
            {id:'PR', n:'Paran√°/Sul',     x:50,y:78, p:5,  econ:1,  soc:-1, nat:0},
            {id:'OUTROS',n:'Demais',      x:30,y:35, p:3,  econ:-1, soc:0,  nat:1}
        ]
    },
    "RV1919": {
        title:"Elei√ß√µes 1919", year:"1919", emoji:"üåø",
        desc:"Epit√°cio Pessoa vs Rui Barbosa. O velho liberal tenta pela √∫ltima vez.",
        available:true, noSecondRound:true, isRepVelha:true,
        newsHeader:"Correio da Manh√£ ‚Äî ABRIL 1919",
        endYear:"1919",
        partyPoolOverride:[{n:"PRM",side:"D",owner:null},{n:"PRP",side:"D",owner:null}],
        candidates:{
            epitacio19:{name:"EPIT√ÅCIO PESSOA",party:"PRM", start:73, money:50, side:"D", color:"#004488", econ:0, soc:0, nat:0, bio:"Epit√°cio Pessoa, paraibano. Eleito com 73% numa elei√ß√£o suplementar ap√≥s a morte de Rodrigues Alves. Chefiou a delega√ß√£o brasileira em Versalhes.", ideologia:"Oligarquismo Nordestino"},
            rui19:     {name:"RUI BARBOSA",    party:"PRP", start:26, money:40, side:"D", color:"#cc6600", econ:2, soc:0, nat:-1,bio:"Rui Barbosa, na sua √∫ltima candidatura presidencial. Com 69 anos, ainda mobilizava multid√µes com seu liberalismo refinado. Perdeu, mas com vota√ß√£o digna.", ideologia:"Liberalismo Civilista"}
        },
        regions:[
            {id:'SP', n:'S√£o Paulo',     x:55,y:70, p:22, econ:2,  soc:-1, nat:0},
            {id:'MG', n:'Minas Gerais',   x:60,y:55, p:17, econ:0,  soc:0,  nat:0},
            {id:'RJ', n:'Rio de Janeiro', x:70,y:68, p:12, econ:0,  soc:1,  nat:0},
            {id:'RS', n:'Rio G. do Sul',  x:50,y:88, p:9,  econ:0,  soc:-1, nat:1},
            {id:'BA', n:'Bahia',          x:78,y:48, p:8,  econ:-1, soc:0,  nat:0},
            {id:'PE', n:'Pernambuco',     x:88,y:33, p:7,  econ:-1, soc:1,  nat:0},
            {id:'CE', n:'Cear√°',          x:82,y:22, p:5,  econ:-1, soc:1,  nat:0},
            {id:'NE', n:'Nordeste (demais)',x:85,y:30,p:8, econ:-2, soc:1,  nat:1},
            {id:'AM', n:'Amazonas/Norte', x:20,y:20, p:4,  econ:-1, soc:0,  nat:1},
            {id:'PR', n:'Paran√°/Sul',     x:50,y:78, p:5,  econ:1,  soc:-1, nat:0},
            {id:'OUTROS',n:'Demais',      x:30,y:35, p:3,  econ:-1, soc:0,  nat:1}
        ]
    },
    "RV1922": {
        title:"Elei√ß√µes 1922", year:"1922", emoji:"üéñÔ∏è",
        desc:"Artur Bernardes vs Nilo Pe√ßanha. Rea√ß√£o Republicana e tenentismo.",
        available:true, noSecondRound:true, isRepVelha:true,
        newsHeader:"A Noite ‚Äî MAR√áO 1922",
        endYear:"1922",
        partyPoolOverride:[{n:"PRM",side:"D",owner:null},{n:"PRF",side:"D",owner:null}],
        candidates:{
            bernardes: {name:"ARTUR BERNARDES",party:"PRM", start:56, money:50, side:"D", color:"#cc6600", econ:0, soc:-1, nat:0, bio:"Artur Bernardes, mineiro. Eleito com 56%, mas sua elei√ß√£o foi contestada. Governou em estado de s√≠tio quase permanente diante do Tenentismo de 1922 e 1924.", ideologia:"Oligarquismo Mineiro"},
            nilo22:    {name:"NILO PE√áANHA",   party:"PRF", start:42, money:35, side:"D", color:"#004488", econ:-1,soc:1, nat:1, bio:"Nilo Pe√ßanha, candidato da Rea√ß√£o Republicana ‚Äî coliga√ß√£o de dissidentes que questionou o dom√≠nio SP-MG e a fraude eleitoral. Representava RS, BA, RJ e PE.", ideologia:"Republicanismo Dissidente"}
        },
        regions:[
            {id:'SP', n:'S√£o Paulo',     x:55,y:70, p:21, econ:2,  soc:-1, nat:0},
            {id:'MG', n:'Minas Gerais',  x:60,y:55, p:16, econ:0,  soc:0,  nat:0},
            {id:'RJ', n:'Rio de Janeiro',x:70,y:68, p:11, econ:0,  soc:1,  nat:0},
            {id:'RS', n:'Rio G. do Sul', x:50,y:88, p:9,  econ:0,  soc:-1, nat:1},
            {id:'BA', n:'Bahia',         x:78,y:48, p:8,  econ:-1, soc:0,  nat:0},
            {id:'PE', n:'Pernambuco',    x:88,y:33, p:7,  econ:-1, soc:1,  nat:0},
            {id:'CE', n:'Cear√°',         x:82,y:22, p:5,  econ:-1, soc:1,  nat:0},
            {id:'NE', n:'Nordeste (demais)',x:85,y:30,p:8,econ:-2, soc:1,  nat:1},
            {id:'AM', n:'Amazonas/Norte',x:20,y:20, p:5,  econ:-1, soc:0,  nat:1},
            {id:'PR', n:'Paran√°/Sul',    x:50,y:78, p:5,  econ:1,  soc:-1, nat:0},
            {id:'OUTROS',n:'Demais',     x:30,y:35, p:5,  econ:-1, soc:0,  nat:1}
        ]
    },
    "RV1926": {
        title:"Elei√ß√µes 1926", year:"1926", emoji:"üèõÔ∏è",
        desc:"Washington Lu√≠s vs Assis Brasil. Os √∫ltimos anos do caf√©-com-leite.",
        available:true, noSecondRound:true, isRepVelha:true,
        newsHeader:"Correio da Manh√£ ‚Äî MAR√áO 1926",
        endYear:"1926",
        partyPoolOverride:[{n:"PRP",side:"D",owner:null},{n:"PL",side:"D",owner:null}],
        candidates:{
            washington:{name:"WASHINGTON LU√çS",party:"PRP", start:98, money:55, side:"D", color:"#cc6600", econ:2, soc:-1, nat:0, bio:"Washington Lu√≠s, paulista. Eleito com 98% num pleito sem oposi√ß√£o efetiva. Seria o √∫ltimo presidente da Rep√∫blica Velha ‚Äî deposto pela Revolu√ß√£o de 1930 antes do fim do mandato.", ideologia:"Oligarquismo Paulista"},
            assis:     {name:"ASSIS BRASIL",    party:"PL",  start:1.5,money:20, side:"D", color:"#004488", econ:0, soc:1, nat:1, bio:"Joaquim Francisco de Assis Brasil, ga√∫cho. Fundador do Partido Libertador, lutou por voto secreto e representa√ß√£o proporcional. Candidatura quase simb√≥lica.", ideologia:"Republicanismo Liberal"}
        },
        regions:[
            {id:'SP', n:'S√£o Paulo',     x:55,y:70, p:21, econ:2,  soc:-1, nat:0},
            {id:'MG', n:'Minas Gerais',   x:60,y:55, p:17, econ:0,  soc:0,  nat:0},
            {id:'RJ', n:'Rio de Janeiro', x:70,y:68, p:12, econ:0,  soc:1,  nat:0},
            {id:'RS', n:'Rio G. do Sul',  x:50,y:88, p:9,  econ:0,  soc:-1, nat:1},
            {id:'BA', n:'Bahia',          x:78,y:48, p:10, econ:-1, soc:0,  nat:0},
            {id:'PE', n:'Pernambuco',     x:88,y:33, p:6,  econ:-1, soc:1,  nat:0},
            {id:'CE', n:'Cear√°',          x:82,y:22, p:5,  econ:-1, soc:1,  nat:0},
            {id:'NE', n:'Nordeste (demais)',x:85,y:30,p:7, econ:-2, soc:1,  nat:1},
            {id:'AM', n:'Amazonas/Norte', x:20,y:20, p:5,  econ:-1, soc:0,  nat:1},
            {id:'PR', n:'Paran√°/Sul',     x:50,y:78, p:5,  econ:1,  soc:-1, nat:0},
            {id:'OUTROS',n:'Demais',      x:30,y:35, p:3,  econ:-1, soc:0,  nat:1}
        ]
    },
    "RV1930": {
        title:"Elei√ß√µes 1930", year:"1930", emoji:"üî´",
        desc:"J√∫lio Prestes vs Get√∫lio Vargas ‚Äî a √∫ltima da Velha Rep√∫blica.",
        available:true, noSecondRound:true, isRepVelha:true,
        newsHeader:"Correio da Manh√£ ‚Äî MAR√áO 1930",
        endYear:"1930",
        partyPoolOverride:[{n:"PRP",side:"D",owner:null},{n:"AL",side:"D",owner:null}],
        candidates:{
            prestes30:{name:"J√öLIO PRESTES",party:"PRP", start:57, money:55, side:"D", color:"#004488", econ:1, soc:-1,nat:0, bio:"J√∫lio Prestes, governador de SP. Venceu oficialmente as elei√ß√µes com 57%, mas nunca tomou posse: a Revolu√ß√£o de 1930 de Get√∫lio Vargas impediu sua chegada ao poder.", ideologia:"Oligarquismo Paulista"},
            getulio:  {name:"GET√öLIO VARGAS",party:"AL",  start:42, money:40, side:"D", color:"#cc0000", econ:-1, soc:1, nat:2, bio:"Get√∫lio Vargas, governador ga√∫cho e candidato da Alian√ßa Liberal. Perdeu as elei√ß√µes oficialmente, mas liderou a Revolu√ß√£o de 1930 que o levou ao poder, encerrando a Rep√∫blica Velha.", ideologia:"Trabalhismo Nascente"}
        },
        regions:[
            {id:'SP',   n:'S√£o Paulo',     x:55,y:70, p:22, econ:2,  soc:-1, nat:0},
            {id:'MG',   n:'Minas Gerais',  x:60,y:55, p:18, econ:0,  soc:0,  nat:0},
            {id:'RJ',   n:'Rio de Janeiro',x:70,y:68, p:12, econ:0,  soc:1,  nat:0},
            {id:'RS',   n:'Rio G. do Sul', x:50,y:88, p:10, econ:-1, soc:1,  nat:2},
            {id:'BA',   n:'Bahia',         x:78,y:48, p:10, econ:-1, soc:0,  nat:0},
            {id:'PE',   n:'Pernambuco',    x:88,y:33, p:7,  econ:-2, soc:1,  nat:0},
            {id:'CE',   n:'Cear√°',         x:82,y:22, p:5,  econ:-2, soc:1,  nat:0},
            {id:'PB',   n:'Para√≠ba',       x:90,y:28, p:4,  econ:-2, soc:1,  nat:0},
            {id:'PR',   n:'Paran√°',        x:50,y:75, p:4,  econ:1,  soc:-1, nat:1},
            {id:'OUTROS',n:'Demais Estados',x:30,y:35,p:8,  econ:-1, soc:0,  nat:1}
        ]
    },
};

// ============================================================
// REP√öBLICA VELHA ‚Äî Elei√ß√µes 1894‚Äì1930
// ============================================================
// Rep√∫blica Velha agora est√° integrada ao scenariosData como elei√ß√µes presidenciais BR normais (ver abaixo)
// Este objeto vazio mantido por compatibilidade com c√≥digo legado
const repvelhaData = {};

// ============================================================
// ELEI√á√ïES INTERNACIONAIS ‚Äî EUA 2024
// ============================================================
const internationalData = {
    "USA2000": {
        title:"U.S. Presidential Election 2000", year:"2000", emoji:"üá∫üá∏",
        country:"usa",
        desc:"Bush vs Gore ‚Äî The closest election in American history. Florida hangs in the balance.",
        available:true,
        isElectoralCollege:true,
        newsHeader:"The New York Times ‚Äî NOVEMBER 2000",
        endYear:"2000",
        partyPoolOverride:[{n:"GREEN",side:"E",owner:null},{n:"REFORM",side:"C",owner:null}],
        candidates:{
            bush00:  {name:"BUSH",    party:"GOP",    start:48, money:70, side:"D", color:"#cc0000", econ:1, soc:-1, nat:1, bio:"George W. Bush, Governor of Texas and son of President George H.W. Bush. Won the presidency in a historic contested election decided by the Supreme Court after a Florida recount controversy. Won 271 electoral votes.", ideologia:"Compassionate Conservatism / Republican", traits:["Bush Dynasty","Texas Governor"], negativeTraits:["Perceived as less experienced","Son of ex-President"]},
            gore00:  {name:"GORE",    party:"DEM",    start:48, money:65, side:"E", color:"#003399", econ:0, soc:1, nat:-1, bio:"Al Gore, Vice-President under Clinton. Won the popular vote by over 500,000 but lost the Electoral College 266-271 after Florida's 25 electoral votes were awarded to Bush by a 5-4 Supreme Court decision.", ideologia:"Moderate Liberalism / New Democrat", traits:["Clinton Legacy","Environmental Champion"], negativeTraits:["Wooden Communicator","Florida Recount Crisis"]},
            nader00: {name:"NADER",   party:"GREEN",  start:3,  money:10, side:"E", color:"#00aa00", econ:-2,soc:2, nat:-1,bio:"Ralph Nader, consumer rights activist. His 97,000 votes in Florida ‚Äî where Bush won by 537 ‚Äî are blamed by Democrats for costing Gore the election.", ideologia:"Green / Progressive", traits:["Moral Authority","Environmental"], negativeTraits:["Spoiler effect","No path to win"]},
            buchanan:{name:"BUCHANAN",party:"REFORM",  start:1, money:8,  side:"D", color:"#884400", econ:0, soc:-2, nat:2, bio:"Pat Buchanan, former Nixon aide and conservative commentator. Gained Reform Party ballot access. His 17,000 votes in Palm Beach (due to the 'butterfly ballot') may have cost Gore votes.", ideologia:"Paleoconservatism / Nationalist"}
        },
        electoralStates:[
            {id:'AL', n:'Alabama',     x:72,y:52, ev:9,  lean:'R', econ:0, soc:-2, nat:1},{id:'AK', n:'Alaska',      x:5, y:10, ev:3,  lean:'R', econ:0, soc:-1, nat:2},
            {id:'AZ', n:'Arizona',     x:15,y:45, ev:8,  lean:'R', econ:1, soc:0,  nat:1},{id:'AR', n:'Arkansas',    x:62,y:48, ev:6,  lean:'R', econ:-1,soc:-2, nat:1},
            {id:'CA', n:'California',  x:5, y:38, ev:54, lean:'D', econ:2, soc:2,  nat:-1},{id:'CO', n:'Colorado',    x:25,y:38, ev:8,  lean:'R', econ:1, soc:1,  nat:0},
            {id:'CT', n:'Connecticut', x:90,y:28, ev:8,  lean:'D', econ:2, soc:2,  nat:-1},{id:'DE', n:'Delaware',    x:88,y:35, ev:3,  lean:'D', econ:1, soc:1,  nat:0},
            {id:'FL', n:'Florida üî•',  x:78,y:65, ev:25, lean:'S', econ:1, soc:-1, nat:1},{id:'GA', n:'Georgia',     x:76,y:55, ev:13, lean:'R', econ:1, soc:-1, nat:0},
            {id:'HI', n:'Hawaii',      x:2, y:75, ev:4,  lean:'D', econ:0, soc:2,  nat:0},{id:'ID', n:'Idaho',       x:15,y:25, ev:4,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'IL', n:'Illinois',    x:65,y:35, ev:22, lean:'D', econ:1, soc:1,  nat:0},{id:'IN', n:'Indiana',     x:70,y:38, ev:12, lean:'R', econ:0, soc:-1, nat:1},
            {id:'IA', n:'Iowa',        x:60,y:32, ev:7,  lean:'S', econ:0, soc:-1, nat:1},{id:'KS', n:'Kansas',      x:50,y:42, ev:6,  lean:'R', econ:0, soc:-1, nat:1},
            {id:'KY', n:'Kentucky',    x:72,y:42, ev:8,  lean:'R', econ:-1,soc:-2, nat:1},{id:'LA', n:'Louisiana',   x:62,y:60, ev:9,  lean:'R', econ:-1,soc:-1, nat:1},
            {id:'ME', n:'Maine',       x:92,y:15, ev:4,  lean:'D', econ:0, soc:1,  nat:0},{id:'MD', n:'Maryland',    x:85,y:38, ev:10, lean:'D', econ:1, soc:2,  nat:-1},
            {id:'MA', n:'Massachusetts',x:92,y:28,ev:12, lean:'D', econ:2, soc:2,  nat:-1},{id:'MI', n:'Michigan',    x:70,y:28, ev:18, lean:'S', econ:0, soc:0,  nat:0},
            {id:'MN', n:'Minnesota',   x:58,y:22, ev:10, lean:'D', econ:0, soc:1,  nat:0},{id:'MS', n:'Mississippi', x:68,y:58, ev:7,  lean:'R', econ:-1,soc:-2, nat:1},
            {id:'MO', n:'Missouri',    x:60,y:42, ev:11, lean:'S', econ:0, soc:-1, nat:1},{id:'MT', n:'Montana',     x:22,y:20, ev:3,  lean:'R', econ:0, soc:-1, nat:2},
            {id:'NE', n:'Nebraska',    x:48,y:35, ev:5,  lean:'R', econ:0, soc:-1, nat:1},{id:'NV', n:'Nevada',      x:10,y:38, ev:4,  lean:'S', econ:0, soc:1,  nat:0},
            {id:'NH', n:'New Hampshire',x:90,y:22,ev:4,  lean:'S', econ:1, soc:1,  nat:0},{id:'NJ', n:'New Jersey',  x:87,y:33, ev:15, lean:'D', econ:2, soc:1,  nat:-1},
            {id:'NM', n:'New Mexico',  x:25,y:52, ev:5,  lean:'S', econ:-1,soc:1,  nat:0},{id:'NY', n:'New York',    x:88,y:30, ev:33, lean:'D', econ:2, soc:2,  nat:-1},
            {id:'NC', n:'N. Carolina', x:80,y:48, ev:14, lean:'R', econ:1, soc:-1, nat:0},{id:'ND', n:'N. Dakota',   x:45,y:18, ev:3,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'OH', n:'Ohio',        x:75,y:36, ev:21, lean:'S', econ:0, soc:-1, nat:1},{id:'OK', n:'Oklahoma',    x:50,y:52, ev:8,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'OR', n:'Oregon',      x:7, y:25, ev:7,  lean:'D', econ:1, soc:2,  nat:0},{id:'PA', n:'Pennsylvania',x:83,y:32, ev:23, lean:'S', econ:0, soc:0,  nat:0},
            {id:'RI', n:'Rhode Island',x:92,y:30, ev:4,  lean:'D', econ:1, soc:2,  nat:-1},{id:'SC', n:'S. Carolina', x:78,y:52, ev:8,  lean:'R', econ:0, soc:-2, nat:1},
            {id:'SD', n:'S. Dakota',   x:45,y:25, ev:3,  lean:'R', econ:0, soc:-2, nat:2},{id:'TN', n:'Tennessee',   x:70,y:48, ev:11, lean:'R', econ:0, soc:-2, nat:1},
            {id:'TX', n:'Texas',       x:45,y:60, ev:32, lean:'R', econ:2, soc:-1, nat:2},{id:'UT', n:'Utah',        x:20,y:40, ev:5,  lean:'R', econ:1, soc:-1, nat:1},
            {id:'VT', n:'Vermont',     x:90,y:20, ev:3,  lean:'D', econ:0, soc:2,  nat:0},{id:'VA', n:'Virginia',    x:83,y:42, ev:13, lean:'R', econ:1, soc:1,  nat:0},
            {id:'WA', n:'Washington',  x:8, y:18, ev:11, lean:'D', econ:2, soc:2,  nat:0},{id:'WV', n:'W. Virginia', x:78,y:40, ev:5,  lean:'S', econ:-2,soc:-2, nat:1},
            {id:'WI', n:'Wisconsin',   x:63,y:28, ev:11, lean:'D', econ:0, soc:0,  nat:0},{id:'WY', n:'Wyoming',     x:28,y:30, ev:3,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'DC', n:'D.C.',        x:84,y:39, ev:3,  lean:'D', econ:2, soc:2,  nat:-2}
        ]
    },
    "USA2004": {
        title:"U.S. Presidential Election 2004", year:"2004", emoji:"üá∫üá∏",
        country:"usa",
        desc:"Bush vs Kerry ‚Äî War on Terror dominates. Can Kerry unseat a wartime president?",
        available:true,
        isElectoralCollege:true,
        newsHeader:"The New York Times ‚Äî NOVEMBER 2004",
        endYear:"2004",
        partyPoolOverride:[{n:"LIBERTARIAN",side:"C",owner:null}],
        candidates:{
            bush04:  {name:"BUSH",    party:"GOP",    start:51, money:75, side:"D", color:"#cc0000", econ:1, soc:-1, nat:2, bio:"George W. Bush, incumbent president navigating post-9/11 America and the Iraq War. Won re-election 286-251 electoral votes, carrying Ohio by 2 points. His 'wartime president' status and Karl Rove's ground game proved decisive.", ideologia:"Compassionate Conservatism / War on Terror", traits:["Wartime Commander-in-Chief","Strong Evangelical Base","Swift Boat Veterans controversy deflected"], negativeTraits:["Iraq War Unpopularity","No WMDs Found","Abu Ghraib Scandal"]},
            kerry:   {name:"KERRY",   party:"DEM",    start:48, money:68, side:"E", color:"#003399", econ:-1,soc:2, nat:-1, bio:"John Kerry, Vietnam War veteran and Massachusetts Senator. 'Swiftboated' by Republican attacks on his military record. Lost Ohio by 118,601 votes ‚Äî the decisive state ‚Äî in a race decided 251-286.", ideologia:"Liberal Democrat / Anti-War Hawk", traits:["Vietnam Hero","Debate Performer"], negativeTraits:["Swift Boat Attacks","Flip-Flopper Label","'I voted for it before I voted against it'"]},
            nader04: {name:"NADER",   party:"IND",    start:1,  money:5,  side:"E", color:"#00aa00", econ:-2,soc:2, nat:-1,bio:"Ralph Nader running as independent. Less impact than 2000 ‚Äî got 0.38% nationally.", ideologia:"Progressive Independent"},
            badnarik:{name:"BADNARIK",party:"LIB",    start:0,  money:3,  side:"C", color:"#ffaa00", econ:2, soc:2, nat:-2,bio:"Michael Badnarik, Libertarian candidate. Constitutional law instructor. Got 0.32%.", ideologia:"Libertarianism"}
        },
        electoralStates:[
            {id:'AL', n:'Alabama',     x:72,y:52, ev:9,  lean:'R', econ:0, soc:-2, nat:1},{id:'AK', n:'Alaska',      x:5, y:10, ev:3,  lean:'R', econ:0, soc:-1, nat:2},
            {id:'AZ', n:'Arizona',     x:15,y:45, ev:10, lean:'R', econ:1, soc:0,  nat:1},{id:'AR', n:'Arkansas',    x:62,y:48, ev:6,  lean:'R', econ:-1,soc:-2, nat:1},
            {id:'CA', n:'California',  x:5, y:38, ev:55, lean:'D', econ:2, soc:2,  nat:-1},{id:'CO', n:'Colorado',    x:25,y:38, ev:9,  lean:'R', econ:1, soc:1,  nat:0},
            {id:'CT', n:'Connecticut', x:90,y:28, ev:7,  lean:'D', econ:2, soc:2,  nat:-1},{id:'DE', n:'Delaware',    x:88,y:35, ev:3,  lean:'D', econ:1, soc:1,  nat:0},
            {id:'FL', n:'Florida',     x:78,y:65, ev:27, lean:'R', econ:1, soc:-1, nat:1},{id:'GA', n:'Georgia',     x:76,y:55, ev:15, lean:'R', econ:1, soc:-1, nat:0},
            {id:'HI', n:'Hawaii',      x:2, y:75, ev:4,  lean:'D', econ:0, soc:2,  nat:0},{id:'ID', n:'Idaho',       x:15,y:25, ev:4,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'IL', n:'Illinois',    x:65,y:35, ev:21, lean:'D', econ:1, soc:1,  nat:0},{id:'IN', n:'Indiana',     x:70,y:38, ev:11, lean:'R', econ:0, soc:-1, nat:1},
            {id:'IA', n:'Iowa',        x:60,y:32, ev:7,  lean:'S', econ:0, soc:-1, nat:1},{id:'KS', n:'Kansas',      x:50,y:42, ev:6,  lean:'R', econ:0, soc:-1, nat:1},
            {id:'KY', n:'Kentucky',    x:72,y:42, ev:8,  lean:'R', econ:-1,soc:-2, nat:1},{id:'LA', n:'Louisiana',   x:62,y:60, ev:9,  lean:'R', econ:-1,soc:-1, nat:1},
            {id:'ME', n:'Maine',       x:92,y:15, ev:4,  lean:'D', econ:0, soc:1,  nat:0},{id:'MD', n:'Maryland',    x:85,y:38, ev:10, lean:'D', econ:1, soc:2,  nat:-1},
            {id:'MA', n:'Massachusetts',x:92,y:28,ev:12, lean:'D', econ:2, soc:2,  nat:-1},{id:'MI', n:'Michigan',    x:70,y:28, ev:17, lean:'D', econ:0, soc:0,  nat:0},
            {id:'MN', n:'Minnesota',   x:58,y:22, ev:10, lean:'D', econ:0, soc:1,  nat:0},{id:'MS', n:'Mississippi', x:68,y:58, ev:6,  lean:'R', econ:-1,soc:-2, nat:1},
            {id:'MO', n:'Missouri',    x:60,y:42, ev:11, lean:'R', econ:0, soc:-1, nat:1},{id:'MT', n:'Montana',     x:22,y:20, ev:3,  lean:'R', econ:0, soc:-1, nat:2},
            {id:'NE', n:'Nebraska',    x:48,y:35, ev:5,  lean:'R', econ:0, soc:-1, nat:1},{id:'NV', n:'Nevada',      x:10,y:38, ev:5,  lean:'R', econ:0, soc:1,  nat:0},
            {id:'NH', n:'New Hampshire',x:90,y:22,ev:4,  lean:'S', econ:1, soc:1,  nat:0},{id:'NJ', n:'New Jersey',  x:87,y:33, ev:15, lean:'D', econ:2, soc:1,  nat:-1},
            {id:'NM', n:'New Mexico',  x:25,y:52, ev:5,  lean:'S', econ:-1,soc:1,  nat:0},{id:'NY', n:'New York',    x:88,y:30, ev:31, lean:'D', econ:2, soc:2,  nat:-1},
            {id:'NC', n:'N. Carolina', x:80,y:48, ev:15, lean:'R', econ:1, soc:-1, nat:0},{id:'ND', n:'N. Dakota',   x:45,y:18, ev:3,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'OH', n:'Ohio üî•',     x:75,y:36, ev:20, lean:'S', econ:0, soc:-1, nat:1},{id:'OK', n:'Oklahoma',    x:50,y:52, ev:7,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'OR', n:'Oregon',      x:7, y:25, ev:7,  lean:'D', econ:1, soc:2,  nat:0},{id:'PA', n:'Pennsylvania',x:83,y:32, ev:21, lean:'S', econ:0, soc:0,  nat:0},
            {id:'RI', n:'Rhode Island',x:92,y:30, ev:4,  lean:'D', econ:1, soc:2,  nat:-1},{id:'SC', n:'S. Carolina', x:78,y:52, ev:8,  lean:'R', econ:0, soc:-2, nat:1},
            {id:'SD', n:'S. Dakota',   x:45,y:25, ev:3,  lean:'R', econ:0, soc:-2, nat:2},{id:'TN', n:'Tennessee',   x:70,y:48, ev:11, lean:'R', econ:0, soc:-2, nat:1},
            {id:'TX', n:'Texas',       x:45,y:60, ev:34, lean:'R', econ:2, soc:-1, nat:2},{id:'UT', n:'Utah',        x:20,y:40, ev:5,  lean:'R', econ:1, soc:-1, nat:1},
            {id:'VT', n:'Vermont',     x:90,y:20, ev:3,  lean:'D', econ:0, soc:2,  nat:0},{id:'VA', n:'Virginia',    x:83,y:42, ev:13, lean:'R', econ:1, soc:1,  nat:0},
            {id:'WA', n:'Washington',  x:8, y:18, ev:11, lean:'D', econ:2, soc:2,  nat:0},{id:'WV', n:'W. Virginia', x:78,y:40, ev:5,  lean:'R', econ:-2,soc:-2, nat:1},
            {id:'WI', n:'Wisconsin',   x:63,y:28, ev:10, lean:'S', econ:0, soc:0,  nat:0},{id:'WY', n:'Wyoming',     x:28,y:30, ev:3,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'DC', n:'D.C.',        x:84,y:39, ev:3,  lean:'D', econ:2, soc:2,  nat:-2}
        ]
    },
    "USA2008": {
        title:"U.S. Presidential Election 2008", year:"2008", emoji:"üá∫üá∏",
        country:"usa",
        desc:"Obama's historic 'Yes We Can' campaign vs McCain. Financial crisis reshapes the race.",
        available:true,
        isElectoralCollege:true,
        newsHeader:"The New York Times ‚Äî NOVEMBER 2008",
        endYear:"2008",
        partyPoolOverride:[{n:"LIBERTARIAN",side:"C",owner:null}],
        candidates:{
            obama08: {name:"OBAMA",   party:"DEM",    start:53, money:80, side:"E", color:"#003399", econ:-1,soc:2, nat:-1, bio:"Barack Obama, Illinois Senator, became the first African-American president. 'Yes We Can' slogan energized youth and minorities. Won 365 electoral votes in a historic landslide, carrying states like Indiana and North Carolina that hadn't voted Democratic in decades.", ideologia:"Liberal Democrat / Hope and Change", traits:["Historic First","Inspirational Orator","Youth Mobilization","Financial Crisis Timing"], negativeTraits:["Inexperience Attacks","'Palling with Terrorists' Smear"]},
            mccain:  {name:"McCAIN",  party:"GOP",    start:46, money:65, side:"D", color:"#cc0000", econ:1, soc:-1, nat:2, bio:"John McCain, Vietnam War hero and Arizona Senator. Chose Sarah Palin as running mate in a gamble that energized the base but worried moderates. Lost 173-365, hurt by Bush's unpopularity and the 2008 financial crisis.", ideologia:"Moderate Conservatism / War Hero", traits:["Military Hero","Maverick Reputation"], negativeTraits:["Palin VP Pick","Bush Legacy","Financial Crisis Blamed on GOP"]},
            nader08: {name:"NADER",   party:"IND",    start:1,  money:4,  side:"E", color:"#00aa00", econ:-2,soc:2, nat:-1,bio:"Ralph Nader, third consecutive presidential run.", ideologia:"Progressive Independent"},
            barr08:  {name:"BARR",    party:"LIB",    start:0,  money:5,  side:"C", color:"#ffaa00", econ:2, soc:2, nat:-2,bio:"Bob Barr, former Republican Congressman from Georgia, Libertarian nominee.", ideologia:"Libertarianism"}
        },
        electoralStates:[
            {id:'AL', n:'Alabama',     x:72,y:52, ev:9,  lean:'R', econ:0, soc:-2, nat:1},{id:'AK', n:'Alaska',      x:5, y:10, ev:3,  lean:'R', econ:0, soc:-1, nat:2},
            {id:'AZ', n:'Arizona',     x:15,y:45, ev:10, lean:'R', econ:1, soc:0,  nat:1},{id:'AR', n:'Arkansas',    x:62,y:48, ev:6,  lean:'R', econ:-1,soc:-2, nat:1},
            {id:'CA', n:'California',  x:5, y:38, ev:55, lean:'D', econ:2, soc:2,  nat:-1},{id:'CO', n:'Colorado',    x:25,y:38, ev:9,  lean:'S', econ:1, soc:1,  nat:0},
            {id:'CT', n:'Connecticut', x:90,y:28, ev:7,  lean:'D', econ:2, soc:2,  nat:-1},{id:'DE', n:'Delaware',    x:88,y:35, ev:3,  lean:'D', econ:1, soc:1,  nat:0},
            {id:'FL', n:'Florida',     x:78,y:65, ev:27, lean:'S', econ:1, soc:-1, nat:1},{id:'GA', n:'Georgia',     x:76,y:55, ev:15, lean:'R', econ:1, soc:-1, nat:0},
            {id:'HI', n:'Hawaii',      x:2, y:75, ev:4,  lean:'D', econ:0, soc:2,  nat:0},{id:'ID', n:'Idaho',       x:15,y:25, ev:4,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'IL', n:'Illinois',    x:65,y:35, ev:21, lean:'D', econ:1, soc:1,  nat:0},{id:'IN', n:'Indiana',     x:70,y:38, ev:11, lean:'S', econ:0, soc:-1, nat:1},
            {id:'IA', n:'Iowa',        x:60,y:32, ev:7,  lean:'S', econ:0, soc:-1, nat:1},{id:'KS', n:'Kansas',      x:50,y:42, ev:6,  lean:'R', econ:0, soc:-1, nat:1},
            {id:'KY', n:'Kentucky',    x:72,y:42, ev:8,  lean:'R', econ:-1,soc:-2, nat:1},{id:'LA', n:'Louisiana',   x:62,y:60, ev:9,  lean:'R', econ:-1,soc:-1, nat:1},
            {id:'ME', n:'Maine',       x:92,y:15, ev:4,  lean:'D', econ:0, soc:1,  nat:0},{id:'MD', n:'Maryland',    x:85,y:38, ev:10, lean:'D', econ:1, soc:2,  nat:-1},
            {id:'MA', n:'Massachusetts',x:92,y:28,ev:12, lean:'D', econ:2, soc:2,  nat:-1},{id:'MI', n:'Michigan',    x:70,y:28, ev:17, lean:'D', econ:0, soc:0,  nat:0},
            {id:'MN', n:'Minnesota',   x:58,y:22, ev:10, lean:'D', econ:0, soc:1,  nat:0},{id:'MS', n:'Mississippi', x:68,y:58, ev:6,  lean:'R', econ:-1,soc:-2, nat:1},
            {id:'MO', n:'Missouri',    x:60,y:42, ev:11, lean:'R', econ:0, soc:-1, nat:1},{id:'MT', n:'Montana',     x:22,y:20, ev:3,  lean:'R', econ:0, soc:-1, nat:2},
            {id:'NE', n:'Nebraska',    x:48,y:35, ev:5,  lean:'R', econ:0, soc:-1, nat:1},{id:'NV', n:'Nevada',      x:10,y:38, ev:5,  lean:'S', econ:0, soc:1,  nat:0},
            {id:'NH', n:'New Hampshire',x:90,y:22,ev:4,  lean:'D', econ:1, soc:1,  nat:0},{id:'NJ', n:'New Jersey',  x:87,y:33, ev:15, lean:'D', econ:2, soc:1,  nat:-1},
            {id:'NM', n:'New Mexico',  x:25,y:52, ev:5,  lean:'D', econ:-1,soc:1,  nat:0},{id:'NY', n:'New York',    x:88,y:30, ev:31, lean:'D', econ:2, soc:2,  nat:-1},
            {id:'NC', n:'N. Carolina', x:80,y:48, ev:15, lean:'S', econ:1, soc:-1, nat:0},{id:'ND', n:'N. Dakota',   x:45,y:18, ev:3,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'OH', n:'Ohio',        x:75,y:36, ev:20, lean:'S', econ:0, soc:-1, nat:1},{id:'OK', n:'Oklahoma',    x:50,y:52, ev:7,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'OR', n:'Oregon',      x:7, y:25, ev:7,  lean:'D', econ:1, soc:2,  nat:0},{id:'PA', n:'Pennsylvania',x:83,y:32, ev:21, lean:'D', econ:0, soc:0,  nat:0},
            {id:'RI', n:'Rhode Island',x:92,y:30, ev:4,  lean:'D', econ:1, soc:2,  nat:-1},{id:'SC', n:'S. Carolina', x:78,y:52, ev:8,  lean:'R', econ:0, soc:-2, nat:1},
            {id:'SD', n:'S. Dakota',   x:45,y:25, ev:3,  lean:'R', econ:0, soc:-2, nat:2},{id:'TN', n:'Tennessee',   x:70,y:48, ev:11, lean:'R', econ:0, soc:-2, nat:1},
            {id:'TX', n:'Texas',       x:45,y:60, ev:34, lean:'R', econ:2, soc:-1, nat:2},{id:'UT', n:'Utah',        x:20,y:40, ev:5,  lean:'R', econ:1, soc:-1, nat:1},
            {id:'VT', n:'Vermont',     x:90,y:20, ev:3,  lean:'D', econ:0, soc:2,  nat:0},{id:'VA', n:'Virginia',    x:83,y:42, ev:13, lean:'S', econ:1, soc:1,  nat:0},
            {id:'WA', n:'Washington',  x:8, y:18, ev:11, lean:'D', econ:2, soc:2,  nat:0},{id:'WV', n:'W. Virginia', x:78,y:40, ev:5,  lean:'R', econ:-2,soc:-2, nat:1},
            {id:'WI', n:'Wisconsin',   x:63,y:28, ev:10, lean:'D', econ:0, soc:0,  nat:0},{id:'WY', n:'Wyoming',     x:28,y:30, ev:3,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'DC', n:'D.C.',        x:84,y:39, ev:3,  lean:'D', econ:2, soc:2,  nat:-2}
        ]
    },
    "USA2012": {
        title:"U.S. Presidential Election 2012", year:"2012", emoji:"üá∫üá∏",
        country:"usa",
        desc:"Obama's re-election bid vs Romney. Obamacare, auto bailout, Bain Capital.",
        available:true,
        isElectoralCollege:true,
        newsHeader:"The New York Times ‚Äî NOVEMBER 2012",
        endYear:"2012",
        partyPoolOverride:[{n:"LIBERTARIAN",side:"C",owner:null},{n:"GREEN",side:"E",owner:null}],
        candidates:{
            obama12: {name:"OBAMA",   party:"DEM",    start:51, money:78, side:"E", color:"#003399", econ:-1,soc:2, nat:-1, bio:"Barack Obama seeking re-election. Defended the Affordable Care Act and auto industry bailout. Won 332-206 electoral votes, with Ohio as the decisive state. Famous '47%' Romney video helped seal the victory.", ideologia:"Liberal Democrat / Pragmatic Progressivism", traits:["Incumbency","Debate Recovery","Ohio Coalition"], negativeTraits:["Economy Still Recovering","'You didn't build that' gaffe"]},
            romney:  {name:"ROMNEY",  party:"GOP",    start:47, money:72, side:"D", color:"#cc0000", econ:2, soc:-1, nat:1, bio:"Mitt Romney, former Massachusetts Governor and private equity executive. Lost 206-332 electoral votes. The '47%' leaked video was devastating, as was failing to win Ohio.", ideologia:"Moderate Republican / Business Conservatism", traits:["Business Credibility","Debate Performance"], negativeTraits:["'47%' Tape","Bain Capital Attacks","'Etch-a-Sketch' Perception"]},
            johnson12:{name:"JOHNSON",party:"LIB",   start:1,  money:8,  side:"C", color:"#ffaa00", econ:2, soc:2, nat:-2,bio:"Gary Johnson, former New Mexico Governor. Libertarian candidate. Got 0.99% ‚Äî best Libertarian showing since 1980.", ideologia:"Libertarianism"},
            stein12: {name:"STEIN",   party:"GREEN",  start:0,  money:3,  side:"E", color:"#00aa00", econ:-2,soc:2, nat:0, bio:"Jill Stein, Green Party candidate. First national presidential run.", ideologia:"Green / Progressive"}
        },
        electoralStates:[
            {id:'AL', n:'Alabama',     x:72,y:52, ev:9,  lean:'R', econ:0, soc:-2, nat:1},{id:'AK', n:'Alaska',      x:5, y:10, ev:3,  lean:'R', econ:0, soc:-1, nat:2},
            {id:'AZ', n:'Arizona',     x:15,y:45, ev:11, lean:'R', econ:1, soc:0,  nat:1},{id:'AR', n:'Arkansas',    x:62,y:48, ev:6,  lean:'R', econ:-1,soc:-2, nat:1},
            {id:'CA', n:'California',  x:5, y:38, ev:55, lean:'D', econ:2, soc:2,  nat:-1},{id:'CO', n:'Colorado',    x:25,y:38, ev:9,  lean:'S', econ:1, soc:1,  nat:0},
            {id:'CT', n:'Connecticut', x:90,y:28, ev:7,  lean:'D', econ:2, soc:2,  nat:-1},{id:'DE', n:'Delaware',    x:88,y:35, ev:3,  lean:'D', econ:1, soc:1,  nat:0},
            {id:'FL', n:'Florida',     x:78,y:65, ev:29, lean:'S', econ:1, soc:-1, nat:1},{id:'GA', n:'Georgia',     x:76,y:55, ev:16, lean:'R', econ:1, soc:-1, nat:0},
            {id:'HI', n:'Hawaii',      x:2, y:75, ev:4,  lean:'D', econ:0, soc:2,  nat:0},{id:'ID', n:'Idaho',       x:15,y:25, ev:4,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'IL', n:'Illinois',    x:65,y:35, ev:20, lean:'D', econ:1, soc:1,  nat:0},{id:'IN', n:'Indiana',     x:70,y:38, ev:11, lean:'R', econ:0, soc:-1, nat:1},
            {id:'IA', n:'Iowa',        x:60,y:32, ev:6,  lean:'D', econ:0, soc:-1, nat:1},{id:'KS', n:'Kansas',      x:50,y:42, ev:6,  lean:'R', econ:0, soc:-1, nat:1},
            {id:'KY', n:'Kentucky',    x:72,y:42, ev:8,  lean:'R', econ:-1,soc:-2, nat:1},{id:'LA', n:'Louisiana',   x:62,y:60, ev:8,  lean:'R', econ:-1,soc:-1, nat:1},
            {id:'ME', n:'Maine',       x:92,y:15, ev:4,  lean:'D', econ:0, soc:1,  nat:0},{id:'MD', n:'Maryland',    x:85,y:38, ev:10, lean:'D', econ:1, soc:2,  nat:-1},
            {id:'MA', n:'Massachusetts',x:92,y:28,ev:11, lean:'D', econ:2, soc:2,  nat:-1},{id:'MI', n:'Michigan',    x:70,y:28, ev:16, lean:'D', econ:0, soc:0,  nat:0},
            {id:'MN', n:'Minnesota',   x:58,y:22, ev:10, lean:'D', econ:0, soc:1,  nat:0},{id:'MS', n:'Mississippi', x:68,y:58, ev:6,  lean:'R', econ:-1,soc:-2, nat:1},
            {id:'MO', n:'Missouri',    x:60,y:42, ev:10, lean:'R', econ:0, soc:-1, nat:1},{id:'MT', n:'Montana',     x:22,y:20, ev:3,  lean:'R', econ:0, soc:-1, nat:2},
            {id:'NE', n:'Nebraska',    x:48,y:35, ev:5,  lean:'R', econ:0, soc:-1, nat:1},{id:'NV', n:'Nevada',      x:10,y:38, ev:6,  lean:'D', econ:0, soc:1,  nat:0},
            {id:'NH', n:'New Hampshire',x:90,y:22,ev:4,  lean:'D', econ:1, soc:1,  nat:0},{id:'NJ', n:'New Jersey',  x:87,y:33, ev:14, lean:'D', econ:2, soc:1,  nat:-1},
            {id:'NM', n:'New Mexico',  x:25,y:52, ev:5,  lean:'D', econ:-1,soc:1,  nat:0},{id:'NY', n:'New York',    x:88,y:30, ev:29, lean:'D', econ:2, soc:2,  nat:-1},
            {id:'NC', n:'N. Carolina', x:80,y:48, ev:15, lean:'R', econ:1, soc:-1, nat:0},{id:'ND', n:'N. Dakota',   x:45,y:18, ev:3,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'OH', n:'Ohio üîë',     x:75,y:36, ev:18, lean:'S', econ:0, soc:-1, nat:1},{id:'OK', n:'Oklahoma',    x:50,y:52, ev:7,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'OR', n:'Oregon',      x:7, y:25, ev:7,  lean:'D', econ:1, soc:2,  nat:0},{id:'PA', n:'Pennsylvania',x:83,y:32, ev:20, lean:'D', econ:0, soc:0,  nat:0},
            {id:'RI', n:'Rhode Island',x:92,y:30, ev:4,  lean:'D', econ:1, soc:2,  nat:-1},{id:'SC', n:'S. Carolina', x:78,y:52, ev:9,  lean:'R', econ:0, soc:-2, nat:1},
            {id:'SD', n:'S. Dakota',   x:45,y:25, ev:3,  lean:'R', econ:0, soc:-2, nat:2},{id:'TN', n:'Tennessee',   x:70,y:48, ev:11, lean:'R', econ:0, soc:-2, nat:1},
            {id:'TX', n:'Texas',       x:45,y:60, ev:38, lean:'R', econ:2, soc:-1, nat:2},{id:'UT', n:'Utah',        x:20,y:40, ev:6,  lean:'R', econ:1, soc:-1, nat:1},
            {id:'VT', n:'Vermont',     x:90,y:20, ev:3,  lean:'D', econ:0, soc:2,  nat:0},{id:'VA', n:'Virginia',    x:83,y:42, ev:13, lean:'S', econ:1, soc:1,  nat:0},
            {id:'WA', n:'Washington',  x:8, y:18, ev:12, lean:'D', econ:2, soc:2,  nat:0},{id:'WV', n:'W. Virginia', x:78,y:40, ev:5,  lean:'R', econ:-2,soc:-2, nat:1},
            {id:'WI', n:'Wisconsin',   x:63,y:28, ev:10, lean:'S', econ:0, soc:0,  nat:0},{id:'WY', n:'Wyoming',     x:28,y:30, ev:3,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'DC', n:'D.C.',        x:84,y:39, ev:3,  lean:'D', econ:2, soc:2,  nat:-2}
        ]
    },
    "USA2016": {
        title:"U.S. Presidential Election 2016", year:"2016", emoji:"üá∫üá∏",
        country:"usa",
        desc:"Trump's shocking upset vs Clinton. The blue wall shatters in the Rust Belt.",
        available:true,
        isElectoralCollege:true,
        newsHeader:"The New York Times ‚Äî NOVEMBER 2016",
        endYear:"2016",
        partyPoolOverride:[{n:"LIBERTARIAN",side:"C",owner:null},{n:"GREEN",side:"E",owner:null}],
        candidates:{
            trump16: {name:"TRUMP",   party:"GOP",    start:46, money:65, side:"D", color:"#cc0000", econ:1, soc:-2, nat:2, bio:"Donald J. Trump, real estate mogul and reality TV star, defied all predictions to win 306-227 electoral votes. Carried Michigan, Pennsylvania, and Wisconsin ‚Äî the 'blue wall' states ‚Äî by razor-thin margins. Won despite losing the popular vote by 2.9 million.", ideologia:"America First / Populist Nationalism", traits:["Anti-Establishment Outsider","Media Domination","Rust Belt Connection"], negativeTraits:["Pussy Tape Scandal","Business Controversies","Erratic Behavior"]},
            clinton: {name:"CLINTON", party:"DEM",    start:48, money:85, side:"E", color:"#003399", econ:0, soc:2, nat:-1, bio:"Hillary Clinton, former Secretary of State and Senator. First woman nominated by a major party for President. Lost 227-306 despite winning the popular vote by 2.9 million. Email server controversy and Comey letter were fatal.", ideologia:"Liberal Democrat / Establishment Progressivism", traits:["Historic First","Experienced","Campaign Infrastructure"], negativeTraits:["Email Server Scandal","Comey Letter Oct. 28","'Lock Her Up' Chant","Unfavorability Ratings"]},
            gjohnson:{name:"JOHNSON", party:"LIB",    start:4,  money:15, side:"C", color:"#ffaa00", econ:2, soc:2, nat:-2,bio:"Gary Johnson, former New Mexico Governor. Best Libertarian performance since 1980 with 3.28% nationally. 'What is Aleppo?' and 'Name a foreign leader' gaffes limited ceiling.", ideologia:"Libertarianism"},
            gstein16:{name:"STEIN",   party:"GREEN",  start:1,  money:5,  side:"E", color:"#00aa00", econ:-2,soc:2, nat:0, bio:"Jill Stein, Green Party. 1.07% nationally. Her vote totals in Michigan and Wisconsin exceeded Trump's margins of victory ‚Äî blamed by some Democrats for Clinton's loss.", ideologia:"Green / Progressive"}
        },
        electoralStates:[
            {id:'AL', n:'Alabama',     x:72,y:52, ev:9,  lean:'R', econ:0, soc:-2, nat:1},{id:'AK', n:'Alaska',      x:5, y:10, ev:3,  lean:'R', econ:0, soc:-1, nat:2},
            {id:'AZ', n:'Arizona',     x:15,y:45, ev:11, lean:'R', econ:1, soc:0,  nat:1},{id:'AR', n:'Arkansas',    x:62,y:48, ev:6,  lean:'R', econ:-1,soc:-2, nat:1},
            {id:'CA', n:'California',  x:5, y:38, ev:55, lean:'D', econ:2, soc:2,  nat:-1},{id:'CO', n:'Colorado',    x:25,y:38, ev:9,  lean:'D', econ:1, soc:1,  nat:0},
            {id:'CT', n:'Connecticut', x:90,y:28, ev:7,  lean:'D', econ:2, soc:2,  nat:-1},{id:'DE', n:'Delaware',    x:88,y:35, ev:3,  lean:'D', econ:1, soc:1,  nat:0},
            {id:'FL', n:'Florida',     x:78,y:65, ev:29, lean:'S', econ:1, soc:-1, nat:1},{id:'GA', n:'Georgia',     x:76,y:55, ev:16, lean:'R', econ:1, soc:-1, nat:0},
            {id:'HI', n:'Hawaii',      x:2, y:75, ev:4,  lean:'D', econ:0, soc:2,  nat:0},{id:'ID', n:'Idaho',       x:15,y:25, ev:4,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'IL', n:'Illinois',    x:65,y:35, ev:20, lean:'D', econ:1, soc:1,  nat:0},{id:'IN', n:'Indiana',     x:70,y:38, ev:11, lean:'R', econ:0, soc:-1, nat:1},
            {id:'IA', n:'Iowa',        x:60,y:32, ev:6,  lean:'R', econ:0, soc:-1, nat:1},{id:'KS', n:'Kansas',      x:50,y:42, ev:6,  lean:'R', econ:0, soc:-1, nat:1},
            {id:'KY', n:'Kentucky',    x:72,y:42, ev:8,  lean:'R', econ:-1,soc:-2, nat:1},{id:'LA', n:'Louisiana',   x:62,y:60, ev:8,  lean:'R', econ:-1,soc:-1, nat:1},
            {id:'ME', n:'Maine',       x:92,y:15, ev:4,  lean:'D', econ:0, soc:1,  nat:0},{id:'MD', n:'Maryland',    x:85,y:38, ev:10, lean:'D', econ:1, soc:2,  nat:-1},
            {id:'MA', n:'Massachusetts',x:92,y:28,ev:11, lean:'D', econ:2, soc:2,  nat:-1},{id:'MI', n:'Michigan üî•', x:70,y:28, ev:16, lean:'S', econ:0, soc:0,  nat:0},
            {id:'MN', n:'Minnesota',   x:58,y:22, ev:10, lean:'D', econ:0, soc:1,  nat:0},{id:'MS', n:'Mississippi', x:68,y:58, ev:6,  lean:'R', econ:-1,soc:-2, nat:1},
            {id:'MO', n:'Missouri',    x:60,y:42, ev:10, lean:'R', econ:0, soc:-1, nat:1},{id:'MT', n:'Montana',     x:22,y:20, ev:3,  lean:'R', econ:0, soc:-1, nat:2},
            {id:'NE', n:'Nebraska',    x:48,y:35, ev:5,  lean:'R', econ:0, soc:-1, nat:1},{id:'NV', n:'Nevada',      x:10,y:38, ev:6,  lean:'S', econ:0, soc:1,  nat:0},
            {id:'NH', n:'New Hampshire',x:90,y:22,ev:4,  lean:'S', econ:1, soc:1,  nat:0},{id:'NJ', n:'New Jersey',  x:87,y:33, ev:14, lean:'D', econ:2, soc:1,  nat:-1},
            {id:'NM', n:'New Mexico',  x:25,y:52, ev:5,  lean:'D', econ:-1,soc:1,  nat:0},{id:'NY', n:'New York',    x:88,y:30, ev:29, lean:'D', econ:2, soc:2,  nat:-1},
            {id:'NC', n:'N. Carolina', x:80,y:48, ev:15, lean:'R', econ:1, soc:-1, nat:0},{id:'ND', n:'N. Dakota',   x:45,y:18, ev:3,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'OH', n:'Ohio',        x:75,y:36, ev:18, lean:'R', econ:0, soc:-1, nat:1},{id:'OK', n:'Oklahoma',    x:50,y:52, ev:7,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'OR', n:'Oregon',      x:7, y:25, ev:7,  lean:'D', econ:1, soc:2,  nat:0},{id:'PA', n:'Pennsylvania üî•',x:83,y:32,ev:20, lean:'S', econ:0, soc:0,  nat:0},
            {id:'RI', n:'Rhode Island',x:92,y:30, ev:4,  lean:'D', econ:1, soc:2,  nat:-1},{id:'SC', n:'S. Carolina', x:78,y:52, ev:9,  lean:'R', econ:0, soc:-2, nat:1},
            {id:'SD', n:'S. Dakota',   x:45,y:25, ev:3,  lean:'R', econ:0, soc:-2, nat:2},{id:'TN', n:'Tennessee',   x:70,y:48, ev:11, lean:'R', econ:0, soc:-2, nat:1},
            {id:'TX', n:'Texas',       x:45,y:60, ev:38, lean:'R', econ:2, soc:-1, nat:2},{id:'UT', n:'Utah',        x:20,y:40, ev:6,  lean:'R', econ:1, soc:-1, nat:1},
            {id:'VT', n:'Vermont',     x:90,y:20, ev:3,  lean:'D', econ:0, soc:2,  nat:0},{id:'VA', n:'Virginia',    x:83,y:42, ev:13, lean:'D', econ:1, soc:1,  nat:0},
            {id:'WA', n:'Washington',  x:8, y:18, ev:12, lean:'D', econ:2, soc:2,  nat:0},{id:'WV', n:'W. Virginia', x:78,y:40, ev:5,  lean:'R', econ:-2,soc:-2, nat:1},
            {id:'WI', n:'Wisconsin üî•', x:63,y:28, ev:10, lean:'S', econ:0, soc:0,  nat:0},{id:'WY', n:'Wyoming',     x:28,y:30, ev:3,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'DC', n:'D.C.',        x:84,y:39, ev:3,  lean:'D', econ:2, soc:2,  nat:-2}
        ]
    },
    "USA2024": {
        title:"U.S. Presidential Election 2024", year:"2024", emoji:"üá∫üá∏",
        country:"usa",
        desc:"Trump vs Harris. Electoral College showdown.",
        available:true,
        isElectoralCollege:true,
        newsHeader:"The Washington Post ‚Äî NOVEMBER 2024",
        endYear:"2024",
        partyPoolOverride:[{n:"LIBERTARIAN",side:"C",owner:null},{n:"GREEN",side:"E",owner:null}],
        candidates:{
            trump:  {name:"TRUMP",  party:"GOP",  start:49, money:70, side:"D", color:"#cc0000", econ:2, soc:-2, nat:2, bio:"Donald J. Trump, 45¬∫ Presidente, concorrendo a um hist√≥rico segundo mandato n√£o-consecutivo. Liderou o movimento MAGA. Venceu a elei√ß√£o de 2024 com 312 votos eleitorais.", ideologia:"Populismo Nacional / MAGA", traits:["Mestre das Redes Sociais","Base Leal Fervorosa"], negativeTraits:["Hist√≥rico de Processos","Discurso Divisivo","Instabilidade Institucional"]},
            harris: {name:"HARRIS", party:"DEM",  start:48, money:75, side:"E", color:"#3355cc", econ:-1, soc:2, nat:-1,bio:"Kamala Harris, Vice-Presidente de Biden. Primeira mulher e pessoa negra/sul-asi√°tica indicada por um grande partido. Perdeu o Col√©gio Eleitoral 226-312.", ideologia:"Liberalismo Progressista", traits:["Marco Hist√≥rico","Apoio Institucional Forte"], negativeTraits:["Baixa Aprova√ß√£o Como VP","Dificuldade de Conex√£o Popular"]},
            rfk:    {name:"RFK JR", party:"IND",  start:5,  money:20, side:"C", color:"#228B22", econ:0, soc:0, nat:0, bio:"Robert F. Kennedy Jr., sobrinho de JFK, concorreu como independente antes de desistir em agosto de 2024 e apoiar Trump. Atraiu apoiadores de ambos os lados com posturas heterodoxas.", ideologia:"Independente Populista", traits:["Nome Hist√≥rico Kennedy"], negativeTraits:["Posi√ß√µes Controversas sobre Vacinas","Desistiu da Corrida em Agosto"]},
            stein:  {name:"STEIN",  party:"GREEN",start:1,  money:10, side:"E", color:"#00aa00", econ:-2,soc:2, nat:0, bio:"Jill Stein, candidata do Partido Verde.", ideologia:"Pol√≠tica Verde"},
            oliver: {name:"OLIVER", party:"LIB",  start:1,  money:8,  side:"C", color:"#ffaa00", econ:2, soc:1, nat:-2,bio:"Chase Oliver, candidato Libert√°rio.", ideologia:"Libertarianismo"}
        },
        // US States with electoral votes
        electoralStates:[
            {id:'AL', n:'Alabama',     x:72,y:52, ev:9,  lean:'R', econ:0, soc:-2, nat:1},
            {id:'AK', n:'Alaska',      x:5, y:10, ev:3,  lean:'R', econ:0, soc:-1, nat:2},
            {id:'AZ', n:'Arizona',     x:15,y:45, ev:11, lean:'S', econ:1, soc:0,  nat:1},
            {id:'AR', n:'Arkansas',    x:62,y:48, ev:6,  lean:'R', econ:-1,soc:-2, nat:1},
            {id:'CA', n:'California',  x:5, y:38, ev:54, lean:'D', econ:2, soc:2,  nat:-1},
            {id:'CO', n:'Colorado',    x:25,y:38, ev:10, lean:'D', econ:1, soc:1,  nat:0},
            {id:'CT', n:'Connecticut', x:90,y:28, ev:7,  lean:'D', econ:2, soc:2,  nat:-1},
            {id:'DE', n:'Delaware',    x:88,y:35, ev:3,  lean:'D', econ:1, soc:1,  nat:0},
            {id:'FL', n:'Florida',     x:78,y:65, ev:30, lean:'R', econ:1, soc:-1, nat:1},
            {id:'GA', n:'Georgia',     x:76,y:55, ev:16, lean:'S', econ:1, soc:-1, nat:0},
            {id:'HI', n:'Hawaii',      x:2, y:75, ev:4,  lean:'D', econ:0, soc:2,  nat:0},
            {id:'ID', n:'Idaho',       x:15,y:25, ev:4,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'IL', n:'Illinois',    x:65,y:35, ev:19, lean:'D', econ:1, soc:1,  nat:0},
            {id:'IN', n:'Indiana',     x:70,y:38, ev:11, lean:'R', econ:0, soc:-1, nat:1},
            {id:'IA', n:'Iowa',        x:60,y:32, ev:6,  lean:'R', econ:0, soc:-1, nat:1},
            {id:'KS', n:'Kansas',      x:50,y:42, ev:6,  lean:'R', econ:0, soc:-1, nat:1},
            {id:'KY', n:'Kentucky',    x:72,y:42, ev:8,  lean:'R', econ:-1,soc:-2, nat:1},
            {id:'LA', n:'Louisiana',   x:62,y:60, ev:8,  lean:'R', econ:-1,soc:-1, nat:1},
            {id:'ME', n:'Maine',       x:92,y:15, ev:4,  lean:'D', econ:0, soc:1,  nat:0},
            {id:'MD', n:'Maryland',    x:85,y:38, ev:10, lean:'D', econ:1, soc:2,  nat:-1},
            {id:'MA', n:'Massachusetts',x:92,y:28,ev:11,lean:'D', econ:2, soc:2,  nat:-1},
            {id:'MI', n:'Michigan',    x:70,y:28, ev:15, lean:'S', econ:0, soc:0,  nat:0},
            {id:'MN', n:'Minnesota',   x:58,y:22, ev:10, lean:'D', econ:0, soc:1,  nat:0},
            {id:'MS', n:'Mississippi', x:68,y:58, ev:6,  lean:'R', econ:-1,soc:-2, nat:1},
            {id:'MO', n:'Missouri',    x:60,y:42, ev:10, lean:'R', econ:0, soc:-1, nat:1},
            {id:'MT', n:'Montana',     x:22,y:20, ev:4,  lean:'R', econ:0, soc:-1, nat:2},
            {id:'NE', n:'Nebraska',    x:48,y:35, ev:5,  lean:'R', econ:0, soc:-1, nat:1},
            {id:'NV', n:'Nevada',      x:10,y:38, ev:6,  lean:'S', econ:0, soc:1,  nat:0},
            {id:'NH', n:'New Hampshire',x:90,y:22,ev:4,  lean:'D', econ:1, soc:1,  nat:0},
            {id:'NJ', n:'New Jersey',  x:87,y:33, ev:14, lean:'D', econ:2, soc:1,  nat:-1},
            {id:'NM', n:'New Mexico',  x:25,y:52, ev:5,  lean:'D', econ:-1,soc:1,  nat:0},
            {id:'NY', n:'New York',    x:88,y:30, ev:28, lean:'D', econ:2, soc:2,  nat:-1},
            {id:'NC', n:'N. Carolina', x:80,y:48, ev:16, lean:'S', econ:1, soc:-1, nat:0},
            {id:'ND', n:'N. Dakota',   x:45,y:18, ev:3,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'OH', n:'Ohio',        x:75,y:36, ev:17, lean:'R', econ:0, soc:-1, nat:1},
            {id:'OK', n:'Oklahoma',    x:50,y:52, ev:7,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'OR', n:'Oregon',      x:7, y:25, ev:8,  lean:'D', econ:1, soc:2,  nat:0},
            {id:'PA', n:'Pennsylvania',x:83,y:32, ev:19, lean:'S', econ:0, soc:0,  nat:0},
            {id:'RI', n:'Rhode Island',x:92,y:30, ev:4,  lean:'D', econ:1, soc:2,  nat:-1},
            {id:'SC', n:'S. Carolina', x:78,y:52, ev:9,  lean:'R', econ:0, soc:-2, nat:1},
            {id:'SD', n:'S. Dakota',   x:45,y:25, ev:3,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'TN', n:'Tennessee',   x:70,y:48, ev:11, lean:'R', econ:0, soc:-2, nat:1},
            {id:'TX', n:'Texas',       x:45,y:60, ev:40, lean:'R', econ:2, soc:-1, nat:2},
            {id:'UT', n:'Utah',        x:20,y:40, ev:6,  lean:'R', econ:1, soc:-1, nat:1},
            {id:'VT', n:'Vermont',     x:90,y:20, ev:3,  lean:'D', econ:0, soc:2,  nat:0},
            {id:'VA', n:'Virginia',    x:83,y:42, ev:13, lean:'D', econ:1, soc:1,  nat:0},
            {id:'WA', n:'Washington',  x:8, y:18, ev:12, lean:'D', econ:2, soc:2,  nat:0},
            {id:'WV', n:'W. Virginia', x:78,y:40, ev:4,  lean:'R', econ:-2,soc:-2, nat:1},
            {id:'WI', n:'Wisconsin',   x:63,y:28, ev:10, lean:'S', econ:0, soc:0,  nat:0},
            {id:'WY', n:'Wyoming',     x:28,y:30, ev:3,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'DC', n:'D.C.',        x:84,y:39, ev:3,  lean:'D', econ:2, soc:2,  nat:-2}
        ]
    },
    "ITA2022": {
        title:"Elei√ß√µes Legislativas Italianas 2022", year:"2022", emoji:"üáÆüáπ",
        country:"italy",
        desc:"Meloni lidera a direita italiana ao poder. O centro-esquerda fragmentado enfrenta o Movimento 5 Estrelas e a coaliz√£o de direita.",
        available:true,
        noSecondRound:true,
        newsHeader:"Corriere della Sera ‚Äî SETTEMBRE 2022",
        endYear:"2022",
        partyPoolOverride:[{n:"FdI",side:"D",owner:null},{n:"Lega",side:"D",owner:null},{n:"PD",side:"E",owner:null},{n:"M5S",side:"E",owner:null}],
        candidates:{
            meloni: {name:"MELONI",  party:"FdI",   start:26, money:50, side:"D", color:"#002366", econ:1, soc:-2, nat:2,  bio:"Giorgia Meloni, l√≠der dos Irm√£os da It√°lia (FdI), partido de ra√≠zes p√≥s-fascistas. Tornou-se a primeira primeira-ministra da It√°lia ap√≥s liderar coaliz√£o de direita √† vit√≥ria com 44% dos votos.", ideologia:"Conservadorismo Nacional / P√≥s-Fascismo", traits:["Comunicadora Carism√°tica","Apelo Populista"], negativeTraits:["Heran√ßa P√≥s-Fascista","Posi√ß√µes Contra-Corrente na UE"]},
            letta:  {name:"LETTA",   party:"PD",    start:19, money:40, side:"E", color:"#cc0000", econ:-1,soc:2,  nat:-1, bio:"Enrico Letta, l√≠der do Partido Democr√°tico (PD). Tentou unir a esquerda fragmentada, mas falhou em apresentar alternativa cr√≠vel ao avan√ßo da direita. Renunciou ap√≥s a derrota.", ideologia:"Social-Democracia / Progressismo Europeu", traits:["Experi√™ncia Europeia"], negativeTraits:["Lideran√ßa Percebida como Fraca","Esquerda Dividida"]},
            conte:  {name:"CONTE",   party:"M5S",   start:16, money:35, side:"C", color:"#ffcc00", econ:-1,soc:1,  nat:0,  bio:"Giuseppe Conte, ex-primeiro-ministro duas vezes, liderou o M5S ap√≥s sa√≠da de Di Maio. Posicionou o movimento √† esquerda, focando em renda b√°sica e anti-corrup√ß√£o.", ideologia:"Populismo / Progressismo Social", traits:["Ex-Primeiro-Ministro","Anti-Establishment"], negativeTraits:["M5S em Crise Interna","Base Eleitoral Fragmentada"]},
            calenda:{name:"CALENDA", party:"Azione",start:7,  money:20, side:"C", color:"#ff6600", econ:2, soc:1,  nat:-1, bio:"Carlo Calenda, l√≠der da A√ß√£o e fundador do polo centrista. Tentou criar terceira via liberal entre direita e esquerda, mas n√£o obteve massa cr√≠tica suficiente.", ideologia:"Liberalismo / Centrismo Reformista", traits:["Perfil T√©cnico e Moderno"], negativeTraits:["Pouca Base Territorial","Coaliz√£o Centrista Fr√°gil"]}
        },
        regions:[
            {id:'NOR', n:'Norte (Lombardia/Piemonte/Veneto)', x:25,y:15, p:32, econ:2,  soc:-1, nat:1},
            {id:'TOS', n:'Toscana (Zona Rossa)',              x:28,y:40, p:10, econ:0,  soc:1,  nat:-1},
            {id:'LAZ', n:'L√°cio (Roma)',                      x:30,y:52, p:15, econ:1,  soc:0,  nat:0},
            {id:'SUD', n:'Sul (Camp√¢nia/Puglia/Sic√≠lia)',     x:40,y:72, p:28, econ:-2, soc:-1, nat:1},
            {id:'EMR', n:'Em√≠lia-Romagna',                   x:30,y:30, p:8,  econ:1,  soc:0,  nat:0},
            {id:'SAR', n:'Sardenha',                         x:18,y:62, p:4,  econ:-1, soc:0,  nat:1},
            {id:'SIC', n:'Sic√≠lia',                          x:38,y:82, p:8,  econ:-2, soc:-1, nat:2}
        ]
    },
    "ARG2023": {
        title:"Elei√ß√µes Presidenciais Argentinas 2023", year:"2023", emoji:"üá¶üá∑",
        country:"argentina",
        desc:"Milei, o outsider libert√°rio, agita a Argentina em crise. Massa representa o kirchnerismo, Bullrich o PRO e Schiaretti o peronismo provincial.",
        available:true,
        noSecondRound:false,
        newsHeader:"Clar√≠n ‚Äî OCTUBRE 2023",
        endYear:"2023",
        partyPoolOverride:[{n:"LLA",side:"D",owner:null},{n:"UxP",side:"E",owner:null},{n:"PRO",side:"D",owner:null}],
        candidates:{
            milei:     {name:"MILEI",     party:"LLA",  start:30, money:40, side:"D", color:"#9932CC", econ:3, soc:-2, nat:1,  bio:"Javier Milei, economista anarcocapitalista e deputado. Com discurso ultraliberal e iconoclasta ‚Äî motosserra como s√≠mbolo ‚Äî, venceu em segundo turno com 55% contra Massa. Prometeu dolariza√ß√£o e elimina√ß√£o do Banco Central.", ideologia:"Libertarianismo Radical / Anarcocapitalismo", traits:["Outsider Radical","Apelo Anti-Casta","Carisma Midi√°tico"], negativeTraits:["Posi√ß√µes Extremas","Instabilidade Comportamental","Sem Experi√™ncia Executiva"]},
            massa:     {name:"MASSA",     party:"UxP",  start:27, money:55, side:"E", color:"#003399", econ:-1,soc:2,  nat:0,  bio:"Sergio Massa, ministro da Economia de Alberto Fern√°ndez. Candidato kirchnerista enfrentou contexto de 140% de infla√ß√£o. Chegou ao 2¬∫ turno em 1¬∫ lugar, mas perdeu para Milei por grande margem.", ideologia:"Peronismo Kirchnerista / Populismo de Esquerda", traits:["Articula√ß√£o Pol√≠tica","Controle do Aparato Estatal"], negativeTraits:["Infla√ß√£o Galopante","Desgaste do Governo","Kirchnerismo Impopular"]},
            bullrich:  {name:"BULLRICH",  party:"PRO",  start:24, money:50, side:"D", color:"#FFD700", econ:1, soc:-1, nat:1,  bio:"Patricia Bullrich, ex-ministra de Seguran√ßa de Macri e candidata do PRO. Representou a direita macrista tradicional, mas ficou em 3¬∫ no 1¬∫ turno e apoiou Milei no balotaje.", ideologia:"Liberalismo Conservador / Macrismo", traits:["Experi√™ncia Ministerial","Perfil Seguran√ßa P√∫blica"], negativeTraits:["Associada ao Fracasso de Macri","Desgaste da Oposi√ß√£o Tradicional"]},
            schiaretti:{name:"SCHIARETTI",party:"PJ",   start:4,  money:15, side:"C", color:"#33aa33", econ:0, soc:0,  nat:0,  bio:"Juan Schiaretti, governador de C√≥rdoba. Representou o peronismo n√£o-kirchnerista e o interior do pa√≠s. Buscou espa√ßo entre os extremos sem sucesso expressivo.", ideologia:"Peronismo Moderado / Federal", traits:["Governador Experimentado"], negativeTraits:["Pouco Reconhecimento Nacional","Sem Diferencia√ß√£o Clara"]}
        },
        regions:[
            {id:'BAI', n:'Buenos Aires (Cidade)',      x:60,y:72, p:8,  econ:2,  soc:1,  nat:-1},
            {id:'GBA', n:'Grande Buenos Aires',        x:57,y:75, p:22, econ:-1, soc:1,  nat:0},
            {id:'COR', n:'C√≥rdoba',                    x:48,y:58, p:9,  econ:1,  soc:-1, nat:1},
            {id:'ROS', n:'Santa F√© / Rosario',         x:52,y:62, p:9,  econ:0,  soc:0,  nat:0},
            {id:'PAT', n:'Patag√¥nia (Sul)',             x:42,y:88, p:5,  econ:1,  soc:0,  nat:1},
            {id:'NOA', n:'Noroeste (Salta/Jujuy)',     x:38,y:28, p:8,  econ:-2, soc:-1, nat:1},
            {id:'NEA', n:'Nordeste (Misiones/Chaco)',  x:62,y:38, p:8,  econ:-2, soc:0,  nat:0},
            {id:'CUY', n:'Cuyo (Mendoza/San Juan)',    x:32,y:62, p:6,  econ:0,  soc:-1, nat:1},
            {id:'LAP', n:'La Pampa / Entre R√≠os',     x:52,y:70, p:5,  econ:0,  soc:0,  nat:0}
        ]
    },
    "IND2024": {
        title:"Elei√ß√µes Gerais Indianas 2024", year:"2024", emoji:"üáÆüá≥",
        country:"india",
        desc:"Modi busca terceiro mandato pela NDA, mas enfrenta oposi√ß√£o unificada da alian√ßa INDIA liderada pelo Congresso Nacional Indiano.",
        available:true,
        noSecondRound:true,
        newsHeader:"The Hindu ‚Äî APRIL-JUNE 2024",
        endYear:"2024",
        partyPoolOverride:[{n:"BJP",side:"D",owner:null},{n:"INC",side:"E",owner:null},{n:"SP",side:"E",owner:null}],
        candidates:{
            modi:   {name:"MODI",   party:"BJP",  start:37, money:80, side:"D", color:"#FF6600", econ:2, soc:-2, nat:2,  bio:"Narendra Modi, primeiro-ministro por 10 anos. Liderou a NDA √† vit√≥ria, mas com maioria reduzida ‚Äî BJP sozinho ficou abaixo dos 272 assentos pela primeira vez desde 2014. Governou com agenda hindu√≠sta (Hindutva) e desenvolvimento econ√¥mico.", ideologia:"Hindu√≠smo Pol√≠tico / Nacionalismo / Neoliberalismo Seletivo", traits:["Comunicador de Massa","Marca Pessoal Forte","Hindu√≠smo como Ativo"], negativeTraits:["Tens√µes Religiosas","Autoritarismo Percebido","Desigualdade Crescente"]},
            kharge: {name:"KHARGE", party:"INC",  start:21, money:40, side:"E", color:"#336699", econ:-1,soc:2,  nat:-1, bio:"Mallikarjun Kharge, presidente do Congresso Nacional Indiano. Representou a alian√ßa INDIA, conseguindo surpreender com avan√ßo eleitoral, mas sem superar a m√°quina da NDA. Primeiro dalit a presidir o INC.", ideologia:"Secularismo / Social-Democracia / Gandhismo Moderno", traits:["Representa√ß√£o Dalit","Alian√ßa INDIA Unificada"], negativeTraits:["Partido Desgastado","Rahul Gandhi como Sombra","Financiamento Limitado"]}
        },
        regions:[
            {id:'UPR', n:'Uttar Pradesh (80 assentos)',     x:52,y:35, p:17, econ:-1, soc:-2, nat:2},
            {id:'MAH', n:'Maharashtra (48 assentos)',       x:38,y:50, p:12, econ:2,  soc:0,  nat:1},
            {id:'WBE', n:'Bengala Ocidental (42 assentos)',x:65,y:42, p:9,  econ:-1, soc:1,  nat:0},
            {id:'BIH', n:'Bihar (40 assentos)',             x:60,y:38, p:8,  econ:-2, soc:-1, nat:1},
            {id:'TAM', n:'Tamil Nadu (39 assentos)',        x:45,y:75, p:8,  econ:1,  soc:1,  nat:-1},
            {id:'RJT', n:'Rajast√£o (25 assentos)',          x:32,y:30, p:6,  econ:-1, soc:-2, nat:2},
            {id:'AND', n:'Andhra/Telangana (42 assentos)', x:45,y:62, p:9,  econ:0,  soc:0,  nat:0},
            {id:'KER', n:'Kerala (20 assentos)',            x:40,y:80, p:4,  econ:0,  soc:2,  nat:-1},
            {id:'GUJ', n:'Gujarat (26 assentos)',           x:28,y:42, p:6,  econ:2,  soc:-1, nat:2},
            {id:'KAR', n:'Karnataka (28 assentos)',         x:38,y:65, p:6,  econ:1,  soc:0,  nat:0},
            {id:'MPR', n:'Madhya Pradesh (29 assentos)',   x:42,y:40, p:6,  econ:-1, soc:-1, nat:1},
            {id:'ORI', n:'Odisha/Jharkhand (35 assentos)', x:58,y:50, p:6,  econ:-2, soc:0,  nat:1},
            {id:'PNJ', n:'Punjab/Haryana (26 assentos)',   x:38,y:20, p:5,  econ:1,  soc:0,  nat:0}
        ]
    },
    "UK2024": {
        title:"Elei√ß√µes Gerais do Reino Unido 2024", year:"2024", emoji:"üá¨üáß",
        country:"uk",
        desc:"Starmer e o Labour buscam encerrar 14 anos de governo conservador. Sunak tenta segurar o poder apesar dos esc√¢ndalos. Davey lidera os Lib Dems e Swinney o SNP.",
        available:true,
        noSecondRound:true,
        newsHeader:"The Guardian ‚Äî JULY 2024",
        endYear:"2024",
        partyPoolOverride:[{n:"Labour",side:"E",owner:null},{n:"Tory",side:"D",owner:null},{n:"LibDem",side:"C",owner:null}],
        candidates:{
            starmer: {name:"STARMER", party:"Labour", start:44, money:55, side:"E", color:"#cc0000", econ:-1,soc:2,  nat:-1, bio:"Keir Starmer, l√≠der trabalhista e ex-promotor p√∫blico. Venceu com maioria hist√≥rica de 412 assentos ‚Äî maior para o Labour desde 1997. Prometeu renova√ß√£o ap√≥s os esc√¢ndalos tories.", ideologia:"Social-Democracia / Trabalhismo Moderado", traits:["Imagem de Integridade","Apelo ao Centro"], negativeTraits:["Percebido como Sem Carisma","Posi√ß√µes Vagas em Pol√≠ticas"]},
            sunak:   {name:"SUNAK",   party:"Tory",   start:29, money:60, side:"D", color:"#003399", econ:2, soc:-1, nat:0,  bio:"Rishi Sunak, primeiro-ministro e ex-chanceler. Sofreu a pior derrota conservadora da hist√≥ria moderna ‚Äî de 365 para 121 assentos. Herdou crises econ√¥micas e esc√¢ndalos de Boris Johnson e Liz Truss.", ideologia:"Conservadorismo Econ√¥mico / Thatcherismo Moderno", traits:["Gestor Fiscal Experiente"], negativeTraits:["Desgaste de 14 Anos de Governo","Esc√¢ndalos do Partido","Boris e Liz Truss"]},
            davey:   {name:"DAVEY",   party:"LibDem", start:12, money:25, side:"C", color:"#FFD700", econ:0, soc:2,  nat:-2, bio:"Ed Davey, l√≠der dos Democratas Liberais. Partido obteve resultado hist√≥rico de 72 assentos, conquistando eleitores moderados e pr√≥-Europa desencantados com os Tories.", ideologia:"Liberalismo Social / Centrismo Progressista", traits:["Apelo ao Eleitorado Moderado","Pr√≥-Europa"], negativeTraits:["Terceiro Partido ‚Äî Teto Estrutural","Regi√£o de Apelo Limitada"]},
            swinney: {name:"SWINNEY", party:"SNP",    start:3,  money:15, side:"E", color:"#FFCC00", econ:-1,soc:1,  nat:2,  bio:"John Swinney, l√≠der do SNP e primeiro-ministro da Esc√≥cia. Partido sofreu queda dr√°stica ‚Äî de 48 para 9 assentos ‚Äî ap√≥s esc√¢ndalos internos e desgaste p√≥s-covid.", ideologia:"Independentismo Escoc√™s / Social-Democracia", traits:["Base Escocesa S√≥lida"], negativeTraits:["SNP em Crise Interna","Independ√™ncia Perdeu For√ßa","Nicola Sturgeon como Sombra"]}
        },
        regions:[
            {id:'ENG', n:'Inglaterra (Sul e East)',       x:58,y:68, p:30, econ:2,  soc:-1, nat:0},
            {id:'MID', n:'Midlands (Leste e Oeste)',      x:50,y:55, p:18, econ:0,  soc:0,  nat:0},
            {id:'NOR', n:'Norte da Inglaterra',           x:46,y:42, p:20, econ:-1, soc:-1, nat:1},
            {id:'LON', n:'Londres',                       x:58,y:62, p:13, econ:2,  soc:2,  nat:-2},
            {id:'SCO', n:'Esc√≥cia',                       x:42,y:22, p:9,  econ:-1, soc:2,  nat:2},
            {id:'WAL', n:'Pa√≠s de Gales',                 x:40,y:52, p:5,  econ:-1, soc:1,  nat:1},
            {id:'NIR', n:'Irlanda do Norte',              x:32,y:35, p:3,  econ:-1, soc:-1, nat:2}
        ]
    },
    "POL2025": {
        title:"Elei√ß√µes Presidenciais da Pol√¥nia 2025", year:"2025", emoji:"üáµüá±",
        country:"poland",
        desc:"Nawrocki (PiS) vs Trzaskowski (KO) no segundo turno. Mentzen cresce pela Confedera√ß√£o libert√°ria. Batalha pelo futuro da democracia polonesa.",
        available:true,
        noSecondRound:false,
        newsHeader:"Gazeta Wyborcza ‚Äî MAJ 2025",
        endYear:"2025",
        partyPoolOverride:[{n:"PiS",side:"D",owner:null},{n:"KO",side:"E",owner:null},{n:"Konf",side:"D",owner:null}],
        candidates:{
            nawrocki:   {name:"NAWROCKI",   party:"PiS/Ind",start:34, money:50, side:"D", color:"#002366", econ:-1,soc:-2, nat:2,  bio:"Karol Nawrocki, presidente do Instituto da Mem√≥ria Nacional, candidato apoiado pelo PiS apesar de se apresentar como independente. Representa a continua√ß√£o da agenda nacional-conservadora de Kaczy≈Ñski.", ideologia:"Nacional-Conservadorismo / Soberanismo", traits:["Apoio do PiS","Base Conservadora S√≥lida"], negativeTraits:["Associado ao Populismo Judicial do PiS","Percebido como Candidato de Kaczy≈Ñski"]},
            trzaskowski:{name:"TRZASKOWSKI",party:"KO",    start:31, money:55, side:"E", color:"#cc0000", econ:1, soc:2,  nat:-1, bio:"Rafa≈Ç Trzaskowski, prefeito de Vars√≥via e candidato da Plataforma C√≠vica. Defensor do Estado de Direito e da integra√ß√£o europeia. J√° perdeu para Duda em 2020 por margem estreita.", ideologia:"Liberalismo Social / Europe√≠smo / Centrismo Progressista", traits:["Prefeito de Vars√≥via","Pr√≥-UE"], negativeTraits:["J√° Perdeu Elei√ß√£o Presidencial","Percebido como Elite Urbana"]},
            mentzen:    {name:"MENTZEN",    party:"Konf",  start:14, money:30, side:"D", color:"#FF6600", econ:3, soc:-2, nat:1,  bio:"S≈Çawomir Mentzen, l√≠der da Confedera√ß√£o, movimento libert√°rio e nacional-conservador. Ganhou espa√ßo entre jovens com discurso anti-impostos, anti-UE e anti-imigra√ß√£o.", ideologia:"Libertarianismo / Nacional-Conservadorismo / Euroc√©tico", traits:["Apelo aos Jovens","Discurso Radical Consistente"], negativeTraits:["Posi√ß√µes Extremas","Associado ao Anti-Semitismo Hist√≥rico do Partido"]}
        },
        regions:[
            {id:'MAZ', n:'Maz√≥via (Vars√≥via)',     x:62,y:35, p:15, econ:2,  soc:1,  nat:-1},
            {id:'SLA', n:'Sil√©sia (Katowice)',     x:50,y:55, p:12, econ:1,  soc:-1, nat:0},
            {id:'WIE', n:'Grande Pol√¥nia (Pozna≈Ñ)',x:38,y:35, p:10, econ:1,  soc:0,  nat:0},
            {id:'LES', n:'Pequena Pol√¥nia (Crac√≥via)',x:58,y:65, p:9, econ:0, soc:-1, nat:1},
            {id:'POD', n:'Subcarp√°cia (Leste)',    x:70,y:65, p:8,  econ:-1, soc:-2, nat:2},
            {id:'LUB', n:'Lublin (Sudeste)',       x:68,y:48, p:8,  econ:-1, soc:-1, nat:2},
            {id:'KUJ', n:'Cui√°via / Pomer√¢nia',   x:42,y:25, p:8,  econ:0,  soc:0,  nat:0},
            {id:'POM', n:'Pomer√¢nia (Gda≈Ñsk)',     x:48,y:15, p:7,  econ:1,  soc:0,  nat:0},
            {id:'WPO', n:'Opole / Baixa Sil√©sia',  x:38,y:50, p:7,  econ:1,  soc:0,  nat:0},
            {id:'WAR', n:'V√°rmia / Maz√∫ria',       x:60,y:20, p:5,  econ:-1, soc:0,  nat:1}
        ]
    },
    "USA2020": {
        title:"U.S. Presidential Election 2020", year:"2020", emoji:"üá∫üá∏",
        country:"usa",
        desc:"Biden vs Trump. A batalha por Michigan, Pennsylvania e Wisconsin decide a elei√ß√£o.",
        available:true,
        isElectoralCollege:true,
        newsHeader:"The New York Times ‚Äî NOVEMBER 2020",
        endYear:"2020",
        partyPoolOverride:[{n:"LIBERTARIAN",side:"C",owner:null},{n:"GREEN",side:"E",owner:null}],
        candidates:{
            biden:     {name:"BIDEN",    party:"DEM",  start:51, money:75, side:"E", color:"#003399", econ:0, soc:2, nat:-1, bio:"Joe Biden, ex-vice-presidente e senador de Delaware. Venceu com 306 votos eleitorais e 81 milh√µes de votos ‚Äî recorde popular ‚Äî prometendo restaurar a democracia e sa√∫de p√∫blica na pandemia.", ideologia:"Liberalismo Moderado / Democrata Centrista", traits:["Experi√™ncia Pol√≠tica Profunda","Apelo ao Eleitorado Moderado"], negativeTraits:["Idade Avan√ßada","Gafes Frequentes","Pouco Carisma"]},
            trump:     {name:"TRUMP",    party:"GOP",  start:47, money:70, side:"D", color:"#cc0000", econ:2, soc:-2, nat:2, bio:"Donald Trump, 45¬∫ presidente em busca de reelei√ß√£o. Perdeu por 232-306 EVs apesar de obter 74 milh√µes de votos ‚Äî o segundo maior total popular da hist√≥ria at√© ent√£o. N√£o reconheceu a derrota, culminando no 6 de janeiro de 2021.", ideologia:"Populismo Nacional / MAGA", traits:["Base Leal Fervorosa","Dom√≠nio Midi√°tico"], negativeTraits:["Gest√£o da Pandemia Criticada","Car√°ter Divisivo"]},
            jorgensen: {name:"JORGENSEN",party:"LIB",  start:1,  money:8,  side:"C", color:"#FFD700", econ:2, soc:2, nat:-2, bio:"Jo Jorgensen, candidata libert√°ria e professora. Obteve 1,8 milh√£o de votos (1,2%).", ideologia:"Libertarianismo"},
            hawkins:   {name:"HAWKINS",  party:"GREEN",start:0.5,money:5,  side:"E", color:"#00aa00", econ:-2,soc:2, nat:-1, bio:"Howie Hawkins, candidato do Partido Verde. Obteve cerca de 400 mil votos.", ideologia:"Ecosocialismo / Pol√≠tica Verde"}
        },
        electoralStates:[
            {id:'AL', n:'Alabama',     x:72,y:52, ev:9,  lean:'R', econ:0, soc:-2, nat:1},
            {id:'AK', n:'Alaska',      x:5, y:10, ev:3,  lean:'R', econ:0, soc:-1, nat:2},
            {id:'AZ', n:'Arizona',     x:15,y:45, ev:11, lean:'S', econ:1, soc:0,  nat:1},
            {id:'AR', n:'Arkansas',    x:62,y:48, ev:6,  lean:'R', econ:-1,soc:-2, nat:1},
            {id:'CA', n:'California',  x:5, y:38, ev:54, lean:'D', econ:2, soc:2,  nat:-1},
            {id:'CO', n:'Colorado',    x:25,y:38, ev:9,  lean:'D', econ:1, soc:1,  nat:0},
            {id:'CT', n:'Connecticut', x:90,y:28, ev:7,  lean:'D', econ:2, soc:2,  nat:-1},
            {id:'DE', n:'Delaware',    x:88,y:35, ev:3,  lean:'D', econ:1, soc:1,  nat:0},
            {id:'FL', n:'Florida',     x:78,y:65, ev:29, lean:'R', econ:1, soc:-1, nat:1},
            {id:'GA', n:'Georgia',     x:76,y:55, ev:16, lean:'S', econ:1, soc:-1, nat:0},
            {id:'HI', n:'Hawaii',      x:2, y:75, ev:4,  lean:'D', econ:0, soc:2,  nat:0},
            {id:'ID', n:'Idaho',       x:15,y:25, ev:4,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'IL', n:'Illinois',    x:65,y:35, ev:20, lean:'D', econ:1, soc:1,  nat:0},
            {id:'IN', n:'Indiana',     x:70,y:38, ev:11, lean:'R', econ:0, soc:-1, nat:1},
            {id:'IA', n:'Iowa',        x:60,y:32, ev:6,  lean:'R', econ:0, soc:-1, nat:1},
            {id:'KS', n:'Kansas',      x:50,y:42, ev:6,  lean:'R', econ:0, soc:-1, nat:1},
            {id:'KY', n:'Kentucky',    x:72,y:42, ev:8,  lean:'R', econ:-1,soc:-2, nat:1},
            {id:'LA', n:'Louisiana',   x:62,y:60, ev:8,  lean:'R', econ:-1,soc:-1, nat:1},
            {id:'ME', n:'Maine',       x:92,y:15, ev:4,  lean:'D', econ:0, soc:1,  nat:0},
            {id:'MD', n:'Maryland',    x:85,y:38, ev:10, lean:'D', econ:1, soc:2,  nat:-1},
            {id:'MA', n:'Massachusetts',x:92,y:28,ev:11, lean:'D', econ:2, soc:2,  nat:-1},
            {id:'MI', n:'Michigan',    x:70,y:28, ev:16, lean:'S', econ:0, soc:0,  nat:0},
            {id:'MN', n:'Minnesota',   x:58,y:22, ev:10, lean:'D', econ:0, soc:1,  nat:0},
            {id:'MS', n:'Mississippi', x:68,y:58, ev:6,  lean:'R', econ:-1,soc:-2, nat:1},
            {id:'MO', n:'Missouri',    x:60,y:42, ev:10, lean:'R', econ:0, soc:-1, nat:1},
            {id:'MT', n:'Montana',     x:22,y:20, ev:3,  lean:'R', econ:0, soc:-1, nat:2},
            {id:'NE', n:'Nebraska',    x:48,y:35, ev:5,  lean:'R', econ:0, soc:-1, nat:1},
            {id:'NV', n:'Nevada',      x:10,y:38, ev:6,  lean:'S', econ:0, soc:1,  nat:0},
            {id:'NH', n:'New Hampshire',x:90,y:22,ev:4,  lean:'D', econ:1, soc:1,  nat:0},
            {id:'NJ', n:'New Jersey',  x:87,y:33, ev:14, lean:'D', econ:2, soc:1,  nat:-1},
            {id:'NM', n:'New Mexico',  x:25,y:52, ev:5,  lean:'D', econ:-1,soc:1,  nat:0},
            {id:'NY', n:'New York',    x:88,y:30, ev:29, lean:'D', econ:2, soc:2,  nat:-1},
            {id:'NC', n:'N. Carolina', x:80,y:48, ev:15, lean:'S', econ:1, soc:-1, nat:0},
            {id:'ND', n:'N. Dakota',   x:45,y:18, ev:3,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'OH', n:'Ohio',        x:75,y:36, ev:18, lean:'R', econ:0, soc:-1, nat:1},
            {id:'OK', n:'Oklahoma',    x:50,y:52, ev:7,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'OR', n:'Oregon',      x:7, y:25, ev:7,  lean:'D', econ:1, soc:2,  nat:0},
            {id:'PA', n:'Pennsylvania',x:83,y:32, ev:20, lean:'S', econ:0, soc:0,  nat:0},
            {id:'RI', n:'Rhode Island',x:92,y:30, ev:4,  lean:'D', econ:1, soc:2,  nat:-1},
            {id:'SC', n:'S. Carolina', x:78,y:52, ev:9,  lean:'R', econ:0, soc:-2, nat:1},
            {id:'SD', n:'S. Dakota',   x:45,y:25, ev:3,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'TN', n:'Tennessee',   x:70,y:48, ev:11, lean:'R', econ:0, soc:-2, nat:1},
            {id:'TX', n:'Texas',       x:45,y:60, ev:38, lean:'R', econ:2, soc:-1, nat:2},
            {id:'UT', n:'Utah',        x:20,y:40, ev:6,  lean:'R', econ:1, soc:-1, nat:1},
            {id:'VT', n:'Vermont',     x:90,y:20, ev:3,  lean:'D', econ:0, soc:2,  nat:0},
            {id:'VA', n:'Virginia',    x:83,y:42, ev:13, lean:'D', econ:1, soc:1,  nat:0},
            {id:'WA', n:'Washington',  x:8, y:18, ev:12, lean:'D', econ:2, soc:2,  nat:0},
            {id:'WV', n:'W. Virginia', x:78,y:40, ev:5,  lean:'R', econ:-2,soc:-2, nat:1},
            {id:'WI', n:'Wisconsin',   x:63,y:28, ev:10, lean:'S', econ:0, soc:0,  nat:0},
            {id:'WY', n:'Wyoming',     x:28,y:30, ev:3,  lean:'R', econ:0, soc:-2, nat:2},
            {id:'DC', n:'D.C.',        x:84,y:39, ev:3,  lean:'D', econ:2, soc:2,  nat:-2}
        ]
    },
    "RUS1996": {
        title:"Elei√ß√£o Presidencial Russa 1996", year:"1996", emoji:"üá∑üá∫",
        country:"russia",
        desc:"Yeltsin, impopular e doente, enfrenta o comunista Zyuganov em plena transi√ß√£o p√≥s-sovi√©tica. Lebed, Yavlinsky e Zhirinovsky completam o campo. Primeiro turno decide quem vai ao balotaje.",
        available:true,
        noSecondRound:false,
        newsHeader:"Izvestia ‚Äî –ò–Æ–õ–¨ 1996",
        endYear:"1996",
        partyPoolOverride:[{n:"Partido do Poder",side:"D",owner:null},{n:"–ö–ü–†–§",side:"E",owner:null},{n:"–õ–î–ü–†",side:"D",owner:null}],
        candidates:{
            yeltsin:    {name:"YELTSIN",   party:"Ind",  start:35, money:80, side:"D", color:"#002aff", econ:2, soc:-1, nat:0, bio:"Boris Yeltsin, primeiro presidente da R√∫ssia p√≥s-sovi√©tica. Reeleito em 2 turnos ap√≥s campanha intensa e presen√ßa constante do Ocidente. Sa√∫de deteriorada, problemas com √°lcool e governo corrupto ‚Äî mas apoio de Lebed no 2¬∫ turno foi decisivo.", ideologia:"Democracia Liberal / Neoliberalismo Econ√¥mico", traits:["Apoio Ocidental","Controle da M√≠dia Estatal"], negativeTraits:["Sa√∫de P√©ssima","Corrup√ß√£o e Oligarcas","Guerra da Chech√™nia Impopular","Alcoolismo"]},
            zyuganov:   {name:"ZYUGANOV",  party:"–ö–ü–†–§", start:32, money:30, side:"E", color:"#cc0000", econ:-3,soc:1,  nat:2, bio:"Gennady Zyuganov, l√≠der do Partido Comunista da Federa√ß√£o Russa. Liderou pesquisas no 1¬∫ turno, mas perdeu o 2¬∫ turno ap√≥s Yeltsin conseguir apoio de Lebed. Representava nostalgia sovi√©tica e descontentamento com transi√ß√£o ca√≥tica.", ideologia:"Comunismo / Socialismo Nacional", traits:["Base Comunista Fiel","Nostalgia Sovi√©tica"], negativeTraits:["Comunismo Impopular no Ocidente","Percebido como Retrocesso"]},
            lebed:      {name:"LEBED",     party:"KRO",  start:15, money:20, side:"D", color:"#228B22", econ:0, soc:-2, nat:2, bio:"Alexandre Lebed, general e pol√≠tico. Obteve 14,5% no 1¬∫ turno, sendo fator decisivo. Apoiou Yeltsin no 2¬∫ turno em troca do posto de secret√°rio de seguran√ßa. Comandou os acordos de paz da Chech√™nia.", ideologia:"Nacional-Patriotismo / Autoritarismo Militar", traits:["Imagem de Homem Forte","Fator-Chave no Balotaje"], negativeTraits:["Base de Apoio Limitada","Oportunismo Pol√≠tico"]},
            yavlinsky:  {name:"YAVLINSKY",party:"Yabloko",start:7, money:15, side:"E", color:"#4488ff", econ:1, soc:2, nat:-1, bio:"Grigory Yavlinsky, economista e l√≠der do Yabloko. Candidato democrata-liberal, cr√≠tico de Yeltsin e opositor de Zyuganov. Representava a terceira via liberal que n√£o decolou.", ideologia:"Liberalismo Democr√°tico / Social-Democracia", traits:["Perfil Intelectual","Defesa do Estado de Direito"], negativeTraits:["Sem Massa Cr√≠tica","Pouca Influ√™ncia nas Regi√µes"]},
            zhirinovsky:{name:"ZHIRINOVSKY",party:"–õ–î–ü–†",start:6, money:15, side:"D", color:"#ffcc00", econ:0, soc:-2, nat:3, bio:"Vladimir Zhirinovsky, fundador do Partido Liberal-Democr√°tico (na verdade ultranacionalista). Personalidade exc√™ntrica e xingamentos p√∫blicos. Obteve 5,7% e apoiou Yeltsin no 2¬∫ turno.", ideologia:"Ultranacionalismo / Populismo Autorit√°rio", traits:["Personalidade Marcante","Voto de Protesto"], negativeTraits:["Posi√ß√µes Extremistas","Pouca Credibilidade Internacional"]},
            fyodorov:   {name:"FYODOROV",  party:"PST",  start:1,  money:8,  side:"C", color:"#888888", econ:1, soc:0, nat:0, bio:"Svyatoslav Fyodorov, oftalmologista famoso e candidato do Partido do Autogoverno dos Trabalhadores. Obteve menos de 1% dos votos.", ideologia:"Tecnocracia / Autogest√£o"}
        },
        regions:[
            {id:'MOS', n:'Moscou e Oblast',           x:52,y:38, p:12, econ:2,  soc:0,  nat:0},
            {id:'URB', n:'Ural (Sverdlovsk/Chelyab)', x:70,y:30, p:10, econ:0,  soc:-1, nat:1},
            {id:'SIB', n:'Sib√©ria Ocidental',          x:75,y:22, p:10, econ:0,  soc:-1, nat:1},
            {id:'SPB', n:'S√£o Petersburgo',            x:48,y:25, p:6,  econ:1,  soc:1,  nat:0},
            {id:'VOL', n:'Volga (Bashkortost√£o etc)', x:60,y:42, p:12, econ:-1, soc:0,  nat:1},
            {id:'CHE', n:'Chech√™nia / C√°ucaso Norte', x:55,y:58, p:3,  econ:-3, soc:0,  nat:3},
            {id:'CEN', n:'Regi√£o Central (excl. Moscou)',x:50,y:44,p:12, econ:-1,soc:-1, nat:1},
            {id:'SUD', n:'Sul (Krasnodar/Rostov)',    x:50,y:55, p:8,  econ:-1, soc:-1, nat:2},
            {id:'NWE', n:'Noroeste (Novgorod etc)',   x:44,y:28, p:6,  econ:0,  soc:0,  nat:0},
            {id:'SIE', n:'Sib√©ria Oriental / Extremo Oriente',x:90,y:20,p:8, econ:-1,soc:-1, nat:1},
            {id:'NOR', n:'Regi√µes do Norte',          x:58,y:15, p:5,  econ:0,  soc:0,  nat:1},
            {id:'SAK', n:'Sakha / Regi√µes Distantes', x:88,y:15, p:4,  econ:0,  soc:0,  nat:1}
        ]
    },
    "RUS2024": {
        title:"Elei√ß√µes Russas 2024", year:"2024", emoji:"üá∑üá∫",
        country:"russia",
        desc:"Putin vs oposi√ß√£o simb√≥lica. Autocracia em forma de elei√ß√£o.",
        available:true,
        isRepVelha:false,
        noSecondRound:false,
        newsHeader:"Folha de S. Pol√≠tica ‚Äî MAR√áO 2024",
        endYear:"2024",
        partyPoolOverride:[{n:"PCRF",side:"E",owner:null},{n:"LDPR",side:"D",owner:null}],
        candidates:{
            putin:      {name:"PUTIN",      party:"Ind.",  start:87, money:80, side:"D", color:"#cc0000", econ:1, soc:-2, nat:2, bio:"Vladimir Putin, presidente desde 2000 (com intervalo 2008-2012). Venceu com 87% em elei√ß√£o com candidatos de oposi√ß√£o real bloqueados ou presos. Quarta elei√ß√£o como presidente.", ideologia:"Nacionalismo Autorit√°rio"},
            kharitonov: {name:"KHARITONOV", party:"PCRF",  start:4,  money:15, side:"E", color:"#8b0000", econ:-2, soc:0, nat:1, bio:"Nikolay Kharitonov, candidato do Partido Comunista Russo. Figura de oposi√ß√£o leal ao Kremlin, permitida participar como alternativa cosm√©tica.", ideologia:"Comunismo Russo"},
            davankov:   {name:"DAVANKOV",   party:"NL",    start:4,  money:10, side:"C", color:"#0044cc", econ:1, soc:0, nat:0, bio:"Vladislav Davankov, do partido Novas Pessoas. Candidato mais jovem, com discurso ligeiramente liberal dentro do permitido pelo sistema. Terminou em segundo lugar com 3,8%.", ideologia:"Liberalismo Moderado"},
            slutsky:    {name:"SLUTSKY",    party:"LDPR",  start:3,  money:12, side:"D", color:"#ff6600", econ:0, soc:-1, nat:2, bio:"Leonid Slutsky, l√≠der do Partido Liberal Democr√°tico Russo. Ap√≥s a morte de Zhirinovsky em 2022, assumiu o partido ultranacionalista que, paradoxalmente, apoia Putin.", ideologia:"Ultranacionalismo"}
        },
        regions:[
            {id:'MSC', n:'Moscou',        x:55,y:38, p:20, econ:2, soc:0,  nat:1},
            {id:'SPB', n:'S√£o Petersburgo',x:48,y:22, p:10, econ:1, soc:1,  nat:1},
            {id:'URG', n:'Ural/Sib√©ria',  x:72,y:30, p:15, econ:0, soc:-1, nat:2},
            {id:'SUL', n:'Sul da R√∫ssia', x:52,y:55, p:12, econ:0, soc:-1, nat:2},
            {id:'VLG', n:'Volga/Kazan',   x:63,y:42, p:10, econ:-1,soc:0,  nat:1},
            {id:'SIBE',n:'Sib√©ria Oriental',x:85,y:25,p:8, econ:-1,soc:-1, nat:2},
            {id:'NORTE',n:'Regi√µes do Norte',x:60,y:15,p:5,econ:-1,soc:-1, nat:2},
            {id:'CAUC',n:'C√°ucaso Norte',  x:55,y:62, p:6, econ:-2,soc:-1, nat:2},
            {id:'OUTROS',n:'Demais Regi√µes',x:35,y:42,p:14,econ:-1,soc:-1, nat:2}
        ]
    },
    "GER2025": {
        title:"Elei√ß√£o Federal Alem√£ 2025", year:"2025", emoji:"üá©üá™",
        country:"germany",
        desc:"Merz vs Weidel vs Scholz. Ascens√£o da AfD, colapso do sem√°foro.",
        available:true,
        isElectoralCollege:false,
        noSecondRound:true,
        newsHeader:"Der Spiegel ‚Äî FEBRUAR 2025",
        endYear:"2025",
        partyPoolOverride:[{n:"CSU",side:"D",owner:null},{n:"FW",side:"C",owner:null},{n:"BSW",side:"C",owner:null}],
        candidates:{
            merz:    {name:"MERZ",    party:"CDU/CSU", start:29, money:65, side:"D", color:"#111111", econ:2, soc:-1, nat:0, bio:"Friedrich Merz, l√≠der da CDU/CSU. Venceu as elei√ß√µes com 28,6% prometendo economia de mercado, controle de imigra√ß√£o e lideran√ßa europeia forte.", ideologia:"Democracia Crist√£ Conservadora"},
            weidel:  {name:"WEIDEL",  party:"AfD",     start:21, money:40, side:"D", color:"#009EE0", econ:1, soc:-2, nat:2, bio:"Alice Weidel, co-l√≠der da AfD. Partido de extrema-direita que obteve 20,8% ‚Äî segundo melhor resultado hist√≥rico. Forte apelo na Alemanha Oriental.", ideologia:"Populismo de Direita / Euroc√©tico"},
            scholz:  {name:"SCHOLZ",  party:"SPD",     start:17, money:55, side:"E", color:"#E3000F", econ:-1, soc:1, nat:-1, bio:"Olaf Scholz, chanceler em exerc√≠cio. SPD despencou de 25% para 16,4% ap√≥s colapso da coaliz√£o sem√°foro. Candidatura desgastada pela crise econ√¥mica alem√£.", ideologia:"Social-Democracia"},
            habeck:  {name:"HABECK",  party:"Greens",  start:13, money:40, side:"E", color:"#46962B", econ:-1, soc:2, nat:-1, bio:"Robert Habeck, ex-vice-chanceler e ministro da Economia. Candidato dos Verdes tentando recuperar terreno ap√≥s crise energ√©tica e pol√™micas.", ideologia:"Ambientalismo Progressista"},
            vanaken: {name:"VAN AKEN",party:"Linke",   start:5,  money:20, side:"E", color:"#CC007A", econ:-2, soc:2, nat:0, bio:"Jan Van Aken, l√≠der de A Esquerda (Die Linke). Partido √† beira do limiar de 5% necess√°rio para entrar no Bundestag ap√≥s sangria para o BSW.", ideologia:"Socialismo de Esquerda"},
            lindner: {name:"LINDNER", party:"FDP",     start:5,  money:30, side:"D", color:"#FFCC00", econ:2, soc:0, nat:-1, bio:"Christian Lindner, ex-ministro das Finan√ßas. Demitido por Scholz, causou o colapso da coaliz√£o. FDP √† beira do limiar de 5% ‚Äî risco de n√£o entrar no Bundestag.", ideologia:"Liberalismo Cl√°ssico"}
        },
        regions:[
            {id:'BW',  n:'Baden-W√ºrttemberg',  x:30,y:80, p:13, econ:2,  soc:-1, nat:0},
            {id:'BAY', n:'Bayern',              x:45,y:82, p:16, econ:2,  soc:-2, nat:0},
            {id:'NRW', n:'Nordrhein-Westfalen', x:20,y:45, p:22, econ:0,  soc:1,  nat:0},
            {id:'NIE', n:'Niedersachsen',       x:30,y:35, p:10, econ:0,  soc:0,  nat:0},
            {id:'HES', n:'Hessen',              x:35,y:60, p:8,  econ:1,  soc:0,  nat:0},
            {id:'OST', n:'Alemanha Oriental',   x:65,y:45, p:18, econ:-1, soc:-1, nat:2},
            {id:'BER', n:'Berlin',              x:68,y:30, p:5,  econ:1,  soc:2,  nat:-1},
            {id:'HAM', n:'Hamburg/Norte',       x:35,y:20, p:8,  econ:1,  soc:1,  nat:-1}
        ]
    },
    "FRA2022": {
        title:"Elei√ß√£o Presidencial Francesa 2022", year:"2022", emoji:"üá´üá∑",
        country:"france",
        desc:"Macron vs Le Pen no 2¬∫ turno. A batalha pela rep√∫blica.",
        available:true,
        isElectoralCollege:false,
        noSecondRound:false,
        newsHeader:"Le Monde ‚Äî AVRIL 2022",
        endYear:"2022",
        partyPoolOverride:[{n:"PS",side:"E",owner:null},{n:"LR",side:"D",owner:null}],
        candidates:{
            macron:   {name:"MACRON",    party:"LREM",  start:27, money:70, side:"C", color:"#FF8000", econ:1, soc:1, nat:-1, bio:"Emmanuel Macron, presidente em exerc√≠cio. Venceu o 2¬∫ turno com 58,5% contra Le Pen, defendendo a Uni√£o Europeia e o centralismo progressista.", ideologia:"Liberalismo Progressista / Centrismo"},
            lepen:    {name:"LE PEN",    party:"RN",    start:23, money:55, side:"D", color:"#0D378A", econ:-1, soc:-2, nat:2, bio:"Marine Le Pen, candidata do Rassemblement National. Obteve recorde de 41,5% no 2¬∫ turno. Discurso anti-imigra√ß√£o, soberania nacional e cr√≠tica ao Euro.", ideologia:"Populismo Nacional-Conservador"},
            melenchon:{name:"M√âLENCHON", party:"FI",    start:20, money:45, side:"E", color:"#CC0000", econ:-2, soc:2, nat:0, bio:"Jean-Luc M√©lenchon, candidato da Fran√ßa Insubmissa. Obteve 21,95% ‚Äî ficou a 1% do 2¬∫ turno. Propunha ruptura com Macron pela esquerda.", ideologia:"Socialismo Populista"},
            zemmour:  {name:"ZEMMOUR",  party:"REC",   start:11, money:35, side:"D", color:"#1B2A4A", econ:1, soc:-2, nat:2, bio:"√âric Zemmour, jornalista e candidato de Reconqu√™te. Discurso ultranacionalista, anti-imigra√ß√£o e islamof√≥bico. Obteve 7,07% com candidatura pol√™mica.", ideologia:"Ultranacionalismo / Identitarismo"}
        },
        regions:[
            {id:'IDF', n:'√éle-de-France',           x:52,y:35, p:18, econ:2,  soc:2,  nat:-2},
            {id:'SUD', n:'PACA/Sul',                x:55,y:78, p:12, econ:1,  soc:-1, nat:1},
            {id:'OUE', n:'Bretagne/Pays de la Loire',x:20,y:45, p:10, econ:0,  soc:1,  nat:0},
            {id:'GRE', n:'Grand Est',               x:65,y:40, p:11, econ:0,  soc:-1, nat:1},
            {id:'AUV', n:'Auvergne/Centre',         x:40,y:55, p:9,  econ:0,  soc:0,  nat:0},
            {id:'AQU', n:'Nouvelle-Aquitaine',      x:25,y:65, p:10, econ:0,  soc:1,  nat:0},
            {id:'NOR', n:'Normandie/Nord',          x:35,y:22, p:12, econ:-1, soc:-1, nat:1},
            {id:'DOM', n:'DOM-TOM',                 x:10,y:85, p:3,  econ:-2, soc:1,  nat:0},
            {id:'OCC', n:'Occitanie',               x:40,y:75, p:7,  econ:-1, soc:1,  nat:0}
        ]
    },
    "POR2026": {
        title:"Elei√ß√µes Presidenciais de Portugal 2026", year:"2026", emoji:"üáµüáπ",
        country:"portugal",
        desc:"Seguro vs Ventura vs Gouveia e Melo. Portugal polarizado.",
        available:true,
        isElectoralCollege:false,
        noSecondRound:false,
        newsHeader:"P√∫blico / Expresso ‚Äî JANEIRO 2026",
        endYear:"2026",
        partyPoolOverride:[{n:"PS",side:"E",owner:null},{n:"CHEGA",side:"D",owner:null},{n:"IL",side:"C",owner:null}],
        candidates:{
            seguro:  {name:"SEGURO",     party:"PS",    start:28, money:40, side:"E", color:"#e91e8c", econ:-1, soc:2, nat:-1, bio:"Ant√≥nio Jos√© Seguro, hist√≥rico do Partido Socialista e ex-vice-presidente, retorna √† pol√≠tica para disputar a presid√™ncia com discurso europe√≠sta e social-democrata.", ideologia:"Social-Democracia Europeia"},
            ventura: {name:"VENTURA",    party:"CHEGA", start:24, money:35, side:"D", color:"#003366", econ:1, soc:-2, nat:2, bio:"Andr√© Ventura, l√≠der do CHEGA, partido de direita populista que cresceu explosivamente nas elei√ß√µes legislativas de 2024. Discurso anti-imigra√ß√£o, anti-corrup√ß√£o e populista.", ideologia:"Populismo de Direita / Conservadorismo Nacional"},
            cotrim:  {name:"COTRIM",     party:"IL",    start:18, money:30, side:"C", color:"#ff6600", econ:2, soc:1, nat:-1, bio:"Jo√£o Cotrim de Figueiredo, l√≠der da Iniciativa Liberal, defensor do Estado m√≠nimo, livre-mercado e liberdades individuais. Apelo √† classe m√©dia urbana e jovens liberais.", ideologia:"Liberalismo Cl√°ssico / Libertarianismo"},
            gouveia: {name:"GOUVEIA E MELO", party:"Ind.", start:22, money:25, side:"C", color:"#1a5276", econ:0, soc:0, nat:1, bio:"Henrique Gouveia e Melo, almirante da Marinha portuguesa e figura ic√¥nica da vacina√ß√£o em massa contra a COVID-19. Candidato independente com forte apelo √† credibilidade institucional e perfil apartid√°rio.", ideologia:"Centro T√©cnico-Institucionalista / Independente"}
        },
        regions:[
            {id:'LIS', n:'Lisboa e Vale do Tejo',  x:20,y:72, p:38, econ:2,  soc:1,  nat:0},
            {id:'NOR', n:'Norte (Porto/Braga)',     x:22,y:20, p:25, econ:0,  soc:-1, nat:1},
            {id:'CEN', n:'Centro (Coimbra/Aveiro)', x:25,y:45, p:12, econ:0,  soc:0,  nat:0},
            {id:'ALE', n:'Alentejo',               x:28,y:82, p:6,  econ:-1, soc:-1, nat:1},
            {id:'ALG', n:'Algarve',                x:25,y:92, p:5,  econ:1,  soc:0,  nat:0},
            {id:'AZO', n:'A√ßores',                 x:2, y:65, p:5,  econ:-1, soc:0,  nat:1},
            {id:'MAD', n:'Madeira',                x:2, y:85, p:5,  econ:0,  soc:-1, nat:1},
            {id:'SET', n:'Set√∫bal/Margem Sul',     x:23,y:78, p:4,  econ:-1, soc:1,  nat:0}
        ]
    },
    // ‚îÄ‚îÄ NOVOS PA√çSES v13 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    "VEN2024": {
        title:"Elei√ß√µes Presidenciais da Venezuela 2024", year:"2024", emoji:"üáªüá™",
        country:"venezuela",
        desc:"Maduro busca reelei√ß√£o em elei√ß√£o contestada. Gonz√°lez lidera oposi√ß√£o unificada com plataforma PUD. Elei√ß√£o marcada por den√∫ncias de fraude e press√£o internacional.",
        available:true,
        noSecondRound:true,
        newsHeader:"El Nacional ‚Äî JULIO 2024",
        endYear:"2024",
        partyPoolOverride:[{n:"PSUV",side:"D",owner:null},{n:"PUD",side:"E",owner:null},{n:"EXM",side:"C",owner:null}],
        specialMechanic:"contested_election",
        candidates:{
            maduro:   {name:"MADURO",   party:"PSUV",  start:42, money:80, side:"D", color:"#cc0000", econ:-1,soc:1, nat:2, bio:"Nicol√°s Maduro, presidente desde 2013, herdeiro de Hugo Ch√°vez. Reeleito em 2018 em elei√ß√£o n√£o reconhecida pelo Ocidente. Em 2024, enfrenta a maior oposi√ß√£o unificada em anos. O CNE proclamou sua reelei√ß√£o, mas oposi√ß√£o e comunidade internacional contestaram os resultados.", ideologia:"Socialismo Bolivariano / Chavismo", traits:["Controle do Aparato Estatal","Apoio Militar"], negativeTraits:["Crise Econ√¥mica Profunda","Emigra√ß√£o de 7 Milh√µes","Suspeita de Fraude Eleitoral","Reconhecimento Internacional Limitado"]},
            gonzalez: {name:"GONZ√ÅLEZ", party:"PUD",   start:52, money:20, side:"E", color:"#003399", econ:1, soc:1, nat:-1,bio:"Edmundo Gonz√°lez Urrutia, ex-embaixador e candidato √∫nico da Plataforma Unitaria Democr√°tica. Coordenado por Mar√≠a Corina Machado, obteve apoio massivo da popula√ß√£o. A oposi√ß√£o declarou vit√≥ria com 67% dos votos, mas o CNE proclamou Maduro vencedor. Gonz√°lez foi para o ex√≠lio.", ideologia:"Democracia Liberal / Oposi√ß√£o Democr√°tica", traits:["Apoio Popular Amplo","Suporte de Machado","Reconhecimento Internacional"], negativeTraits:["Sem Acesso ao Aparato Estatal","Persegui√ß√£o Governamental"]},
            bertucci: {name:"BERTUCCI", party:"EXM",   start:4,  money:10, side:"C", color:"#ff8800", econ:0, soc:0, nat:1, bio:"Javier Bertucci, pastor evang√©lico e empres√°rio. J√° disputou em 2018. Em 2024 representa a terceira via entre chavismo e oposi√ß√£o unificada.", ideologia:"Evang√©lico / Centro Independente", traits:["Base Evang√©lica"], negativeTraits:["Percebido como Candidato de Ocasi√£o","Pouco Reconhecimento Nacional"]}
        },
        regions:[
            {id:'CAR', n:'Caracas e Miranda',        x:58,y:28, p:22, econ:1,  soc:0,  nat:0},
            {id:'ZUL', n:'Zulia (Maracaibo)',         x:22,y:18, p:18, econ:2,  soc:-1, nat:1},
            {id:'CAR2',n:'Carabobo (Valencia)',       x:42,y:30, p:12, econ:1,  soc:-1, nat:0},
            {id:'AND', n:'Andes (M√©rida/T√°chira)',   x:28,y:42, p:10, econ:-1, soc:-2, nat:1},
            {id:'LLA', n:'Los Llanos (Barinas/Gu√°r)',x:48,y:48, p:10, econ:-2, soc:1,  nat:2},
            {id:'ORI', n:'Oriente (Anzo√°tegui/Monagas)',x:72,y:38,p:12,econ:2, soc:-1, nat:1},
            {id:'BOL', n:'Bol√≠var (Minera√ß√£o)',       x:62,y:55, p:8,  econ:0,  soc:-1, nat:2},
            {id:'CEN', n:'Centro (Aragua/Gu√°rico)',   x:50,y:35, p:6,  econ:-1, soc:0,  nat:1},
            {id:'OCE', n:'Occidente (Barquisimeto)',  x:32,y:28, p:8,  econ:0,  soc:-1, nat:1},
            {id:'INS', n:'Insular (Nueva Esparta)',   x:78,y:22, p:4,  econ:1,  soc:0,  nat:0}
        ]
    },
    "MEX2024": {
        title:"Elei√ß√µes Presidenciais do M√©xico 2024", year:"2024", emoji:"üá≤üáΩ",
        country:"mexico",
        desc:"Sheinbaum, delfina de AMLO, enfrenta G√°lvez pelo PAN/PRI/PRD e M√°ynez pelo Movimiento Ciudadano. M√©xico vive elei√ß√£o hist√≥rica com candidata presidencial favorita.",
        available:true,
        noSecondRound:true,
        newsHeader:"El Universal ‚Äî JUNIO 2024",
        endYear:"2024",
        partyPoolOverride:[{n:"Morena",side:"E",owner:null},{n:"PAN",side:"D",owner:null},{n:"MC",side:"C",owner:null}],
        candidates:{
            sheinbaum:{name:"SHEINBAUM",party:"Morena",start:59, money:70, side:"E", color:"#8b0000", econ:-1,soc:2, nat:0, bio:"Claudia Sheinbaum, ex-prefeita da CDMX e doutora em engenharia ambiental. Escolhida por AMLO como sua sucessora e confirmada com 59% dos votos ‚Äî vit√≥ria hist√≥rica. Primeira mulher eleita presidente do M√©xico. Mant√©m pol√≠tica social de AMLO com tom mais t√©cnico.", ideologia:"Social-Democracia / Obradorismo / Progressismo", traits:["Herdeira de AMLO","Perfil T√©cnico-Cient√≠fico","Apelo √†s Mulheres"], negativeTraits:["Associada aos Erros do Governo","Depend√™ncia do Legado de AMLO"]},
            galvez:   {name:"G√ÅLVEZ",    party:"PAN",   start:28, money:50, side:"D", color:"#003399", econ:2, soc:-1, nat:0, bio:"X√≥chitl G√°lvez, senadora e empres√°ria do Vale do Mezquital. Candidata da alian√ßa PAN-PRI-PRD (Frente Amplia). De origem ind√≠gena, discurso anti-AMLO e pr√≥-mercado. Perdeu com 28% dos votos.", ideologia:"Liberalismo Conservador / Centro-Direita", traits:["Origem Humilde como Narrativa","Alian√ßa Ampla"], negativeTraits:["Associada ao PRI Hist√≥rico","Fragmenta√ß√£o da Alian√ßa"]},
            maynez:   {name:"M√ÅYNEZ",    party:"MC",    start:10, money:20, side:"C", color:"#ff6600", econ:0, soc:1, nat:-1,bio:"Jorge M√°ynez, senador pelo Movimiento Ciudadano do Jalisco. Candidato jovem e moderado, buscou terceira via entre Morena e direita. Obteve 10% ‚Äî melhor resultado do MC numa presidencial.", ideologia:"Centrismo Progressista / Social-Liberalismo", traits:["Apelo aos Jovens","Terceira Via"], negativeTraits:["Sem Massa Cr√≠tica Nacional","Partido Regional"]}
        },
        regions:[
            {id:'CDM', n:'CDMX / √Årea Metropolitana', x:52,y:52, p:20, econ:2,  soc:2,  nat:-1},
            {id:'JAL', n:'Jalisco (Guadalajara)',      x:32,y:42, p:10, econ:1,  soc:0,  nat:0},
            {id:'NUL', n:'Nuevo Le√≥n (Monterrey)',     x:48,y:22, p:9,  econ:2,  soc:-1, nat:0},
            {id:'VER', n:'Veracruz e Golfo',           x:62,y:50, p:9,  econ:-1, soc:1,  nat:1},
            {id:'PUE', n:'Puebla e Hidalgo',           x:58,y:52, p:8,  econ:-1, soc:1,  nat:0},
            {id:'OAX', n:'Oaxaca e Chiapas (Sul)',     x:58,y:68, p:8,  econ:-2, soc:2,  nat:2},
            {id:'GUA', n:'Guanajuato e Baj√≠o',         x:42,y:45, p:7,  econ:1,  soc:-1, nat:1},
            {id:'SIN', n:'Sinaloa e Pacifico',         x:22,y:32, p:5,  econ:0,  soc:-1, nat:2},
            {id:'YUC', n:'Yucat√°n / Pen√≠nsula',        x:72,y:52, p:5,  econ:0,  soc:0,  nat:0},
            {id:'CHH', n:'Chihuahua e Norte',          x:32,y:15, p:5,  econ:1,  soc:-2, nat:1},
            {id:'GRO', n:'Guerrero e Michoac√°n',       x:42,y:60, p:5,  econ:-2, soc:1,  nat:2},
            {id:'TAM', n:'Tamaulipas e Fronteira NE',  x:52,y:18, p:4,  econ:0,  soc:-1, nat:1},
            {id:'BCN', n:'Baja California e NW',       x:10,y:18, p:4,  econ:1,  soc:0,  nat:0},
            {id:'ZAC', n:'Zacatecas / San Luis / Aguasc.',x:38,y:35,p:4, econ:-1,soc:-1, nat:1}
        ]
    },
    "CHI2025": {
        title:"Elei√ß√µes Presidenciais do Chile 2025", year:"2025", emoji:"üá®üá±",
        country:"chile",
        desc:"Kast (direita radical) vs Jara (comunista). Chile polarizado ap√≥s o plebiscito constitucional. Elei√ß√£o decide o rumo do pa√≠s p√≥s-Boric.",
        available:true,
        noSecondRound:false,
        newsHeader:"La Tercera / El Mercurio ‚Äî NOVIEMBRE 2025",
        endYear:"2025",
        partyPoolOverride:[{n:"Rep",side:"D",owner:null},{n:"PC-Chile",side:"E",owner:null},{n:"RN",side:"D",owner:null}],
        candidates:{
            kast: {name:"KAST",  party:"Republicano",start:32, money:45, side:"D", color:"#003366", econ:2,soc:-2, nat:2, bio:"Jos√© Antonio Kast, ex-deputado e fundador do Partido Republicano. Perdeu o 2¬∫ turno de 2021 para Boric. Retorna em 2025 como principal candidato da direita dura, com discurso anti-imigra√ß√£o, pr√≥-livre mercado e valores conservadores. Refer√™ncia da nova direita latino-americana.", ideologia:"Conservadorismo Nacional / Direita Radical", traits:["Consist√™ncia Ideol√≥gica","Base Conservadora Fiel"], negativeTraits:["Percebido como Extremista","Compara√ß√µes com Pinochet"]},
            jara: {name:"JARA",  party:"PC Chile",  start:28, money:35, side:"E", color:"#cc0000", econ:-2,soc:2, nat:0, bio:"Jeannette Jara, ex-ministra do Trabalho de Gabriel Boric. Candidata do Partido Comunista e do pacto Unidad para Chile. Defende amplia√ß√£o das reformas sociais e um novo modelo de previd√™ncia. Representa a continuidade e aprofundamento do projeto de Boric.", ideologia:"Comunismo / Socialismo Democr√°tico", traits:["Experi√™ncia Ministerial","Apoio de Boric"], negativeTraits:["Associada ao Desgaste do Governo","Partido Comunista como Peso"]},
            matthei:{name:"MATTHEI",party:"RN/UDI",start:25, money:40, side:"D", color:"#0066cc", econ:1,soc:-1, nat:1, bio:"Evelyn Matthei, prefeita de Providencia e candidata da alian√ßa Chile Vamos. Filho do general Matthei, representa a direita tradicional moderada, distante do radicalismo de Kast.", ideologia:"Liberalismo Conservador / Direita Moderada", traits:["Gest√£o Municipal S√≥lida","Apelo ao Centro"], negativeTraits:["Disputada com Kast pelo mesmo eleitorado","Heran√ßa Familiar Controversa"]},
            narvaez:{name:"NARVAEZ",party:"PPD/PS",start:10, money:20, side:"E", color:"#e84393", econ:-1,soc:2, nat:0, bio:"Ximena Narv√°ez, candidata da esquerda moderada e do Chile Digno. Busca o eleitorado desiludido com Boric mas que n√£o quer Kast.", ideologia:"Social-Democracia / Progressismo", traits:["Perfil Carism√°tico"], negativeTraits:["Sombra de Boric","Eleitorado Fragmentado"]}
        },
        regions:[
            {id:'RM',  n:'Regi√£o Metropolitana (Santiago)', x:42,y:68, p:40, econ:2,  soc:1,  nat:-1},
            {id:'BI',  n:"Bio-B√≠o e √ëuble",                x:38,y:78, p:12, econ:0,  soc:-1, nat:0},
            {id:'LA',  n:'La Araucan√≠a (Mapuche)',          x:36,y:83, p:7,  econ:-2, soc:-1, nat:2},
            {id:'VA',  n:'Valpara√≠so',                      x:38,y:65, p:10, econ:1,  soc:1,  nat:0},
            {id:'OH',  n:"O'Higgins e Maule",               x:40,y:72, p:8,  econ:-1, soc:-1, nat:1},
            {id:'CO',  n:'Coquimbo e Atacama (Norte)',      x:35,y:45, p:5,  econ:1,  soc:-1, nat:1},
            {id:'AN',  n:'Antofagasta e Tarapac√° (Extremo Norte)', x:30,y:28, p:5, econ:2, soc:-2, nat:1},
            {id:'LO',  n:'Los R√≠os e Los Lagos (Sul)',      x:35,y:88, p:7,  econ:-1, soc:0,  nat:1},
            {id:'MA',  n:'Magallanes e Ays√©n (Extremo Sul)',x:32,y:96, p:3,  econ:0,  soc:0,  nat:2},
            {id:'AI',  n:'Arica e Parinacota / Tarapac√°',  x:28,y:18, p:3,  econ:0,  soc:1,  nat:1}
        ]
    },
    "COL2026": {
        title:"Elei√ß√µes Presidenciais da Col√¥mbia 2026", year:"2026", emoji:"üá®üá¥",
        country:"colombia",
        desc:"Cepeda (Pacto Hist√≥rico de Petro) vs De la Espriella (independente) vs Fajardo (Centro) vs Valencia (Centro Democr√°tico). Colombia decide o futuro p√≥s-Petro.",
        available:true,
        noSecondRound:false,
        newsHeader:"El Tiempo / El Espectador ‚Äî MAYO 2026",
        endYear:"2026",
        partyPoolOverride:[{n:"PH",side:"E",owner:null},{n:"CD",side:"D",owner:null},{n:"DC",side:"C",owner:null}],
        candidates:{
            cepeda:   {name:"CEPEDA",     party:"Pacto H.", start:28, money:40, side:"E", color:"#cc0000", econ:-1,soc:2, nat:0, bio:"Iv√°n Cepeda Castro, senador hist√≥rico de esquerda e filho do jornalista Manuel Cepeda assassinado por paramilitares. Candidato do Pacto Hist√≥rico para suceder Gustavo Petro. Defende amplia√ß√£o dos programas sociais, paz total e reforma agr√°ria.", ideologia:"Socialismo Democr√°tico / Petrorismo", traits:["Defensor dos Direitos Humanos","Continuidade de Petro"], negativeTraits:["Associado ao Desgaste de Petro","Imagem Polarizadora"]},
            espriella:{name:"ESPRIELLA",  party:"Ind.",     start:24, money:35, side:"C", color:"#228B22", econ:1, soc:0, nat:1, bio:"Abelardo de la Espriella, ex-senador e advogado criminalista de Barranquilla. Candidato independente do Caribe colombiano, defende pragmatismo, seguran√ßa e combate √† corrup√ß√£o sem os extremos ideol√≥gicos.", ideologia:"Independente / Centro Pragm√°tico", traits:["Perfil Regional Forte","Imagem Apartid√°ria"], negativeTraits:["Pouco Reconhecimento Nacional","Sem Estrutura Partid√°ria"]},
            fajardo:  {name:"FAJARDO",    party:"DC",       start:22, money:30, side:"C", color:"#4444cc", econ:0, soc:1, nat:-1,bio:"Sergio Fajardo, ex-prefeito de Medell√≠n e ex-governador de Antioquia. Refer√™ncia da pol√≠tica de transforma√ß√£o urbana e educa√ß√£o. Candidato da Dignidad y Compromiso, busca o eleitorado de centro desiludido tanto com Petro quanto com a direita tradicional.", ideologia:"Centro Democr√°tico / Tecnocracia Progressista", traits:["Transforma√ß√£o de Medell√≠n como Marca","Apelo ao Voto Independente"], negativeTraits:["J√° Perdeu Tr√™s Elei√ß√µes Presidenciais","Percebido como Candidato Eterno"]},
            valencia: {name:"VALENCIA",   party:"CD",       start:22, money:38, side:"D", color:"#003366", econ:2, soc:-2, nat:2, bio:"Paloma Valencia, senadora do Centro Democr√°tico e pr√≥xima de √Ålvaro Uribe. Candidata da direita uribista, defende seguran√ßa dura, livre mercado e combate √†s FARC. Principal voz da oposi√ß√£o ao petrorismo.", ideologia:"Uribismo / Conservadorismo / Seguran√ßa Dura", traits:["Base Uribista Fiel","Discurso de Seguran√ßa"], negativeTraits:["Percebida como Extremista","Associada ao Legado Controverso de Uribe"]}
        },
        regions:[
            {id:'CUN', n:'Bogot√° e Cundinamarca',           x:42,y:55, p:22, econ:2,  soc:1,  nat:-1},
            {id:'ANT', n:'Antioquia (Medell√≠n)',             x:30,y:40, p:16, econ:1,  soc:-1, nat:1},
            {id:'VCA', n:'Valle del Cauca (Cali)',           x:22,y:52, p:11, econ:1,  soc:0,  nat:0},
            {id:'CAR', n:'Caribe (Barranquilla/Cartagena)',  x:42,y:18, p:15, econ:0,  soc:1,  nat:1},
            {id:'SAN', n:'Santander e Norte de Santander',  x:52,y:32, p:7,  econ:0,  soc:-1, nat:1},
            {id:'TOL', n:'Tolima e Huila',                  x:38,y:58, p:5,  econ:-1, soc:-1, nat:2},
            {id:'NAR', n:'Nari√±o e Cauca (Pac√≠fico Sul)',   x:22,y:68, p:5,  econ:-2, soc:2,  nat:2},
            {id:'COR', n:'C√≥rdoba e Sucre',                 x:32,y:25, p:5,  econ:-2, soc:0,  nat:1},
            {id:'META',n:'Meta e Llanos Orientais',          x:55,y:58, p:4,  econ:0,  soc:-1, nat:2},
            {id:'BOY', n:'Boyac√° e Caldas',                 x:45,y:43, p:5,  econ:-1, soc:-1, nat:1},
            {id:'AMA', n:'Amaz√¥nia e Orinoqu√≠a',            x:60,y:72, p:5,  econ:-2, soc:0,  nat:2}
        ]
    },
    "CAN2025": {
        title:"Elei√ß√µes Federais do Canad√° 2025", year:"2025", emoji:"üá®üá¶",
        country:"canada",
        desc:"Carney (Liberal) vs Poilievre (Conservador) vs Singh (NDP) vs Blanchet (Bloco Qu√©bec). Elei√ß√£o federal canadense decide PM ap√≥s sa√≠da de Trudeau.",
        available:true,
        noSecondRound:true,
        isParliamentary:true,
        parliamentSeats:343,
        majoritySeats:172,
        newsHeader:"The Globe and Mail / Le Devoir ‚Äî APRIL 2025",
        endYear:"2025",
        partyPoolOverride:[{n:"Liberal",side:"E",owner:null},{n:"Conserv.",side:"D",owner:null},{n:"NDP",side:"E",owner:null},{n:"BQ",side:"C",owner:null}],
        candidates:{
            carney:    {name:"CARNEY",    party:"Liberal",  start:41, money:60, side:"E", color:"#cc0000", econ:1,soc:2, nat:-1,bio:"Mark Carney, ex-presidente do Banco do Canad√° e do Banco da Inglaterra. Assumiu a lideran√ßa Liberal ap√≥s Justin Trudeau e liderou o partido a uma surpreendente vit√≥ria impulsionada em parte pela amea√ßa tarif√°ria de Trump. Primeira elei√ß√£o como pol√≠tico ap√≥s d√©cadas como tecnocrata.", ideologia:"Social-Liberalismo / Tecnocracia Progressista", traits:["Credibilidade Econ√¥mica","Anti-Trump como Narrativa"], negativeTraits:["Nunca Exerceu Cargo Eletivo","Associado ao Legado de Trudeau"]},
            poilievre: {name:"POILIEVRE", party:"Conserv.", start:40, money:65, side:"D", color:"#003399", econ:2,soc:-1, nat:1, bio:"Pierre Poilievre, l√≠der conservador desde 2022. Campanha focada no custo de vida, habita√ß√£o e cr√≠tica √† pol√≠tica econ√¥mica de Trudeau. Liderou as pesquisas por meses mas perdeu a elei√ß√£o impulsionada pelo contexto geopol√≠tico Trump/Tarifas.", ideologia:"Conservadorismo Econ√¥mico / Populismo de Direita", traits:["Comunicador Afiado","Base Conservadora Fiel"], negativeTraits:["Radicalismo Percebido","Associa√ß√£o com Trumpismo"]},
            blanchet:  {name:"BLANCHET",  party:"BQ",       start:8,  money:20, side:"C", color:"#4444cc", econ:0,soc:1, nat:3, bio:"Yves-Fran√ßois Blanchet, l√≠der do Bloc Qu√©b√©cois. Partido soberanista que defende os interesses de Qu√©bec no Parlamento federal. Fiel √†s causas quebequenses: l√≠ngua francesa, cultura, autonomia.", ideologia:"Soberanismo Quebequense / Nacionalismo Cultural", traits:["Defensor Vocal do Qu√©bec","Orat√≥ria Excepcional"], negativeTraits:["Partido Regional ‚Äî Sem Governo Nacional","Teto Eleitorado Limitado ao Qu√©bec"]},
            singh:     {name:"SINGH",     party:"NDP",      start:7,  money:25, side:"E", color:"#f4821f", econ:-1,soc:2, nat:-1,bio:"Jagmeet Singh, l√≠der do Novo Partido Democr√°tico desde 2017. Primeiro l√≠der de grande partido federal de origem sikh. Apoiou o governo Liberal com acordo de confian√ßa, mas rompeu em 2024. Candidato da esquerda trabalhista e de minorias.", ideologia:"Social-Democracia / Trabalhismo / Progressismo", traits:["Diversidade e Representatividade","Apelo a Jovens e Minoriais"], negativeTraits:["NDP com Teto Hist√≥rico","Criticado por Apoiar Trudeau por Tempo Demais"]}
        },
        regions:[
            {id:'ON',  n:'Ontario (Toronto/Ottawa)',       x:62,y:52, p:38, econ:2,  soc:1,  nat:0},
            {id:'QC',  n:'Qu√©bec (Montr√©al/Qu√©bec City)', x:72,y:42, p:23, econ:0,  soc:2,  nat:2},
            {id:'BC',  n:'Col√∫mbia Brit√¢nica (Vancouver)',x:12,y:42, p:13, econ:1,  soc:2,  nat:0},
            {id:'AB',  n:'Alberta (Calgary/Edmonton)',     x:28,y:38, p:11, econ:2,  soc:-2, nat:2},
            {id:'MB',  n:'Manitoba (Winnipeg)',            x:45,y:40, p:4,  econ:0,  soc:0,  nat:1},
            {id:'SK',  n:'Saskatchewan (Regina)',          x:35,y:38, p:3,  econ:1,  soc:-1, nat:1},
            {id:'ATL', n:'Atl√¢ntico (NS/NB/PEI/NL)',      x:85,y:48, p:6,  econ:-1, soc:1,  nat:0},
            {id:'NTH', n:'Territ√≥rios (YT/NT/NU)',         x:22,y:18, p:2,  econ:-1, soc:0,  nat:2}
        ]
    },
    // ‚îÄ‚îÄ NOVOS PA√çSES v14 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    "UKR2019": {
        title:"Elei√ß√£o Presidencial da Ucr√¢nia 2019", year:"2019", emoji:"üá∫üá¶",
        country:"ukraine",
        desc:"Zelensky, ator e comediante sem experi√™ncia pol√≠tica, surpreende o mundo ao derrotar Poroshenko. Tymoshenko tenta o retorno. Ucr√¢nia p√≥s-Maidan em busca de renova√ß√£o.",
        available:true,
        noSecondRound:false,
        newsHeader:"Ukrainska Pravda ‚Äî –ö–í–Ü–¢–ï–ù–¨ 2019",
        endYear:"2019",
        partyPoolOverride:[{n:"SN",side:"C",owner:null},{n:"Ind.",side:"D",owner:null},{n:"Bat.",side:"E",owner:null}],
        candidates:{
            zelensky:    {name:"ZELENSKY",    party:"SN",  start:30, money:40, side:"C", color:"#0057b7", econ:0, soc:1, nat:1, bio:"Volodymyr Zelensky, ator e produtor, famoso pelo seriado 'Servo do Povo' onde interpretava um presidente. Venceu o 1¬∫ turno com 30% e o 2¬∫ turno com 73% contra Poroshenko. Simbolizava renova√ß√£o e luta contra a corrup√ß√£o.", ideologia:"Centrismo / Reformismo Anti-Corrup√ß√£o", traits:["Carisma Popular","Renova√ß√£o Total","Anti-Establishment"], negativeTraits:["Sem Experi√™ncia Pol√≠tica","Programa Vago"]},
            poroshenko:  {name:"POROSHENKO",  party:"Ind.", start:24, money:70, side:"D", color:"#FFD700", econ:2, soc:-1, nat:2, bio:"Petro Poroshenko, presidente incumbente desde 2014. Governou durante a guerra no Donbas e a perda da Crimeia. Candidato pr√≥-europeu e anti-R√∫ssia, mas impopular pela corrup√ß√£o e enriquecimento pessoal durante a guerra.", ideologia:"Liberalismo / Conservadorismo Nacional / Pr√≥-UE", traits:["Incumbente ‚Äî Controle do Estado","Narrativa de Guerra e Sacrif√≠cio"], negativeTraits:["Corrup√ß√£o Percebida","Fracasso no Fim da Guerra","Impopularidade Alta"]},
            tymoshenko:  {name:"TYMOSHENKO",  party:"Bat.", start:15, money:35, side:"E", color:"#cc0000", econ:-1,soc:2, nat:1, bio:"Yulia Tymoshenko, ex-primeira-ministra e √≠cone da Revolu√ß√£o Laranja. Tentou voltar ao poder com discurso social e anti-oligarquia. Ficou em 3¬∫ no 1¬∫ turno.", ideologia:"Populismo / Social-Democracia / Pr√≥-UE", traits:["L√≠der Hist√≥rica","Apelo Feminino e Jovem"], negativeTraits:["Desgaste Pol√≠tico de D√©cadas","Percebida como Parte do Sistema"]}
        },
        regions:[
            {id:'KYV', n:'Kyiv e Oblast de Kyiv',           x:55,y:30, p:15, econ:2,  soc:1,  nat:0},
            {id:'KHR', n:'Kharkiv (Leste)',                  x:72,y:25, p:10, econ:1,  soc:0,  nat:-1},
            {id:'DNI', n:'Dnipro / Zaporizhzhia',           x:68,y:45, p:12, econ:1,  soc:-1, nat:0},
            {id:'DON', n:'Donbas (Donetsk/Luhansk)',        x:78,y:38, p:8,  econ:-1, soc:-1, nat:-2},
            {id:'ODE', n:'Odessa (Sul)',                     x:52,y:62, p:8,  econ:0,  soc:0,  nat:0},
            {id:'LVI', n:'Lviv / Gal√≠cia (Oeste)',           x:25,y:28, p:10, econ:0,  soc:1,  nat:2},
            {id:'VIN', n:'Vinnytsia / Pod√≥llia (Centro)',   x:42,y:40, p:8,  econ:-1, soc:0,  nat:1},
            {id:'ZAK', n:'Zakarpattia / Chernivtsi',        x:18,y:42, p:5,  econ:-2, soc:0,  nat:2},
            {id:'POL', n:'Poltava / Sumy (Centro-Leste)',   x:63,y:32, p:6,  econ:-1, soc:0,  nat:1},
            {id:'MYK', n:'Mykolaiv / Kherson',              x:58,y:60, p:6,  econ:-1, soc:-1, nat:0},
            {id:'CRI', n:'Crimeia (Ocupada)',                x:62,y:70, p:2,  econ:0,  soc:-2, nat:-2}
        ]
    },
    "ESP2023": {
        title:"Elei√ß√µes Gerais da Espanha 2023", year:"2023", emoji:"üá™üá∏",
        country:"spain",
        desc:"Feij√≥o lidera PP √† vit√≥ria relativa, mas sem maioria. S√°nchez busca governabilidade com coaliz√£o ampla. Abascal (Vox) avan√ßa pela direita radical. D√≠az representa nova esquerda.",
        available:true,
        noSecondRound:true,
        isParliamentary:true,
        parliamentSeats:350,
        majoritySeats:176,
        newsHeader:"El Pa√≠s / El Mundo ‚Äî JULIO 2023",
        endYear:"2023",
        partyPoolOverride:[{n:"PP",side:"D",owner:null},{n:"PSOE",side:"E",owner:null},{n:"Vox",side:"D",owner:null},{n:"Sumar",side:"E",owner:null}],
        candidates:{
            feijoo:   {name:"FEIJ√ìO",   party:"PP",    start:33, money:65, side:"D", color:"#0056A2", econ:2, soc:-1, nat:0, bio:"Alberto N√∫√±ez Feij√≥o, ex-presidente da Gal√≠cia por 12 anos. Ganhou o maior n√∫mero de votos (33%) e assentos (137), mas n√£o conseguiu maioria para governar. Sua indica√ß√£o para PM foi rejeitada pelo Congresso.", ideologia:"Democracia Crist√£ / Conservadorismo Liberal", traits:["Gest√£o Galega Aclamada","Perfil Moderado"], negativeTraits:["Alian√ßa Dif√≠cil com Vox","Sem Maioria Parlamentar"]},
            sanchez:  {name:"S√ÅNCHEZ",  party:"PSOE",  start:29, money:60, side:"E", color:"#cc0000", econ:-1,soc:2, nat:-1, bio:"Pedro S√°nchez, presidente do governo desde 2018. Apesar de obter menos votos que o PP no 1T, conseguiu maioria parlamentar com Sumar, partidos independentistas e regionais. Reeleito PM em novembro de 2023.", ideologia:"Social-Democracia / Progressismo / Plurinacionalismo", traits:["Articulador Pol√≠tico Habilidoso","Alian√ßa com Independentistas"], negativeTraits:["Pol√™mica com Catalunha","Desgaste de Cinco Anos"]},
            abascal:  {name:"ABASCAL",  party:"Vox",   start:13, money:35, side:"D", color:"#63BE21", econ:1, soc:-2, nat:2, bio:"Santiago Abascal, l√≠der do Vox. Partido de extrema-direita que defende unidade espanhola intransigente, anti-imigra√ß√£o e tradi√ß√µes cat√≥licas. Perdeu assentos em rela√ß√£o a 2019 mas manteve relev√¢ncia.", ideologia:"Ultranacionalismo / Conservadorismo Social Extremo", traits:["Base Identit√°ria Fiel","Anti-Imigra√ß√£o Vocal"], negativeTraits:["Percebido como Extremista","Alian√ßa Dificulta PP"]},
            diaz:     {name:"D√çAZ",     party:"Sumar",  start:13, money:30, side:"E", color:"#8B1C8B", econ:-2,soc:2, nat:-1, bio:"Yolanda D√≠az, ex-ministra do Trabalho e arquiteta da reforma trabalhista espanhola. Liderou a plataforma Sumar ‚Äî unindo toda a esquerda al√©m do PSOE. Obteve 31 assentos, tornando-se parceira indispens√°vel de S√°nchez.", ideologia:"Socialismo / Ecosocialismo / Feminismo", traits:["Reforma Trabalhista como Trunfo","Coaliz√£o de Esquerda Ampla"], negativeTraits:["Plataforma Nova sem Consolida√ß√£o","Tens√£o Interna na Coaliz√£o"]}
        },
        regions:[
            {id:'CAT', n:'Catalunha (Barcelona)',          x:82,y:25, p:15, econ:2,  soc:2,  nat:2},
            {id:'AND', n:'Andaluzia (Sevilha/M√°laga)',     x:38,y:82, p:19, econ:-1, soc:-1, nat:0},
            {id:'MAD', n:'Comunidade de Madrid',           x:52,y:48, p:14, econ:2,  soc:0,  nat:0},
            {id:'VAL', n:'Valenciana (Val√™ncia)',          x:68,y:55, p:11, econ:1,  soc:1,  nat:1},
            {id:'GAL', n:'Gal√≠cia (Santiago)',             x:20,y:22, p:7,  econ:-1, soc:0,  nat:2},
            {id:'PVA', n:'Pa√≠s Basco (Bilbao)',            x:48,y:18, p:5,  econ:1,  soc:1,  nat:2},
            {id:'CAS', n:'Castilla-La Mancha / Le√≥n',     x:42,y:42, p:10, econ:-1, soc:-1, nat:0},
            {id:'ARA', n:'Arag√£o / Navarra / La Rioja',   x:62,y:28, p:6,  econ:0,  soc:0,  nat:1},
            {id:'EXT', n:'Extremadura / M√∫rcia',          x:32,y:65, p:7,  econ:-2, soc:-1, nat:0},
            {id:'ISL', n:'Ilhas Baleares / Can√°rias',     x:15,y:90, p:4,  econ:1,  soc:1,  nat:1},
            {id:'CEU', n:'Ceuta e Melilla',                x:38,y:95, p:1,  econ:-1, soc:-1, nat:1},
            {id:'AST', n:'Asturias / Cantabria',           x:38,y:18, p:3,  econ:-1, soc:0,  nat:1}
        ]
    },
    "JAP2026": {
        title:"Elei√ß√£o Presidencial do PLD ‚Äî Jap√£o 2026", year:"2026", emoji:"üáØüáµ",
        country:"japan",
        desc:"Crise de popularidade no PLD abre espa√ßo para alternativas. Takaichi lidera a direita conservadora. Noda reaparece pelo Kaikaku Chushin. Yoshimura pelo Ishin e Tamaki pelo DPP disputam o centro. Kamiya (Sanseito) e Anno (Equipe Mirai) representam extremos.",
        available:true,
        noSecondRound:true,
        isParliamentary:true,
        parliamentSeats:465,
        majoritySeats:233,
        newsHeader:"Asahi Shimbun ‚Äî 2026Âπ¥",
        endYear:"2026",
        partyPoolOverride:[{n:"PLD",side:"D",owner:null},{n:"Kaikaku",side:"C",owner:null},{n:"Ishin",side:"C",owner:null},{n:"DPP",side:"C",owner:null}],
        candidates:{
            takaichi:  {name:"TAKAICHI",  party:"PLD",     start:28, money:70, side:"D", color:"#cc0000", econ:1, soc:-2, nat:2, bio:"Sanae Takaichi, ex-ministra e l√≠der da ala Abe do PLD. Defensora de pol√≠ticas revisionistas hist√≥ricas, militariza√ß√£o e Abenomics. Seria a primeira primeira-ministra do Jap√£o se eleita.", ideologia:"Conservadorismo Nacional / Revisionismo Hist√≥rico", traits:["Ala Abe","Primeira Mulher PM se Eleita"], negativeTraits:["Associada ao Esc√¢ndalo Moeda Pol√≠tica","Revisionismo Pol√™mico"]},
            noda:      {name:"NODA",       party:"Kaikaku", start:22, money:45, side:"C", color:"#0044aa", econ:0, soc:1, nat:-1, bio:"Yoshihiko Noda, ex-primeiro-ministro pelo antigo DPJ. Voltou √† cena pol√≠tica pelo Kaikaku Chushin (Reforma Centrista), agregando moderados de diferentes partidos. Representa experi√™ncia governamental e modera√ß√£o.", ideologia:"Centrismo Liberal / Social-Democracia", traits:["Ex-PM Experiente","Coaliz√£o Moderada Ampla"], negativeTraits:["Associado √†s Derrotas do DPJ","Partido Novo sem Consolida√ß√£o"]},
            yoshimura: {name:"YOSHIMURA", party:"Ishin",   start:18, money:40, side:"C", color:"#FF6600", econ:2, soc:0, nat:0, bio:"Hirofumi Yoshimura, governador de Osaka e rosto do movimento Nippon Ishin no Kai. Popular√≠ssimo em Osaka pela gest√£o pragm√°tica. Defende descentraliza√ß√£o, reformas administrativas e identidade regional.", ideologia:"Reformismo Liberal / Descentraliza√ß√£o / Neo-Conservadorismo", traits:["Governador Popular de Osaka","Reformas Concretas"], negativeTraits:["Percebido como Regional","Sem Experi√™ncia Nacional"]},
            tamaki:    {name:"TAMAKI",    party:"DPP",     start:14, money:30, side:"C", color:"#33aa33", econ:0, soc:1, nat:0, bio:"Yuichiro Tamaki, l√≠der do Partido Democr√°tico do Povo. Cresceu expressivamente nas elei√ß√µes de 2024, com apelo entre jovens que buscam alternativas ao PLD sem ir √† esquerda.", ideologia:"Centrismo Progressista / Reformismo Econ√¥mico", traits:["Apelo √† Juventude","Anti-Establishment Moderado"], negativeTraits:["Partido Pequeno","Sem Massa Cr√≠tica Nacional"]},
            kamiya:    {name:"KAMIYA",    party:"Sanseito",start:9,  money:15, side:"D", color:"#880000", econ:0, soc:-2, nat:3, bio:"Sohei Kamiya, l√≠der do Sanseito, partido de direita ultranacionalista anti-imigra√ß√£o. Cresceu nas redes sociais com discurso de pureza cultural e ceticismo sobre globaliza√ß√£o.", ideologia:"Ultranacionalismo / Conservadorismo Cultural", traits:["Presen√ßa nas Redes Sociais"], negativeTraits:["Extremismo Percebido","Associado ao Revisionismo Extremo"]},
            anno:      {name:"ANNO",      party:"Equipe Mirai",start:6, money:10, side:"E", color:"#AA00AA", econ:-1,soc:2, nat:-1, bio:"Takahiro Anno, ativista e l√≠der do Equipe Mirai (Seiwa Mirai), partido progressista que defende direitos femininos, igualdade e sustentabilidade. Apelo urbano e jovem.", ideologia:"Progressismo / Feminismo / Sustentabilidade", traits:["Apelo Urbano Jovem"], negativeTraits:["Pouca Base Eleitorar","Partido em Desenvolvimento"]}
        },
        regions:[
            {id:'TKY', n:'T√≥quio (Metropolitano)',      x:72,y:42, p:11, econ:2,  soc:2,  nat:-1},
            {id:'OSA', n:'Osaka / Kinki (Kansai)',      x:58,y:52, p:16, econ:1,  soc:0,  nat:0},
            {id:'KAN', n:'Kanagawa / Yokohama',         x:72,y:46, p:9,  econ:2,  soc:1,  nat:0},
            {id:'CHU', n:'Chukyo (Nagoya/Aichi)',       x:62,y:50, p:8,  econ:2,  soc:0,  nat:0},
            {id:'HOK', n:'Hokkaido (Norte)',             x:72,y:12, p:6,  econ:-1, soc:1,  nat:0},
            {id:'TOH', n:'Tohoku (Nordeste)',            x:78,y:25, p:8,  econ:-1, soc:-1, nat:1},
            {id:'KYU', n:'Kyushu / Okinawa (Sul)',      x:38,y:75, p:13, econ:-1, soc:-1, nat:1},
            {id:'CHG', n:'Chugoku / Shikoku (Oeste)',   x:45,y:58, p:7,  econ:-1, soc:-1, nat:1},
            {id:'SHN', n:'Shinetsu / Kita-Kanto',       x:68,y:35, p:8,  econ:0,  soc:0,  nat:0},
            {id:'OKI', n:'Okinawa (Ilhas)',              x:28,y:88, p:1,  econ:-2, soc:2,  nat:-1},
            {id:'KIN', n:'Kinki Interior (Nara/Mie)',   x:58,y:56, p:6,  econ:0,  soc:-1, nat:0},
            {id:'HOK2',n:'Hokuriku / Chubu',            x:58,y:40, p:7,  econ:0,  soc:0,  nat:0}
        ]
    },
    "KOR2025": {
        title:"Elei√ß√£o Presidencial da Coreia do Sul 2025", year:"2025", emoji:"üá∞üá∑",
        country:"southkorea",
        desc:"Lee Jae-myung (Democr√°tico) vs Kim Moon-soo (Poder Popular) vs Lee Jun Seok (Reforma). Elei√ß√£o antecipada ap√≥s o impeachment de Yoon Suk-yeol pela tentativa de lei marcial em dezembro de 2024.",
        available:true,
        noSecondRound:false,
        noSecondRound:true,
        newsHeader:"JoongAng Ilbo ‚Äî 2025ÎÖÑ 6Ïõî",
        endYear:"2025",
        partyPoolOverride:[{n:"Democr√°tico",side:"E",owner:null},{n:"PPP",side:"D",owner:null},{n:"Reforma",side:"C",owner:null}],
        candidates:{
            lee_jm:    {name:"LEE JAE-MYUNG", party:"Democr√°tico", start:40, money:55, side:"E", color:"#0057FF", econ:-1,soc:2, nat:0, bio:"Lee Jae-myung, l√≠der do Partido Democr√°tico e ex-prefeito de Incheon. Sobreviveu a tentativa de assassinato em 2024 e liderou o impeachment de Yoon. Vencedor esperado em elei√ß√£o antecipada ap√≥s crise constitucional.", ideologia:"Progressismo / Social-Democracia / Anti-Yoon", traits:["L√≠der do Impeachment","Sobrevivente ‚Äî Apelo Emocional"], negativeTraits:["Processos Criminais Pendentes","Percep√ß√£o de Populismo"]},
            kim_ms:    {name:"KIM MOON-SOO",  party:"PPP",         start:35, money:60, side:"D", color:"#cc0000", econ:2, soc:-1, nat:1, bio:"Kim Moon-soo, ex-governador de Gyeonggi e l√≠der sindical convertido. Candidato do Partido do Poder do Povo (PPP), tentando salvar o partido ap√≥s o desastre de Yoon Suk-yeol e a lei marcial fracassada.", ideologia:"Conservadorismo / Liberalismo Econ√¥mico / Pr√≥-Alian√ßa EUA", traits:["Ex-Sindicalista ‚Äî Apelo Trabalhador"], negativeTraits:["PPP Manchado pelo Esc√¢ndalo Yoon","Dissocia√ß√£o Dif√≠cil"]},
            lee_js:    {name:"LEE JUN SEOK",  party:"Reforma",     start:12, money:25, side:"C", color:"#FF6600", econ:1, soc:0, nat:0, bio:"Lee Jun Seok, ex-l√≠der do PPP que fundou o Partido Reforma (Gaehaek). Representa a gera√ß√£o jovem conservadora que rompeu com Yoon. Candidato do centrismo reformista e anti-corrup√ß√£o.", ideologia:"Centrismo Liberal / Reformismo Anti-Corrup√ß√£o", traits:["Apelo aos Jovens Conservadores","Ruptura com o PPP"], negativeTraits:["Partido Novo sem Estrutura","Base Limitada"]}
        },
        regions:[
            {id:'SEO', n:'Seul (Metr√≥pole)',                 x:55,y:28, p:19, econ:2,  soc:2,  nat:-1},
            {id:'GGI', n:'Gyeonggi (Ao Redor de Seul)',     x:55,y:32, p:25, econ:1,  soc:1,  nat:0},
            {id:'BSN', n:'Busan / Ulsan / Gyeongnam (Sul)', x:68,y:70, p:14, econ:1,  soc:-1, nat:1},
            {id:'INH', n:'Incheon / Hwaseong (Oeste)',      x:48,y:32, p:6,  econ:1,  soc:0,  nat:0},
            {id:'DAG', n:'Daegu / Gyeongbuk (Sudeste)',     x:70,y:55, p:10, econ:0,  soc:-2, nat:2},
            {id:'DAJ', n:'Daejeon / Chungcheong',           x:55,y:50, p:8,  econ:0,  soc:0,  nat:0},
            {id:'GWJ', n:'Gwangju / Jeolla (Sudoeste)',     x:42,y:70, p:10, econ:-1, soc:2,  nat:0},
            {id:'GWW', n:'Gangwon / Jeju',                  x:68,y:35, p:4,  econ:-1, soc:0,  nat:1},
            {id:'JEJ', n:'Jeju (Ilha)',                      x:52,y:88, p:1,  econ:0,  soc:1,  nat:0},
            {id:'JAM', n:'Jeonbuk (Norte-Sudoeste)',        x:45,y:62, p:3,  econ:-2, soc:1,  nat:0}
        ]
    },
    "ZAF2024": {
        title:"Elei√ß√µes Gerais da √Åfrica do Sul 2024", year:"2024", emoji:"üáøüá¶",
        country:"southafrica",
        desc:"ANC perde maioria absoluta pela primeira vez desde 1994. Ramaphosa enfrenta DA, MK (Zuma) e EFF (Malema) numa elei√ß√£o hist√≥rica que for√ßa um governo de unidade nacional.",
        available:true,
        noSecondRound:true,
        isParliamentary:true,
        parliamentSeats:400,
        majoritySeats:201,
        newsHeader:"Mail & Guardian / Daily Maverick ‚Äî MAY 2024",
        endYear:"2024",
        partyPoolOverride:[{n:"ANC",side:"E",owner:null},{n:"DA",side:"D",owner:null},{n:"MK",side:"C",owner:null},{n:"EFF",side:"E",owner:null}],
        candidates:{
            ramaphosa: {name:"RAMAPHOSA",  party:"ANC",  start:40, money:70, side:"E", color:"#009a44", econ:0, soc:1, nat:1, bio:"Cyril Ramaphosa, presidente desde 2018. ANC caiu de 57% (2019) para 40% ‚Äî perda hist√≥rica. For√ßado a negociar Governo de Unidade Nacional (GNU) com DA e outros partidos. Enfrenta crises de load-shedding, desemprego e corrup√ß√£o.", ideologia:"Social-Democracia / P√≥s-Apartheid / ANC Hist√≥rico", traits:["Legitimidade do ANC","Experi√™ncia Empresarial"], negativeTraits:["Percep√ß√£o de Corrup√ß√£o no ANC","Crise Energ√©tica","Desemprego 32%"]},
            steenhuisen:{name:"STEENHUISEN",party:"DA",   start:22, money:60, side:"D", color:"#003087", econ:2, soc:1, nat:-1, bio:"John Steenhuisen, l√≠der da Alian√ßa Democr√°tica. Partido historicamente visto como branco e liberal, tenta expandir apelo para eleitores negros e coloreds. Obteve 21,8% ‚Äî melhor resultado em d√©cadas. Entrou no Governo de Unidade Nacional.", ideologia:"Liberalismo Cl√°ssico / Federalismo / Anti-Corrup√ß√£o", traits:["Imagem de Limpeza","Gest√£o Comprovada no Cabo Ocidental"], negativeTraits:["Percebido como Partido Branco","Heran√ßa do Apartheid"]},
            zuma:      {name:"ZUMA",       party:"MK",   start:15, money:30, side:"C", color:"#000000", econ:-1,soc:0, nat:2, bio:"Jacob Zuma, ex-presidente banido do ANC, criou o partido MK (uMkhonto we Sizwe). Focado em KwaZulu-Natal com apelo zulu e populismo anti-establishment. Obteve 14,6% ‚Äî resultado surpreendente especialmente em KZN.", ideologia:"Populismo Zulu / Nacionalismo Africano Radical", traits:["Apelo Tribal em KZN","Base Zulu S√≥lida"], negativeTraits:["Condenado por Corrup√ß√£o","Desestabilizador Institucional"]},
            malema:    {name:"MALEMA",     party:"EFF",  start:10, money:20, side:"E", color:"#cc0000", econ:-2,soc:1, nat:2, bio:"Julius Malema, l√≠der dos Combatentes pela Liberdade Econ√¥mica (EFF). Radical de esquerda que defende expropria√ß√£o de terras sem compensa√ß√£o e nacionaliza√ß√£o das minas. Obteve 9,5%.", ideologia:"Socialismo Radical / Pan-Africanismo / Redistribui√ß√£o de Terra", traits:["Mobilizador de Massas","Discurso Radical Consistente"], negativeTraits:["Percebido como Extremista","Expropria√ß√£o Assusta Investidores"]}
        },
        regions:[
            {id:'GP',  n:'Gauteng (Joanesburgo/Pret√≥ria)',  x:62,y:38, p:26, econ:2,  soc:1,  nat:0},
            {id:'WC',  n:'Cabo Ocidental (Cidade do Cabo)', x:30,y:78, p:12, econ:1,  soc:1,  nat:-1},
            {id:'KZN', n:'KwaZulu-Natal (Durban)',          x:72,y:52, p:21, econ:-1, soc:-1, nat:2},
            {id:'EC',  n:'Cabo Oriental',                   x:60,y:72, p:13, econ:-2, soc:0,  nat:1},
            {id:'LP',  n:'Limpopo (Norte)',                 x:62,y:18, p:11, econ:-2, soc:-1, nat:1},
            {id:'MP',  n:'Mpumalanga',                      x:70,y:30, p:7,  econ:-1, soc:-1, nat:1},
            {id:'NC',  n:'Cabo do Norte',                   x:38,y:55, p:3,  econ:0,  soc:0,  nat:0},
            {id:'NW',  n:'Noroeste',                        x:48,y:35, p:5,  econ:-1, soc:-1, nat:1},
            {id:'FS',  n:'Estado Livre',                    x:52,y:52, p:6,  econ:-1, soc:-1, nat:0}
        ]
    },
    "PHL2022": {
        title:"Elei√ß√£o Presidencial das Filipinas 2022", year:"2022", emoji:"üáµüá≠",
        country:"philippines",
        desc:"Bongbong Marcos, filho do ex-ditador, busca reabilitar o legado da fam√≠lia com maioria maci√ßa. Robredo lidera oposi√ß√£o progressista. Pacquiao representa o populismo. Moreno pela via independente.",
        available:true,
        noSecondRound:false,
        noSecondRound:true,
        newsHeader:"Philippine Daily Inquirer ‚Äî MAY 2022",
        endYear:"2022",
        partyPoolOverride:[{n:"PFP",side:"D",owner:null},{n:"LP",side:"E",owner:null},{n:"PROMDI",side:"C",owner:null},{n:"AD",side:"C",owner:null}],
        candidates:{
            marcos:    {name:"MARCOS",   party:"PFP",   start:47, money:80, side:"D", color:"#cc0000", econ:1, soc:-1, nat:2, bio:"Ferdinand Marcos Jr. ('Bongbong'), filho do ex-ditador Ferdinand Marcos. Venceu com 58,7% ‚Äî a maior margem desde o pai. Campanha baseada em nostalgia do 'Era dos Marcos' e negacionismo hist√≥rico nas redes sociais.", ideologia:"Populismo Din√°stico / Conservadorismo Filipinos", traits:["M√°quina Pol√≠tica Hist√≥rica","Alian√ßa com Duterte"], negativeTraits:["Legado Ditatorial do Pai","Negacionismo Hist√≥rico"]},
            robredo:   {name:"ROBREDO",  party:"LP",    start:25, money:40, side:"E", color:"#ff6699", econ:-1,soc:2, nat:-1, bio:"Leni Robredo, vice-presidente e ex-ombudsman. Candidata da oposi√ß√£o democr√°tica e progressista. Obteve 27,9% numa campanha de voluntariado massivo ('Pink Movement') que mobilizou a sociedade civil.", ideologia:"Democracia Liberal / Progressismo / Anti-Marcos", traits:["Movimento Rosa Viral","Base de Volunt√°rios Maci√ßa"], negativeTraits:["Sem Acesso √† M√°quina Estatal","Fracionamento da Oposi√ß√£o"]},
            pacquiao:  {name:"PACQUIAO", party:"PROMDI",start:9,  money:25, side:"C", color:"#FFD700", econ:0, soc:-1, nat:1, bio:"Manny Pacquiao, lend√°rio boxeador e senador. Candidato populista que desafiou Duterte pela corrup√ß√£o. Obteve 8,7%.", ideologia:"Populismo / Conservadorismo Evang√©lico", traits:["Her√≥i Nacional ‚Äî Pugilista","Base Popular nas Prov√≠ncias"], negativeTraits:["Programa Vago","Sem M√°quina Pol√≠tica"]},
            moreno:    {name:"MORENO",   party:"AD",    start:7,  money:20, side:"C", color:"#0044cc", econ:0, soc:0, nat:0, bio:"Francisco 'Isko' Moreno, ex-ator e prefeito de Manila. Candidato independente centrista. Obteve 10% como outsider pragm√°tico.", ideologia:"Centrismo / Populismo Moderado", traits:["Prefeito de Manila","Personalidade Midi√°tica"], negativeTraits:["Fracionou a Oposi√ß√£o","Associado √† Direita Tardia"]}
        },
        regions:[
            {id:'LUZ', n:'Lu√ß√£o Norte (Ilocos/Cagayan)',    x:52,y:18, p:15, econ:-1, soc:-1, nat:2},
            {id:'NCR', n:'Regi√£o da Capital Nacional (Manila)',x:55,y:42,p:13,econ:2, soc:1,  nat:0},
            {id:'CLU', n:'Lu√ß√£o Central (Pampanga/Bulacan)',x:54,y:35, p:14, econ:1,  soc:0,  nat:0},
            {id:'CAL', n:'CALABARZON (Rizal/Cavite)',       x:58,y:48, p:18, econ:1,  soc:0,  nat:0},
            {id:'BIC', n:'Bicol (Sul de Lu√ß√£o)',            x:62,y:58, p:6,  econ:-2, soc:1,  nat:1},
            {id:'VIS', n:'Visayas Ocidental (Cebu/Iloilo)', x:58,y:65, p:12, econ:0,  soc:0,  nat:0},
            {id:'EVI', n:'Visayas Orientais',               x:68,y:62, p:5,  econ:-2, soc:0,  nat:1},
            {id:'MIN', n:'Mindanao Ocidental (Zamboanga)', x:45,y:78, p:5,  econ:-2, soc:-1, nat:1},
            {id:'DAV', n:'Mindanao Central (Davao ‚Äî Duterte)',x:58,y:80,p:8, econ:0,  soc:-1, nat:2},
            {id:'CAR', n:'Caraga / ARMM (Mindanao Norte)', x:65,y:72, p:4,  econ:-2, soc:-1, nat:1}
        ]
    },
    "TUR2023": {
        title:"Elei√ß√£o Presidencial da Turquia 2023", year:"2023", emoji:"üáπüá∑",
        country:"turkey",
        desc:"Erdoƒüan busca terceiro mandato. Kƒ±lƒ±√ßdaroƒülu lidera oposi√ß√£o unificada de seis partidos. Oƒüan como terceira for√ßa. Elei√ß√£o decide rumo da Turquia entre autoritarismo e democracia liberal.",
        available:true,
        noSecondRound:false,
        newsHeader:"Cumhuriyet / H√ºrriyet ‚Äî MAYIS 2023",
        endYear:"2023",
        partyPoolOverride:[{n:"AKP",side:"D",owner:null},{n:"CHP",side:"E",owner:null},{n:"Ata ƒ∞tt.",side:"C",owner:null}],
        candidates:{
            erdogan:      {name:"ERDOƒûAN",      party:"AKP",     start:49, money:80, side:"D", color:"#FFA500", econ:1, soc:-2, nat:2, bio:"Recep Tayyip Erdoƒüan, presidente desde 2014 (PM 2003-2014). Venceu o 2¬∫ turno com 52,1% ap√≥s empate t√©cnico no 1¬∫ turno (49,5%). Com 20 anos no poder, liderou transforma√ß√£o islamista conservadora e autorit√°ria da Turquia.", ideologia:"Islamismo Conservador / Populismo Nacional / Autoritarismo", traits:["20 Anos no Poder ‚Äî M√°quina Completa","Controle da M√≠dia"], negativeTraits:["Infla√ß√£o de 80%","Desastre do Terremoto 2023","Autocratismo Crescente"]},
            kilicdaroglu: {name:"KILI√áDAROƒûLU", party:"CHP",     start:44, money:55, side:"E", color:"#cc0000", econ:-1,soc:2, nat:-1, bio:"Kemal Kƒ±lƒ±√ßdaroƒülu, l√≠der do CHP desde 2010. Candidato da 'Mesa dos Seis' ‚Äî alian√ßa de seis partidos de oposi√ß√£o. Obteve 44,9% no 1T e 47,8% no 2T. Perdeu apesar de ser favorito em pesquisas.", ideologia:"Social-Democracia Kemalista / Secularismo / Pr√≥-UE", traits:["Alian√ßa de Seis Partidos","Imagem de Integridade"], negativeTraits:["Personalidade Pouco Carism√°tica","Perdeu Elei√ß√µes M√∫ltiplas Vezes"]},
            ogan:         {name:"OƒûAN",         party:"Ind.",    start:5,  money:15, side:"C", color:"#888888", econ:0, soc:-1, nat:2, bio:"Sinan Oƒüan, ex-deputado e candidato do movimento Ata ƒ∞ttifakƒ±. Obteve 5,2% no 1T com discurso ultranacionalista e anti-imigra√ß√£o. Apoiou Erdoƒüan no 2T em troca de promessas de deporta√ß√µes.", ideologia:"Ultranacionalismo Turco / Anti-Imigra√ß√£o", traits:["Terceira For√ßa Decisiva"], negativeTraits:["Partido sem Base Estrutural","Oportunismo Percebido"]}
        },
        regions:[
            {id:'IST', n:'Istambul (Metr√≥pole)',              x:18,y:22, p:18, econ:2,  soc:1,  nat:0},
            {id:'ANK', n:'Ancara (Capital)',                  x:40,y:35, p:8,  econ:1,  soc:0,  nat:0},
            {id:'IZM', n:'ƒ∞zmir (Egeu ‚Äî Kemalista)',         x:15,y:45, p:7,  econ:1,  soc:2,  nat:-1},
            {id:'ANA', n:'Anat√≥lia Central (Konya/Kayseri)', x:50,y:45, p:12, econ:-1, soc:-2, nat:2},
            {id:'MED', n:'Mediterr√¢neo (Antalya/Adana)',     x:38,y:58, p:10, econ:1,  soc:-1, nat:1},
            {id:'EGE', n:'Tr√°cia Europeia / Mar de M√°rmara',x:22,y:25, p:8,  econ:2,  soc:1,  nat:0},
            {id:'BKD', n:'Mar Negro (Trabzon/Samsun)',       x:52,y:18, p:8,  econ:-1, soc:-1, nat:2},
            {id:'KUR', n:'Curdist√£o (Diyarbakƒ±r/Van)',       x:68,y:52, p:8,  econ:-2, soc:1,  nat:-2},
            {id:'ELA', n:'Anat√≥lia Oriental (Erzurum)',      x:65,y:38, p:6,  econ:-2, soc:-2, nat:2},
            {id:'GUI', n:'G√ºneydoƒüu (Sudoeste ‚Äî √°rabe)',    x:62,y:62, p:5,  econ:-2, soc:-1, nat:1}
        ]
    },
    "GER1932": {
        title:"Elei√ß√£o Presidencial Alem√£ 1932", year:"1932", emoji:"üá©üá™üèõÔ∏è",
        country:"germany1932",
        desc:"Hindenburg, 84 anos, enfrenta Hitler e Th√§lmann numa Alemanha devastada pela Grande Depress√£o. O resultado moldar√° o destino do mundo.",
        available:true,
        noSecondRound:false,
        isHistorical:true,
        newsHeader:"Vossische Zeitung ‚Äî APRIL 1932",
        endYear:"1932",
        partyPoolOverride:[{n:"DNVP",side:"D",owner:null},{n:"NSDAP",side:"D",owner:null},{n:"KPD",side:"E",owner:null},{n:"SPD",side:"E",owner:null}],
        candidates:{
            hindenburg:{name:"HINDENBURG",party:"Ind.",   start:53, money:50, side:"C", color:"#3388aa", econ:0, soc:-1, nat:1, bio:"Paul von Hindenburg, marechal de campo e presidente em exerc√≠cio com 84 anos. Reeleito no 2¬∫ turno com 53% contra Hitler (36,8%) e Th√§lmann (10,2%). Ironicamente nomearia Hitler como chanceler em 1933, entregando a Rep√∫blica de Weimar.", ideologia:"Conservadorismo Prussiano / Monarquismo Republicano", traits:["Her√≥i de Guerra","Legitimidade Institucional"], negativeTraits:["Fraqueza e Senilidade","Desprezo pela Democracia","Cedeu a Hitler em 1933"]},
            hitler:    {name:"HITLER",    party:"NSDAP",  start:30, money:60, side:"D", color:"#8b0000", econ:1, soc:-2, nat:3, bio:"Adolf Hitler, l√≠der do NSDAP. Obteve 30,1% no 1T e 36,8% no 2T. Apesar de perder para Hindenburg, a vota√ß√£o mostrou o tamanho do movimento nazista. Em 30 de janeiro de 1933, Hindenburg o nomeou chanceler.", ideologia:"Nazismo / Fascismo / Antissemitismo / Ultranacionalismo", traits:["Mobiliza√ß√£o de Massas","Propaganda Moderna"], negativeTraits:["Agenda Genocida","Instabilidade Violenta","Suporte de Extremistas"]},
            thalmann:  {name:"TH√ÑLMANN", party:"KPD",    start:13, money:20, side:"E", color:"#cc0000", econ:-3,soc:1, nat:-1, bio:"Ernst Th√§lmann, l√≠der do Partido Comunista Alem√£o. Obteve 13,2% no 1T. Preso pelos nazistas em 1933, assassinado em Buchenwald em 1944.", ideologia:"Comunismo / Internacionalismo Prolet√°rio", traits:["Base Oper√°ria Fiel"], negativeTraits:["Subordina√ß√£o a Moscou","Recusa de Frente Unida com SPD"]}
        },
        regions:[
            {id:'PRU', n:'Pr√∫ssia (Berlim/Brandenburgo)',   x:62,y:28, p:30, econ:0,  soc:1,  nat:0},
            {id:'BAY', n:'Bayern (Munique)',                 x:48,y:65, p:15, econ:0,  soc:-2, nat:1},
            {id:'SAX', n:'Sax√¥nia (Leipzig/Dresden)',       x:58,y:42, p:12, econ:-1, soc:1,  nat:1},
            {id:'BER', n:'Berlim (Capital)',                 x:65,y:25, p:6,  econ:1,  soc:2,  nat:-1},
            {id:'WES', n:'Westf√°lia / Ren√¢nia (Ruhr)',      x:28,y:35, p:18, econ:-1, soc:1,  nat:0},
            {id:'THU', n:'Tur√≠ngia / Hessen',               x:45,y:48, p:8,  econ:-1, soc:0,  nat:1},
            {id:'HAM', n:'Hamburgo / Norte',                x:38,y:15, p:5,  econ:0,  soc:1,  nat:0},
            {id:'SIL', n:'Sil√©sia (Wroc≈Çaw)',               x:72,y:45, p:6,  econ:-2, soc:0,  nat:1}
        ]
    }
};

// ============================================================
// SISTEMA DE CONQUISTAS
// ============================================================
let achievements = JSON.parse(localStorage.getItem('sim_achievements') || '{}');
const achievementDefs = [
    {id:'first_win',       name:'Primeira Vit√≥ria',        emoji:'üèÜ', desc:'Ven√ßa qualquer elei√ß√£o pela primeira vez.'},
    {id:'first_round',     name:'Primeiro Turno!',         emoji:'‚ö°', desc:'Ven√ßa no primeiro turno com mais de 50%.'},
    {id:'underdog',        name:'Azar√£o',                  emoji:'üê∂', desc:'Ven√ßa come√ßando com menos de 15% nas pesquisas.'},
    {id:'coalition',       name:'Arquiteto do Poder',      emoji:'ü§ù', desc:'Monte uma coliga√ß√£o de 5+ partidos.'},
    {id:'repvelha_win',    name:'Filho da Velha Rep√∫blica',emoji:'üìú', desc:'Ven√ßa uma elei√ß√£o da Rep√∫blica Velha.'},
    {id:'usa_win',         name:'Presidente dos EUA',      emoji:'üá∫üá∏', desc:'Ven√ßa as elei√ß√µes americanas de 2024.'},
    {id:'russia_win',      name:'Camarada Putin',          emoji:'üá∑üá∫', desc:'Ven√ßa as elei√ß√µes russas de 2024.'},
    {id:'scandal_survive', name:'Sobrevivente',            emoji:'üí•', desc:'Ven√ßa com n√≠vel de esc√¢ndalo 5+.'},
    {id:'all_states',      name:'Brasil Total',            emoji:'üó∫Ô∏è', desc:'Ven√ßa todos os 27 estados numa elei√ß√£o presidencial.'},
    {id:'historic_1930',   name:'Alian√ßa Liberal',         emoji:'üî´', desc:'Ven√ßa como Get√∫lio Vargas em 1930.'},
    {id:'historic_1955',   name:'50 Anos em 5',            emoji:'üöÇ', desc:'Ven√ßa como JK em 1955.'},
    {id:'governor_win',    name:'Governador!',             emoji:'üó∫Ô∏è', desc:'Ven√ßa qualquer elei√ß√£o estadual.'},
    {id:'landslide',       name:'Avalanche',               emoji:'üåä', desc:'Ven√ßa com mais de 65% dos votos.'},
    {id:'historic_1989',   name:'Ca√ßador de Maraj√°s',      emoji:'ü¶Ö', desc:'Ven√ßa como Collor em 1989.'},
    {id:'historic_1994',   name:'Real Power',              emoji:'üí∞', desc:'Ven√ßa como FHC em 1994.'},
    {id:'historic_2002',   name:'Lula L√°',                emoji:'‚≠ê', desc:'Ven√ßa como Lula em 2002.'},
    {id:'historic_2022',   name:'Ele Voltou',              emoji:'üîÑ', desc:'Ven√ßa como Lula em 2022.'},
    {id:'municipal_win',   name:'Prefeito!',               emoji:'üèôÔ∏è', desc:'Ven√ßa uma elei√ß√£o municipal.'},
    {id:'rui_barbosa',     name:'A √Åguia de Haia',         emoji:'ü¶Ö', desc:'Ven√ßa como Rui Barbosa numa elei√ß√£o da Rep√∫blica Velha.'},
    {id:'come_from_behind',name:'Virada √âpica',            emoji:'üîÉ', desc:'Ven√ßa ap√≥s estar em 3¬∫ ou abaixo no turno 5.'},
    {id:'no_money',        name:'Campanha Pobre',          emoji:'üí∏', desc:'Ven√ßa com menos de R$5M no caixa.'},
    {id:'domination',      name:'Sem Rival',               emoji:'üëë', desc:'Ven√ßa com mais de 70% dos votos.'},
    {id:'survivor',        name:'√öltimo a Cair',           emoji:'üßü', desc:'Ven√ßa ap√≥s ter menos de 10% nas pesquisas no turno 3.'},
    {id:'spirit_master',   name:'Mestre dos Esp√≠ritos',    emoji:'üåü', desc:'Ative 5 esp√≠ritos diferentes numa mesma campanha.'},
    {id:'wealthy_winner',  name:'Milion√°rio Eleito',       emoji:'üíé', desc:'Ven√ßa com mais de R$80M em caixa.'},
    {id:'all_scenarios',   name:'Historiador',             emoji:'üìö', desc:'Jogue 10 elei√ß√µes diferentes.'},
    {id:'perfect_debate',  name:'Orador de Ouro',          emoji:'üé§', desc:'Ven√ßa todos os debates de uma campanha.'},
    {id:'speed_run',       name:'Rel√¢mpago',               emoji:'‚ö°', desc:'Ven√ßa uma elei√ß√£o antes do turno 8.'},
    {id:'germany_win',     name:'Bundeskanzler',           emoji:'üá©üá™', desc:'Ven√ßa as elei√ß√µes alem√£s.'},
    {id:'france_win',      name:'Pr√©sident de la R√©publique',emoji:'üá´üá∑', desc:'Ven√ßa as elei√ß√µes francesas.'},
    {id:'clean_campaign',  name:'Campanha Limpa',          emoji:'üïäÔ∏è', desc:'Ven√ßa sem nenhum esc√¢ndalo.'},
    {id:'chaos_mode',      name:'No Olho do Caos',         emoji:'üî•', desc:'Ven√ßa em modo Ca√≥tico.'},
    {id:'lone_wolf',       name:'Lobo Solit√°rio',          emoji:'üê∫', desc:'Ven√ßa sem nenhuma alian√ßa.'},
    {id:'indirect_master', name:'Articulador',             emoji:'‚öôÔ∏è', desc:'Ven√ßa uma elei√ß√£o indireta.'},
    {id:'mega_coalition',  name:'Coliga√ß√£o Monstruosa',    emoji:'ü¶Å', desc:'Monte uma coliga√ß√£o de 8+ partidos.'},
    {id:'first_turn_lead', name:'Sempre na Frente',        emoji:'üöÄ', desc:'Lidere as pesquisas em todos os 15 turnos.'},
    // INTERNATIONAL VICTORIES
    {id:'italy_win',       name:'Fratelli d\'Italia!',     emoji:'üáÆüáπ', desc:'Ven√ßa as elei√ß√µes italianas de 2022.'},
    {id:'argentina_win',   name:'El Presidente',           emoji:'üá¶üá∑', desc:'Ven√ßa as elei√ß√µes argentinas de 2023.'},
    {id:'india_win',       name:'PM da √çndia',             emoji:'üáÆüá≥', desc:'Ven√ßa as elei√ß√µes indianas de 2024.'},
    {id:'uk_win',          name:'Prime Minister',          emoji:'üá¨üáß', desc:'Ven√ßa as elei√ß√µes brit√¢nicas de 2024.'},
    {id:'poland_win',      name:'Prezydent Rzeczypospolitej',emoji:'üáµüá±', desc:'Ven√ßa as elei√ß√µes polacas de 2025.'},
    {id:'usa2020_win',     name:'46¬∫ Presidente',          emoji:'üóΩ', desc:'Ven√ßa as elei√ß√µes americanas de 2020.'},
    {id:'russia96_win',    name:'Yeltsin Sobrevive',       emoji:'ü™Ü', desc:'Ven√ßa as elei√ß√µes russas de 1996.'},
    {id:'portugal_win',    name:'Presidente de Portugal',  emoji:'üáµüáπ', desc:'Ven√ßa as elei√ß√µes portuguesas.'},
    {id:'venezuela_win',   name:'Revolu√ß√£o Bolivariana',   emoji:'üáªüá™', desc:'Ven√ßa as elei√ß√µes venezuelanas de 2024.'},
    {id:'mexico_win',      name:'El Se√±or Presidente',     emoji:'üá≤üáΩ', desc:'Ven√ßa as elei√ß√µes mexicanas de 2024.'},
    {id:'chile_win',       name:'La Moneda √© Sua',         emoji:'üá®üá±', desc:'Ven√ßa as elei√ß√µes chilenas de 2025.'},
    {id:'colombia_win',    name:'Casa de Nari√±o',          emoji:'üá®üá¥', desc:'Ven√ßa as elei√ß√µes colombianas de 2026.'},
    {id:'canada_win',      name:'Prime Minister',          emoji:'üá®üá¶', desc:'Ven√ßa as elei√ß√µes federais canadenses de 2025.'},
    // v14 NEW ACHIEVEMENTS
    {id:'ukraine_win',     name:'Presidente da Ucr√¢nia',   emoji:'üá∫üá¶', desc:'Ven√ßa as elei√ß√µes ucranianas de 2019.'},
    {id:'spain_win',       name:'Presidente do Governo',   emoji:'üá™üá∏', desc:'Ven√ßa as elei√ß√µes gerais espanholas de 2023.'},
    {id:'japan_win',       name:'Primeiro-Ministro do Jap√£o',emoji:'üáØüáµ', desc:'Ven√ßa as elei√ß√µes parlamentares japonesas de 2026.'},
    {id:'skorea_win',      name:'Presidente da Coreia do Sul',emoji:'üá∞üá∑', desc:'Ven√ßa as elei√ß√µes sul-coreanas de 2025.'},
    {id:'safrica_win',     name:'Presidente da √Åfrica do Sul',emoji:'üáøüá¶', desc:'Ven√ßa as elei√ß√µes sul-africanas de 2024.'},
    {id:'philippines_win', name:'Presidente das Filipinas', emoji:'üáµüá≠', desc:'Ven√ßa as elei√ß√µes filipinas de 2022.'},
    {id:'turkey_win',      name:'Cumhurba≈ükanƒ±',           emoji:'üáπüá∑', desc:'Ven√ßa as elei√ß√µes turcas de 2023.'},
    {id:'ger1932_win',     name:'Presidente de Weimar',    emoji:'üèõÔ∏è', desc:'Ven√ßa a elei√ß√£o presidencial alem√£ de 1932.'},
    {id:'stop_hitler',     name:'O Mundo que Poderia Ser', emoji:'üïäÔ∏è', desc:'Ven√ßa contra Hitler em 1932 com mais de 53%.'},
    // SPECIAL PLAYSTYLE
    {id:'sandbox_win',     name:'Modo Deus',               emoji:'‚ôæÔ∏è', desc:'Ven√ßa em modo Sandbox.'},
    {id:'corrupt_win',     name:'Chefe do Esquema',        emoji:'ü§ë', desc:'Ven√ßa ap√≥s usar a aba de corrup√ß√£o.'},
    {id:'vice_win',        name:'Dupla Din√¢mica',          emoji:'üëî', desc:'Ven√ßa com um vice-presidente negociado.'},
    {id:'all_regions',     name:'Varredor Nacional',       emoji:'üßπ', desc:'Ven√ßa todas as regi√µes do Brasil.'},
    {id:'northeast_win',   name:'Rei do Nordeste',         emoji:'‚òÄÔ∏è', desc:'Ven√ßa todos os estados do Nordeste.'},
    {id:'south_win',       name:'Ga√∫cho de Ouro',          emoji:'üåæ', desc:'Ven√ßa todos os estados do Sul.'},
    {id:'rally_king',      name:'Com√≠cio na Pra√ßa',        emoji:'üé∫', desc:'Fa√ßa 5 com√≠cios regionais numa campanha.'},
    // SCORE MILESTONES
    {id:'score_100',       name:'Centen√°rio',              emoji:'üíØ', desc:'Atinja 100 pontos acumulados numa campanha.'},
    {id:'money_200',       name:'Bar√£o do Dinheiro',       emoji:'üè¶', desc:'Acumule R$200M num √∫nico jogo.'},
    // HISTORIC LOSSES (play specific characters)
    {id:'played_collor_loss',name:'Impichado',             emoji:'üíî', desc:'Jogue como Collor em qualquer elei√ß√£o.'},
    {id:'played_bolsonaro',  name:'Mito Jogou',            emoji:'üêä', desc:'Jogue como Bolsonaro.'},
    {id:'played_lula_1989',  name:'Primeiro Lula',         emoji:'üåü', desc:'Jogue como Lula em 1989.'},
    // SCENARIO SPECIFIC
    {id:'historic_2018',   name:'O Capit√£o Chegou',        emoji:'üéñÔ∏è', desc:'Ven√ßa como Bolsonaro em 2018.'},
    {id:'historic_2010',   name:'Dilma Eleita',            emoji:'üë©', desc:'Ven√ßa como Dilma em 2010.'},
    {id:'historic_2006',   name:'Lula Reeleito',           emoji:'üîÅ', desc:'Ven√ßa como Lula em 2006.'},
    {id:'historic_2014',   name:'Muito Dif√≠cil',           emoji:'üò∞', desc:'Ven√ßa como Dilma em 2014.'},
    {id:'historic_1960',   name:'J√¢nio Presidente',        emoji:'üßπ', desc:'Ven√ßa como J√¢nio em 1960.'},
    {id:'historic_1998',   name:'FHC Reeleito',            emoji:'üìä', desc:'Ven√ßa como FHC em 1998.'},
    // MANIPULATION & STRATEGIES
    {id:'max_scandal',     name:'Esc√¢ndalos M√∫ltiplos',    emoji:'üì∞', desc:'Cause n√≠vel de esc√¢ndalo 8+ em 2 rivais simult√¢neos.'},
    {id:'zero_approval',   name:'Amado e Odiado',          emoji:'üìä', desc:'Tenha 90%+ de aprova√ß√£o E 90% de rejei√ß√£o simult√¢neos.'},
    {id:'debate_sweep',    name:'Knockout Total',          emoji:'ü•ä', desc:'Ven√ßa 5 debates seguidos.'},
    {id:'last_minute',     name:'Virada de √öltimo Minuto', emoji:'‚è∞', desc:'Ven√ßa estando em 2¬∫ lugar no turno 14.'},
    {id:'all_international',name:'Cidad√£o do Mundo',       emoji:'üåç', desc:'Jogue todas as elei√ß√µes internacionais dispon√≠veis.'},
    {id:'ancient_history', name:'Arque√≥logo Eleitoral',    emoji:'üè∫', desc:'Jogue todas as elei√ß√µes da Rep√∫blica Velha.'},
    {id:'custom_win',      name:'Candidato Alternativo',   emoji:'‚ú®', desc:'Ven√ßa com um candidato criado por voc√™.'},
    {id:'five_in_row',     name:'Cinco Seguidas',          emoji:'üéØ', desc:'Ven√ßa 5 elei√ß√µes consecutivas.'},
    // === NOVAS CONQUISTAS v13+ (totalizando 100) ===
    // ELEI√á√ïES PARLAMENTARES
    {id:'parliament_majority',  name:'Maioria Absoluta',       emoji:'üèõÔ∏è', desc:'Ven√ßa com maioria absoluta num sistema parlamentar.'},
    {id:'coalition_gov',        name:'Governo de Coaliz√£o',    emoji:'ü§ù', desc:'Governe sem maioria, mas pela maior bancada.'},
    {id:'snap_election',        name:'Elei√ß√£o Rel√¢mpago',      emoji:'‚ö°', desc:'Jogue uma elei√ß√£o convocada antecipadamente (UK/Espanha).'},
    // COL√âGIO ELEITORAL
    {id:'ec_sweep',             name:'Sweep Eleitoral',        emoji:'üó∫Ô∏è', desc:'Ven√ßa todos os swing states nos EUA.'},
    {id:'ec_comeback',          name:'Comeback no Col√©gio',    emoji:'üîÑ', desc:'Ven√ßa o Col√©gio Eleitoral estando atr√°s no voto popular.'},
    {id:'ec_landslide_ev',      name:'Avalanche Eleitoral',    emoji:'üåä', desc:'Ven√ßa com mais de 350 votos eleitorais.'},
    // ELEI√á√ïES INDIRETAS
    {id:'indirect_majority_1st',name:'Maioria na 1¬™ Rodada',  emoji:'‚ö°', desc:'Ven√ßa elei√ß√£o indireta na primeira rodada de vota√ß√£o.'},
    {id:'indirect_all',         name:'Golpista Pac√≠fico',      emoji:'üïäÔ∏è', desc:'Jogue todas as 5 elei√ß√µes indiretas dispon√≠veis.'},
    {id:'indirect_underdog',    name:'Azar√£o do Congresso',   emoji:'üê∂', desc:'Ven√ßa elei√ß√£o indireta tendo menos de 25% inicial.'},
    // ESTRAT√âGIA
    {id:'no_deals',             name:'Sem Favores',            emoji:'üßä', desc:'Ven√ßa elei√ß√£o indireta sem usar "Proposta de Governo".'},
    {id:'pressure_wins',        name:'Press√£o Popular',        emoji:'üë•', desc:'Ven√ßa elei√ß√£o indireta com n√≠vel de press√£o popular ‚â•8.'},
    {id:'total_dominator',      name:'Domina√ß√£o Total',        emoji:'üí™', desc:'Ven√ßa com 80%+ dos votos em qualquer elei√ß√£o.'},
    // GEOGR√ÅFICAS
    {id:'europe_all',           name:'Europol√≠tico',           emoji:'üá™üá∫', desc:'Jogue todas as elei√ß√µes europeias dispon√≠veis.'},
    {id:'asia_all',             name:'Estadista Asi√°tico',     emoji:'üåè', desc:'Jogue todas as elei√ß√µes asi√°ticas dispon√≠veis.'},
    {id:'latin_all',            name:'L√≠der Latino-Americano', emoji:'üåé', desc:'Jogue todas as elei√ß√µes da Am√©rica Latina.'},
    {id:'africa_play',          name:'Ubuntu ‚Äî Sou por N√≥s',  emoji:'üåç', desc:'Jogue a elei√ß√£o sul-africana de 2024.'},
    // === NOVAS CONQUISTAS v16 ===
    {id:'usa2016_win',          name:'A Grande Virada',        emoji:'üé©', desc:'Ven√ßa as elei√ß√µes americanas de 2016.'},
    {id:'usa2012_win',          name:'44¬∫ Reeleito',           emoji:'üóΩ', desc:'Ven√ßa as elei√ß√µes americanas de 2012.'},
    {id:'usa2008_win',          name:'Yes We Can',             emoji:'‚úä', desc:'Ven√ßa as elei√ß√µes americanas de 2008.'},
    {id:'usa2004_win',          name:'Guerra e Elei√ß√£o',       emoji:'üéñÔ∏è', desc:'Ven√ßa as elei√ß√µes americanas de 2004.'},
    {id:'usa2000_win',          name:'Cada Voto Conta',        emoji:'üó≥Ô∏è', desc:'Ven√ßa as elei√ß√µes americanas de 2000.'},
    {id:'scandal_master',       name:'Mestre do Esc√¢ndalo',    emoji:'üïµÔ∏è', desc:'Use a aba de Crises em pelo menos 8 turnos numa campanha.'},
    {id:'narrative_king',       name:'Rei da Narrativa',       emoji:'üì∞', desc:'Plante narrativas com sucesso 5 vezes numa mesma campanha.'},
    {id:'ec_all_swing',         name:'Dom√≠nio Total dos Swing States', emoji:'‚≠ê', desc:'Ven√ßa todos os swing states (lean=S) nos EUA.'},
    {id:'comeback_scandal',     name:'Redemption Arc',         emoji:'üîÑ', desc:'Ven√ßa uma elei√ß√£o ap√≥s ter esc√¢ndalo n√≠vel 8+ em algum turno.'},
    {id:'defensive_campaign',   name:'Fortaleza Inexpugn√°vel', emoji:'üõ°Ô∏è', desc:'Ven√ßa sem deixar nenhum estado do pr√≥prio lado ser conquistado pelo rival.'},
    {id:'usa_historical_all',   name:'Historiador Americano',  emoji:'ü¶Ö', desc:'Jogue todas as 7 elei√ß√µes hist√≥ricas americanas (2000-2024).'},
    {id:'max_radicalizado',     name:'Pa√≠s em Chamas',         emoji:'üî•', desc:'Atinja n√≠vel de radicaliza√ß√£o 95 numa campanha.'},
    {id:'peacemaker',           name:'Pacificador',            emoji:'‚òÆÔ∏è', desc:'Reduza a radicaliza√ß√£o de 90+ para abaixo de 50 numa campanha.'},
    {id:'vice_turned_election', name:'O Vice Decidiu',         emoji:'üëî', desc:'Ven√ßa com menos de 2% de margem tendo um vice-presidente.'},
    {id:'no_scandal_intl',      name:'Diplomata Limpo',        emoji:'üåê', desc:'Ven√ßa uma elei√ß√£o internacional sem nenhum esc√¢ndalo.'},
];

function checkAchievements(winnerId, winnerVotes, scenario) {
    let earned = [];
    if(!achievements['first_win']) { achievements['first_win'] = true; earned.push('first_win'); }
    if(game.fase===1 && winnerVotes>50 && !achievements['first_round']) { achievements['first_round']=true; earned.push('first_round'); }
    let startVotes = candidatesData[winnerId]?.start||0;
    if(startVotes<15 && !achievements['underdog']) { achievements['underdog']=true; earned.push('underdog'); }
    let coalLen = game.coalition.filter(p=>!p.includes('_seat')).length;
    if(coalLen>=5 && !achievements['coalition']) { achievements['coalition']=true; earned.push('coalition'); }
    if(game.isRepVelha && !achievements['repvelha_win']) { achievements['repvelha_win']=true; earned.push('repvelha_win'); }
    if(scenario==='USA2024' && !achievements['usa_win']) { achievements['usa_win']=true; earned.push('usa_win'); }
    if(scenario==='RUS2024' && !achievements['russia_win']) { achievements['russia_win']=true; earned.push('russia_win'); }
    if((game.scandalLevels[winnerId]||0)>=5 && !achievements['scandal_survive']) { achievements['scandal_survive']=true; earned.push('scandal_survive'); }
    if(game.isGovernor && !achievements['governor_win']) { achievements['governor_win']=true; earned.push('governor_win'); }
    if(governorData[game.scenario]?.isMunicipal && !achievements['municipal_win']) { achievements['municipal_win']=true; earned.push('municipal_win'); }
    if(winnerVotes>65 && !achievements['landslide']) { achievements['landslide']=true; earned.push('landslide'); }
    if(winnerVotes>70 && !achievements['domination']) { achievements['domination']=true; earned.push('domination'); }
    if(game.money<5 && !achievements['no_money']) { achievements['no_money']=true; earned.push('no_money'); }
    if(scenario==='RV1930' && winnerId==='getulio' && !achievements['historic_1930']) { achievements['historic_1930']=true; earned.push('historic_1930'); }
    if(scenario==='1955' && winnerId==='jk' && !achievements['historic_1955']) { achievements['historic_1955']=true; earned.push('historic_1955'); }
    if(scenario==='1989' && winnerId==='collor' && !achievements['historic_1989']) { achievements['historic_1989']=true; earned.push('historic_1989'); }
    if(scenario==='1994' && winnerId==='fhc' && !achievements['historic_1994']) { achievements['historic_1994']=true; earned.push('historic_1994'); }
    if(scenario==='2002' && winnerId==='lula' && !achievements['historic_2002']) { achievements['historic_2002']=true; earned.push('historic_2002'); }
    if(scenario==='2022' && winnerId==='lula22' && !achievements['historic_2022']) { achievements['historic_2022']=true; earned.push('historic_2022'); }
    // Rui Barbosa wins
    if(game.isRepVelha && (winnerId==='rui10'||winnerId==='rui14'||winnerId==='rui19') && !achievements['rui_barbosa']) { achievements['rui_barbosa']=true; earned.push('rui_barbosa'); }
    // Come from behind: check pollHistory at turn 5
    if(game.pollHistory.length >= 5) {
        let snap5 = game.pollHistory[Math.min(4, game.pollHistory.length-1)];
        let playerVotes5 = snap5?.votes[winnerId] || 100;
        let ranked5 = Object.entries(snap5?.votes||{}).sort((a,b)=>b[1]-a[1]).findIndex(([id])=>id===winnerId);
        if(ranked5 >= 2 && !achievements['come_from_behind']) { achievements['come_from_behind']=true; earned.push('come_from_behind'); }
        if(playerVotes5 < 10 && !achievements['survivor']) { achievements['survivor']=true; earned.push('survivor'); }
    }
    // Check all states
    if(!game.isGovernor && !game.isRepVelha && !achievements['all_states']) {
        let statesWon = allStates.filter(s => {
            let v = Object.entries(game.stateVotes[s.id]||{}).sort((a,b)=>b[1]-a[1]);
            return v.length>0 && v[0][0]===winnerId;
        }).length;
        if(statesWon>=27) { achievements['all_states']=true; earned.push('all_states'); }
    }
    try { localStorage.setItem('sim_achievements', JSON.stringify(achievements)); } catch(e) {}
    // New achievements
    if(scenario==='GER2025' && !achievements['germany_win']) { achievements['germany_win']=true; earned.push('germany_win'); }
    if(scenario==='FRA2022' && !achievements['france_win']) { achievements['france_win']=true; earned.push('france_win'); }
    if((game.scandalLevels[winnerId]||0)===0 && !achievements['clean_campaign']) { achievements['clean_campaign']=true; earned.push('clean_campaign'); }
    // v14 achievements
    if(scenario==='UKR2019' && !achievements['ukraine_win']) { achievements['ukraine_win']=true; earned.push('ukraine_win'); }
    if(scenario==='ESP2023' && !achievements['spain_win']) { achievements['spain_win']=true; earned.push('spain_win'); }
    if(scenario==='JAP2026' && !achievements['japan_win']) { achievements['japan_win']=true; earned.push('japan_win'); }
    if(scenario==='KOR2025' && !achievements['skorea_win']) { achievements['skorea_win']=true; earned.push('skorea_win'); }
    if(scenario==='ZAF2024' && !achievements['safrica_win']) { achievements['safrica_win']=true; earned.push('safrica_win'); }
    if(scenario==='PHL2022' && !achievements['philippines_win']) { achievements['philippines_win']=true; earned.push('philippines_win'); }
    if(scenario==='TUR2023' && !achievements['turkey_win']) { achievements['turkey_win']=true; earned.push('turkey_win'); }
    if(scenario==='GER1932' && !achievements['ger1932_win']) { achievements['ger1932_win']=true; earned.push('ger1932_win'); }
    if(scenario==='GER1932' && winnerId!=='hitler' && winnerVotes>53 && !achievements['stop_hitler']) { achievements['stop_hitler']=true; earned.push('stop_hitler'); }
    if(game.mode==='caotico' && !achievements['chaos_mode']) { achievements['chaos_mode']=true; earned.push('chaos_mode'); }
    if(game.coalition.filter(p=>!p.includes('_seat')).length===0 && !achievements['lone_wolf']) { achievements['lone_wolf']=true; earned.push('lone_wolf'); }
    if(game.isElectoralCollege && !achievements['indirect_master']) { achievements['indirect_master']=true; earned.push('indirect_master'); }
    let coalLen8 = game.coalition.filter(p=>!p.includes('_seat')).length;
    if(coalLen8>=8 && !achievements['mega_coalition']) { achievements['mega_coalition']=true; earned.push('mega_coalition'); }
    if(game.money>80 && !achievements['wealthy_winner']) { achievements['wealthy_winner']=true; earned.push('wealthy_winner'); }
    if(game.turn<=8 && !achievements['speed_run']) { achievements['speed_run']=true; earned.push('speed_run'); }
    // Spirit master: tracked via game.spiritsActivated
    if((game.spiritsActivated||0)>=5 && !achievements['spirit_master']) { achievements['spirit_master']=true; earned.push('spirit_master'); }
    // Perfect debate: tracked via game.debatesWon and game.debatesTotal
    if(game.debatesTotal>0 && game.debatesWon===game.debatesTotal && game.debatesTotal>=2 && !achievements['perfect_debate']) { achievements['perfect_debate']=true; earned.push('perfect_debate'); }
    // Always leading: tracked via game.turnLed
    if((game.turnLed||0)>=14 && !achievements['first_turn_lead']) { achievements['first_turn_lead']=true; earned.push('first_turn_lead'); }
    // All scenarios played: track in localStorage
    let played = JSON.parse(localStorage.getItem('sim_played_scenarios') || '[]');
    if(!played.includes(scenario)) played.push(scenario);
    try { localStorage.setItem('sim_played_scenarios', JSON.stringify(played)); } catch(e) {}
    if(played.length>=10 && !achievements['all_scenarios']) { achievements['all_scenarios']=true; earned.push('all_scenarios'); }
    // International wins
    if(scenario==='ITA2022' && !achievements['italy_win']) { achievements['italy_win']=true; earned.push('italy_win'); }
    if(scenario==='ARG2023' && !achievements['argentina_win']) { achievements['argentina_win']=true; earned.push('argentina_win'); }
    if(scenario==='IND2024' && !achievements['india_win']) { achievements['india_win']=true; earned.push('india_win'); }
    if(scenario==='UK2024' && !achievements['uk_win']) { achievements['uk_win']=true; earned.push('uk_win'); }
    if(scenario==='POL2025' && !achievements['poland_win']) { achievements['poland_win']=true; earned.push('poland_win'); }
    if(scenario==='USA2020' && !achievements['usa2020_win']) { achievements['usa2020_win']=true; earned.push('usa2020_win'); }
    if(scenario==='RUS1996' && !achievements['russia96_win']) { achievements['russia96_win']=true; earned.push('russia96_win'); }
    if((scenario==='POR2026'||scenario==='POR2024') && !achievements['portugal_win']) { achievements['portugal_win']=true; earned.push('portugal_win'); }
    if(scenario==='VEN2024' && !achievements['venezuela_win']) { achievements['venezuela_win']=true; earned.push('venezuela_win'); }
    if(scenario==='MEX2024' && !achievements['mexico_win']) { achievements['mexico_win']=true; earned.push('mexico_win'); }
    if(scenario==='CHI2025' && !achievements['chile_win']) { achievements['chile_win']=true; earned.push('chile_win'); }
    if(scenario==='COL2026' && !achievements['colombia_win']) { achievements['colombia_win']=true; earned.push('colombia_win'); }
    if(scenario==='CAN2025' && !achievements['canada_win']) { achievements['canada_win']=true; earned.push('canada_win'); }
    // Special playstyle
    if(game.mode==='sandbox' && !achievements['sandbox_win']) { achievements['sandbox_win']=true; earned.push('sandbox_win'); }
    if((game.corruptFund||0)>0 && !achievements['corrupt_win']) { achievements['corrupt_win']=true; earned.push('corrupt_win'); }
    if(game.vice && !achievements['vice_win']) { achievements['vice_win']=true; earned.push('vice_win'); }
    // Regional wins
    if(!game.isGovernor && !game.isRepVelha) {
        let nordeste = allStates.filter(s=>s.r==='Nordeste').every(s=>{
            let v = Object.entries(game.stateVotes[s.id]||{}).sort((a,b)=>b[1]-a[1]);
            return v.length>0 && v[0][0]===winnerId;
        });
        if(nordeste && !achievements['northeast_win']) { achievements['northeast_win']=true; earned.push('northeast_win'); }
        let sul = allStates.filter(s=>s.r==='Sul').every(s=>{
            let v = Object.entries(game.stateVotes[s.id]||{}).sort((a,b)=>b[1]-a[1]);
            return v.length>0 && v[0][0]===winnerId;
        });
        if(sul && !achievements['south_win']) { achievements['south_win']=true; earned.push('south_win'); }
        let allR = ['Norte','Nordeste','Sudeste','Sul','Centro-Oeste'].every(reg => {
            let sts = allStates.filter(s=>s.r===reg);
            return sts.some(s=>{
                let v = Object.entries(game.stateVotes[s.id]||{}).sort((a,b)=>b[1]-a[1]);
                return v.length>0 && v[0][0]===winnerId;
            });
        });
        if(allR && !achievements['all_regions']) { achievements['all_regions']=true; earned.push('all_regions'); }
    }
    // Historic scenarios
    if(scenario==='2018' && winnerId==='bolsonaro' && !achievements['historic_2018']) { achievements['historic_2018']=true; earned.push('historic_2018'); }
    if(scenario==='2010' && winnerId==='dilma' && !achievements['historic_2010']) { achievements['historic_2010']=true; earned.push('historic_2010'); }
    if(scenario==='2006' && winnerId==='lula06' && !achievements['historic_2006']) { achievements['historic_2006']=true; earned.push('historic_2006'); }
    if(scenario==='2014' && winnerId==='dilma14' && !achievements['historic_2014']) { achievements['historic_2014']=true; earned.push('historic_2014'); }
    if(scenario==='1960' && winnerId==='janio' && !achievements['historic_1960']) { achievements['historic_1960']=true; earned.push('historic_1960'); }
    if(scenario==='1998' && winnerId==='fhc98' && !achievements['historic_1998']) { achievements['historic_1998']=true; earned.push('historic_1998'); }
    // Custom win
    if(winnerId==='custom' && !achievements['custom_win']) { achievements['custom_win']=true; earned.push('custom_win'); }
    // Consecutive wins
    let wins = parseInt(localStorage.getItem('sim_consecutive_wins')||'0');
    wins++; localStorage.setItem('sim_consecutive_wins', wins);
    if(wins>=5 && !achievements['five_in_row']) { achievements['five_in_row']=true; earned.push('five_in_row'); }
    // Debates
    if(game.debatesWon>=5 && !achievements['debate_sweep']) { achievements['debate_sweep']=true; earned.push('debate_sweep'); }
    // Last minute
    if(game.pollHistory.length>=14) {
        let snap14 = game.pollHistory[13];
        let rank14 = Object.entries(snap14?.votes||{}).sort((a,b)=>b[1]-a[1]).findIndex(([id])=>id===winnerId);
        if(rank14===1 && !achievements['last_minute']) { achievements['last_minute']=true; earned.push('last_minute'); }
    }
    // Played all international
    let intlScenarios = ['ITA2022','ARG2023','IND2024','UK2024','POL2025','USA2020','RUS1996','GER2025','FRA2022','USA2024','VEN2024','MEX2024','CHI2025','COL2026','CAN2025'];
    if(intlScenarios.every(s=>played.includes(s)) && !achievements['all_international']) { achievements['all_international']=true; earned.push('all_international'); }
    // All Rep Velha
    let rvScenarios = ['RV1910','RV1914','RV1919','RV1922','RV1926','RV1930'];
    if(rvScenarios.every(s=>played.includes(s)) && !achievements['ancient_history']) { achievements['ancient_history']=true; earned.push('ancient_history'); }

    // NEW v13+ ACHIEVEMENTS
    // Parliamentary system
    const sc_data = internationalData[scenario];
    if(sc_data && sc_data.isParliamentary && sc_data.parliamentSeats) {
        let majority = sc_data.majoritySeats || Math.floor(sc_data.parliamentSeats/2)+1;
        let totalV = game.candidates.reduce((a,c)=>a+c.votes,0);
        let qualified = game.candidates.filter(c=>c.votes/totalV>=0.05);
        let qualTotal = qualified.reduce((a,c)=>a+c.votes,0);
        let mySeats = Math.round((game.candidates.find(c=>c.id===winnerId)?.votes||0)/qualTotal*sc_data.parliamentSeats);
        if(mySeats >= majority && !achievements['parliament_majority']) { achievements['parliament_majority']=true; earned.push('parliament_majority'); }
        if(mySeats < majority && !achievements['coalition_gov']) { achievements['coalition_gov']=true; earned.push('coalition_gov'); }
        if(['UK2024','ESP2023'].includes(scenario) && !achievements['snap_election']) { achievements['snap_election']=true; earned.push('snap_election'); }
    }
    // Electoral College specific
    if(game.isElectoralCollege) {
        let evCounts = getEVCounts();
        let winEV = evCounts[winnerId]||0;
        if(winEV >= 350 && !achievements['ec_landslide_ev']) { achievements['ec_landslide_ev']=true; earned.push('ec_landslide_ev'); }
        const ecSc = internationalData[scenario];
        if(ecSc && ecSc.electoralStates) {
            let swings = ecSc.electoralStates.filter(s=>s.lean==='S');
            let allSwingsWon = swings.every(s=>{
                let votes = game.stateVotes[s.id];
                if(!votes) return false;
                let sorted = Object.entries(votes).sort((a,b)=>b[1]-a[1]);
                return sorted.length>0 && sorted[0][0]===winnerId;
            });
            if(allSwingsWon && swings.length>0 && !achievements['ec_sweep']) { achievements['ec_sweep']=true; earned.push('ec_sweep'); }
        }
        // Comeback: win EC while behind in popular
        let myPop = game.candidates.find(c=>c.id===winnerId)?.votes||0;
        let others = game.candidates.filter(c=>c.id!==winnerId).sort((a,b)=>b.votes-a.votes);
        if(others.length>0 && myPop < others[0].votes && winEV>=270 && !achievements['ec_comeback']) { achievements['ec_comeback']=true; earned.push('ec_comeback'); }
    }
    // Geographic
    let europeScenarios = ['GER2025','FRA2022','UK2024','POL2025','ITA2022','POR2026','ESP2023','TUR2023','UKR2019'];
    if(europeScenarios.filter(s=>played.includes(s)).length>=europeScenarios.length && !achievements['europe_all']) { achievements['europe_all']=true; earned.push('europe_all'); }
    let asiaScenarios = ['IND2024','JAP2026','KOR2025','PHL2022'];
    if(asiaScenarios.filter(s=>played.includes(s)).length>=asiaScenarios.length && !achievements['asia_all']) { achievements['asia_all']=true; earned.push('asia_all'); }
    let latinScenarios = ['ARG2023','MEX2024','CHI2025','COL2026','VEN2024'];
    if(latinScenarios.filter(s=>played.includes(s)).length>=latinScenarios.length && !achievements['latin_all']) { achievements['latin_all']=true; earned.push('latin_all'); }
    if(played.includes('ZAF2024') && !achievements['africa_play']) { achievements['africa_play']=true; earned.push('africa_play'); }
    if(winnerVotes>=80 && !achievements['total_dominator']) { achievements['total_dominator']=true; earned.push('total_dominator'); }
    // === NOVAS CONQUISTAS v16 ===
    if(scenario==='USA2016' && !achievements['usa2016_win']) { achievements['usa2016_win']=true; earned.push('usa2016_win'); }
    if(scenario==='USA2012' && !achievements['usa2012_win']) { achievements['usa2012_win']=true; earned.push('usa2012_win'); }
    if(scenario==='USA2008' && !achievements['usa2008_win']) { achievements['usa2008_win']=true; earned.push('usa2008_win'); }
    if(scenario==='USA2004' && !achievements['usa2004_win']) { achievements['usa2004_win']=true; earned.push('usa2004_win'); }
    if(scenario==='USA2000' && !achievements['usa2000_win']) { achievements['usa2000_win']=true; earned.push('usa2000_win'); }
    if((game.crisesTabVisits||0)>=8 && !achievements['scandal_master']) { achievements['scandal_master']=true; earned.push('scandal_master'); }
    if((game.narrativeSuccesses||0)>=5 && !achievements['narrative_king']) { achievements['narrative_king']=true; earned.push('narrative_king'); }
    if(game.isElectoralCollege) {
        const scEC = internationalData[game.scenario];
        if(scEC && scEC.electoralStates) {
            let swingStates = scEC.electoralStates.filter(s=>s.lean==='S');
            let allSwingWon = swingStates.every(s => {
                let v = Object.entries(game.stateVotes[s.id]||{}).sort((a,b)=>b[1]-a[1]);
                return v.length>0 && v[0][0]===winnerId;
            });
            if(allSwingWon && swingStates.length > 0 && !achievements['ec_all_swing']) { achievements['ec_all_swing']=true; earned.push('ec_all_swing'); }
        }
    }
    if((game.maxScandalReached||0)>=8 && !achievements['comeback_scandal']) { achievements['comeback_scandal']=true; earned.push('comeback_scandal'); }
    let sortedV2 = [...game.candidates].sort((a,b)=>b.votes-a.votes);
    let marginV2 = sortedV2.length>1 ? sortedV2[0].votes - sortedV2[1].votes : 100;
    if(game.vice && marginV2 < 2 && !achievements['vice_turned_election']) { achievements['vice_turned_election']=true; earned.push('vice_turned_election'); }
    if(internationalData[game.scenario] && (game.scandalLevels[winnerId]||0)===0 && !achievements['no_scandal_intl']) { achievements['no_scandal_intl']=true; earned.push('no_scandal_intl'); }
    let usaHistAll = ['USA2000','USA2004','USA2008','USA2012','USA2016','USA2020','USA2024'];
    if(usaHistAll.every(s=>played.includes(s)) && !achievements['usa_historical_all']) { achievements['usa_historical_all']=true; earned.push('usa_historical_all'); }
    if((game.maxRadicalization||0)>=95 && !achievements['max_radicalizado']) { achievements['max_radicalizado']=true; earned.push('max_radicalizado'); }
    if(game.peacemakerAchieved && !achievements['peacemaker']) { achievements['peacemaker']=true; earned.push('peacemaker'); }

    try { localStorage.setItem('sim_achievements', JSON.stringify(achievements)); } catch(e) {}
    if(earned.length > 0) {
        setTimeout(()=>{
            let html = earned.map(id=>{
                let def = achievementDefs.find(d=>d.id===id);
                return def ? `<div style="padding:8px;border:2px solid var(--gold);background:#fffde8;margin:4px 0"><b>${def.emoji} ${def.name}</b><br><small>${def.desc}</small></div>` : '';
            }).join('');
            showModal('üèÜ CONQUISTAS DESBLOQUEADAS!', html, `<button class="btn" onclick="closeModal()">Excelente!</button>`);
        }, 1000);
    }
}

// ============================================================
// DADOS DE ELEI√á√ïES ESTADUAIS (GOVERNADORES)
// ============================================================
const governorData = {
    "RJ2022": {
        title:"Rio de Janeiro 2022", state:"RJ", year:"2022", emoji:"üèñÔ∏è",
        desc:"Castro vs Freixo. Direita x Esquerda no RJ.",
        available:true,
        newsHeader:"O Globo ‚Äî OUTUBRO 2022",
        stateFullName:"Rio de Janeiro",
        partyPoolOverride:[
            {n:"PP",side:"D",owner:null},{n:"PSOL",side:"E",owner:null},{n:"PDT",side:"C",owner:null},{n:"AVANTE",side:"C",owner:null}
        ],
        candidates:{
            castro22: {name:"CASTRO",   party:"PL",   start:42, money:55, side:"D", color:"#22bb22", econ:1,  soc:-2, nat:2,  bio:"Cl√°udio Castro, governador incumbente. Herdeiro pol√≠tico de Wilson Witzel. Venceu no 2¬∫ turno com 59% contra Freixo. Apoiado por Bolsonaro.", ideologia:"Conservadorismo Bolsonarista"},
            freixo22: {name:"FREIXO",   party:"PSB",  start:30, money:45, side:"E", color:"#cc0000", econ:-1, soc:2,  nat:1,  bio:"Marcelo Freixo, deputado federal e cineasta. Ex-PSOL, foi para PSB com apoio de Lula. Perdeu para Castro no 2T por ampla margem.", ideologia:"Social-Democracia"},
            rodrigues:{name:"RODRIGUES",party:"NOVO", start:11, money:20, side:"D", color:"#ff6600", econ:2,  soc:-1, nat:0,  bio:"Eduardo Serra Rodrigues, candidato do Novo. Representou o voto liberal-conservador que n√£o queria votar em Castro.", ideologia:"Liberalismo Cl√°ssico"},
            lindber:  {name:"LINDBERGH",party:"PT",   start:10, money:15, side:"E", color:"#ff3333", econ:-2, soc:2,  nat:1,  bio:"Lindbergh Farias, ex-senador e vereador carioca. Candidato da esquerda petista no estado.", ideologia:"Social-Desenvolvimentismo"},
            cyro22:   {name:"CYRO",     party:"PDT",  start:6,  money:10, side:"C", color:"#996600", econ:0,  soc:1,  nat:0,  bio:"Cyro Garcia, candidato do PDT, esquerda brizolista hist√≥rica.", ideologia:"Trabalhismo"}
        },
        regions:[
            {id:'METRO', n:'Capital (Rio)',      x:60,y:65, p:35, econ:0, soc:1,  nat:0},
            {id:'BAIXADA',n:'Baixada Fluminense',x:50,y:62, p:22, econ:-1,soc:0,  nat:1},
            {id:'NITEROI',n:'Niter√≥i/SG',        x:68,y:65, p:10, econ:1, soc:1,  nat:0},
            {id:'NORTE',  n:'Norte Fluminense',  x:72,y:28, p:8,  econ:-1,soc:0,  nat:1},
            {id:'SERRANA',n:'Regi√£o Serrana',    x:60,y:42, p:7,  econ:0, soc:-1, nat:1},
            {id:'LAGOS',  n:'Regi√£o dos Lagos',  x:78,y:55, p:5,  econ:0, soc:0,  nat:0},
            {id:'MEDIO',  n:'M√©dio Para√≠ba',     x:45,y:52, p:7,  econ:1, soc:-1, nat:0},
            {id:'SERTOEZ',n:'Noroeste',          x:35,y:38, p:3,  econ:-1,soc:-1, nat:1},
            {id:'COSTAV', n:'Costa Verde',       x:42,y:68, p:3,  econ:0, soc:0,  nat:0}
        ]
    },
    "SP2024MUN": {
        title:"S√£o Paulo Municipal 2024", state:"SP", year:"2024", emoji:"üèôÔ∏è",
        desc:"Nunes vs Boulos. Prefeitura da maior cidade.",
        available:true,
        newsHeader:"Folha de S. Paulo ‚Äî OUTUBRO 2024",
        stateFullName:"S√£o Paulo (Municipal)",
        isMunicipal:true,
        partyPoolOverride:[
            {n:"PP",side:"D",owner:null},{n:"PSB",side:"E",owner:null},{n:"PCdoB",side:"E",owner:null},{n:"AVANTE",side:"C",owner:null}
        ],
        candidates:{
            nunes24:  {name:"NUNES",    party:"MDB",  start:40, money:55, side:"D", color:"#0044cc", econ:1,  soc:-1, nat:0,  bio:"Ricardo Nunes, prefeito incumbente. Venceu o 2¬∫ turno contra Boulos com 59%. Apoiado por Bolsonaro e Tarc√≠sio. Candidato da direita paulistana.", ideologia:"Centro-Direita"},
            boulos:   {name:"BOULOS",   party:"PSOL", start:28, money:45, side:"E", color:"#cc0000", econ:-2, soc:2,  nat:1,  bio:"Guilherme Boulos, l√≠der do MTST e deputado federal. Candidato apoiado por Lula e Marta Suplicy. Perdeu para Nunes no 2T com 41%.", ideologia:"Socialismo Democr√°tico"},
            datena:   {name:"DATENA",   party:"PSDB", start:16, money:25, side:"C", color:"#0066aa", econ:0,  soc:0,  nat:0,  bio:"Jos√© Luiz Datena, apresentador de TV. Candidatura conturbada, tentou desistir v√°rias vezes, ganhou notoriedade por dar cadeirada em Pablo Mar√ßal durante debate.", ideologia:"Centrismo Midi√°tico"},
            tabata:   {name:"TABATA",   party:"PSB",  start:8,  money:20, side:"E", color:"#996600", econ:0,  soc:1,  nat:0,  bio:"Tabata Amaral, deputada federal. Candidata centro-esquerda progressista, ficou em 4¬∫ lugar.", ideologia:"Progressismo Liberal"},
            marcal:   {name:"MAR√áAL",   party:"PRTB", start:6,  money:15, side:"D", color:"#ff6600", econ:2,  soc:-2, nat:2,  bio:"Pablo Mar√ßal, coach e influenciador. Candidato bolsonarista radical, ficou em 3¬∫ e causou confus√£o no debate. Infernizou a campanha de Nunes.", ideologia:"Ultra-Conservadorismo"},
            marina24: {name:"MARINA",   party:"NOVO", start:2,  money:8,  side:"E", color:"#006600", econ:0,  soc:2,  nat:0,  bio:"Marina Helou, candidata da Rede Sustentabilidade. Presen√ßa ambiental no debate.", ideologia:"Ecologismo"}
        },
        regions:[
            {id:'CENTRO', n:'Centro/Oeste',      x:40,y:55, p:12, econ:2, soc:1,  nat:0},
            {id:'LESTE1', n:'Zona Leste I',       x:65,y:52, p:18, econ:-1,soc:1,  nat:1},
            {id:'LESTE2', n:'Zona Leste II',      x:75,y:55, p:12, econ:-2,soc:1,  nat:1},
            {id:'NORTE',  n:'Zona Norte',         x:50,y:38, p:14, econ:0, soc:0,  nat:1},
            {id:'SUL',    n:'Zona Sul',           x:45,y:72, p:15, econ:0, soc:0,  nat:0},
            {id:'SUDSUL', n:'Santo Amaro/ABC',    x:55,y:78, p:10, econ:1, soc:-1, nat:0},
            {id:'PENHA',  n:'Penha/Tatuap√©',      x:60,y:48, p:8,  econ:0, soc:0,  nat:0},
            {id:'PINHEIROS',n:'Pinheiros/Ibirapuera',x:38,y:60,p:7,econ:2,soc:2,  nat:-1},
            {id:'CAMPO',  n:'Campo Limpo/M\'boi', x:38,y:75, p:4,  econ:-2,soc:1,  nat:1}
        ]
    },
    "MG2022": {
        title:"Minas Gerais 2022", state:"MG", year:"2022", emoji:"‚õèÔ∏è",
        desc:"Zema tenta reelei√ß√£o em MG. Kalil desafia.",
        available:true,
        newsHeader:"Folha de Minas ‚Äî OUTUBRO 2022",
        stateFullName:"Minas Gerais",
        partyPoolOverride:[
            {n:"AVANTE",side:"C",owner:null},{n:"PSB",side:"E",owner:null},{n:"PCdoB",side:"E",owner:null},{n:"SOLIDARIEDADE",side:"C",owner:null}
        ],
        candidates:{
            zema22:   {name:"ZEMA",     party:"NOVO",  start:45, money:50, side:"D", color:"#ff6600", econ:2,  soc:-1, nat:0,  bio:"Romeu Zema, governador incumbente de MG. Liberal, anti-PT. Venceu a reelei√ß√£o no 1¬∫ turno com 56%, quebrando uma tradi√ß√£o de 2¬∫ turno no estado.", ideologia:"Liberalismo Cl√°ssico"},
            kalil22:  {name:"KALIL",    party:"PSD",   start:32, money:45, side:"E", color:"#cc0000", econ:-1, soc:1,  nat:0,  bio:"Alexandre Kalil, ex-prefeito de BH. Candidato apoiado por Lula, ex-PSD, ex-Avante. Perdeu para Zema no 1¬∫ turno por larga margem.", ideologia:"Centro-Esquerda"},
            viana22:  {name:"VIANA",    party:"PL",    start:12, money:25, side:"D", color:"#22bb22", econ:1,  soc:-2, nat:2,  bio:"Carlos Viana, senador bolsonarista. Esperava capitalizar o bolsonarismo em MG mas ficou em terceiro, abaixo das expectativas.", ideologia:"Conservadorismo Bolsonarista"},
            pestana:  {name:"PESTANA",  party:"PSDB",  start:6,  money:15, side:"D", color:"#0044cc", econ:1,  soc:0,  nat:-1, bio:"Marcus Pestana, deputado federal tucano. O PSDB entrou em colapso em MG assim como no plano nacional, obtendo vota√ß√£o irris√≥ria.", ideologia:"Social-Democracia"}
        },
        regions:[
            {id:'BH',      n:'Belo Horizonte',   x:62,y:50, p:14, econ:1,  soc:0, nat:0},
            {id:'TRI',     n:'Tri√¢ngulo Mineiro', x:30,y:38, p:10, econ:2,  soc:-1,nat:1},
            {id:'ZNORTE',  n:'Zona Norte',        x:68,y:22, p:9,  econ:-1, soc:1, nat:0},
            {id:'VALE',    n:'Vale do Rio Doce',  x:82,y:38, p:8,  econ:-1, soc:0, nat:1},
            {id:'MATA',    n:'Zona da Mata',      x:80,y:58, p:7,  econ:0,  soc:0, nat:0},
            {id:'SUL',     n:'Sul de Minas',      x:55,y:72, p:11, econ:1,  soc:-1,nat:0},
            {id:'CENTRO',  n:'Centro-Oeste MG',   x:45,y:50, p:8,  econ:1,  soc:-1,nat:0},
            {id:'NOROESTE',n:'Noroeste',           x:22,y:30, p:5,  econ:0,  soc:-1,nat:1},
            {id:'JEQUI',   n:'Jequitinhonha',     x:78,y:28, p:6,  econ:-2, soc:2, nat:0},
            {id:'METRO',   n:'Colar Metropolitano',x:58,y:56, p:12, econ:0,  soc:1, nat:0},
            {id:'ALTO',    n:'Alto Parana√≠ba',    x:35,y:42, p:5,  econ:1,  soc:-1,nat:1},
            {id:'LESTE',   n:'Leste Mineiro',     x:78,y:46, p:5,  econ:0,  soc:0, nat:0}
        ]
    },
    "SP2022": {
        title:"S√£o Paulo 2022", state:"SP", year:"2022", emoji:"üèôÔ∏è",
        desc:"Tarc√≠sio estreia. Haddad tenta voltar.",
        available:true,
        newsHeader:"Folha de SP ‚Äî OUTUBRO 2022",
        stateFullName:"S√£o Paulo",
        partyPoolOverride:[
            {n:"MDB",side:"C",owner:null},{n:"PSB",side:"E",owner:null},{n:"PCdoB",side:"E",owner:null},{n:"PSDB",side:"D",owner:null}
        ],
        candidates:{
            tarcisio: {name:"TARC√çSIO",  party:"REPUBLICANOS", start:35, money:55, side:"D", color:"#0044cc", econ:2,  soc:-2, nat:1,  bio:"Tarc√≠sio de Freitas, ex-ministro de Bolsonaro. Venceu o 2¬∫ turno contra Haddad com 57%. Ex-federal sem ra√≠zes em SP, tornou-se o nome mais forte da direita nacional.", ideologia:"Conservadorismo Bolsonarista"},
            haddad22: {name:"HADDAD",    party:"PT",           start:28, money:50, side:"E", color:"#cc0000", econ:-1, soc:2,  nat:1,  bio:"Fernando Haddad, ex-prefeito de SP e candidato presidencial 2018. Perdeu para Tarc√≠sio no 2T, mas fez campanha competitiva em SP.", ideologia:"Social-Desenvolvimentismo"},
            poit:     {name:"POIT",      party:"NOVO",         start:10, money:20, side:"D", color:"#ff6600", econ:2,  soc:-1, nat:0,  bio:"Vinicius Poit, candidato do Novo. Liberal cl√°ssico, ficou em terceiro. O Novo foi relevante em SP como espa√ßo para o voto antissistema de direita.", ideologia:"Liberalismo Cl√°ssico"},
            elvis:    {name:"ELVIS",     party:"PDT",          start:8,  money:15, side:"C", color:"#996600", econ:0,  soc:1,  nat:0,  bio:"Elvis Cezar, prefeito de Santo Andr√©. Candidato do PDT, tentou ocupar o centro-esquerda moderado mas ficou sem espa√ßo numa elei√ß√£o polarizada.", ideologia:"Social-Democracia Trabalhista"},
            colombo:  {name:"COLOMBO",   party:"PCB",          start:1,  money:5,  side:"E", color:"#8b0000", econ:-2, soc:2,  nat:1,  bio:"Gabriel Colombo, candidato comunista. Presen√ßa simb√≥lica da esquerda radical em SP.", ideologia:"Comunismo"}
        },
        regions:[
            {id:'GRAN',    n:'Grande S√£o Paulo',  x:58,y:62, p:28, econ:1,  soc:0, nat:0},
            {id:'INT_N',   n:'Interior Norte',    x:55,y:30, p:12, econ:2,  soc:-1,nat:1},
            {id:'INT_O',   n:'Interior Oeste',    x:30,y:45, p:10, econ:2,  soc:-2,nat:1},
            {id:'INT_L',   n:'Interior Leste',    x:75,y:45, p:9,  econ:1,  soc:0, nat:0},
            {id:'VALE_P',  n:'Vale do Para√≠ba',   x:78,y:65, p:8,  econ:1,  soc:-1,nat:0},
            {id:'SOROCABA',n:'Sorocaba',           x:45,y:68, p:7,  econ:1,  soc:-1,nat:0},
            {id:'CAMPINAS',n:'Campinas',           x:48,y:52, p:11, econ:2,  soc:0, nat:-1},
            {id:'LITORAL', n:'Baixada Santista',  x:55,y:80, p:5,  econ:0,  soc:0, nat:0},
            {id:'ARA√áAT',  n:'Ara√ßatuba',         x:25,y:35, p:4,  econ:2,  soc:-2,nat:1},
            {id:'RIBEIRAP',n:'Ribeir√£o Preto',    x:60,y:40, p:6,  econ:2,  soc:-1,nat:0}
        ]
    }
};

let currentGovernorKey = null;
let partyPool = [];
let currentScenario = "1994";

let game = {
    player: "", turn: 1, money: 0, points: 2, fase: 1, difficulty: 2, mode: "historico",
    scenario: "1994",
    candidates: [], coalition: [], availableParties: [],
    stateVotes: {}, news: [], defeatedCandidates: [],
    pollHistory: [],
    scandalLevels: {},
    approvals: {},
    momentumTracker: {},
    congressSeats: {},
    firedHistoricalEvents: [],
    tvTime: {}, // candidate_id -> tv time points (0-100)
    spiritCooldown: 0,
    debatesWon: 0,
    debatesTotal: 0,
    debateCooldown: 0,
    debatePrep: null,
    centraoDebt: 0,
    spiritsActivated: 0,
    spiritsActivatedSet: null,
    partyWings: { moderate: 40, radical: 25, centrao: 35 },
    vice: null,
    corruptFund: 0,
    corruptImunidade: 0,
    mediaBonus: 0,
};

let currentEvents = [];

// ============================================================
// SISTEMA DE SOM COMPLETO
// ============================================================
let menuMusicCtx = null;
let menuMusicNodes = [];
let menuMusicPlaying = false;

function playSound(f, d=100, type='square', vol=0.3) {
    try {
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const osc = ctx.createOscillator();
        const g = ctx.createGain();
        osc.type = type;
        osc.connect(g); g.connect(ctx.destination);
        osc.frequency.value = f;
        g.gain.setValueAtTime(vol, ctx.currentTime);
        osc.start();
        g.gain.exponentialRampToValueAtTime(0.00001, ctx.currentTime + d/1000);
        setTimeout(() => ctx.close(), d + 150);
    } catch(e) {}
}

function playSoundSeq(notes, spacing=90) {
    notes.forEach(([f, d, t], i) => {
        setTimeout(() => playSound(f, d, t||'square', 0.25), i * spacing);
    });
}

function playVictoryFanfare() {
    playSoundSeq([
        [523,80],[659,80],[784,80],[1046,300,'sine'],
        [784,80,'sine'],[1046,400,'sine']
    ], 100);
}

function playDefeatSound() {
    playSoundSeq([[392,200,'sine'],[349,200,'sine'],[311,400,'sine']], 220);
}

function playAllianceSound() {
    playSoundSeq([[523,60],[659,60],[784,80],[880,120]], 80);
}

function playSpiritSound() {
    playSoundSeq([
        [880,60,'sine'],[1046,60,'sine'],[1318,80,'sine'],
        [1568,150,'sine'],[1318,80,'sine'],[1046,200,'sine']
    ], 70);
}

function playDebateSound() {
    playSoundSeq([[220,80],[294,60],[440,100]], 90);
}

function playScandalSound() {
    playSoundSeq([[200,80,'sawtooth'],[150,120,'sawtooth'],[100,200,'sawtooth']], 100);
}

function playNextTurnSound() {
    playSoundSeq([[330,50],[392,50],[440,80]], 70);
}

function playMenuHover() {
    playSound(523, 40, 'square', 0.1);
}

// Menu background music (marcha eleitoral procedural)
function startMenuMusic() {
    if(menuMusicPlaying) return;
    try {
        menuMusicCtx = new (window.AudioContext || window.webkitAudioContext)();
        menuMusicPlaying = true;
        let melody = [523,587,659,698,784,698,659,587,523,494,523,0,523,659,784,880,784,659,523,0];
        let bass   = [262,262,294,349,392,349,294,262,262,247,262,0,262,294,392,440,392,294,262,0];
        let idx = 0;
        let tempo = 280; // ms per note
        
        function playMelodyNote() {
            if(!menuMusicPlaying || !menuMusicCtx) return;
            let f = melody[idx % melody.length];
            let fb = bass[idx % bass.length];
            if(f > 0) {
                let osc = menuMusicCtx.createOscillator();
                let g = menuMusicCtx.createGain();
                osc.type = 'square';
                osc.frequency.value = f;
                g.gain.setValueAtTime(0.08, menuMusicCtx.currentTime);
                g.gain.exponentialRampToValueAtTime(0.001, menuMusicCtx.currentTime + (tempo-20)/1000);
                osc.connect(g); g.connect(menuMusicCtx.destination);
                osc.start(); osc.stop(menuMusicCtx.currentTime + tempo/1000);
            }
            if(fb > 0 && idx % 2 === 0) {
                let osc2 = menuMusicCtx.createOscillator();
                let g2 = menuMusicCtx.createGain();
                osc2.type = 'triangle';
                osc2.frequency.value = fb;
                g2.gain.setValueAtTime(0.05, menuMusicCtx.currentTime);
                g2.gain.exponentialRampToValueAtTime(0.001, menuMusicCtx.currentTime + (tempo*1.8)/1000);
                osc2.connect(g2); g2.connect(menuMusicCtx.destination);
                osc2.start(); osc2.stop(menuMusicCtx.currentTime + tempo*1.8/1000);
            }
            idx++;
            if(menuMusicPlaying) setTimeout(playMelodyNote, tempo);
        }
        playMelodyNote();
    } catch(e) {}
}

function stopMenuMusic() {
    menuMusicPlaying = false;
    if(menuMusicCtx) { try { menuMusicCtx.close(); } catch(e) {} menuMusicCtx = null; }
}

function init() {
    renderScenarios();
    // Music disabled
}

function toggleMenuMusic() {
    if(menuMusicPlaying) {
        stopMenuMusic();
        let btn = document.getElementById('music-btn');
        if(btn) btn.style.opacity = '0.3';
    } else {
        startMenuMusic();
        let btn = document.getElementById('music-btn');
        if(btn) btn.style.opacity = '1';
    }
}


let currentScenarioTab = 'pres';

function switchScenarioTab(tab) {
    currentScenarioTab = tab;
    ['pres','gov','mun','ind','pais','conq'].forEach(t => {
        const btn = document.getElementById('tab-btn-'+t);
        if(btn) btn.style.background = t===tab ? '#000080' : '';
        if(btn) btn.style.color = t===tab ? 'white' : '';
    });
    renderScenarios();
}

function renderScenarios() {
    const list = document.getElementById("scenario-list");
    list.innerHTML = "";

    if(currentScenarioTab === 'pres') {
        renderPresidentialScenarios(list);
    } else if(currentScenarioTab === 'gov') {
        renderGovernorScenarios(list);
    } else if(currentScenarioTab === 'mun') {
        renderMunicipalScenarios(list);
    } else if(currentScenarioTab === 'ind') {
        renderIndirectScenarios(list);
    } else if(currentScenarioTab === 'pais') {
        renderCountryScenarios(list);
    } else if(currentScenarioTab === 'conq') {
        renderAchievements(list);
    }
}

function renderPresidentialScenarios(list) {
    list.style.display = 'grid';
    list.style.gridTemplateColumns = 'repeat(3,1fr)';
    list.style.gap = '8px';

    const available = [];
    const cancelled = [];
    const repvelha = [];
    Object.entries(scenariosData).forEach(([key, sc]) => {
        if(!sc.available || sc.indirect) return;
        if(sc.isRepVelha) { repvelha.push([key,sc]); return; }
        if(sc.cancelled) cancelled.push([key,sc]);
        else available.push([key,sc]);
    });

    list.innerHTML += `<div style="grid-column:1/-1;font-size:10px;font-weight:bold;color:#000080;padding:2px 0;border-bottom:1px solid #aaa;margin-bottom:4px">üó≥Ô∏è ELEI√á√ïES DIRETAS PRESIDENCIAIS (1945‚Äì2026)</div>`;
    available.forEach(([key, sc]) => {
        list.innerHTML += `<div class="scenario-card" onclick="selectScenarioSound('${key}')">
            <div class="year">${sc.emoji} ${sc.year}</div>
            <h3>${sc.title}</h3>
            <div class="desc">${sc.desc}</div>
        </div>`;
    });

    if(cancelled.length) {
        list.innerHTML += `<div style="grid-column:1/-1;font-size:10px;font-weight:bold;color:#8b0000;padding:4px 0 2px;border-bottom:1px solid #cc9999;margin-top:8px;margin-bottom:4px">üö´ ELEI√á√ïES QUE N√ÉO OCORRERAM (Simuladas)</div>`;
        cancelled.forEach(([key, sc]) => {
            list.innerHTML += `<div class="scenario-card" style="background:#fff5f5;border-color:#cc8888;" onclick="selectScenarioSound('${key}')">
                <div class="year" style="color:#8b0000;font-size:16px">${sc.emoji} ${sc.year}</div>
                <h3>${sc.title}</h3>
                <div class="desc" style="color:#663333">${sc.desc}</div>
                <div style="font-size:9px;color:#aa0000;margin-top:2px">‚ö†Ô∏è Elei√ß√£o cancelada/n√£o realizada</div>
            </div>`;
        });
    }

    if(repvelha.length) {
        list.innerHTML += `<div style="grid-column:1/-1;font-size:10px;font-weight:bold;color:#8b4513;padding:4px 0 2px;border-bottom:2px solid #8b4513;margin-top:10px;margin-bottom:4px">üìú REP√öBLICA VELHA (1894‚Äì1930) ‚Äî Sem 2¬∫ turno ¬∑ Apenas jornais, r√°dio e com√≠cios</div>`;
        repvelha.forEach(([key, sc]) => {
            list.innerHTML += `<div class="scenario-card" style="background:#fff9f0;border-color:#8b4513" onclick="selectRepVelhaScenario('${key}')">
                <div class="year" style="color:#8b4513">${sc.emoji} ${sc.year}</div>
                <h3>${sc.title}</h3>
                <div class="desc">${sc.desc}</div>
                <div style="font-size:9px;color:#8b4513;margin-top:2px">üìú Rep. Velha ‚Äî Sem 2¬∫ turno</div>
            </div>`;
        });
    }
}

function renderMunicipalScenarios(list) {
    list.style.display = 'block';
    list.innerHTML = '';
    // SP2024MUN
    const mun = {'SP2024MUN': governorData['SP2024MUN']};
    list.innerHTML += `<div style="margin-bottom:12px;">
        <div style="font-size:11px;font-weight:bold;color:#000080;padding:4px 6px;background:#d4d0c8;border-left:4px solid #000080;margin-bottom:6px">üèôÔ∏è S√£o Paulo</div>
        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px;">
        ${Object.entries(mun).map(([key, g]) => `
            <div class="scenario-card" onclick="selectGovernorScenario('${key}')">
                <div class="year" style="font-size:18px">${g.emoji} ${g.year}</div>
                <h3>${g.title}</h3>
                <div class="desc">${g.desc}</div>
                <div style="font-size:9px;color:#884400;margin-top:2px">üèôÔ∏è Elei√ß√£o Municipal</div>
            </div>`).join('')}
        </div>
    </div>
    <div style="background:#f0f0f0;border:1px solid #ccc;padding:8px;margin-top:8px">
        <b style="font-size:10px;color:#666">üîí Municipais planejadas:</b><br>
        <small style="color:#888">RJ 2024 (Paes vs Ramagem) ¬∑ BH 2024 ¬∑ Salvador 2024 ¬∑ Recife 2024 ¬∑ Fortaleza 2024 ¬∑ SP 2020 ¬∑ RJ 2020 ¬∑ e mais...</small>
    </div>`;
}

function renderGovernorScenarios(list) {
    list.style.display = 'block';
    list.style.gridTemplateColumns = '';

    // Group by state, exclude municipals
    const byState = {};
    Object.entries(governorData).forEach(([key, g]) => {
        if(g.isMunicipal) return; // municipais ficam na aba pr√≥pria
        if(!byState[g.stateFullName]) byState[g.stateFullName] = [];
        byState[g.stateFullName].push([key, g]);
    });

    list.innerHTML = '';
    Object.entries(byState).forEach(([stateName, elections]) => {
        list.innerHTML += `<div style="margin-bottom:12px;">
            <div style="font-size:11px;font-weight:bold;color:#000080;padding:4px 6px;background:#d4d0c8;border-left:4px solid #000080;margin-bottom:6px">
                üó∫Ô∏è ${stateName}
            </div>
            <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px;">
            ${elections.map(([key, g]) => `
                <div class="scenario-card" onclick="selectGovernorScenario('${key}')">
                    <div class="year" style="font-size:18px">${g.emoji} ${g.year}</div>
                    <h3>${g.title}</h3>
                    <div class="desc">${g.desc}</div>
                    <div style="font-size:9px;color:#006600;margin-top:2px">üó∫Ô∏è Elei√ß√£o Estadual</div>
                </div>`).join('')}
            </div>
        </div>`;
    });
}

function renderIndirectScenarios(list) {
    list.style.display = 'grid';
    list.style.gridTemplateColumns = 'repeat(3,1fr)';
    list.style.gap = '8px';

    const indirect = [];
    const lockedInd = [];
    Object.entries(scenariosData).forEach(([key, sc]) => {
        if(sc.available && sc.indirect) indirect.push([key,sc]);
        else if(!sc.available && (key.endsWith('_i') || (sc.indirect))) lockedInd.push([key,sc]);
    });

    list.innerHTML += `<div style="grid-column:1/-1;font-size:10px;font-weight:bold;color:#8b0000;padding:2px 0;border-bottom:1px solid #cc9999;margin-bottom:4px">üèõÔ∏è COL√âGIOS ELEITORAIS & ELEI√á√ïES INDIRETAS</div>`;
    indirect.forEach(([key, sc]) => {
        list.innerHTML += `<div class="scenario-card indirect" onclick="selectScenarioSound('${key}')">
            <div class="year" style="color:#8b0000;font-size:18px">${sc.emoji} ${sc.year}</div>
            <h3>${sc.title}</h3>
            <div class="desc" style="color:#663333">${sc.desc}</div>
            <div style="font-size:9px;color:#8b4513;margin-top:3px;background:#ffeedd;padding:2px;border-radius:2px">üèõÔ∏è Sistema especial de vota√ß√£o</div>
        </div>`;
    });
    if(lockedInd.length) {
        list.innerHTML += `<div style="grid-column:1/-1;font-size:10px;font-weight:bold;color:#666;padding:4px 0;border-bottom:1px solid #ccc;margin-top:8px;margin-bottom:4px">üîí EM DESENVOLVIMENTO</div>`;
        lockedInd.forEach(([key,sc]) => {
            list.innerHTML += `<div class="scenario-card locked">
                <div class="year" style="font-size:14px">üîí ${sc.year}</div>
                <h3>${sc.title || key}</h3>
                <div class="desc">${sc.desc_locked||'Em desenvolvimento'}</div>
            </div>`;
        });
    }
}


function renderRepVelhaScenarios(list) {
    list.style.display = 'grid';
    list.style.gridTemplateColumns = 'repeat(3,1fr)';
    list.style.gap = '8px';
    list.innerHTML = `<div style="grid-column:1/-1;font-size:10px;font-weight:bold;color:#8b4513;padding:2px 0;border-bottom:2px solid #8b4513;margin-bottom:4px">üìú REP√öBLICA VELHA (1894‚Äì1930) ‚Äî Elei√ß√µes diretas sem 2¬∫ turno</div>`;
    Object.entries(repvelhaData).forEach(([key, sc]) => {
        list.innerHTML += `<div class="scenario-card" style="background:#fff9f0;border-color:#8b4513" onclick="selectRepVelhaScenario('${key}')">
            <div class="year" style="color:#8b4513">${sc.emoji} ${sc.year}</div>
            <h3>${sc.title}</h3>
            <div class="desc">${sc.desc}</div>
            <div style="font-size:9px;color:#8b4513;margin-top:2px">üìú Rep. Velha ‚Äî Sem 2¬∫ turno</div>
        </div>`;
    });
}

function renderCountryScenarios(list) {
    list.style.display = 'block';
    list.innerHTML = '';

    // === AM√âRICA DO NORTE ===
    list.innerHTML += `<div style="margin-bottom:12px">
        <div style="font-size:11px;font-weight:bold;color:#cc0000;padding:4px 6px;background:#f0e8d0;border-left:4px solid #cc0000;margin-bottom:6px">üåé AM√âRICA DO NORTE</div>
        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px">
            <div class="scenario-card" onclick="selectInternationalScenario('USA2024')">
                <div class="year" style="color:#cc0000">üá∫üá∏ 2024</div>
                <h3>Elei√ß√£o Presidencial EUA 2024</h3>
                <div class="desc">Trump vs Harris ‚Äî Col√©gio Eleitoral</div>
                <div style="font-size:9px;color:#000080;margin-top:2px">üèõÔ∏è Col√©gio Eleitoral ‚Äî 270 votos necess√°rios</div>
            </div>
            <div class="scenario-card" onclick="selectInternationalScenario('CAN2025')" style="background:#fff5f5;border-color:#cc0000">
                <div class="year" style="color:#cc0000">üá®üá¶ 2025</div>
                <h3>Elei√ß√µes Federais do Canad√° 2025</h3>
                <div class="desc">Carney vs Poilievre vs Singh vs Blanchet</div>
                <div style="font-size:9px;color:#cc0000;margin-top:2px">üèõÔ∏è Sistema parlamentar FPTP ‚Äî 343 cadeiras por constituency</div>
            </div>
        </div>
    </div>`;

    // === AM√âRICAS DO SUL E CENTRAL ===
    list.innerHTML += `<div style="margin-bottom:12px">
        <div style="font-size:11px;font-weight:bold;color:#006600;padding:4px 6px;background:#e8f5e8;border-left:4px solid #006600;margin-bottom:6px">üåé AM√âRICAS DO SUL E CENTRAL</div>
        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px">
            <div class="scenario-card" onclick="selectInternationalScenario('ARG2023')" style="background:#f5f8ff;border-color:#74acdf">
                <div class="year" style="color:#003087">üá¶üá∑ 2023</div>
                <h3>Elei√ß√µes Presidenciais Argentinas 2023</h3>
                <div class="desc">Milei vs Massa vs Bullrich</div>
                <div style="font-size:9px;color:#003087;margin-top:2px">üó≥Ô∏è Balotaje ‚Äî 2 turnos | 9 prov√≠ncias</div>
            </div>
            <div class="scenario-card" onclick="selectInternationalScenario('MEX2024')" style="background:#fff5f0;border-color:#8b0000">
                <div class="year" style="color:#8b0000">üá≤üáΩ 2024</div>
                <h3>Elei√ß√µes Presidenciais M√©xico 2024</h3>
                <div class="desc">Sheinbaum vs G√°lvez vs M√°ynez</div>
                <div style="font-size:9px;color:#8b0000;margin-top:2px">üó≥Ô∏è Turno √∫nico ‚Äî 14 regi√µes eleitorais</div>
            </div>
            <div class="scenario-card" onclick="selectInternationalScenario('VEN2024')" style="background:#fff0f0;border-color:#cc0000">
                <div class="year" style="color:#cc0000">üáªüá™ 2024</div>
                <h3>Elei√ß√µes Presidenciais Venezuela 2024</h3>
                <div class="desc">Maduro vs Gonz√°lez vs Bertucci</div>
                <div style="font-size:9px;color:#8b0000;margin-top:2px">‚ö†Ô∏è Elei√ß√£o contestada ‚Äî mec√¢nica especial</div>
            </div>
            <div class="scenario-card" onclick="selectInternationalScenario('COL2026')" style="background:#fff8f0;border-color:#cc7700">
                <div class="year" style="color:#cc6600">üá®üá¥ 2026</div>
                <h3>Elei√ß√µes Presidenciais Col√¥mbia 2026</h3>
                <div class="desc">Cepeda vs Espriella vs Fajardo vs Valencia</div>
                <div style="font-size:9px;color:#cc6600;margin-top:2px">üó≥Ô∏è 2 turnos ‚Äî 11 regi√µes colombianas</div>
            </div>
            <div class="scenario-card" onclick="selectInternationalScenario('CHI2025')" style="background:#f0f5ff;border-color:#003366">
                <div class="year" style="color:#003366">üá®üá± 2025</div>
                <h3>Elei√ß√µes Presidenciais Chile 2025</h3>
                <div class="desc">Kast vs Jara vs Matthei vs Narv√°ez</div>
                <div style="font-size:9px;color:#003366;margin-top:2px">üó≥Ô∏è 2 turnos ‚Äî 10 regi√µes chilenas</div>
            </div>
        </div>
    </div>`;

    // === ELEI√á√ïES HIST√ìRICAS INTERNACIONAIS ===
    list.innerHTML += `<div style="margin-bottom:12px">
        <div style="font-size:11px;font-weight:bold;color:#4a2800;padding:4px 6px;background:#f5e8d0;border-left:4px solid #8b4513;margin-bottom:6px">üìú ELEI√á√ïES HIST√ìRICAS INTERNACIONAIS</div>
        <div style="font-size:10px;font-weight:bold;color:#cc0000;margin-bottom:4px">üá∫üá∏ ELEI√á√ïES HIST√ìRICAS EUA ‚Äî Col√©gio Eleitoral</div>
        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:8px">
            <div class="scenario-card" onclick="selectInternationalScenario('USA2020')" style="background:#f5f5ff;border-color:#003399">
                <div class="year" style="color:#003399">üá∫üá∏ 2020</div>
                <h3>Elei√ß√£o Presidencial EUA 2020</h3>
                <div class="desc">Biden vs Trump ‚Äî Pandemia e polariza√ß√£o</div>
                <div style="font-size:9px;color:#000080;margin-top:2px">üèõÔ∏è Col√©gio Eleitoral ‚Äî 270 votos necess√°rios</div>
            </div>
            <div class="scenario-card" onclick="selectInternationalScenario('USA2016')" style="background:#fff5f5;border-color:#cc0000">
                <div class="year" style="color:#cc0000">üá∫üá∏ 2016</div>
                <h3>Elei√ß√£o Presidencial EUA 2016</h3>
                <div class="desc">Trump vs Clinton ‚Äî A Virada Hist√≥rica</div>
                <div style="font-size:9px;color:#cc0000;margin-top:2px">üèõÔ∏è Col√©gio Eleitoral ‚Äî 270 votos necess√°rios</div>
            </div>
            <div class="scenario-card" onclick="selectInternationalScenario('USA2012')" style="background:#f0f5ff;border-color:#003399">
                <div class="year" style="color:#003399">üá∫üá∏ 2012</div>
                <h3>Elei√ß√£o Presidencial EUA 2012</h3>
                <div class="desc">Obama vs Romney ‚Äî Batalha pelos swing states</div>
                <div style="font-size:9px;color:#003399;margin-top:2px">üèõÔ∏è Col√©gio Eleitoral ‚Äî 270 votos necess√°rios</div>
            </div>
            <div class="scenario-card" onclick="selectInternationalScenario('USA2008')" style="background:#f0f5ff;border-color:#003399">
                <div class="year" style="color:#003399">üá∫üá∏ 2008</div>
                <h3>Elei√ß√£o Presidencial EUA 2008</h3>
                <div class="desc">Obama vs McCain ‚Äî Elei√ß√£o hist√≥rica</div>
                <div style="font-size:9px;color:#003399;margin-top:2px">üèõÔ∏è Col√©gio Eleitoral ‚Äî 270 votos necess√°rios</div>
            </div>
            <div class="scenario-card" onclick="selectInternationalScenario('USA2004')" style="background:#fff5f5;border-color:#cc0000">
                <div class="year" style="color:#cc0000">üá∫üá∏ 2004</div>
                <h3>Elei√ß√£o Presidencial EUA 2004</h3>
                <div class="desc">Bush vs Kerry ‚Äî Era da Guerra ao Terror</div>
                <div style="font-size:9px;color:#cc0000;margin-top:2px">üèõÔ∏è Col√©gio Eleitoral ‚Äî 270 votos necess√°rios</div>
            </div>
            <div class="scenario-card" onclick="selectInternationalScenario('USA2000')" style="background:#f0f5ff;border-color:#003399">
                <div class="year" style="color:#003399">üá∫üá∏ 2000</div>
                <h3>Elei√ß√£o Presidencial EUA 2000</h3>
                <div class="desc">Bush vs Gore ‚Äî A Recontagem da Fl√≥rida</div>
                <div style="font-size:9px;color:#003399;margin-top:2px">üèõÔ∏è Col√©gio Eleitoral ‚Äî 270 votos necess√°rios</div>
            </div>
        </div>
        <div style="font-size:10px;font-weight:bold;color:#4a2800;margin-bottom:4px;margin-top:8px">üåç ELEI√á√ïES HIST√ìRICAS MUNDIAIS</div>
        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px">
            <div class="scenario-card" onclick="selectInternationalScenario('GER1932')" style="background:#1a0a0a;border-color:#8b0000">
                <div class="year" style="color:#cc0000">üá©üá™üèõÔ∏è 1932</div>
                <h3>Elei√ß√£o Presidencial Alem√£ 1932</h3>
                <div class="desc">Hindenburg vs Hitler vs Th√§lmann ‚Äî Rep√∫blica de Weimar</div>
                <div style="font-size:9px;color:#cc4444;margin-top:2px">‚ö†Ô∏è ELEI√á√ÉO QUE MUDOU O MUNDO | 2 Turnos</div>
            </div>
            <div class="scenario-card" onclick="selectInternationalScenario('RUS1996')" style="background:#fff0f0;border-color:#993300">
                <div class="year" style="color:#993300">üá∑üá∫ 1996</div>
                <h3>Elei√ß√£o Presidencial Russa 1996</h3>
                <div class="desc">Yeltsin vs Zyuganov vs Lebed</div>
                <div style="font-size:9px;color:#993300;margin-top:2px">üì∞ Pr√©-Internet | 2 Turnos | Transi√ß√£o P√≥s-URSS</div>
            </div>
        </div>
    </div>`;

    // === EUROPA ===
    list.innerHTML += `<div style="margin-bottom:12px">
        <div style="font-size:11px;font-weight:bold;color:#003399;padding:4px 6px;background:#e8eef8;border-left:4px solid #003399;margin-bottom:6px">üåç EUROPA</div>
        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px">
            <div class="scenario-card" onclick="selectInternationalScenario('RUS2024')" style="background:#fff5f5;border-color:#cc2222">
                <div class="year" style="color:#cc0000">üá∑üá∫ 2024</div>
                <h3>Elei√ß√µes Russas 2024</h3>
                <div class="desc">Putin vs oposi√ß√£o simb√≥lica</div>
                <div style="font-size:9px;color:#8b0000;margin-top:2px">‚ö†Ô∏è Elei√ß√£o em contexto autorit√°rio</div>
            </div>
            <div class="scenario-card" onclick="selectInternationalScenario('GER2025')" style="background:#f5f5f5;border-color:#333">
                <div class="year" style="color:#000">üá©üá™ 2025</div>
                <h3>Elei√ß√£o Federal Alem√£ 2025</h3>
                <div class="desc">Merz vs Weidel vs Scholz</div>
                <div style="font-size:9px;color:#333;margin-top:2px">üó≥Ô∏è Sistema proporcional ‚Äî sem 2¬∫ turno</div>
            </div>
            <div class="scenario-card" onclick="selectInternationalScenario('FRA2022')" style="background:#f5f5ff;border-color:#0055a4">
                <div class="year" style="color:#0055a4">üá´üá∑ 2022</div>
                <h3>Elei√ß√£o Presidencial Francesa 2022</h3>
                <div class="desc">Macron vs Le Pen vs M√©lenchon</div>
                <div style="font-size:9px;color:#0055a4;margin-top:2px">üó≥Ô∏è 2 turnos ‚Äî maioria absoluta necess√°ria</div>
            </div>
            <div class="scenario-card" onclick="selectInternationalScenario('POR2026')" style="background:#f5fff5;border-color:#006600">
                <div class="year" style="color:#006600">üáµüáπ 2026</div>
                <h3>Elei√ß√µes Presidenciais de Portugal 2026</h3>
                <div class="desc">Seguro vs Ventura vs Gouveia e Melo vs Cotrim</div>
                <div style="font-size:9px;color:#006600;margin-top:2px">üó≥Ô∏è 2 turnos ‚Äî regi√µes de Portugal</div>
            </div>
            <div class="scenario-card" onclick="selectInternationalScenario('ITA2022')" style="background:#fff8f0;border-color:#009246">
                <div class="year" style="color:#009246">üáÆüáπ 2022</div>
                <h3>Elei√ß√µes Legislativas Italianas 2022</h3>
                <div class="desc">Meloni vs Letta vs Conte vs Calenda</div>
                <div style="font-size:9px;color:#ce2b37;margin-top:2px">üó≥Ô∏è Sistema proporcional ‚Äî sem 2¬∫ turno</div>
            </div>
            <div class="scenario-card" onclick="selectInternationalScenario('UK2024')" style="background:#f0f4ff;border-color:#002147">
                <div class="year" style="color:#002147">üá¨üáß 2024</div>
                <h3>Elei√ß√µes Gerais do Reino Unido 2024</h3>
                <div class="desc">Starmer vs Sunak vs Davey vs Swinney</div>
                <div style="font-size:9px;color:#002147;margin-top:2px">üèõÔ∏è FPTP parlamentar ‚Äî 650 cadeiras por constitu√™ncia</div>
            </div>
            <div class="scenario-card" onclick="selectInternationalScenario('POL2025')" style="background:#fff0f5;border-color:#dc143c">
                <div class="year" style="color:#dc143c">üáµüá± 2025</div>
                <h3>Elei√ß√µes Presidenciais da Pol√¥nia 2025</h3>
                <div class="desc">Nawrocki vs Trzaskowski vs Mentzen</div>
                <div style="font-size:9px;color:#dc143c;margin-top:2px">üó≥Ô∏è 2 turnos ‚Äî voivodatos poloneses</div>
            </div>
            <div class="scenario-card" onclick="selectInternationalScenario('UKR2019')" style="background:#f0f8ff;border-color:#0057b7">
                <div class="year" style="color:#0057b7">üá∫üá¶ 2019</div>
                <h3>Elei√ß√£o Presidencial da Ucr√¢nia 2019</h3>
                <div class="desc">Zelensky vs Poroshenko vs Tymoshenko</div>
                <div style="font-size:9px;color:#0057b7;margin-top:2px">üó≥Ô∏è 2 turnos ‚Äî oblasts ucranianos</div>
            </div>
            <div class="scenario-card" onclick="selectInternationalScenario('ESP2023')" style="background:#fff8e0;border-color:#aa0000">
                <div class="year" style="color:#aa0000">üá™üá∏ 2023</div>
                <h3>Elei√ß√µes Gerais da Espanha 2023</h3>
                <div class="desc">Feij√≥o vs S√°nchez vs Abascal vs D√≠az</div>
                <div style="font-size:9px;color:#aa0000;margin-top:2px">üèõÔ∏è Sistema parlamentar FPTP ‚Äî 350 assentos</div>
            </div>
            <div class="scenario-card" onclick="selectInternationalScenario('TUR2023')" style="background:#fff5e0;border-color:#c8102e">
                <div class="year" style="color:#c8102e">üáπüá∑ 2023</div>
                <h3>Elei√ß√£o Presidencial da Turquia 2023</h3>
                <div class="desc">Erdoƒüan vs Kƒ±lƒ±√ßdaroƒülu vs Oƒüan</div>
                <div style="font-size:9px;color:#c8102e;margin-top:2px">üó≥Ô∏è 2 turnos ‚Äî prov√≠ncias turcas</div>
            </div>
        </div>
    </div>`;

    // === √ÅSIA ===
    list.innerHTML += `<div style="margin-bottom:12px">
        <div style="font-size:11px;font-weight:bold;color:#8b4513;padding:4px 6px;background:#fff0e0;border-left:4px solid #8b4513;margin-bottom:6px">üåè √ÅSIA</div>
        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px">
            <div class="scenario-card" onclick="selectInternationalScenario('IND2024')" style="background:#fff5e0;border-color:#ff6600">
                <div class="year" style="color:#ff6600">üáÆüá≥ 2024</div>
                <h3>Elei√ß√µes Gerais Indianas 2024</h3>
                <div class="desc">Modi (BJP) vs Kharge (INC)</div>
                <div style="font-size:9px;color:#ff6600;margin-top:2px">üèõÔ∏è Sistema parlamentar ‚Äî 543 cadeiras Lok Sabha por constituency</div>
            </div>
            <div class="scenario-card" onclick="selectInternationalScenario('JAP2026')" style="background:#fff0f5;border-color:#bc002d">
                <div class="year" style="color:#bc002d">üáØüáµ 2026</div>
                <h3>Elei√ß√£o Parlamentar do Jap√£o 2026</h3>
                <div class="desc">Takaichi vs Noda vs Yoshimura vs Tamaki</div>
                <div style="font-size:9px;color:#bc002d;margin-top:2px">üèõÔ∏è Sistema parlamentar ‚Äî 465 assentos na C√¢mara dos Representantes</div>
            </div>
            <div class="scenario-card" onclick="selectInternationalScenario('KOR2025')" style="background:#f0f5ff;border-color:#003087">
                <div class="year" style="color:#003087">üá∞üá∑ 2025</div>
                <h3>Elei√ß√£o Presidencial da Coreia do Sul 2025</h3>
                <div class="desc">Lee Jae-myung vs Kim Moon-soo vs Lee Jun Seok</div>
                <div style="font-size:9px;color:#003087;margin-top:2px">üó≥Ô∏è Turno √∫nico p√≥s-impeachment de Yoon</div>
            </div>
            <div class="scenario-card" onclick="selectInternationalScenario('PHL2022')" style="background:#fff5f0;border-color:#0038A8">
                <div class="year" style="color:#0038A8">üáµüá≠ 2022</div>
                <h3>Elei√ß√£o Presidencial das Filipinas 2022</h3>
                <div class="desc">Marcos vs Robredo vs Pacquiao vs Moreno</div>
                <div style="font-size:9px;color:#0038A8;margin-top:2px">üó≥Ô∏è Turno √∫nico ‚Äî prov√≠ncias e regi√µes filipinas</div>
            </div>
        </div>
    </div>`;

    // === √ÅFRICA ===
    list.innerHTML += `<div style="margin-bottom:12px">
        <div style="font-size:11px;font-weight:bold;color:#1a5200;padding:4px 6px;background:#e8f5e0;border-left:4px solid #1a5200;margin-bottom:6px">üåç √ÅFRICA</div>
        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px">
            <div class="scenario-card" onclick="selectInternationalScenario('ZAF2024')" style="background:#f5fff0;border-color:#009a44">
                <div class="year" style="color:#009a44">üáøüá¶ 2024</div>
                <h3>Elei√ß√µes Gerais da √Åfrica do Sul 2024</h3>
                <div class="desc">Ramaphosa vs Steenhuisen vs Zuma vs Malema</div>
                <div style="font-size:9px;color:#009a44;margin-top:2px">üèõÔ∏è Sistema parlamentar PR ‚Äî 400 assentos na Assembleia Nacional</div>
            </div>
        </div>
    </div>`;

    const locked = [
        {flag:'üáßüá¥',name:'Bol√≠via 2025'},{flag:'üáµüá™',name:'Peru 2026'},
        {flag:'üá∏üá™',name:'Su√©cia 2026'},{flag:'üáÆüá©',name:'Indon√©sia 2024'},
        {flag:'üáßüá©',name:'Bangladesh 2024'},{flag:'üá≥üá¨',name:'Nig√©ria 2023'},
    ];
    list.innerHTML += `<div style="margin-bottom:8px">
        <div style="font-size:11px;font-weight:bold;color:#666;padding:4px 6px;background:#d4d0c8;border-left:4px solid #888;margin-bottom:6px">üîí EM DESENVOLVIMENTO</div>
        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px">
        ${locked.map(c=>`<div class="scenario-card locked">
            <div class="year" style="font-size:18px">${c.flag} üîí</div>
            <h3>${c.name}</h3>
            <div class="desc">Em desenvolvimento</div>
        </div>`).join('')}
        </div>
    </div>`;
}

function renderAchievements(list) {
    list.style.display = 'block';
    list.innerHTML = `<div style="font-size:11px;font-weight:bold;color:#000080;padding:4px 6px;background:#d4d0c8;border-left:4px solid gold;margin-bottom:8px">üèÜ CONQUISTAS ‚Äî ${Object.keys(achievements).length}/${achievementDefs.length} desbloqueadas</div>
    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px">
    ${achievementDefs.map(def=>{
        let earned = achievements[def.id];
        return '<div style="padding:10px;background:'+(earned?'#fffde8':'#eee')+';border:2px solid '+(earned?'var(--gold)':'#ccc')+';text-align:center;border-radius:2px"><div style="font-size:24px">'+(earned?def.emoji:'üîí')+'</div><b style="font-size:11px;color:'+(earned?'#000':'#888')+'">'+def.name+'</b><br><small style="color:#555">'+def.desc+'</small></div>';
    }).join('')}
    </div>
    <div style="margin-top:12px;padding:8px;background:#fff8e8;border:1px solid #cc9900"><b>üìä ESTAT√çSTICAS</b><br><small>Conquistas desbloqueadas: <b>${Object.keys(achievements).length}/${achievementDefs.length}</b></small></div>`;
}

function selectRepVelhaScenario(key) {
    playSound(523, 80);
    setTimeout(() => playSound(659, 80), 90);
    setTimeout(() => playSound(784, 120), 180);
    const sc = scenariosData[key];
    currentScenario = key;
    game.isRepVelha = true;
    game.isGovernor = false;
    game.isElectoralCollege = false;
    candidatesData = JSON.parse(JSON.stringify(sc.candidates));
    partyPool = sc.partyPoolOverride ? JSON.parse(JSON.stringify(sc.partyPoolOverride)) : [];
    document.getElementById("scenario-screen").classList.remove("active");
    document.getElementById("setup-screen").classList.add("active");
    document.getElementById("setup-title").innerHTML = `<h2 style="margin:5px 0">${sc.emoji} ${sc.title.toUpperCase()}</h2><p style="font-size:11px;color:#8b4513;margin:2px 0">üìú Rep√∫blica Velha ‚Äî Sem segundo turno</p>`;
    document.getElementById("news-date").innerText = sc.newsHeader || sc.year;
    const setup = document.getElementById("setup-candidates");
    setup.innerHTML = "";
    for(let k in candidatesData) {
        setup.innerHTML += `<div class="card" style="text-align:center;padding:5px;"><b>${candidatesData[k].name}</b><br><small>${candidatesData[k].party}</small><br><small style="color:#666">${candidatesData[k].ideologia}</small><br><button class="btn" onclick="startRepVelhaGame('${k}','${key}')">ESCOLHER</button></div>`;
    }
}

function startRepVelhaGame(id, scKey) {
    const sc = scenariosData[scKey];
    game.player = id; game.scenario = scKey;
    game.isGovernor = false; game.isRepVelha = true; game.isElectoralCollege = false;
    game.difficulty = parseInt(document.getElementById("difficulty-level").value);
    game.mode = document.getElementById("game-mode").value;
    game.money = candidatesData[id].money;
    game.points = game.difficulty === 1 ? 7 : (game.difficulty === 3 ? 3 : 5);
    game.energy = 100; game.firedHistoricalEvents = [];
    game.availableParties = JSON.parse(JSON.stringify(partyPool));
    game.coalition = []; game.news = []; game.scandalLevels = {};
    game.approvals = {}; game.momentumTracker = {}; game.congressSeats = {};
    game.stateVotes = {}; game.pollHistory = []; game.defeatedCandidates = [];
    game.fase = 1; game.turn = 1;
    game.candidates = Object.keys(candidatesData).map(k => ({id: k, ...candidatesData[k], votes: candidatesData[k].start}));
    game.candidates.forEach(c => {
        game.scandalLevels[c.id] = 0;
        game.approvals[c.id] = {app: c.votes * 1.1, rej: Math.max(5, 50 - c.votes)};
        game.momentumTracker[c.id] = [];
    });
    sc.regions.forEach(r => {
        game.stateVotes[r.id] = {};
        game.candidates.forEach(c => {
            let cd = candidatesData[c.id];
            let ideoDiff = Math.abs((cd.econ||0)-(r.econ||0)) + Math.abs((cd.soc||0)-(r.soc||0));
            game.stateVotes[r.id][c.id] = Math.max(1, c.votes + (4-ideoDiff)*1.5 + (Math.random()*6-3));
        });
        let sum = Object.values(game.stateVotes[r.id]).reduce((a,b)=>a+b,0);
        game.candidates.forEach(c => game.stateVotes[r.id][c.id] = (game.stateVotes[r.id][c.id]/sum)*100);
    });
    game.pollHistory = []; recordPollSnapshot();
    document.getElementById("setup-screen").classList.remove("active");
    document.getElementById("game-screen").classList.add("active");
    addNews(`ELEI√á√ïES ${sc.year} ‚Äî REP√öBLICA VELHA`, sc.desc);
    renderRegionalMap(sc.regions, '#3a2200');
    renderCampaignActions(); updateUI(); playSound(440);
}

function selectInternationalScenario(key) {
    playSound(523, 80);
    setTimeout(() => playSound(659, 80), 90);
    setTimeout(() => playSound(784, 120), 180);
    const sc = internationalData[key];
    currentScenario = key; game.isGovernor = false; game.isRepVelha = false;
    game.isElectoralCollege = sc.isElectoralCollege || false;
    candidatesData = JSON.parse(JSON.stringify(sc.candidates));
    partyPool = sc.partyPoolOverride ? JSON.parse(JSON.stringify(sc.partyPoolOverride)) : [];
    document.getElementById("scenario-screen").classList.remove("active");
    document.getElementById("setup-screen").classList.add("active");
    let subtitle = sc.isElectoralCollege 
        ? `<p style="font-size:11px;color:#000080;margin:2px 0">üèõÔ∏è Col√©gio Eleitoral ‚Äî 270 votos necess√°rios para vencer</p>`
        : `<p style="font-size:11px;color:#cc0000;margin:2px 0">üåç Elei√ß√£o Internacional ‚Äî Ven√ßa por maioria</p>`;
    document.getElementById("setup-title").innerHTML = `<h2 style="margin:5px 0">${sc.emoji} ${sc.title.toUpperCase()}</h2>${subtitle}`;
    document.getElementById("news-date").innerText = sc.newsHeader || sc.year;
    const setup = document.getElementById("setup-candidates");
    setup.innerHTML = "";
    for(let k in candidatesData) {
        setup.innerHTML += `<div class="card" style="text-align:center;padding:5px;"><b>${candidatesData[k].name}</b><br><small>${candidatesData[k].party}</small><br><small style="color:#666">${candidatesData[k].ideologia}</small><br><button class="btn" onclick="startInternationalGame('${k}','${key}')">ESCOLHER</button></div>`;
    }
}

function startInternationalGame(id, scKey) {
    const sc = internationalData[scKey];
    game.player = id; game.scenario = scKey;
    game.isGovernor = false; game.isRepVelha = false;
    game.isElectoralCollege = sc.isElectoralCollege || false;
    game.difficulty = parseInt(document.getElementById("difficulty-level").value);
    game.mode = document.getElementById("game-mode").value;
    game.money = candidatesData[id].money;
    game.points = game.difficulty === 1 ? 7 : (game.difficulty === 3 ? 3 : 5);
    game.energy = 100; game.firedHistoricalEvents = [];
    game.availableParties = JSON.parse(JSON.stringify(partyPool));
    game.coalition = []; game.news = []; game.scandalLevels = {};
    game.approvals = {}; game.momentumTracker = {}; game.congressSeats = {};
    game.stateVotes = {}; game.pollHistory = []; game.defeatedCandidates = [];
    game.fase = 1; game.turn = 1;
    game.candidates = Object.keys(candidatesData).map(k => ({id: k, ...candidatesData[k], votes: candidatesData[k].start}));
    game.candidates.forEach(c => {
        game.scandalLevels[c.id] = 0;
        game.approvals[c.id] = {app: c.votes * 1.1, rej: Math.max(5, 50 - c.votes)};
        game.momentumTracker[c.id] = [];
    });
    if(sc.isElectoralCollege && sc.electoralStates) {
        // Find top R and D candidates dynamically
        let topR = Object.entries(candidatesData).filter(([,c])=>c.side==='D').sort((a,b)=>b[1].start-a[1].start)[0]?.[0];
        let topD = Object.entries(candidatesData).filter(([,c])=>c.side==='E').sort((a,b)=>b[1].start-a[1].start)[0]?.[0];
        sc.electoralStates.forEach(s => {
            game.stateVotes[s.id] = {};
            // Safe states get enormous lean advantage: 28pts. Swing states only 5pts.
            let leanStrength = s.lean==='S' ? 5 : 28;
            game.candidates.forEach(c => {
                let cd = candidatesData[c.id];
                let leanBonus = s.lean==='R' ? (c.id===topR?leanStrength:-leanStrength) : 
                                s.lean==='D' ? (c.id===topD?leanStrength:-leanStrength) : 0;
                let ideoDiff = Math.abs((cd.econ||0)-(s.econ||0)) + Math.abs((cd.soc||0)-(s.soc||0));
                // More random variation per state so even safe states have unique starting points
                let stateRandom = (Math.random()*10-5); // ¬±5pts unique per state
                game.stateVotes[s.id][c.id] = Math.max(1, 50 + leanBonus + (4-ideoDiff)*1.5 + stateRandom);
            });
            let sum = Object.values(game.stateVotes[s.id]).reduce((a,b)=>a+b,0);
            game.candidates.forEach(c => game.stateVotes[s.id][c.id] = (game.stateVotes[s.id][c.id]/sum)*100);
        });
    } else if(sc.regions) {
        sc.regions.forEach(r => {
            game.stateVotes[r.id] = {};
            game.candidates.forEach(c => {
                let cd = candidatesData[c.id];
                let ideoDiff = Math.abs((cd.econ||0)-(r.econ||0)) + Math.abs((cd.soc||0)-(r.soc||0));
                // Each region starts with independent random variation so not all move together
                let regionRandom = (Math.random()*12-6); // ¬±6pts unique per region
                game.stateVotes[r.id][c.id] = Math.max(1, c.votes + (4-ideoDiff)*1.5 + regionRandom);
            });
            let sum = Object.values(game.stateVotes[r.id]).reduce((a,b)=>a+b,0);
            game.candidates.forEach(c => game.stateVotes[r.id][c.id] = (game.stateVotes[r.id][c.id]/sum)*100);
        });
    }
    game.pollHistory = []; recordPollSnapshot();
    if(game.mode === 'sandbox') { game.money = 9999; game.points = 9999; }
    document.getElementById("setup-screen").classList.remove("active");
    document.getElementById("game-screen").classList.add("active");
    addNews(`ELEI√á√ÉO: ${sc.title.toUpperCase()}`, sc.desc);
    if(sc.isElectoralCollege) {
        renderECMap(sc);
    } else if(sc.regions) {
        renderRegionalMap(sc.regions, '#1a2040');
    }
    renderCampaignActions(); updateUI(); playSound(440);
}

function renderRegionalMap(regions, bgColor) {
    const container = document.getElementById("map-container");
    container.innerHTML = '';
    container.style.background = bgColor || '#004d00';
    regions.forEach(r => {
        const node = document.createElement('div');
        node.id = 'node-'+r.id; node.className = 'state-node';
        node.style.left = r.x+'%'; node.style.top = r.y+'%';
        node.style.width = '36px'; node.style.height = '18px'; node.style.fontSize = '7px';
        node.textContent = r.id; node.title = r.n;
        node.onclick = () => showRegionDetail(r);
        container.appendChild(node);
    });
    updateRegionalMap(regions);
}

function updateRegionalMap(regions) {
    if(!regions) {
        if(game.isRepVelha && scenariosData[game.scenario]) regions = scenariosData[game.scenario].regions;
        else if(game.isGovernor && governorData[currentGovernorKey]) regions = governorData[currentGovernorKey].regions;
        else if(internationalData[game.scenario] && internationalData[game.scenario].regions) regions = internationalData[game.scenario].regions;
        else return;
    }
    regions.forEach(r => {
        let votes = game.stateVotes[r.id];
        if(!votes) return;
        let sorted = Object.entries(votes).sort((a,b)=>b[1]-a[1]);
        const node = document.getElementById('node-'+r.id);
        if(node && sorted.length && candidatesData[sorted[0][0]]) {
            node.style.backgroundColor = candidatesData[sorted[0][0]].color;
        }
    });
}

function renderECMap(sc) {
    const container = document.getElementById("map-container");
    container.innerHTML = ''; container.style.background = '#0d1525';
    // EV scoreboard bar at top
    let evBar = document.createElement('div');
    evBar.id = 'ec-ev-bar';
    evBar.style.cssText = 'position:absolute;top:2px;left:0;right:0;text-align:center;z-index:10;font-size:10px;color:white;pointer-events:none;';
    container.appendChild(evBar);
    sc.electoralStates.forEach(s => {
        const node = document.createElement('div');
        node.id = 'node-'+s.id; node.className = 'state-node';
        node.style.left = s.x+'%'; node.style.top = s.y+'%';
        node.style.width = '18px'; node.style.height = '13px'; node.style.fontSize = '6px';
        node.style.color = 'white';
        // Swing states get a gold border
        if(s.lean === 'S') node.style.outline = '1px solid gold';
        node.textContent = s.id; node.title = `${s.n} (${s.ev} EV)${s.lean==='S'?' ‚≠ê SWING':''}`;
        node.onclick = () => {
            let votes = game.stateVotes[s.id];
            if(!votes) return;
            let sorted = Object.entries(votes).sort((a,b)=>b[1]-a[1]);
            let swingTag = s.lean==='S' ? ' <span style="color:gold">‚≠ê SWING STATE</span>' : '';
            let html = `<b>${s.n}</b>${swingTag} ‚Äî <b>${s.ev} Electoral Votes</b><br>`;
            sorted.forEach(([cid,v])=>{
                let c = candidatesData[cid];
                if(c) html += `<span style="color:${c.color}">‚ñ†</span> ${c.name}: ${v.toFixed(1)}% &nbsp;`;
            });
            let cost_p = s.lean==='S' ? 2 : 3;
            let cost_m = s.lean==='S' ? 4 : 5;
            html += `<br><button class="btn" style="width:auto;font-size:10px;margin-top:4px" onclick="campaignEC('${s.id}',${s.ev})">Campanha aqui (${cost_p}p, $${cost_m}M)</button>`;
            document.getElementById("state-details").innerHTML = html;
        };
        container.appendChild(node);
    });
    // Swing state strategy button in state-details panel
    document.getElementById("state-details").innerHTML = `
        <b style="color:#FFD700">üá∫üá∏ COL√âGIO ELEITORAL</b><br>
        <small>270 votos eleitorais para vencer</small><br>
        <small style="color:gold">‚≠ê Estados com borda dourada = Swing States</small><br>
        <button class="btn" style="width:100%;margin-top:6px;font-size:10px;background:#1a3060" onclick="targetSwingStates()">‚≠ê Ver Swing States</button>
        <div id="ec-live-count" style="margin-top:8px;font-size:10px"></div>`;
    updateECMapColors(sc);
    updateECLiveCount();
}

function updateECLiveCount() {
    const div = document.getElementById('ec-live-count');
    if(!div) return;
    let evCounts = getEVCounts();
    let sorted = Object.entries(evCounts).sort((a,b)=>b[1]-a[1]);
    div.innerHTML = '<b>üó≥Ô∏è VOTOS ELEITORAIS ATUAIS:</b><br>' + sorted.map(([id,ev])=>{
        let c = candidatesData[id];
        if(!c) return '';
        let isPlayer = id === game.player;
        return `<div style="display:flex;justify-content:space-between;padding:1px 0"><span style="color:${c.color}">${isPlayer?'‚ñ∂ ':''}${c.name}</span><b style="color:${ev>=270?'#44ff44':'#ccc'}">${ev} EV ${ev>=270?'‚úì':''}</b></div>`;
    }).join('') + `<div style="color:#888;font-size:9px;margin-top:4px">270 necess√°rios</div>`;
}

function updateECMapColors(sc) {
    if(!sc) sc = internationalData[game.scenario];
    if(!sc) return;
    sc.electoralStates.forEach(s => {
        let votes = game.stateVotes[s.id];
        if(!votes) return;
        let sorted = Object.entries(votes).sort((a,b)=>b[1]-a[1]);
        const node = document.getElementById('node-'+s.id);
        if(node && sorted.length && candidatesData[sorted[0][0]]) {
            let margin = sorted.length>=2 ? sorted[0][1]-sorted[1][1] : 100;
            let col = candidatesData[sorted[0][0]].color;
            // Dimmer color if margin < 5% (very close)
            node.style.backgroundColor = col;
            node.style.opacity = margin < 3 ? '0.5' : margin < 8 ? '0.75' : '1';
        }
    });
    updateECLiveCount();
}

function campaignEC(sid, evWeight) {
    const sc = internationalData[game.scenario];
    const stateData = sc && sc.electoralStates ? sc.electoralStates.find(s=>s.id===sid) : null;
    const isSwing = stateData && stateData.lean === 'S';
    const cost_p = isSwing ? 2 : 3;
    const cost_m = isSwing ? 4 : 5;
    if(game.points < cost_p || game.money < cost_m) { log(`Not enough points (${cost_p}p) or money ($${cost_m}M).`); return; }
    game.points -= cost_p; game.money -= cost_m;
    let gain = evWeight * 1.5 + (isSwing ? evWeight * 0.5 : 0);
    game.stateVotes[sid][game.player] = (game.stateVotes[sid][game.player]||50) + gain;
    // Normalize that state
    let stateSum = Object.values(game.stateVotes[sid]).reduce((a,b)=>a+b,0);
    Object.keys(game.stateVotes[sid]).forEach(cid => game.stateVotes[sid][cid] = game.stateVotes[sid][cid]/stateSum*100);
    updateNationalVotes(game.player, evWeight * 0.15);
    log(`${isSwing?'‚≠ê SWING STATE ‚Äî ':''} Campaign in ${sid} (${evWeight} EV). +votes!`);
    updateECMapColors(sc);
    // Update EV display in state-details
    let votes = game.stateVotes[sid];
    let sorted = Object.entries(votes).sort((a,b)=>b[1]-a[1]);
    let html = `<b>${stateData?.n||sid}</b> ‚Äî ${evWeight} Electoral Votes ${isSwing?'‚≠ê SWING':''}:<br>`;
    sorted.forEach(([cid,v])=>{ let c = candidatesData[cid]; if(c) html+=`<span style="color:${c.color}">‚ñ†</span> ${c.name}: ${v.toFixed(1)}% `; });
    html += `<br><b style="color:#00cc00">‚úì Campanha feita aqui!</b><br><button class="btn" style="width:auto;font-size:10px;margin-top:4px" onclick="campaignEC('${sid}',${evWeight})">Campanha novamente (${cost_p}p,$${cost_m}M)</button>`;
    document.getElementById("state-details").innerHTML = html;
    updateUI();
}

function targetSwingStates() {
    // Show a list of swing states with current EV projections
    const sc = internationalData[game.scenario];
    if(!sc || !sc.electoralStates) return;
    let swings = sc.electoralStates.filter(s=>s.lean==='S');
    let evCounts = getEVCounts();
    let html = `<b>‚≠ê SWING STATES ‚Äî Foco Eleitoral</b><br><small>Estados competitivos onde cada campanha importa mais</small><hr>`;
    html += `<div style="display:grid;grid-template-columns:1fr 1fr;gap:6px;max-height:300px;overflow-y:auto">`;
    swings.forEach(s=>{
        let votes = game.stateVotes[s.id];
        let sorted = votes ? Object.entries(votes).sort((a,b)=>b[1]-a[1]) : [];
        let leader = sorted[0];
        let leaderCand = leader ? candidatesData[leader[0]] : null;
        let margin = sorted.length>=2 ? (sorted[0][1]-sorted[1][1]).toFixed(1) : '?';
        html += `<div style="background:#0d1525;border:1px solid #334;padding:6px;border-radius:3px">
            <b style="color:#FFD700">${s.n}</b> <small style="color:#888">${s.ev} EV</small><br>
            ${leaderCand?`<span style="color:${leaderCand.color}">‚ñ† ${leaderCand.name}</span> +${margin}%`:''}<br>
            <button class="btn" style="width:100%;font-size:9px;margin-top:4px;background:#1a3a1a" onclick="closeModal();document.getElementById('state-details').innerHTML='<b>${s.n.replace(/'/g,'')}</b>';campaignEC('${s.id}',${s.ev})">Fazer Campanha (2p,$4M)</button>
        </div>`;
    });
    html += '</div>';
    showModal('‚≠ê ESTRAT√âGIA: SWING STATES', html, `<button class="btn" onclick="closeModal()">Fechar</button>`);
}

function getEVCounts() {
    const sc = internationalData[game.scenario];
    if(!sc) return {};
    let evCounts = {};
    game.candidates.forEach(c => evCounts[c.id] = 0);
    sc.electoralStates.forEach(s => {
        let votes = game.stateVotes[s.id];
        if(!votes) return;
        let sorted = Object.entries(votes).sort((a,b)=>b[1]-a[1]);
        if(sorted.length) evCounts[sorted[0][0]] = (evCounts[sorted[0][0]]||0) + s.ev;
    });
    return evCounts;
}

function selectGovernorScenario(key) {
    playSound(523, 80);
    setTimeout(() => playSound(659, 80), 90);
    setTimeout(() => playSound(784, 120), 180);
    currentGovernorKey = key;
    const g = governorData[key];
    candidatesData = JSON.parse(JSON.stringify(g.candidates));
    partyPool = g.partyPoolOverride ? JSON.parse(JSON.stringify(g.partyPoolOverride)) : [];

    document.getElementById("scenario-screen").classList.remove("active");
    document.getElementById("setup-screen").classList.add("active");
    document.getElementById("setup-title").innerHTML = `<h2 style="margin:5px 0">${g.emoji} ${g.title.toUpperCase()}</h2><p style="font-size:11px;color:#555;margin:2px 0">üó∫Ô∏è Elei√ß√£o Estadual ‚Äî ${g.stateFullName}</p>`;
    document.getElementById("news-date").innerText = g.newsHeader || g.year;

    const setup = document.getElementById("setup-candidates");
    setup.innerHTML = "";
    for(let k in candidatesData) {
        setup.innerHTML += `<div class="card" style="text-align:center;padding:5px;">
            <b>${candidatesData[k].name}</b><br><small>${candidatesData[k].party}</small><br>
            <small style="color:#666">${candidatesData[k].ideologia}</small><br>
            <button class="btn" onclick="startGovernorGame('${k}')">ESCOLHER</button>
        </div>`;
    }
}

function startGovernorGame(id) {
    playSound(440);
    const g = governorData[currentGovernorKey];
    game.player = id;
    game.scenario = currentGovernorKey;
    game.isGovernor = true;
    game.difficulty = parseInt(document.getElementById("difficulty-level").value);
    game.mode = document.getElementById("game-mode").value;
    game.money = candidatesData[id].money;
    game.points = game.difficulty === 1 ? 7 : (game.difficulty === 3 ? 3 : 5);
    game.energy = 100;
    game.firedHistoricalEvents = [];
    game.availableParties = JSON.parse(JSON.stringify(partyPool));
    game.coalition = [];
    game.news = [];
    game.scandalLevels = {};
    game.approvals = {};
    game.momentumTracker = {};
    game.congressSeats = {};
    game.pollHistory = [];
    game.defeatedCandidates = [];
    game.fase = 1;
    game.turn = 1;
    initBaseEleitoral();
    game.coalitionLoyalty = {};

    game.candidates = Object.keys(candidatesData).map(k => ({
        id: k, ...candidatesData[k], votes: candidatesData[k].start
    }));

    game.candidates.forEach(c => {
        game.scandalLevels[c.id] = 0;
        game.approvals[c.id] = {app: c.votes * 1.1, rej: Math.max(5, 50 - c.votes)};
        game.momentumTracker[c.id] = [];
    });

    // Use governor regions instead of states
    game.stateVotes = {};
    const regions = g.regions;
    regions.forEach(r => {
        game.stateVotes[r.id] = {};
        game.candidates.forEach(c => {
            let cd = candidatesData[c.id];
            let ideoDiff = Math.abs((cd.econ||0)-(r.econ||0)) + Math.abs((cd.soc||0)-(r.soc||0));
            let ideoBonus = (4 - ideoDiff) * 1.5;
            game.stateVotes[r.id][c.id] = Math.max(1, c.votes + ideoBonus + (Math.random()*6-3));
        });
        let sum = Object.values(game.stateVotes[r.id]).reduce((a,b)=>a+b,0);
        game.candidates.forEach(c => game.stateVotes[r.id][c.id] = (game.stateVotes[r.id][c.id]/sum)*100);
    });

    game.pollHistory = [];
    recordPollSnapshot();

    document.getElementById("setup-screen").classList.remove("active");
    document.getElementById("game-screen").classList.add("active");
    addNews(`ELEI√á√ïES ${g.year} ‚Äî ${g.stateFullName.toUpperCase()}`, g.desc);

    // Override map rendering for governor game
    renderGovernorMap();
    renderCampaignActions();
    updateUI();
}

function renderGovernorMap() {
    const g = governorData[currentGovernorKey];
    if(!g) return;
    const container = document.getElementById("map-container");
    container.innerHTML = '';
    container.style.background = '#004d00';

    g.regions.forEach(r => {
        const node = document.createElement('div');
        node.id = 'node-'+r.id;
        node.className = 'state-node';
        node.style.left = r.x+'%';
        node.style.top = r.y+'%';
        node.style.width = '32px';
        node.style.height = '18px';
        node.style.fontSize = '7px';
        node.textContent = r.id;
        node.title = r.n;
        node.onclick = () => showRegionDetail(r);
        container.appendChild(node);
    });
    updateGovernorMap();
}

function updateGovernorMap() {
    const g = governorData[currentGovernorKey];
    if(!g) return;
    g.regions.forEach(r => {
        let votes = game.stateVotes[r.id];
        if(!votes) return;
        let sorted = Object.entries(votes).sort((a,b)=>b[1]-a[1]);
        if(sorted.length && candidatesData[sorted[0][0]]) {
            const node = document.getElementById('node-'+r.id);
            if(node) node.style.backgroundColor = candidatesData[sorted[0][0]].color;
        }
    });
}

function showRegionDetail(r) {
    let votes = game.stateVotes[r.id];
    if(!votes) return;
    let sorted = Object.entries(votes).sort((a,b)=>b[1]-a[1]);
    let html = `<b>${r.n}</b> | Pop. rel.: ${r.p}%<br>`;
    sorted.forEach(([id, v]) => {
        let c = candidatesData[id];
        if(c) html += `<span style="color:${c.color}">‚ñ†</span> ${c.name}: ${v.toFixed(1)}% &nbsp;`;
    });
    document.getElementById("state-details").innerHTML = html;
}

function selectScenarioSound(key) {
    playSound(523, 80);
    setTimeout(() => playSound(659, 80), 90);
    setTimeout(() => playSound(784, 120), 180);
    const sc = scenariosData[key];
    if(sc && sc.indirect) {
        startIndirectGame(key);
    } else {
        selectScenario(key);
    }
}

function selectScenario(key) {
    currentScenario = key;
    const sc = scenariosData[key];
    candidatesData = JSON.parse(JSON.stringify(sc.candidates));
    partyPool = sc.partyPoolOverride ? JSON.parse(JSON.stringify(sc.partyPoolOverride)) : [];
    
    document.getElementById("scenario-screen").classList.remove("active");
    document.getElementById("setup-screen").classList.add("active");
    document.getElementById("setup-title").innerHTML = `<h2 style="margin:5px 0">${sc.emoji} ${sc.title.toUpperCase()}</h2>`;
    document.getElementById("news-date").innerText = sc.newsHeader || sc.year;
    
    const setup = document.getElementById("setup-candidates");
    setup.innerHTML = "";
    for(let k in candidatesData) {
        setup.innerHTML += `<div class="card" style="text-align:center; padding: 5px;">
            <b>${candidatesData[k].name}</b><br><small>${candidatesData[k].party}</small><br>
            <small style="color:#666">${candidatesData[k].ideologia}</small><br>
            <button class="btn" onclick="startGame('${k}')">ESCOLHER</button>
        </div>`;
    }
}

function goToScenarios() {
    document.getElementById("setup-screen").classList.remove("active");
    document.getElementById("indirect-screen").classList.remove("active");
    document.getElementById("scenario-screen").classList.add("active");
}

function goToMainMenu() {
    // Hide ALL game screens and return to scenario selection
    ['setup-screen','indirect-screen','game-screen','end-screen'].forEach(id => {
        const el = document.getElementById(id);
        if(el) el.classList.remove('active');
    });
    document.getElementById("scenario-screen").classList.add("active");
    renderScenarios();
}

function toggleCustomPartyInput(val) {
    document.getElementById('custom-party-fields').style.display = val === '__custom__' ? 'block' : 'none';
}

function setCustomColor(hex) {
    document.getElementById('custom-color').value = hex;
}

function startCustomGame() {
    const name = document.getElementById("custom-name").value || "Voc√™";
    const partySelect = document.getElementById("custom-party");
    const customColor = document.getElementById("custom-color")?.value || "#8b4513";
    let party, side, ideologia;
    if(partySelect.value === '__custom__') {
        party = document.getElementById('custom-party-name').value || 'PARTIDO NOVO';
        side = document.getElementById('custom-party-side').value || 'C';
        ideologia = document.getElementById('custom-party-ideology').value || 'Independente';
    } else {
        party = partySelect.value;
        side = (party === 'PSTU' || party === 'PV') ? 'E' : 'D';
        ideologia = 'Independente';
    }
    candidatesData['custom'] = {name: name.toUpperCase(), party: party, start: 5, money: 30, side: side, color: customColor, econ: side==='E'?-1:(side==='D'?1:0), soc: side==='E'?1:(side==='D'?-1:0), nat: 0, bio: "Um candidato independente que desafiou as estruturas tradicionais. Com uma proposta focada em renova√ß√£o, conseguiu mobilizar setores descontentes da sociedade civil.", ideologia: ideologia};
    startGame('custom');
}

function startGame(id) {
    stopMenuMusic();
    playSoundSeq([[262,80,'sine'],[330,80,'sine'],[392,80,'sine'],[523,200,'sine']], 90);
    game.player = id;
    game.scenario = currentScenario;
    game.isGovernor = false;
    game.isRepVelha = false;
    game.isElectoralCollege = false;
    game.difficulty = parseInt(document.getElementById("difficulty-level").value);
    game.mode = document.getElementById("game-mode").value;
    game.money = candidatesData[id].money;
    game.points = game.difficulty === 1 ? 7 : (game.difficulty === 3 ? 3 : 5);
    game.energy = 100;
    game.firedHistoricalEvents = [];
    game.availableParties = JSON.parse(JSON.stringify(partyPool));
    game.coalition = [];
    game.news = [];
    game.scandalLevels = {};
    game.approvals = {};
    game.momentumTracker = {};
    game.congressSeats = {};
    game.stateVotes = {};
    game.pollHistory = [];
    game.defeatedCandidates = [];
    game.fase = 1;
    game.turn = 1;
    // Party wings (percentages sum to 100)
    game.partyWings = { moderate: 40, radical: 25, centrao: 35 };
    // Debate tracking
    game.debatesWon = 0;
    game.debatesTotal = 0;
    game.debateCooldown = 0;
    game.debatePrep = null;
    // Spirit tracking
    game.spiritCooldown = 0;
    game.spiritsActivated = 0;
    game.spiritsActivatedSet = new Set();
    // Centr√£o debt
    game.centraoDebt = 0;
    // Coalition betrayal risk
    game.coalitionBetrayalRisk = 0;
    // Party relations
    game.partyRelations = {};
    // Initialize new systems
    activeSpirits = [];
    radicalizationLevel = 30;
    eventQueue = [];
    isShowingEvent = false;
    initAbstention(currentScenario);
    // Reset vice and corruption
    game.vice = null;
    game.corruptFund = 0;
    game.corruptImunidade = 0;
    game.mediaBonus = 0;
    // Initialize base eleitoral
    initBaseEleitoral();
    // Initialize coalition loyalty tracking
    game.coalitionLoyalty = {}; // partyName -> {loyalty: 0-100, cargo, betrayalWarned}
    // Hide vice tab initially
    const viceBtn = document.getElementById('tab-btn-vice');
    if(viceBtn) viceBtn.style.display = 'none';
    
    game.candidates = Object.keys(candidatesData).map(k => ({
        id: k, ...candidatesData[k], votes: candidatesData[k].start
    }));

    // Initialize TV time based on candidate popularity
    game.tvTime = {};
    game.candidates.forEach(c => {
        let cd = candidatesData[c.id];
        let baseTv = cd.start || 5;
        game.tvTime[c.id] = Math.min(100, baseTv * 2 + Math.random() * 10);
    });

    if(game.mode === 'caotico') {
        game.candidates.forEach(c => { c.votes = 10 + Math.random() * 25; });
        let s = game.candidates.reduce((a,b) => a + b.votes, 0);
        game.candidates.forEach(c => c.votes = (c.votes/s)*100);
    }
    if(game.mode === 'sandbox') {
        game.money = 9999; game.points = 9999;
    }
    
    game.candidates.forEach(c => {
        game.scandalLevels[c.id] = 0;
        game.approvals[c.id] = {app: c.votes * 1.1, rej: Math.max(5, 50 - c.votes)};
        game.momentumTracker[c.id] = [];
    });

    allStates.forEach(s => {
        game.stateVotes[s.id] = {};
        
        // SISTEMA DIRETO: votos estaduais = voto nacional + b√¥nus de trait regional
        // O candidato que lidera nacionalmente tende a liderar os estados.
        // Traits regionais ajustam para cima/baixo conforme a ideologia do estado.
        
        let natTotal = game.candidates.reduce((sum, c) => sum + c.votes, 0) || 100;
        let natSorted = [...game.candidates].sort((a,b) => b.votes - a.votes);
        let traits = stateTraits[s.id] || [];
        
        let stateScores = {};
        game.candidates.forEach((c, idx) => {
            let cd = candidatesData[c.id];
            if(!cd) { stateScores[c.id] = 1; return; }
            
            // Base = voto nacional normalizado
            let natShare = (c.votes / natTotal) * 100;
            
            // B√¥nus ideol√≥gico por traits do estado
            let traitBonus = 0;
            traits.forEach(t => {
                if(t.side && cd.side === t.side) traitBonus += t.bonus * 0.9;
                else if(t.side && cd.side !== t.side && t.bonus > 0) traitBonus -= t.bonus * 0.5;
            });
            
            // Ru√≠do inicial (para dar varia√ß√£o inicial entre estados)
            let noise = (Math.random() * 4 - 2); // ¬±2%
            
            let score = natShare + traitBonus + noise;
            
            // Candidatos fora do top 2 t√™m teto
            let rank = natSorted.findIndex(nc => nc.id === c.id);
            if(rank >= 2) {
                let cap = Math.min(12, natShare * 1.8 + 3);
                score = Math.min(score, cap);
            }
            
            stateScores[c.id] = Math.max(0.5, score);
        });
        
        // Normalizar para 100%
        let totalScore = Object.values(stateScores).reduce((a,b)=>a+b, 0);
        if(totalScore > 0) {
            game.candidates.forEach(c => {
                game.stateVotes[s.id][c.id] = (stateScores[c.id] / totalScore) * 100;
            });
        } else {
            game.candidates.forEach(c => {
                game.stateVotes[s.id][c.id] = 100 / game.candidates.length;
            });
        }
    });

    game.pollHistory = [];
    recordPollSnapshot();

    document.getElementById("setup-screen").classList.remove("active");
    document.getElementById("game-screen").classList.add("active");
    let sc = scenariosData[currentScenario];
    addNews(`ELEI√á√ïES ${sc.year}`, `Inicia-se a corrida eleitoral. ${sc.desc}`);
    addNews(`IN√çCIO DE CAMPANHA`, `Candidatos come√ßam a divulgar suas plataformas eleitorais. A disputa est√° aberta!`);
    // Generate initial social media events
    generateSocialMediaEvent();
    generateSocialMediaEvent();
    renderMap(); renderCampaignActions(); updateUI();
}

function showTab(t) {
    playSound(400, 50);
    ['campanha', 'estrategia', 'regioes', 'jornal', 'opcoes', 'espiritos', 'debate', 'vice', 'corrupcao', 'base', 'coligacoes', 'crises', 'inteligencia'].forEach(tab => {
        const el = document.getElementById('tab-' + tab);
        if(el) el.style.display = tab === t ? 'block' : 'none';
    });
    if(t === 'campanha') renderCampaignActions();
    if(t === 'estrategia') renderAdversaries();
    if(t === 'regioes') renderRegions();
    if(t === 'jornal') renderNews();
    if(t === 'espiritos') renderSpiritsTab();
    if(t === 'radical') renderRadicalTab();
    if(t === 'debate') renderDebateTab();
    if(t === 'vice') renderViceTab();
    if(t === 'corrupcao') renderCorrupcaoTab();
    if(t === 'base') { renderBaseEleitoral(); if(game) game.baseTabVisited = game.turn; }
    if(t === 'coligacoes') renderColigacoes();
    if(t === 'crises') { game.lastCrisesTabTurn = game.turn; game.crisesTabVisits = (game.crisesTabVisits||0)+1; renderCrisesTab(); }
    if(t === 'inteligencia') renderInteligenciaTab();
}

function renderCampaignActions() {
    const div = document.getElementById('tab-campanha');
    if(!div) return;
    let year = parseInt(game.scenario) || 2000;
    let isOld = game.isRepVelha || year < 1960;
    let isMid = !isOld && year < 1990;
    let isModern = year >= 2010;
    let isUS = game.isElectoralCollege;
    let isIntl = !!internationalData[game.scenario];
    let html = '';

    // Spirits active indicator
    if(activeSpirits.length > 0) {
        html += `<div style="background:#fffde8;border:1px solid #cc9900;padding:3px 5px;font-size:9px;margin-bottom:4px">‚ú® ${activeSpirits.map(s=>spiritDefs[s.id].emoji+' '+spiritDefs[s.id].name).join(' | ')}</div>`;
    }

    html += `<b>COMUNICA√á√ÉO</b>`;
    if(isOld) {
        html += `<button class="btn" onclick="actionJornal()">üì∞ An√∫ncio em Jornal (2p, R$5M)</button>
                 <button class="btn" onclick="actionRadio()">üìª Inser√ß√µes de R√°dio (3p, R$6M)</button>
                 <button class="btn" onclick="actionComicioPra√ßa()">üé∫ Com√≠cio na Pra√ßa (3p, R$4M)</button>
                 <button class="btn" onclick="actionPanfleto()">üìã Panfletagem Massiva (1p, R$2M)</button>`;
    } else if(isMid) {
        html += `<button class="btn" onclick="actionTV()">üì∫ Hor√°rio Eleitoral (6p, R$12M)</button>
                 <button class="btn" onclick="actionRadio()">üìª Inser√ß√µes de R√°dio (3p, R$6M)</button>
                 <button class="btn" onclick="actionJornal()">üì∞ An√∫ncio em Jornal (2p, R$5M)</button>
                 <button class="btn" onclick="actionEntrevista()">üéôÔ∏è Entrevista em Rede (4p)</button>
                 <button class="btn" onclick="actionComicioPra√ßa()">üé∫ Com√≠cio P√∫blico (3p, R$4M)</button>`;
    } else if(isModern || isUS || isIntl) {
        html += `<button class="btn" onclick="actionTV()">üì∫ Hor√°rio Eleitoral (6p, R$12M)</button>
                 <button class="btn" onclick="actionRadio()">üìª Inser√ß√µes de R√°dio (3p, R$6M)</button>
                 <button class="btn" onclick="actionEntrevista()">üéôÔ∏è Entrevista em Rede (4p)</button>
                 <button class="btn" onclick="actionRedesSociais()">üì± Redes Sociais (2p, R$4M)</button>
                 <button class="btn" onclick="actionLiveStream()">üé¨ Live de Debate (3p)</button>
                 <button class="btn" onclick="actionPodcast()">üéß Podcast Pol√≠tico (2p)</button>
                 <button class="btn" onclick="actionMeetup()">üèüÔ∏è Com√≠cio de Massa (4p, R$8M)</button>
                 <button class="btn" onclick="actionPressKit()">üì∞ Kit de Imprensa (2p)</button>
                 <button class="btn" onclick="actionInfluencerPaid()">üåü Contratar Influencer (3p, R$6M)</button>
                 <button class="btn" onclick="actionDocumentario()">üé¨ Document√°rio Eleitoral (4p, R$5M)</button>
                 <button class="btn" onclick="actionInfluenciadores()">ü§≥ Influenciadores Digitais (3p, R$3M)</button>
                 <button class="btn" onclick="actionCriseMediatica()">üõ°Ô∏è Gerenciar Crise Midi√°tica (3p)</button>`;
    } else {
        html += `<button class="btn" onclick="actionTV()">üì∫ Hor√°rio Eleitoral Nacional (6p, R$12M)</button>
                 <button class="btn" onclick="actionRadio()">üìª Inser√ß√µes de R√°dio (3p, R$6M)</button>
                 <button class="btn" onclick="actionEntrevista()">üéôÔ∏è Entrevista em Rede (4p)</button>
                 <button class="btn" onclick="actionMeetup()">üèüÔ∏è Com√≠cio de Massa (4p, R$8M)</button>
                 <button class="btn" onclick="actionPressKit()">üì∞ Kit de Imprensa (2p)</button>`;
    }

    html += `<b>FINANCEIRO</b>
    <button class="btn" onclick="actionCaixaEmpresarial()">üè≠ Arrecadar: Empres√°rios (2p, risco)</button>
    <button class="btn" onclick="actionCaixaSindical()">‚öíÔ∏è Arrecadar: Sindicatos (2p)</button>
    <button class="btn" onclick="actionCaixaPopular()">üèòÔ∏è Arrecadar: Vaquinha (1p)</button>
    <button class="btn" onclick="actionEventoGala()">üé© Jantar de Gala (3p, R$-5M ‚Üí R$40M)</button>
    <button class="btn" onclick="actionCrowdfunding()">üí≥ Crowdfunding Digital (2p)</button>
    <button class="btn" onclick="actionONGParcerias()">üå± Parcerias com ONGs (2p)</button>
    <button class="btn" onclick="actionLeilaoArte()">üñºÔ∏è Leil√£o Beneficente (3p, R$-3M)</button>
    <b>ESTRAT√âGIA</b>
    <button class="btn" id="btn-alliance" onclick="openAllianceMenu()">ü§ù Negociar Alian√ßas (4p)</button>
    <button class="btn" onclick="actionAumentarEngajamento()">üì£ Engajamento C√≠vico (3p)</button>
    <button class="btn" onclick="actionDebateRegional()">üó∫Ô∏è Tour Regional (3p, R$5M)</button>
    <button class="btn" style="background:#1a5c2a;color:white;font-size:10px" onclick="openViceNegotiation()">üëî Negociar Vice-Presidente (6p)</button>
    <button class="btn" style="background:#eee" onclick="showTab('estrategia')">‚öîÔ∏è Ataque & Apoio</button>
    <b>PARTIDO</b>
    <button class="btn" onclick="openPartyManagement()">üèõÔ∏è Gerenciar Partido (2p)</button>`;

    // Electoral College specific actions
    if(isUS) {
        html += `<b>üá∫üá∏ COL√âGIO ELEITORAL ‚Äî ESTRAT√âGIAS</b>
        <button class="btn" style="background:#1a2040;color:#FFD700;border-color:#FFD700" onclick="targetSwingStates()">‚≠ê Ver Swing States (Estrat√©gia)</button>
        <button class="btn" style="background:#1a2040;color:white" onclick="actionECGroundGame()">üèòÔ∏è Ground Game (3p, $6M)</button>
        <button class="btn" style="background:#1a2040;color:white" onclick="actionECStatePoll()">üìä Sondagem Estadual (2p)</button>
        <button class="btn" style="background:#1a2040;color:white" onclick="actionECNationalAdd()">üì∫ An√∫ncio Nacional (5p, $10M)</button>`;
    }

    div.innerHTML = html;
}

function actionECGroundGame() {
    if(game.points < 3 || game.money < 6) { log("Pontos ou dinheiro insuficientes."); return; }
    game.points -= 3; game.money -= 6;
    const sc = internationalData[game.scenario];
    if(!sc || !sc.electoralStates) return;
    // Find 3 closest swing or lean states and boost player there
    let closeStates = sc.electoralStates.filter(s => {
        let votes = game.stateVotes[s.id];
        if(!votes) return false;
        let sorted = Object.entries(votes).sort((a,b)=>b[1]-a[1]);
        return sorted.length >= 2 && (sorted[0][1]-sorted[1][1]) < 10;
    }).slice(0, 3);
    let totalEV = 0;
    closeStates.forEach(s => {
        game.stateVotes[s.id][game.player] = (game.stateVotes[s.id][game.player]||50) + s.ev * 0.8;
        let sum = Object.values(game.stateVotes[s.id]).reduce((a,b)=>a+b,0);
        Object.keys(game.stateVotes[s.id]).forEach(cid=>game.stateVotes[s.id][cid]=game.stateVotes[s.id][cid]/sum*100);
        totalEV += s.ev;
    });
    updateNationalVotes(game.player, totalEV * 0.05);
    updateECMapColors(sc);
    let stateNames = closeStates.map(s=>s.id).join(', ');
    log(`Ground game mobilizou volunt√°rios em ${closeStates.length} estados disputados (${stateNames}). +votos!`);
    addNews("GROUND GAME", `Campanha mobiliza volunt√°rios em estados-chave: ${stateNames}.`);
    updateUI();
}

function actionECStatePoll() {
    if(game.points < 2) { log("Pontos insuficientes."); return; }
    game.points -= 2;
    const sc = internationalData[game.scenario];
    if(!sc || !sc.electoralStates) return;
    let evCounts = getEVCounts();
    let sorted = Object.entries(evCounts).sort((a,b)=>b[1]-a[1]);
    // Show swing state projections
    let swings = sc.electoralStates.filter(s=>s.lean==='S');
    let html = `<b>üìä SONDAGEM ESTADUAL ‚Äî RESULTADO</b><hr>
        <b>Proje√ß√£o do Col√©gio Eleitoral:</b><br>`;
    sorted.forEach(([id,ev])=>{
        let c = candidatesData[id];
        if(c) html += `<div style="display:flex;justify-content:space-between;padding:3px;background:${id===game.player?'#001a00':''};border-radius:2px">
            <span style="color:${c.color}">‚ñ† ${c.name}</span>
            <b style="color:${ev>=270?'#44ff44':'#ccc'}">${ev} EV ${ev>=270?'‚úÖ':''}</b>
        </div>`;
    });
    html += `<hr><b>Swing States (${swings.length}):</b><br>`;
    swings.forEach(s=>{
        let votes = game.stateVotes[s.id];
        let sortedV = votes ? Object.entries(votes).sort((a,b)=>b[1]-a[1]) : [];
        let leader = sortedV[0];
        let margin = sortedV.length>=2 ? (sortedV[0][1]-sortedV[1][1]).toFixed(1) : '?';
        let lc = leader ? candidatesData[leader[0]] : null;
        html += `<div style="display:flex;justify-content:space-between;padding:2px 0">
            <span>${s.n} (${s.ev} EV)</span>
            <span style="color:${lc?lc.color:'#888'}">${lc?lc.name:'?'} +${margin}%</span>
        </div>`;
    });
    showModal('üìä SONDAGEM DO COL√âGIO ELEITORAL', html, `<button class="btn" onclick="closeModal()">Fechar</button>`);
    log("Sondagem estadual revelou estado atual dos swing states.");
    updateUI();
}

function actionECNationalAdd() {
    if(game.points < 5 || game.money < 10) { log("Pontos ou dinheiro insuficientes."); return; }
    game.points -= 5; game.money -= 10;
    const sc = internationalData[game.scenario];
    if(!sc || !sc.electoralStates) return;
    // Boost all swing states
    let swings = sc.electoralStates.filter(s=>s.lean==='S');
    swings.forEach(s=>{
        game.stateVotes[s.id][game.player] = (game.stateVotes[s.id][game.player]||50) + 4;
        let sum = Object.values(game.stateVotes[s.id]).reduce((a,b)=>a+b,0);
        Object.keys(game.stateVotes[s.id]).forEach(cid=>game.stateVotes[s.id][cid]=game.stateVotes[s.id][cid]/sum*100);
    });
    updateNationalVotes(game.player, 1.5);
    updateECMapColors(sc);
    log(`An√∫ncio nacional transmitido em todas as redes. Boost em todos os ${swings.length} swing states!`);
    addNews("AN√öNCIO NACIONAL", "Campanha lan√ßa an√∫ncio massivo em hor√°rio nobre em todos os estados disputados.");
    updateUI();
}

function addNews(title, text) {
    game.news.unshift({title: title.toUpperCase(), text: text});
    if(game.news.length > 15) game.news.pop();
}

// Twitter-style accounts for social media feed
const twitterAccounts = {
    // ‚îÄ‚îÄ ESQUERDA ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    E: [
        // F√£s & Ativistas
        {handle:'@lulaforever13',        name:'Petista Raiz ü¶ï',              type:'f√£'},
        {handle:'@votolula_sempre',      name:'Volunt√°ria da Campanha',        type:'ativista'},
        {handle:'@brizola_filho',        name:'Trabalhista Hist√≥rico',         type:'normal'},
        {handle:'@resist√™ncia_br',       name:'Resist√™ncia Popular',           type:'ativista'},
        {handle:'@lula22_sp',            name:'Lula SP ‚Äî Zona Leste',          type:'f√£'},
        {handle:'@nordeste_vota',        name:'Nordeste Vota! üåµ',             type:'ativista'},
        {handle:'@periferia_vota_br',    name:'Periferia Vota üèöÔ∏è',             type:'ativista'},
        {handle:'@juventude_vermelha',   name:'Juventude Vermelha üö©',         type:'f√£'},
        {handle:'@lula_presidente13',    name:'Lula √â O Cara üí™',              type:'f√£'},
        {handle:'@operaria_nordeste',    name:'Maria Oper√°ria ‚Äî NE',           type:'ativista'},
        {handle:'@sem_teto_br',          name:'Marcha Sem Teto',               type:'org'},
        {handle:'@vamos_juntos_br',      name:'Vamos Juntos Brasil ‚úä',         type:'ativista'},
        // Partidos & Movimentos
        {handle:'@pt_oficial_br',        name:'PT Brasil ü¶ï',                  type:'partido'},
        {handle:'@psol_nacional',        name:'PSOL Nacional üåπ',              type:'partido'},
        {handle:'@pcdob_online',         name:'PCdoB Online ‚ò≠',               type:'partido'},
        {handle:'@pdtbrasil',            name:'PDT Brasil',                    type:'partido'},
        {handle:'@pcb_partido',          name:'PCB ‚Äî Partido Comunista BR ‚ò≠',  type:'partido'},
        {handle:'@pstu_br',              name:'PSTU Brasil',                   type:'partido'},
        {handle:'@up_unidade_popular',   name:'Unidade Popular üåª',            type:'partido'},
        {handle:'@rede_sustentabi',      name:'Rede Sustentabilidade üåø',       type:'partido'},
        {handle:'@mst_landless',         name:'MST ‚Äî Sem Terra',               type:'org'},
        {handle:'@cut_sindical',         name:'CUT Brasil ‚úä',                 type:'org'},
        {handle:'@ubes_estudantes',      name:'UBES Estudantes',               type:'org'},
        {handle:'@mtst_br',              name:'MTST ‚Äî Habita√ß√£o',              type:'org'},
        {handle:'@quilombo_digital',     name:'Quilombo Digital',              type:'org'},
        {handle:'@cimi_indigenas',       name:'CIMI ‚Äî Povos Ind√≠genas üåø',     type:'org'},
        {handle:'@levante_popular',      name:'Levante Popular da Juventude',  type:'org'},
        {handle:'@brigadas_populares',   name:'Brigadas Populares',            type:'org'},
        {handle:'@frente_negra_br',      name:'Frente Negra Brasileira',       type:'org'},
        {handle:'@marcha_mulheres_br',   name:'Marcha Mundial das Mulheres',   type:'org'},
        // Pol√≠ticos de Esquerda
        {handle:'@gleisi_hofmann',       name:'Gleisi Hoffmann ‚Äî PT',          type:'pol√≠tico'},
        {handle:'@guilherme_boulos',     name:'Guilherme Boulos ‚Äî PSOL',       type:'pol√≠tico'},
        {handle:'@jandira_feghali',      name:'Jandira Feghali ‚Äî PCdoB',       type:'pol√≠tico'},
        {handle:'@lindbergh_br',         name:'Lindbergh Farias ‚Äî PT',         type:'pol√≠tico'},
        {handle:'@flavio_dino_br',       name:'Fl√°vio Dino ‚Äî STF',             type:'pol√≠tico'},
        {handle:'@manuela_davila',       name:'Manuela D\'√Åvila ‚Äî PCdoB',       type:'pol√≠tico'},
        {handle:'@alexandre_padilha',    name:'Alexandre Padilha ‚Äî PT',        type:'pol√≠tico'},
        {handle:'@haddad_fernando',      name:'Fernando Haddad ‚Äî PT',          type:'pol√≠tico'},
        {handle:'@paulo_pimenta_pt',     name:'Paulo Pimenta ‚Äî PT',            type:'pol√≠tico'},
        {handle:'@reginaldo_lopes_mg',   name:'Reginaldo Lopes ‚Äî MG',          type:'pol√≠tico'},
        {handle:'@benedita_silva_rj',    name:'Benedita da Silva ‚Äî RJ',        type:'pol√≠tico'},
        {handle:'@celsosabino_pa',       name:'Celso Sabino ‚Äî PA',             type:'pol√≠tico'},
        {handle:'@lula_dep_federal',     name:'Deputado Petista SP',           type:'pol√≠tico'},
        {handle:'@senadora_esq_br',      name:'Senadora da Esquerda',          type:'pol√≠tico'},
        // Influenciadores de Esquerda
        {handle:'@influencer_rosa',      name:'Carol Rosa üíï (4.1M)',           type:'influenciador'},
        {handle:'@preta_cultura',        name:'Preta Gil ‚Äî Cultura Viva',      type:'influenciador'},
        {handle:'@emicida_real',         name:'Emicida üé§',                    type:'influenciador'},
        {handle:'@mano_brown_rap',       name:'Mano Brown',                    type:'influenciador'},
        {handle:'@professora_pol',       name:'Prof. Samira | Pol√≠tica',        type:'influenciador'},
        {handle:'@djonga_rapper',        name:'Djonga ‚Äî Rap & Pol√≠tica üé§',    type:'influenciador'},
        {handle:'@nego_bala_rj',         name:'Nego Bala ‚Äî Favela News (2M)',  type:'influenciador'},
        {handle:'@feminista_digital',    name:'Feminista Digital üå∫ (1.8M)',    type:'influenciador'},
        {handle:'@afrobrasileira_tv',    name:'AfroBrasileira TV (900k)',       type:'influenciador'},
        {handle:'@esquerdista_pods',     name:'Podcast Esquerda Real üéôÔ∏è',      type:'influenciador'},
        {handle:'@chay_suede_art',       name:'Chay Suede ‚Äî Arte e Cultura',   type:'influenciador'},
        {handle:'@lethicia_bronstein',   name:'Lethicia B. ‚Äî Atriz Pol√≠tica',  type:'influenciador'},
        // Memes de Esquerda
        {handle:'@esquerda_memes',       name:'Memes da Resist√™ncia üí™',       type:'meme'},
        {handle:'@memespt_br',           name:'Memeland PT üòÇ',                type:'meme'},
        {handle:'@mito_desmitificado',   name:'Desmitificando o Mito ü§°',      type:'meme'},
        {handle:'@comunismo_meme_br',    name:'Comunismo em Memes ‚ò≠üòÇ',        type:'meme'},
        {handle:'@lulinha_memes',        name:'Lulinha Memes Pack ü¶ï',         type:'meme'},
        {handle:'@thread_esquerda',      name:'Threader Esquerdista üßµ',       type:'meme'},
        // Pessoas comuns que hitam no Twitter/Threads
        {handle:'@ze_da_zona_leste',     name:'Zezinho ‚Äî Zona Leste SP',       type:'normal'},
        {handle:'@nordestina_pr',        name:'Nordestina que veio pro Sul',    type:'normal'},
        {handle:'@professora_publica',   name:'Professora da Rede P√∫blica',    type:'normal'},
        {handle:'@enfermeira_sus',       name:'Enfermeira do SUS üë©‚Äç‚öïÔ∏è',          type:'normal'},
        {handle:'@trabalhadora_sp',      name:'Trabalhadora da CLT',           type:'normal'},
        {handle:'@diarista_que_opina',   name:'Diarista com Opini√£o üò§',       type:'normal'},
        {handle:'@motorista_app_esq',    name:'Motorista de App que Vota E',   type:'normal'},
    ],
    // ‚îÄ‚îÄ DIREITA ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    D: [
        // F√£s & Ativistas
        {handle:'@bolsonaro_mito',       name:'Mito Eterno üáßüá∑',               type:'f√£'},
        {handle:'@patriota_202',         name:'Patriota Raiz üáßüá∑',              type:'f√£'},
        {handle:'@tarcisio_fanclub',     name:'F√£ Clube Tarc√≠sio ‚ù§Ô∏è',          type:'f√£'},
        {handle:'@nikolas_br_fan',       name:'Nikolas Forever üíô',             type:'f√£'},
        {handle:'@conservador_raiz',     name:'Conservador Raiz',               type:'normal'},
        {handle:'@agro_e_pop',           name:'AgroPOP Brasil üåæ',              type:'normal'},
        {handle:'@liberal_cl√°ssico',     name:'Liberal Cl√°ssico üìö',            type:'normal'},
        {handle:'@capitao_f√£',           name:'Capit√£o do Povo ‚Äî Fan Account',  type:'f√£'},
        {handle:'@direita_de_verdade',   name:'Direita de Verdade üáßüá∑',         type:'f√£'},
        {handle:'@bolsonarismo_vivo',    name:'Bolsonarismo N√£o Acabou',        type:'f√£'},
        {handle:'@minas_conservadora',   name:'Minas Gerais Conservadora',      type:'normal'},
        {handle:'@rancher_do_agro',      name:'Rancher do Agro üåæ (3M)',        type:'normal'},
        // Partidos de Direita
        {handle:'@pl_brasil_oficial',    name:'PL Brasil üáßüá∑',                  type:'partido'},
        {handle:'@novo_partido',         name:'Partido NOVO üí∞',                type:'partido'},
        {handle:'@republicanos_br',      name:'Republicanos BR üôè',             type:'partido'},
        {handle:'@uni√£o_brasil',         name:'Uni√£o Brasil',                   type:'partido'},
        {handle:'@pp_progressistas',     name:'Progressistas BR',               type:'partido'},
        {handle:'@solidariedade_br',     name:'Solidariedade BR',               type:'partido'},
        {handle:'@psdb_oficial',         name:'PSDB Oficial',                   type:'partido'},
        {handle:'@dem_democratas',       name:'DEM ‚Äî Democratas',               type:'partido'},
        {handle:'@patriota_partido',     name:'Patriota ‚Äî Partido',             type:'partido'},
        // Organiza√ß√µes Direitistas
        {handle:'@biblia_pol√≠tica',      name:'Fam√≠lia Brasil üôè',              type:'org'},
        {handle:'@mbl_br',               name:'MBL ‚Äî Movimento Brasil Livre',   type:'org'},
        {handle:'@vem_pra_rua',          name:'Vem pra Rua üáßüá∑',               type:'org'},
        {handle:'@agro_family_br',       name:'Agro Family Brasil üåæ',          type:'org'},
        {handle:'@israel_com_br',        name:'Israel com BR üáÆüá±üáßüá∑',             type:'org'},
        {handle:'@ong_escola_sem_partido',name:'Escola Sem Partido',            type:'org'},
        {handle:'@pr√≥_vida_br',          name:'Pr√≥ Vida Brasil üå∏',             type:'org'},
        {handle:'@instituto_millenium',  name:'Instituto Millenium üí°',          type:'org'},
        {handle:'@f√≥rum_liberdade',      name:'F√≥rum da Liberdade',             type:'org'},
        {handle:'@oposi√ß√£o_ativa',       name:'Oposi√ß√£o Ativa Brasil',          type:'org'},
        // Pol√≠ticos de Direita
        {handle:'@sergio_moro_br',       name:'Sergio Moro ‚Äî Senador',          type:'pol√≠tico'},
        {handle:'@damares_alves',        name:'Damares Alves üôè',               type:'pol√≠tico'},
        {handle:'@paulo_guedes',         name:'Paulo Guedes ‚Äî Economia',        type:'pol√≠tico'},
        {handle:'@flavio_bolsonaro',     name:'Fl√°vio Bolsonaro üáßüá∑',            type:'pol√≠tico'},
        {handle:'@ciro_nogueira_pi',     name:'Ciro Nogueira ‚Äî PI',             type:'pol√≠tico'},
        {handle:'@marcos_pontes_br',     name:'Marcos Pontes üöÄ',               type:'pol√≠tico'},
        {handle:'@nikolas_ferr_dep',     name:'Nikolas Ferreira ‚Äî MG',          type:'pol√≠tico'},
        {handle:'@tarcisio_gomes_sp',    name:'Tarc√≠sio ‚Äî Gov SP',              type:'pol√≠tico'},
        {handle:'@romeu_zema_mg',        name:'Romeu Zema ‚Äî Gov MG',            type:'pol√≠tico'},
        {handle:'@arthur_lira_sp',       name:'Arthur Lira ‚Äî C√¢mara',           type:'pol√≠tico'},
        {handle:'@daniel_silveira_rj',   name:'Daniel Silveira ‚Äî RJ',           type:'pol√≠tico'},
        {handle:'@costa_e_silva_dep',    name:'Dep. Conservador Sul',           type:'pol√≠tico'},
        {handle:'@senador_direitinha',   name:'Senador da Direita Cl√°ssica',    type:'pol√≠tico'},
        {handle:'@katia_abreu_to',       name:'K√°tia Abreu ‚Äî Agro',             type:'pol√≠tico'},
        // Influenciadores de Direita
        {handle:'@silas_malafaia',       name:'Pastor Silas Malafaia',          type:'influenciador'},
        {handle:'@caio_torres_red',      name:'Caio Torres üáßüá∑ (8.2M)',          type:'influenciador'},
        {handle:'@rodrigo_constantino',  name:'Rodrigo Constantino',            type:'influenciador'},
        {handle:'@monark_liberdade',     name:'Monark ‚Äî Liberdade üóΩ',          type:'influenciador'},
        {handle:'@flow_podcast_fan',     name:'F√£ do Flow Podcast üéôÔ∏è',         type:'f√£'},
        {handle:'@pablo_mar√ßal_f√£',      name:'Pablo Mar√ßal F√£ Club',          type:'f√£'},
        {handle:'@bia_kicis_dep',        name:'Bia Kicis ‚Äî Deputada DF',        type:'influenciador'},
        {handle:'@nando_moura_br',       name:'Nando Moura ‚Äî YouTube (5M)',     type:'influenciador'},
        {handle:'@weintraub_br',         name:'Weintraub ‚Äî Educa√ß√£o Livre',     type:'influenciador'},
        {handle:'@gab√≠_sbrinna',         name:'Gabi Sbrinna ‚Äî Life Coach Livre',type:'influenciador'},
        {handle:'@cl√©ber_verde_god',     name:'Cl√©ber Verde ‚Äî Pastor Famoso',   type:'influenciador'},
        {handle:'@liberal_trader_br',    name:'Trader Liberal üí∞ (1.2M)',       type:'influenciador'},
        // Memes de Direita
        {handle:'@direita_memes',        name:'Memes da Direita üòÇ',            type:'meme'},
        {handle:'@record_politica',      name:'Record News Pol√≠tica',           type:'not√≠cia'},
        {handle:'@mito_memes',           name:'Mito em Meme ‚Äî Pack Di√°rio',     type:'meme'},
        {handle:'@anticomunismo_br',     name:'Anti-Comunismo BR üö´‚ò≠',          type:'meme'},
        {handle:'@brasil_conservador_x', name:'Brasil Conservador üáßüá∑ memes',   type:'meme'},
        {handle:'@thread_liberal',       name:'Threader Liberal ‚Äî An√°lises üßµ', type:'meme'},
        {handle:'@brasil_sem_medo',      name:'Brasil Sem Medo üí™',             type:'meme'},
        // Pessoas comuns Direitistas que hitam
        {handle:'@fazendeiro_ms',        name:'Fazendeiro do MS üåæ',            type:'normal'},
        {handle:'@militar_reserva_br',   name:'Militar da Reserva üéñÔ∏è',          type:'normal'},
        {handle:'@empres√°rio_pmsp',      name:'Empres√°rio de SP',               type:'normal'},
        {handle:'@pastor_interior_br',   name:'Pastor do Interior',             type:'normal'},
        {handle:'@motorista_app_dir',    name:'Motorista de App Conservador',   type:'normal'},
    ],
    // ‚îÄ‚îÄ CENTRO / NEUTRO / IMPRENSA ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    C: [
        // Imprensa
        {handle:'@g1_politica',          name:'G1 Pol√≠tica',                   type:'not√≠cia'},
        {handle:'@folha_sp_pol',         name:'Folha de S.Paulo',              type:'not√≠cia'},
        {handle:'@uol_noticias',         name:'UOL Not√≠cias',                  type:'not√≠cia'},
        {handle:'@estad√£o_digital',      name:'Estad√£o Digital',               type:'not√≠cia'},
        {handle:'@bbc_brasil',           name:'BBC Brasil',                    type:'not√≠cia'},
        {handle:'@cnn_br_pol',           name:'CNN Brasil',                    type:'not√≠cia'},
        {handle:'@band_news_pol',        name:'Band News Pol√≠tica',            type:'not√≠cia'},
        {handle:'@jovem_pan_pol',        name:'Jovem Pan Pol√≠tica üìª',         type:'not√≠cia'},
        {handle:'@agencia_brasil_br',    name:'Ag√™ncia Brasil',                type:'not√≠cia'},
        {handle:'@jn_globo',             name:'Jornal Nacional',               type:'not√≠cia'},
        {handle:'@valor_econ',           name:'Valor Econ√¥mico',               type:'not√≠cia'},
        {handle:'@cartacapital_br',      name:'Carta Capital',                 type:'not√≠cia'},
        {handle:'@the_intercept_br',     name:'The Intercept Brasil',          type:'not√≠cia'},
        {handle:'@metr√≥poles_br',        name:'Metr√≥poles',                    type:'not√≠cia'},
        {handle:'@correio_brasiliense',  name:'Correio Braziliense',           type:'not√≠cia'},
        {handle:'@ga√∫cha_rdio',          name:'Ga√∫cha ‚Äî R√°dio RS',             type:'not√≠cia'},
        {handle:'@revista_veja_br',      name:'Veja ‚Äî Revista Semanal',        type:'not√≠cia'},
        {handle:'@√©poca_revista',        name:'√âpoca Online',                  type:'not√≠cia'},
        // Pesquisas & An√°lise
        {handle:'@datafolha_real',       name:'Datafolha üìä',                  type:'pesquisa'},
        {handle:'@quaest_br',            name:'Quaest Pesquisas üìä',           type:'pesquisa'},
        {handle:'@ibope_politica',       name:'Ipespe Pol√≠tica üìä',            type:'pesquisa'},
        {handle:'@atlas_intel_poll',     name:'Atlas Intel üìä',                type:'pesquisa'},
        {handle:'@poder360_pol',         name:'Poder360 Elei√ß√µes',             type:'an√°lise'},
        {handle:'@nexo_jornal',          name:'Nexo Jornal',                   type:'an√°lise'},
        {handle:'@piaui_mag',            name:'Piau√≠ Magazine',                type:'an√°lise'},
        {handle:'@eleicoes_hoje',        name:'Elei√ß√µes Hoje üó≥Ô∏è',             type:'an√°lise'},
        {handle:'@nathalia_campos',      name:'Nath√°lia Campos ‚Äî TV',          type:'not√≠cia'},
        {handle:'@an√°lise_pol√≠tica_br',  name:'An√°lise Pol√≠tica BR üß†',        type:'an√°lise'},
        {handle:'@professor_cipol√≠tica', name:'Prof. de Ci√™ncia Pol√≠tica',     type:'an√°lise'},
        {handle:'@jornalismo_cr√≠tico',   name:'Jornalismo Cr√≠tico BR',         type:'an√°lise'},
        // Pol√≠ticos de Centro
        {handle:'@simone_tebet_ms',      name:'Simone Tebet ‚Äî MS',             type:'pol√≠tico'},
        {handle:'@ciro_gomes_ce',        name:'Ciro Gomes ‚Äî CE',               type:'pol√≠tico'},
        {handle:'@tabata_amaral_sp',     name:'Tabata Amaral ‚Äî SP',            type:'pol√≠tico'},
        {handle:'@kim_kataguiri_sp',     name:'Kim Kataguiri ‚Äî SP',            type:'pol√≠tico'},
        {handle:'@luciana_genro_rs',     name:'Luciana Genro ‚Äî RS',            type:'pol√≠tico'},
        {handle:'@senador_centro',       name:'Senador do Centro Democr√°tico',  type:'pol√≠tico'},
        {handle:'@dep_fdr_centro',       name:'Deputado Federal ‚Äî Centro',     type:'pol√≠tico'},
        {handle:'@prefeito_dem_br',      name:'Prefeito Democrata ‚Äî BR',       type:'pol√≠tico'},
        // Influenciadores Neutros / de Centro
        {handle:'@jovem_nerd_pol',       name:'Jovem Nerd Pol√≠tico üéÆ',        type:'influenciador'},
        {handle:'@ponto_de_vista',       name:'Ponto de Vista BR üéôÔ∏è',          type:'influenciador'},
        {handle:'@caf√©_com_pol√≠tica',    name:'Caf√© com Pol√≠tica ‚òï',           type:'influenciador'},
        {handle:'@xadrez_verbal_br',     name:'Xadrez Verbal ‚Äî An√°lise',       type:'influenciador'},
        {handle:'@faixa_etaria_br',      name:'Faixa Et√°ria ‚Äî Comunica√ß√£o',    type:'influenciador'},
        {handle:'@deolane_bezerra_f√£',   name:'Deolane Bezerra Fan Account',   type:'influenciador'},
        {handle:'@sabrina_sato_pol√≠t',   name:'Sabrina Sato fala de pol√≠tica', type:'influenciador'},
        {handle:'@virg√≠lia_alves_br',    name:'Virg√≠nia ‚Äî M√£e & Opin√£o üå∏',    type:'influenciador'},
        {handle:'@porta_dos_fundos_pol', name:'Porta dos Fundos ‚Äî S√°tira',     type:'influenciador'},
        // Memes neutros / gerais
        {handle:'@memes_elei√ß√£o_br',     name:'Memes da Elei√ß√£o üáßüá∑üòÇ',        type:'meme'},
        {handle:'@twitter_br_memes',     name:'Twitter BR Memes',              type:'meme'},
        {handle:'@brasil_meme_pack',     name:'Brasil Meme Pack üíÄ',           type:'meme'},
        {handle:'@threads_viral_br',     name:'Threads Viral Brasil',          type:'meme'},
        {handle:'@tiktok_pol√≠tico_br',   name:'TikTok Pol√≠tica BR üéµ',         type:'meme'},
        {handle:'@politica_em_meme',     name:'Pol√≠tica em Meme',              type:'meme'},
        {handle:'@perfil_aleat√≥rio_pol', name:'Perfil Aleat√≥rio que Viralizou',type:'meme'},
        {handle:'@thread_viral_br',      name:'Thread Mais Retweetada Hoje üßµ',type:'meme'},
        // Cidad√£os comuns que hitam no Twitter/Threads
        {handle:'@z√©_eleitor',           name:'Z√© da Padaria ü•ê',             type:'normal'},
        {handle:'@maria_curiosa',        name:'Maria Curiosa ü§î',              type:'normal'},
        {handle:'@vitor_imparcial',        name:'Vitor Imparcial ü§∑',            type:'normal'},
        {handle:'@marcos_conta',            name:'Marcos da Contabilidade',       type:'normal'},
        {handle:'@genteboa_br',             name:'Gente Boa BR üáßüá∑',              type:'normal'},
        {handle:'@desempregado_br',         name:'Desempregado Profissional',     type:'normal'},
        {handle:'@tia_celia',               name:'Tia C√©lia no Twitter',          type:'normal'},
        {handle:'@voz_das_ruas',            name:'Voz das Ruas üó£Ô∏è',              type:'normal'},
        {handle:'@concurseiro_solitario',   name:'Concurseiro Solit√°rio üìö',      type:'normal'},
        {handle:'@dona_lurdes_sp',          name:'Dona Lurdes ‚Äî SP üëµ',           type:'normal'},
        {handle:'@jo√£o_interior_mg',        name:'Jo√£o do Interior ‚Äî MG',         type:'normal'},
        {handle:'@universit√°ria_rj',        name:'Universit√°ria no Rio üéì',       type:'normal'},
        {handle:'@m√£e_solteira_br',         name:'M√£e Solo que Opina üí™',         type:'normal'},
        {handle:'@aposentado_online',       name:'Aposentado nas Redes üë¥',       type:'normal'},
        {handle:'@professor_redepubl',      name:'Professor da Rede P√∫blica',     type:'normal'},
        {handle:'@uber_eats_driver',        name:'Entregador de App üõµ',           type:'normal'},
        {handle:'@clt_sobrevivente',        name:'CLT Sobrevivente üò§',           type:'normal'},
        {handle:'@vendedor_feira',          name:'Vendedor da Feira üõí',           type:'normal'},
        {handle:'@analista_rh_br',          name:'Analista de RH | Opinando',     type:'normal'},
        {handle:'@m√©dico_sus_br',           name:'M√©dico do SUS ü©∫',              type:'normal'},
        {handle:'@ex_militante_br',         name:'Ex-Militante Decepcionado',     type:'normal'},
        {handle:'@engenheiro_formado',      name:'Engenheiro Formado Desempregado',type:'normal'},
        // Memes gerais (centro)
        {handle:'@eleicoes_memes',          name:'Memes das Elei√ß√µes üòÇ',         type:'meme'},
        {handle:'@virgula_memes',           name:'V√≠rgula Memes (12M) üòÇ',        type:'meme'},
        {handle:'@brasil_memes_off',        name:'Brasil Memes',                  type:'meme'},
        {handle:'@fernanda_brum_br',        name:'Fernanda Brum üôè (3M)',         type:'influenciador'},
        {handle:'@debatedores_br',          name:'Debatedores do Brasil üéôÔ∏è',      type:'influenciador'},
        // === NOVOS PERFIS BRASIL v13 ===
        // Extrema esquerda
        {handle:'@boulos_sp_prefeitura',     name:'Boulos Prefeito SP üèöÔ∏è',         type:'pol√≠tico'},
        {handle:'@socialismo_ja_br',         name:'Socialismo J√°! ‚úäüö©',            type:'partido'},
        {handle:'@marea_vermelha_br',        name:'Mar√© Vermelha Brasil üåä',        type:'org'},
        // Extrema direita / ultra
        {handle:'@ancap_brasil_real',        name:'AncapBR ‚Äî Anarcocapitalismo üêç', type:'ativista'},
        {handle:'@integralismo_digital',     name:'Integralismo Digital ü¶Ö',        type:'f√£'},
        {handle:'@resistencia_dir_br',       name:'Resist√™ncia Digital üáßüá∑üí™',       type:'org'},
        // Influencers reais de pol√≠tica
        {handle:'@pablo_marcal_real',        name:'Pablo Mar√ßal üí™ (12M)',          type:'influenciador'},
        {handle:'@lorelay_fox_pol',          name:'Lorelay Fox üåà ‚Äî Pol√≠tica (2M)', type:'influenciador'},
        {handle:'@whindersson_threads',      name:'Whindersson no Threads üé≠ (18M)',type:'influenciador'},
        {handle:'@fabio_porchat_satira',     name:'F√°bio Porchat ‚Äî S√°tira üòÇ',     type:'influenciador'},
        {handle:'@kim_paim_yt',             name:'Kim do YouTube ‚Äî Pol√≠tica',      type:'influenciador'},
        {handle:'@felipeneto_pol',           name:'Felipe Neto ‚Äî Pol√≠tica (45M)',   type:'influenciador'},
        // Movimentos pol√≠ticos
        {handle:'@mpl_transporte_livre',     name:'MPL ‚Äî Transporte Livre üöå',      type:'org'},
        {handle:'@brasil_paralelo_pol',      name:'Brasil Paralelo Pol√≠tica üìΩÔ∏è',    type:'org'},
        {handle:'@entaoesisso_br',           name:'Ent√£o √© Isso ‚Äî Threads üßµ',      type:'influenciador'},
        // Enquetes / pesquisas mockadas
        {handle:'@enquete_politica_br',      name:'üìä Enquete Pol√≠tica BR',         type:'pesquisa'},
        // Novos cidad√£os comuns
        {handle:'@crypto_ancap_br',          name:'Cripto + Liberdade üêç‚Çø',        type:'normal'},
        {handle:'@cansado_de_tudo_br',       name:'Cansado de Tudo üòÆ‚Äçüí®',            type:'normal'},
        {handle:'@feminismo_negro_br',       name:'Feminismo Negro BR ‚úäüèø',         type:'ativista'},
        {handle:'@transg√™nero_pol_br',       name:'Trans na Pol√≠tica BR üè≥Ô∏è‚Äç‚ößÔ∏è',       type:'ativista'},
    ]
};

// Meme templates
const memeTemplates = [
    // Candidato-espec√≠ficos
    (c) => `BREAKING: ${c} saiu para fazer campanha e encontrou um cachorro abandonado. Adotou na hora. J√° tem 2 milh√µes de curtidas. A oposi√ß√£o t√° em p√¢nico üò≠`,
    (c) => `Meu tio que nunca falava de pol√≠tica foi jantar hoje e ficou 2 horas falando de ${c}. Estamos perdidos üíÄ`,
    (c) => `${c}: [fala algo normal] | M√≠dia mainstream: üî¥URGENTEüî¥ | Redes sociais: BEM-VINDO AO BRASIL 2024 üò≠`,
    (c) => `POV: Voc√™ √© o ${c} e acabou de abrir o Twitter üíÄüíÄüíÄ`,
    (c) => `Se ${c} ganhar: ‚úÖ Meu tio fica calado no churrasco ‚úÖ Minha av√≥ para de mandar correntes ‚úÖ O pa√≠s melhora`,
    (c) => `Quantos seguidores o ${c} vai ter depois dessa entrevista: [gr√°fico exponencial subindo] üìà`,
    (c) => `${c} entrou na live com aquela energia de "eu sei que t√¥ ganhando". Calma a√≠ üòÇ`,
    (c) => `O ${c} postou uma foto comendo mortadela e a internet parou. 4.2M de curtidas. √â Brasil demais pra mim.`,
    (c) => `Minha namorada: "n√£o vou votar no ${c}". Eu: "a gente vai casar". Ela: "felicidades pro seu candidato" üíÄ`,
    (c) => `${c} no debate: [responde racionalmente] | Twitter do lado que perde: ISSO √â GOLPE ABSURDO INACREDIT√ÅVEL üò≠`,
    (c) => `A assessoria do ${c} quando algu√©m lembra de tu√≠tes de 2013: üíÄüíÄüíÄ`,
    (c) => `Thread de 47 partes explicando por que ${c} vai ganhar segundo uma an√°lise que ningu√©m pediu mas todo mundo vai RT`,
    (c) => `${c} colocou uma m√∫sica boa no com√≠cio e agora metade do Twitter t√° a favor. √â isso o Brasil üáßüá∑`,
    (c) => `Meu pai foi ver o com√≠cio do ${c} "s√≥ pra ver como √©". Voltou com 3 camisetas e bandeirinha. üíÄ`,
    (c) => `O momento em que ${c} virou meme eterno. N√£o tem mais volta. Isso √© parte da hist√≥ria agora.`,
    (c) => `Acabei de ver um post de ${c} de 2009. A pessoa n√£o existia politicamente. Agora √© o centro do universo. Brasil.`,
    (c) => `Quando ${c} faz alguma coisa boa: "pagou pra fazer!" Quando faz algo ruim: "era o esperado" A l√≥gica do Twitter BR üíÄ`,
    (c) => `${c} acenando pro pov√£o enquanto os assessores nos bastidores: [meme do suor na testa] üòÇ`,
    (c) => `An√°lise t√©cnica: ${c} ganhou o debate. An√°lise emocional: quem eu j√° ia votar continua ganhando. Ci√™ncia pol√≠tica.`,
    (c) => `Bom, o ${c} acabou de postar um v√≠deo dan√ßando. A campanha rival em reuni√£o de emerg√™ncia √†s 2h da manh√£.`,
    (c) => `${c}: Vou fazer [promessa ambiciosa]. Eu que paguei o PIX da promessa anterior: üòê`,
    (c) => `NPC behavior: apoiar incondicionalmente ${c} mas criticar exatamente as mesmas coisas no advers√°rio ü§°`,
    (c) => `Ningu√©m: | Absolutamente ningu√©m: | ${c}: *solta nota √† meia-noite de um domingo*`,
    (c) => `Amigo: o ${c} vai ganhar com folga! Dados reais: [gr√°fico mostrando empate t√©cnico] üíÄ`,
    (c) => `${c} no come√ßo da campanha vs ${c} faltando 1 semana pro pleito: [antes/depois extremo]`,
    (c) => `J√° foram 3 debates e continuamos votando em quem j√° √≠amos votar. A democracia funciona... diferente do que pens√°vamos.`,
    (c) => `Quando ${c} ganhar a elei√ß√£o o Brasil vai: [A] Melhorar muito [B] Piorar muito [C] Continuar igual [D] Depende de quem voc√™ pergunta`,
    (c) => `${c} acabou de fazer uma live de 4 horas. Ningu√©m assistiu tudo mas todo mundo tem opini√£o sobre o que foi dito üòÇ`,
    (c) => `Juro que ia dormir cedo hoje. A√≠ ${c} postou aquela coisa e aqui estou √†s 2h lendo threads de an√°lise üíÄ`,
    (c) => `O n√∫mero de pessoas que j√° decidiram em quem votar antes do debate vs o n√∫mero que assiste o debate fingindo estar em d√∫vida üìä`,
    // Gerais sem candidato
    () => `As pesquisas: [candidatos empatados] | Os eleitores: NOSSA LADO T√Å DOMINANDO`,
    () => `Debate pol√≠tico no Twitter em 2024: Eu > Voc√™ > Seu candidato > A humanidade inteira`,
    () => `[Pesquisa saiu] Esquerda: "VAMOS GANHAR!!" Direita: "A PESQUISA √â FAKE!!" | Pesquisa contr√°ria ‚Üí inverter respostas`,
    () => `Minha vizinha botou bandeira do candidato dela. Minha m√£e botou bandeira do candidato dela. Eu to de mudan√ßa.`,
    () => `Esse neg√≥cio de elei√ß√£o me deixou t√£o estressado que fui dormir √†s 22h. Acordei √†s 3h pra checar pesquisa. Help.`,
    () => `Olha o que a elei√ß√£o fez com minha fam√≠lia: grupo do WhatsApp tem agora 4 grupos separados. üíÄ`,
    () => `Candidato: "vou resolver isso em 100 dias" | Eu, sabendo como funciona: üòÇüòÇüòÇ`,
    () => `Voto nulo √© voto. Voto em branco √© voto. Voto press√£o √© mito. Voto no meu meme √© ilegal mas deveria contar.`,
    () => `A imprensa brasileira cobrindo elei√ß√£o: tudo urgente, tudo breaking, tudo hist√≥rico, tudo sem precedente. Respira, gente.`,
    () => `Debate hoje √† noite. J√° preparei o pipoca, os prints e os memes prontos pra postar. A an√°lise pol√≠tica come√ßa √†s 23h.`,
    () => `Elei√ß√£o = descobrir quem da sua fam√≠lia voc√™ nunca mais vai falar. Spoiler: √© mais gente do que voc√™ imagina.`,
    () => `N√£o existe "voto √∫til". Existe voto estrat√©gico, ideol√≥gico, por press√£o, "minha m√£e mandou" e por desespero.`,
    () => `Esse candidato prometeu o que eu sempre quis. Da√≠ eu fui ler as propostas. Da√≠ eu fui dormir.`,
    () => `Expliquei pol√≠tica pro meu gato. Ele olhou pra mim, virou as costas e foi dormir. O mais sensato da casa.`,
    () => `Pesquisa eleitoral: margem de erro ¬±3%. Minha m√£e: "ent√£o pode ser 100%". N√£o √© bem assim, m√£e.`,
    () => `J√° bloqueei minha m√£e, meu cunhado, um colega de trabalho e uma planta que me lembrava do candidato deles. Paz.`,
    () => `Live eleitoral essa noite: [candidato A fala por 3 min] [candidato B interrompe] [candidato C finge que acabou o tempo] üçø`,
    () => `Quando acaba a elei√ß√£o: posso voltar pro Facebook? Posso ver foto de sobrinho? Posso existir em paz? Perguntando por um amigo.`,
    () => `Threads do Twitter essa semana: 90% pol√≠tica, 5% receita de bolo, 5% gente tentando sair do Twitter mas falhando`,
    () => `S√≥ nesse pa√≠s a gente resolve elei√ß√£o com: um debate na Globo, um boato no Zap, uma nota do TSE e um meme de cachorro üáßüá∑`,
    () => `Fui postar sobre meu gato e a galera debateu pol√≠tica embaixo. At√© o gato t√° polarizado agora.`,
    () => `Eu: vou ficar longe de pol√≠tica esse fim de semana | Twitter √†s 6h de s√°bado: [coisa absurda aconteceu]`,
    () => `"Quem ganhar a elei√ß√£o, vou embora do Brasil." ‚Äî dito por todo lado pol√≠tico desde 1989. Country still here.`,
    () => `TSE: √© proibido not√≠cia falsa nas elei√ß√µes | WhatsApp da minha fam√≠lia: [continua normalmente]`,
    () => `Candidato no debate: eu represento o povo! | Povo: voc√™ mora num flat de R$8k e n√£o sabe o pre√ßo do arroz`,
    () => `Em ano de elei√ß√£o o Brasil inventa: nova g√≠ria, novo meme de debate, novo esc√¢ndalo, novo milagre das pesquisas. Todo ano.`,
    // === NOVOS MEMES BRASIL v13 ===
    // Enquetes (simulam widget de poll do Twitter/Threads)
    () => `üìä ENQUETE (97k respostas) ‚Äî Voc√™ confia nas pesquisas eleitorais?\n‚úÖ Sim: 23%\n‚ùå N√£o: 54%\nü§î Depende: 23%\nRT p/ mais gente responder üáßüá∑`,
    () => `üìä POLL: O maior problema do Brasil em 2024?\nüî¥ Corrup√ß√£o: 38%\nüü° Desemprego: 29%\nüü¢ Seguran√ßa: 22%\nüîµ Sa√∫de: 11%\n(1.2M votos)`,
    () => `üìä Quem ganha o debate hoje √† noite segundo os meus seguidores (vote antes de come√ßar):\n‚Üí Esquerda: 48% \n‚Üí Direita: 49%\n‚Üí Ningu√©m: 3%\n(empate t√©cnico como sempre üíÄ)`,
    // Threads virais sobre brasil
    (c) => `üßµ Thread: por que ${c} √© o candidato mais subestimado dessa elei√ß√£o (42 tweets, 180k impress√µes) ‚Üì`,
    (c) => `üßµ Thread sobre a estrat√©gia de ${c} que a m√≠dia n√£o est√° mostrando. Vai at√© o final, vale muito. ‚Üì [1/28]`,
    () => `üßµ Thread: como a elei√ß√£o de 2026 vai ser decidida pelo eleitor que ainda n√£o se decidiu. Dados exclusivos. Vai at√© o fim ‚Üì [1/35]`,
    // Memes espec√≠ficos de contexto brasileiro
    () => `Pablo Mar√ßal entra numa live com 500k pessoas e fica 3 horas falando do pr√≥prio sucesso. Os 500k assistem tudo. Brasil √© foda.`,
    () => `Whindersson fez um post sobre o candidato X. 8M de curtidas. TSE convocou reuni√£o de emerg√™ncia. S√≥ no Brasil.`,
    () => `Felipe Neto declarou voto. Imediatamente 200 contas direitistas fazem thread de "cancelamento". O felipe t√° na praia.`,
    (c) => `[DEEP FAKE ALERTA] V√≠deo falso de ${c} dan√ßando funk circulando no ZAP. 12 milh√µes de visualiza√ß√µes antes da checagem. üíÄ`,
    () => `Brasil paralelo soltou document√°rio de 4 horas explicando que a elei√ß√£o vai ser roubada. Algu√©m assistiu? Perguntando por um amigo.`,
    () => `Ankap do twitter: o estado √© viol√™ncia! Vota em candidato que quer menos estado! | Candidato reduz estado | Ankap: NAO ASSIM üò≠`,
    () => `A galera que diz que "n√£o existe diferen√ßa entre os candidatos" nunca precisou de SUS, INSS, ENEM ou CRAS. Curioso isso.`,
    () => `Lula: [postou foto dormindo numa viagem] | Direita: PROVA QUE N√ÉO TRABALHA | Bolsonaro: [postou foto dormindo] | Direita: TRABALHADOR CANSADO ‚ù§Ô∏è`,
    () => `Debate hoje. Timeline antes: todo mundo vai mudando de voto. Timeline depois: todo mundo votando igual ao antes. Democracia.`,
    () => `N√£o tem nada mais brasileiro do que candidato fazer campanha no show do Wesley Safad√£o, no Altas Horas E no Flow Podcast na mesma semana.`,
];
// Influencer endorsement posts ‚Äî variados e espec√≠ficos
const influencerPosts = [
    (c) => `Galera, depois de muita reflex√£o, decidi falar abertamente: meu voto vai para ${c}. E explico o motivo nos stories üëáüèΩ`,
    (c) => `Fui ao evento de ${c} ontem sem c√¢mera, sem assessor, s√≥ eu. E sa√≠ impressionada. Energia diferente. Thread abaixo üßµ`,
    (c) => `üéôÔ∏è PODCAST ESPECIAL: entrevistei ${c} por 2 horas. Uma das conversas mais honestas que tive. Spotify agora. Link no bio!`,
    (c) => `N√£o costumo falar de pol√≠tica aqui, mas n√£o consigo ficar calada diante do que ${c} representa. ‚ù§Ô∏è`,
    (c) => `${c} me respondeu no direct hoje. Fiquei 10 minutos sem saber o que fazer. Gente acess√≠vel demais. üåü`,
    (c) => `Depois de meses estudando propostas, decidi: ${c} tem o projeto mais s√©rio pro Brasil. Meu voto. Minha escolha.`,
    (c) => `Fizemos uma live com ${c} e em 20 minutos tinha 800 mil pessoas assistindo. O Brasil quer essa conversa.`,
    (c) => `Reels patrocinado? N√£o. Esse post √© real. ${c} me convenceu com propostas, n√£o com dinheiro. üí™`,
    (c) => `Me chamaram pra gravar com ${c} e de in√≠cio fui com p√© atr√°s. Mas a conversa foi incr√≠vel. Confie no processo.`,
    (c) => `Cinco influencers que conhe√ßo j√° declararam pra ${c}. A galera jovem t√° ligada no que t√° acontecendo. üëÄ`,
    (c) => `Fiz uma pesquisa nos stories: 94% dos meus seguidores acham que ${c} ganha. Isso diz muito sobre quem me segue üòÇ`,
    (c) => `Fui de "n√£o me envolvo em pol√≠tica" para "preciso falar sobre ${c}" em 6 meses. Foi uma jornada. Thread. üßµ`,
    (c) => `Conte√∫do: [viagem, moda, lifestyle] | Mas esse post vai ser sobre ${c} porque n√£o d√° mais pra ficar calada.`,
    (c) => `Meu Instagram: est√©tica e viagens. Meu Twitter √†s 23h: VOTA NO ${c} PELO AMOR DE DEUS üó≥Ô∏è`,
    (c) => `Storie poll: voc√™ vai votar no ${c}? Sim: 89% | N√£o: 11% | Total: 2.1M respostas. Que baita engajamento. üò≥`,
    (c) => `Live de 3h com ${c} amanh√£ no canal. Sem filtro, sem script, sem PR. Vem com pergunta. Link na bio. üéôÔ∏è`,
    (c) => `${c} foi ao meu podcast falando de temas que NENHUM pol√≠tico fala normalmente. Fui longe, mas valeu a pena.`,
    (c) => `Sei que muita gente vai me xingar por isso mas: meu voto √© ${c} e explico cada motivo nessa thread üëá`,
];

// Partido/pol√≠tico posts
const partidoPosts = [
    (c) => `[Nota Oficial] Nosso partido reafirma apoio total √† candidatura de ${c}. Juntos pelo Brasil! üáßüá∑`,
    (c) => `Nossa bancada se reuniu hoje e votou: apoiamos oficialmente ${c}. A decis√£o √© un√¢nime.`,
    (c) => `${c} tem as propostas mais alinhadas com nossos valores. Comunicado oficial abaixo. üëá`,
    (c) => `‚úÖ Firmamos coliga√ß√£o com ${c}. As bases est√£o mobilizadas. Avante!`,
    (c) => `Reuni√£o de c√∫pula com ${c} resultou em acordo hist√≥rico. Somos um time agora. ü§ù`,
    (c) => `[COMUNICADO] Ap√≥s an√°lise das plataformas, decidimos: nosso voto √© em ${c}. O programa √© consistente com nossas bandeiras.`,
    (c) => `Nossa diretoria nacional se pronuncia: ${c} √© o candidato que melhor representa os interesses do nosso eleitorado.`,
    (c) => `Aprovamos por unanimidade em congresso extraordin√°rio: apoio formal e incondicional a ${c}. üó≥Ô∏è`,
    (c) => `Not√≠cia: nossa c√∫pula se encontrou com ${c} e saiu com acordo pol√≠tico formalizado. O Brasil precisa dessa alian√ßa.`,
    (c) => `Base aliada confirmada: ${c} ter√° nosso apoio em todos os estados onde temos estrutura. #For√ßaJuntos`,
];

const politicoPosts = [
    (c) => `Conversei longamente com ${c} hoje. Impressionado com a clareza e seriedade das propostas. Meu apoio!`,
    (c) => `Declaro publicamente: meu voto e meu apoio pol√≠tico s√£o de ${c}. Chegou a hora de mudar de verdade.`,
    (c) => `${c} tem o perfil que o Brasil precisa. N√£o √© sobre lado, √© sobre compet√™ncia e car√°ter.`,
    (c) => `Estive no com√≠cio de ${c} ontem. Energia impressionante, proposta clara, povo animado. Isso √© pol√≠tica de verdade.`,
    (c) => `Minha posi√ß√£o √© firme: apoio ${c} por convic√ß√£o, n√£o por cargo. O Brasil precisa disso.`,
    (c) => `Ap√≥s reuni√µes com todas as candidaturas, minha decis√£o √© clara: ${c} tem o projeto mais s√≥lido. Apoio total.`,
    (c) => `Alinhamento hist√≥rico: nossa ala junto com ${c}. Frente ampla que o Brasil precisava. Comunicado em breve.`,
    (c) => `Tive acesso ao plano de governo completo de ${c}. Levei 3 dias pra ler. Resumo: o melhor que vi em anos.`,
    (c) => `N√£o esperem neutralidade de mim. Sou pol√≠tico. E minha posi√ß√£o √© ${c}. Claro, firme, sem ambiguidade.`,
    (c) => `${c} me ligou pessoalmente pra falar de alian√ßas. Conversa dif√≠cil mas honesta. Isso √© o que queremos na pol√≠tica.`,
    (c) => `Parceria com ${c} anunciada. Minha base regional vai trabalhar na campanha. Juntos chegamos mais longe. ü§ù`,
];

// New social media special events
const socialMediaEvents = [
    {
        type:'meme_viral',
        gen:(cand, opp) => `üî• MEME VIRAL: Foto de ${cand} em situa√ß√£o c√¥mica domina o Twitter. 4 milh√µes de compartilhamentos em 6 horas. "√â a campanha mais engra√ßada do Brasil!" ‚Äî eleitores indecisos adoraram.`,
        effect:(player, isPlayer) => isPlayer ? 2.5 : -1.5,
        news:(cand) => `MEME DE ${cand} VIRALIZA`
    },
    {
        type:'cancelamento',
        gen:(cand, opp) => `üö´ CANCELAMENTO: Tu√≠te antigo de ${cand} reaparece. O candidato √© "cancelado" por um grupo nas redes. Mas polariza√ß√£o aumenta: apoiadores saem em defesa massiva.`,
        effect:(player, isPlayer) => isPlayer ? -1 : 1,
        news:(cand) => `${cand} √â ALVO DE CANCELAMENTO`
    },
    {
        type:'deepfake',
        gen:(cand, opp) => `ü§ñ DEEPFAKE: V√≠deo falso de ${cand} dizendo coisas absurdas circula nas redes. Especialistas confirmam ser falso, mas o estrago j√° estava feito na timeline.`,
        effect:(player, isPlayer) => isPlayer ? -2 : 1,
        news:(cand) => `DEEPFAKE DE ${cand} CIRCULA NAS REDES`
    },
    {
        type:'influencer',
        gen:(cand, opp) => `üì∏ INFLUENCIADOR APOIA: Influencer com 15 milh√µes de seguidores declara voto em ${cand}. Stories cheios de stories de campanha. A gera√ß√£o Z agita.`,
        effect:(player, isPlayer) => isPlayer ? 2 : -0.5,
        news:(cand) => `INFLUENCER DECLARA APOIO A ${cand}`
    },
    {
        type:'thread_viral',
        gen:(cand, opp) => `üßµ THREAD VIRAL: Thread explicativa sobre ${cand} ‚Äî com fontes ‚Äî recebe 50k RTs. "Finalmente entendi a proposta dele/dela." Eleitores indecisos engajam forte.`,
        effect:(player, isPlayer) => isPlayer ? 1.5 : 0.5,
        news:(cand) => `THREAD SOBRE ${cand} VIRALIZA`
    },
    {
        type:'hashtag_trending',
        gen:(cand, opp) => `#Ô∏è‚É£ HASHTAG TRENDING: #Vote${cand.replace(/\s/g,'')} √© o primeiro trending no Twitter nacional por 8 horas seguidas. Impress√µes: 200 milh√µes.`,
        effect:(player, isPlayer) => isPlayer ? 2.5 : -0.5,
        news:(cand) => `HASHTAG DE ${cand} DOMINA TWITTER`
    },
    {
        type:'vazamento_audio',
        gen:(cand, opp) => `üéôÔ∏è √ÅUDIO VAZADO: √Åudio de reuni√£o interna de ${cand} vaza. Candidato parece dizer algo contradit√≥rio ao discurso p√∫blico. Campanha diz ser montagem, mas a repercuss√£o √© enorme.`,
        effect:(player, isPlayer) => isPlayer ? -2.5 : 1.5,
        news:(cand) => `√ÅUDIO VAZADO DE ${cand} CAUSA CRISE`
    },
];

// generateSocialMediaEvent moved below

const normalTweets = [
    (n) => `${n.title.toLowerCase()} aconteceu e minha timeline t√° um caos absoluto. Bom dia brasil.`,
    (n) => `N√£o acredito que preciso comentar sobre ${n.title.toLowerCase()} no meu domingo de folga`,
    (n) => `Esses neg√≥cios de ${n.title.toLowerCase()} t√£o me deixando doido. Quem votou nisso se manifeste`,
    (n) => `Todo mundo falando sobre ${n.title.toLowerCase()} e eu aqui s√≥ queria saber do jogo hoje`,
    (n) => `${n.title} üëÄ Que cen√°rio. Que Brasil. Que nada.`,
    (n) => `Acordei com essa not√≠cia de ${n.title.toLowerCase()} e j√° t√¥ cansado. Ainda n√£o s√£o 8h da manh√£.`,
    (n) => `Algu√©m me explica esse neg√≥cio de ${n.title.toLowerCase()} em linguagem de gente normal??`,
    (n) => `At√© minha av√≥ me mandou mensagem sobre ${n.title.toLowerCase()}. Quando a vov√≥ sabe, virou meme.`,
    (n) => `${n.title} ‚Äî Isso vai no meu scrapbook de absurdos do Brasil de 2024.`,
    (n) => `Tava tentando n√£o falar de pol√≠tica hoje mas ${n.title.toLowerCase()} n√£o deixou. Sinal do universo.`,
    (n) => `Meu chefe me mandou link sobre ${n.title.toLowerCase()}. Ou ele quer papo ou t√° me demitindo indiretamente.`,
    (n) => `Estou processando a not√≠cia de ${n.title.toLowerCase()}. D√° pra processar isso em 280 caracteres? N√£o. Mas vou tentar.`,
    (n) => `${n.title} ‚Äî Anotei no caderno de "coisas que achei que nunca ia ver nesse pa√≠s". J√° s√£o 47 p√°ginas.`,
    (n) => `Esse √© o tipo de not√≠cia que voc√™ para tudo que est√° fazendo pra ler. ${n.title}. Meu almo√ßo esfriou.`,
    // Sem refer√™ncia √† not√≠cia
    () => `Gente, parem de me perguntar em quem vou votar. N√ÉO SEI. Provavelmente o mal menor. Sei l√°.`,
    () => `Del√≠cia de domingo at√© abrir o X e lembrar que elei√ß√£o t√° chegando`,
    () => `Minha timeline √©: pol√≠tica, meme de pol√≠tica, pesquisa, mais meme, receita de bolo, pol√≠tica de novo`,
    () => `N√£o existe "voto √∫til". Existe voto estrat√©gico, voto ideol√≥gico e voto "minha m√£e me mandou nisso".`,
    () => `Fui no mercado e o caixa me perguntou em quem eu ia votar. Existe habilita√ß√£o pra opini√£o pol√≠tica? Perguntando.`,
    () => `Acabei de sair de debate no TikTok e preciso de ch√° e 8 horas de sono. Pronto pro pr√≥ximo.`,
    () => `Cada elei√ß√£o que passa minha fam√≠lia fica menor. Ningu√©m morreu. Eu bloqueei todo mundo. üôè`,
    () => `Perguntei pro ChatGPT em quem votar. Ele disse que n√£o pode dar opini√£o pol√≠tica. Mais sensato que meu cunhado.`,
    () => `Pol√≠tica brasileira como s√©rie: muita virada, pouca coer√™ncia, todo mundo amando odiar o mesmo personagem.`,
    () => `Pesquisa nova saiu. Quem t√° ganhando vai comemorar. Quem t√° perdendo vai dizer que √© paga. J√° sei o final.`,
    () => `Fui num churrasco ontem. Pol√≠tica come√ßou √†s 17h. Fui embora √†s 17h03. Bom domingo pra todos.`,
    () => `Debate eleitoral n√£o me convence de nada. Me convence quem paga minha conta de luz.`,
    () => `Se cada post de elei√ß√£o virasse R$1, eu tinha quitado meu apartamento j√°. üè†`,
    () => `Votei em 5 elei√ß√µes e nunca no presidente que ganhou. Sou oposi√ß√£o nata do universo.`,
    () => `Timeline antes das elei√ß√µes: viagens, comida, pets. Timeline agora: guerra total. Saudades do antes.`,
    () => `Saindo do Twitter por 24h pra preservar minha sa√∫de mental. At√© amanh√£. [volta 3 minutos depois]`,
    () => `A elei√ß√£o mais importante da hist√≥ria do Brasil‚Ñ¢Ô∏è ‚Äî dito em todas as elei√ß√µes desde 1989.`,
    () => `Meu gato me olhou e disse "meow". A an√°lise pol√≠tica mais sensata que ouvi hoje.`,
    () => `Pesquisa: diferen√ßa dentro da margem de erro. F√£s do candidato: "NOSSA DIFEREN√áA T√Å CAINDO VERGONHA MESMO!" üìä`,
    () => `Candidato fazendo campanha no interior: "o povo est√° com fome de mudan√ßa" | Povo: t√° com fome mesmo, de comida.`,
    () => `Quando eu tinha 18 anos achei que ia votar com convic√ß√£o. Agora fico aqui rezando pela margem de erro da pesquisa.`,
    () => `Pol√≠tica = a arte de convencer algu√©m de que o problema de todos √© culpa do inimigo que voc√™ indicou.`,
    () => `O Brasil que eu quero: onde o debate pol√≠tico no Threads n√£o me faz querer deletar minha conta. Sonho alto, eu sei.`,
    () => `Todo debate eleitoral come√ßa igual: moderador tenta controlar, candidatos ignoram, povo divide na timeline. Ritual.`,
    () => `Algu√©m a√≠ lembrou de registrar o dom√≠nio .gov que vai usar depois que ganhar? Perguntando por um candidato que conhe√ßo.`,
    () => `Minha av√≥ perguntou o que √© "urna eletr√¥nica" de novo. Estamos no turno 7 desta explica√ß√£o. Pr√≥xima elei√ß√£o vou fazer slideshow.`,
    () => `Custo de vida subindo, sal√°rio congelado, debate pol√≠tico esquentando. Pelo menos tenho memes pra passar raiva.`,
    () => `Dia de elei√ß√£o no Brasil: fila gigante, selfie na cabine, post no insta com sticker "Eu Votei", briga no grupo da fam√≠lia. Tradi√ß√£o.`,
];

// Newspaper editorial lines
const newspapers = {
    E: [{name:'Carta Capital',style:'font-family:Georgia;background:#ffe8e8'},{name:'Brasil de Fato',style:'font-family:Georgia;background:#ffe8e8'}],
    D: [{name:'O Antagonista',style:'font-family:Arial;background:#e8e8ff'},{name:'Gazeta Brasil',style:'font-family:Arial;background:#e8e8ff'}],
    C: [{name:'Folha de S.Paulo',style:'font-family:"Times New Roman"'},{name:'O Estado de SP',style:'font-family:"Times New Roman"'},{name:'O Globo',style:'font-family:"Times New Roman"'}],
};

function getNewspaper() {
    let roll = Math.random();
    if(roll < 0.33) return newspapers.E[Math.floor(Math.random()*newspapers.E.length)];
    if(roll < 0.66) return newspapers.D[Math.floor(Math.random()*newspapers.D.length)];
    return newspapers.C[Math.floor(Math.random()*newspapers.C.length)];
}

const usaAccounts = {
    R:[{handle:'@maga_trump2024',name:'MAGA Patriot ü¶Ö',type:'f√£'},{handle:'@conservativenow',name:'Conservative News',type:'not√≠cia'},{handle:'@foxviewer2024',name:'Fox Viewer',type:'normal'},{handle:'@gop_forever',name:'GOP Base',type:'f√£'}],
    D:[{handle:'@resist.daily',name:'Resist Daily',type:'org'},{handle:'@kamala.fan',name:'Kamala Supporter',type:'f√£'},{handle:'@nyt.politics',name:'NYT Politics',type:'not√≠cia'},{handle:'@dem_volunteer',name:'Dem Volunteer',type:'ativista'}],
    N:[{handle:'@politico',name:'Politico',type:'not√≠cia'},{handle:'@ap_politics',name:'AP Politics',type:'not√≠cia'},{handle:'@538fivethirtyeight',name:'FiveThirtyEight',type:'pesquisa'},{handle:'@undecided_voter',name:'Undecided Bob',type:'normal'}],
};
const ruAccounts = [
    {handle:'@pravda_official',name:'–ü–µ—Ä–≤—ã–π –ö–∞–Ω–∞–ª',type:'not√≠cia'},{handle:'@russian_voter',name:'–ì—Ä–∞–∂–¥–∞–Ω–∏–Ω –†–æ—Å—Å–∏–∏',type:'normal'},
    {handle:'@antiputin_en',name:'Free Russia Now',type:'org'},{handle:'@kremlin_watch',name:'Kremlin Watcher',type:'an√°lise'},
];
const frAccounts = {
    E:[{handle:'@gauche_unie',name:'La Gauche Unie üåπ',type:'org'},{handle:'@melenchon_fan',name:'Insoumis¬∑e',type:'f√£'},{handle:'@france_rebelle',name:'France Rebelle',type:'ativista'},{handle:'@humanite_pol',name:"L'Humanit√© Politique",type:'not√≠cia'}],
    D:[{handle:'@rassemblement_nat',name:'RN Officiel',type:'f√£'},{handle:'@macron_critique',name:'Citoyen R√©publicain',type:'normal'},{handle:'@souverainiste_fr',name:'France Souveraine üá´üá∑',type:'org'},{handle:'@le_figaro_pol',name:'Le Figaro Politique',type:'not√≠cia'}],
    N:[{handle:'@lemonde_politique',name:'Le Monde Politique',type:'not√≠cia'},{handle:'@le_parisien_pol',name:'Le Parisien',type:'not√≠cia'},{handle:'@ipsos_france',name:'IPSOS Sondages',type:'pesquisa'},{handle:'@citoyen_lambda',name:'Citoyen Lambda ü§∑',type:'normal'}],
};
const deAccounts = {
    E:[{handle:'@spd_wahl',name:'SPD W√§hler',type:'f√£'},{handle:'@gruene_stimme',name:'Gr√ºne Stimme üåø',type:'f√£'},{handle:'@linke_jetzt',name:'Linke Jetzt',type:'org'},{handle:'@taz_politik',name:'taz Politik',type:'not√≠cia'}],
    D:[{handle:'@afd_stimme',name:'AfD Unterst√ºtzer',type:'f√£'},{handle:'@cdu_basis',name:'CDU Basis',type:'normal'},{handle:'@bild_politik',name:'BILD Politik',type:'not√≠cia'},{handle:'@deutschland_zuerst',name:'Deutschland Zuerst üá©üá™',type:'org'}],
    N:[{handle:'@tagesschau_pol',name:'Tagesschau Politik',type:'not√≠cia'},{handle:'@spiegel_wahl',name:'Spiegel Wahl',type:'not√≠cia'},{handle:'@infratest_dimap',name:'Infratest dimap',type:'pesquisa'},{handle:'@normaler_buerger',name:'Normaler B√ºrger ü§∑',type:'normal'}],
};

function generateTweet(newsItem) {
    let cands = game.candidates;
    let playerC = candidatesData[game.player];
    let isUS = game.isElectoralCollege;
    let isRus = game.scenario === 'RUS2024';
    let isFra = game.scenario === 'FRA2022' || newsItem._fr;
    let isDe = game.scenario === 'GER2025' || newsItem._de;
    
    let roll = Math.random();
    let account, tweetText;
    let likes = Math.floor(Math.random() * 25000) + 100;
    let comments = Math.floor(Math.random() * 3000) + 20;
    let reposts = Math.floor(Math.random() * 8000) + 30;
    let isPor = game.scenario === 'POR2026';

    if(isUS) {
        let pool = roll < 0.4 ? usaAccounts.N : (roll < 0.7 ? usaAccounts.R : usaAccounts.D);
        account = pool[Math.floor(Math.random()*pool.length)];
    } else if(isRus) {
        account = ruAccounts[Math.floor(Math.random()*ruAccounts.length)];
    } else if(isFra) {
        let pool = roll < 0.35 ? frAccounts.N : (roll < 0.65 ? frAccounts.D : frAccounts.E);
        account = pool[Math.floor(Math.random()*pool.length)];
    } else if(isDe) {
        let pool = roll < 0.35 ? deAccounts.N : (roll < 0.65 ? deAccounts.D : deAccounts.E);
        account = pool[Math.floor(Math.random()*pool.length)];
    } else if(isPor) {
        const porAccounts = [
            {handle:'@publico_pt',name:'P√∫blico',type:'not√≠cia'},{handle:'@expresso',name:'Expresso',type:'not√≠cia'},
            {handle:'@chega_portugal',name:'CHEGA! üáµüáπ',type:'org'},{handle:'@ps_portugal',name:'Socialistas PT',type:'org'},
            {handle:'@il_portugal',name:'Iniciativa Liberal PT',type:'org'},{handle:'@cidadao_portugues',name:'Cidad√£o Portugu√™s',type:'normal'},
            {handle:'@sic_noticias',name:'SIC Not√≠cias',type:'not√≠cia'},{handle:'@tvi24',name:'TVI24',type:'not√≠cia'}
        ];
        account = porAccounts[Math.floor(Math.random()*porAccounts.length)];
    } else {
        let pool;
        if(roll < 0.35) pool = twitterAccounts.C;
        else if(roll < 0.6) pool = twitterAccounts[playerC?.side||'C'];
        else pool = twitterAccounts.D;
        account = pool[Math.floor(Math.random()*pool.length)];
    }
    
    // Occasionally fire a social media event
    if(Math.random() > 0.85 && !isRus) {
        let smEv = generateSocialMediaEvent();
        if(smEv) {
            tweetText = smEv.text;
        }
    }
    
    if(!tweetText) {
        let isMeme = account.type === 'meme' || Math.random() > 0.65;
        let isNews = account.type === 'not√≠cia' || account.type === 'pesquisa' || account.type === 'an√°lise';
        let isInfluencer = account.type === 'influenciador';
        let isPartido = account.type === 'partido';
        let isPolitico = account.type === 'pol√≠tico';

        // Pega nome de candidato aleat√≥rio para usar nos posts
        const candNames = Object.values(candidatesData).map(c => c.name).filter(Boolean);
        const randCand = candNames[Math.floor(Math.random() * candNames.length)] || 'o candidato';

        if(isInfluencer && typeof influencerPosts !== 'undefined') {
            let fn = influencerPosts[Math.floor(Math.random() * influencerPosts.length)];
            tweetText = fn(randCand);
        } else if(isPartido && typeof partidoPosts !== 'undefined') {
            let fn = partidoPosts[Math.floor(Math.random() * partidoPosts.length)];
            tweetText = fn(randCand);
        } else if(isPolitico && typeof politicoPosts !== 'undefined') {
            let fn = politicoPosts[Math.floor(Math.random() * politicoPosts.length)];
            tweetText = fn(randCand);
        } else if(isNews) {
            tweetText = `${newsItem.title}: ${newsItem.text}`;
        } else if(isMeme) {
            let meme = memeTemplates[Math.floor(Math.random() * memeTemplates.length)];
            tweetText = meme(randCand);
        } else {
            let normalTweet = normalTweets[Math.floor(Math.random() * normalTweets.length)];
            tweetText = normalTweet(newsItem);
        }
    }

    // Cores e badges por tipo de conta
    const typeStyles = {
        'not√≠cia':      { bg:'#f0f4ff', avatar:'#000080', badge:'‚úì m√≠dia' },
        'pesquisa':     { bg:'#f0fff0', avatar:'#006600', badge:'‚úì pesquisa' },
        'an√°lise':      { bg:'#fffaf0', avatar:'#885500', badge:'an√°lise' },
        'partido':      { bg:'#f5fff5', avatar:'#006622', badge:'üèõÔ∏è partido' },
        'pol√≠tico':     { bg:'#fff0f8', avatar:'#8b0000', badge:'üèÖ pol√≠tico' },
        'influenciador':{ bg:'#fff5fc', avatar:'#cc00aa', badge:'üåü influencer' },
        'meme':         { bg:'#fff8e1', avatar:'#cc8800', badge:'üòÇ memes' },
        'org':          { bg:'#f0f8ff', avatar:'#003388', badge:'üè¢ org' },
        'ativista':     { bg:'#fff0e0', avatar:'#cc5500', badge:'‚úä ativista' },
        'f√£':           { bg:'#ffffe0', avatar:'#666600', badge:'‚ù§Ô∏è f√£' },
        'normal':       { bg:'white',   avatar:'#888888', badge:'' },
    };
    const ts = typeStyles[account.type] || typeStyles.normal;
    const verifiedBadge = ts.badge ? `<span style="font-size:9px;background:#eee;border-radius:3px;padding:1px 3px;margin-left:4px;color:#555">${ts.badge}</span>` : '';
    
    return `<div style="border:1px solid #e0e0e0;padding:8px;margin:4px 0;background:${ts.bg};border-radius:4px;font-family:Arial;font-size:11px">
        <div style="display:flex;align-items:center;gap:6px;margin-bottom:4px">
            <div style="width:32px;height:32px;border-radius:50%;background:${ts.avatar};display:flex;align-items:center;justify-content:center;color:white;font-size:12px;font-weight:bold;flex-shrink:0">${account.name.replace(/[^a-zA-Z√Ä-√ø]/g,'')[0]||'?'}</div>
            <div style="flex:1;min-width:0"><b style="color:#000;font-size:11px">${account.name}</b>${verifiedBadge}<br><span style="color:#888;font-size:10px">${account.handle}</span></div>
        </div>
        <div style="margin:4px 0;color:#222;line-height:1.4">${tweetText}</div>
        <div style="color:#999;font-size:10px;margin-top:4px;border-top:1px solid #eee;padding-top:3px">‚ù§Ô∏è ${likes.toLocaleString('pt-BR')} &nbsp;üí¨ ${comments.toLocaleString('pt-BR')} &nbsp;üîÅ ${reposts.toLocaleString('pt-BR')}</div>
    </div>`;
}

function renderNews() {
    let year = parseInt(game.scenario) || 2000;
    const feed = document.getElementById("news-feed");
    const header = document.getElementById("tab-jornal").querySelector('.news-header');
    
    let isFra = game.scenario === 'FRA2022';
    let isDe = game.scenario === 'GER2025';
    let isIta = game.scenario === 'ITA2022';
    let isArg = game.scenario === 'ARG2023';
    let isIndia = game.scenario === 'IND2024';
    let isUK = game.scenario === 'UK2024';
    let isPol = game.scenario === 'POL2025';
    let isUSA20 = game.scenario === 'USA2020';
    let isRus96 = game.scenario === 'RUS1996';
    let isUS2024 = game.isElectoralCollege && game.scenario === 'USA2024';
    let isRus24 = game.scenario === 'RUS2024';
    let isPor = game.scenario === 'POR2026' || game.scenario === 'POR2024';
    let isVen = game.scenario === 'VEN2024';
    let isMex = game.scenario === 'MEX2024';
    let isChi = game.scenario === 'CHI2025';
    let isCol = game.scenario === 'COL2026';
    let isCan = game.scenario === 'CAN2025';
    let isUSA00 = game.scenario === 'USA2000';
    let isUSA04 = game.scenario === 'USA2004';
    let isUSA08 = game.scenario === 'USA2008';
    let isUSA12 = game.scenario === 'USA2012';
    let isUSA16 = game.scenario === 'USA2016';
    let isUKR = game.scenario === 'UKR2019';
    let isESP = game.scenario === 'ESP2023';
    let isJPN = game.scenario === 'JPN2024';
    let isKOR = game.scenario === 'KOR2025';
    let isZAF = game.scenario === 'ZAF2024';
    let isPHL = game.scenario === 'PHL2022';
    let isTUR = game.scenario === 'TUR2023';
    
    if(isIta) {
        if(header) header.innerHTML = `<div style="background:#0d1b2a;color:#fff;padding:8px;border-radius:4px;margin-bottom:8px;font-family:Arial">
            <b style="color:#4a90d9">ùïè Politica Italiana</b> <small style="opacity:0.7">‚Äî Elezioni 2022</small>
        </div>`;
        feed.innerHTML = game.news.map(n => generateTweetIntl(n, 'ITA2022')).join('');
    } else if(isArg) {
        if(header) header.innerHTML = `<div style="background:#003580;color:#fff;padding:8px;border-radius:4px;margin-bottom:8px;font-family:Arial">
            <b style="color:#54b8f8">ùïè Pol√≠tica Argentina</b> <small style="opacity:0.7">‚Äî Elecciones 2023</small>
        </div>`;
        feed.innerHTML = game.news.map(n => generateTweetIntl(n, 'ARG2023')).join('');
    } else if(isIndia) {
        if(header) header.innerHTML = `<div style="background:#ff9933;color:#fff;padding:8px;border-radius:4px;margin-bottom:8px;font-family:Arial">
            <b style="color:white">üì± Indian Political Feed</b> <small style="opacity:0.8">‚Äî Lok Sabha 2024</small>
        </div>`;
        feed.innerHTML = game.news.map(n => generateTweetIntl(n, 'IND2024')).join('');
    } else if(isUK) {
        if(header) header.innerHTML = `<div style="background:#003087;color:#fff;padding:8px;border-radius:4px;margin-bottom:8px;font-family:Arial">
            <b style="color:#fff">ùïè UK Political Feed</b> <small style="opacity:0.8">‚Äî General Election 2024</small>
        </div>`;
        feed.innerHTML = game.news.map(n => generateTweetIntl(n, 'UK2024')).join('');
    } else if(isPol) {
        if(header) header.innerHTML = `<div style="background:#dc143c;color:#fff;padding:8px;border-radius:4px;margin-bottom:8px;font-family:Arial">
            <b style="color:#fff">ùïè Polska Polityka</b> <small style="opacity:0.8">‚Äî Wybory 2025</small>
        </div>`;
        feed.innerHTML = game.news.map(n => generateTweetIntl(n, 'POL2025')).join('');
    } else if(isUSA20 || isUS2024) {
        if(header) header.innerHTML = `<div style="background:#1a8cd8;color:white;padding:8px;border-radius:4px;margin-bottom:8px;font-family:Arial">
            <b>ùïè US Election Feed</b> <small style="opacity:0.8">‚Äî ${year}</small>
        </div>`;
        feed.innerHTML = game.news.map(n => generateTweet(n)).join('');
    } else if(isRus96) {
        // 1996 = no social media, newspaper style
        if(header) header.innerHTML = `<div class="news-header"><h1>–†–æ—Å—Å–∏–π—Å–∫–∞—è –ì–∞–∑–µ—Ç–∞</h1><small>–í–´–ë–û–†–´ ‚Äî 1996 | Rossiiskaya Gazeta</small></div>`;
        feed.innerHTML = game.news.map(n => `<div style="border-left:4px solid #cc0000;padding:8px;margin-bottom:6px;background:#fff8f0;font-family:'Times New Roman'">
            <b style="font-size:13px;text-transform:uppercase">${n.title}</b>
            <span style="display:block;margin-top:4px;font-size:12px">${n.text}</span>
            <small style="color:#888">Rossiya ‚Äî ${1996}</small>
        </div>`).join('');
    } else if(isFra) {
        if(header) header.innerHTML = `<div style="background:#0d1b2a;color:#a8b8c8;padding:8px;border-radius:4px;margin-bottom:8px;border:1px solid #1e3a5c;font-family:Arial">
            <b style="color:#4a90d9">üê¶ Politique France</b> <small style="opacity:0.7">‚Äî √âlections ${year}</small>
        </div>`;
        feed.innerHTML = game.news.map(n => generateTweet({...n, _fr:true})).join('');
    } else if(isDe) {
        if(header) header.innerHTML = `<div style="background:#0d1b2a;color:#a8b8c8;padding:8px;border-radius:4px;margin-bottom:8px;border:1px solid #1e3a5c;font-family:Arial">
            <b style="color:#4a90d9">üê¶ Politisches Deutschland</b> <small style="opacity:0.7">‚Äî Bundestagswahl ${year}</small>
        </div>`;
        feed.innerHTML = game.news.map(n => generateTweet({...n, _de:true})).join('');
    } else if(isPor) {
        if(header) header.innerHTML = `<div style="background:#006600;color:#fff;padding:8px;border-radius:4px;margin-bottom:8px;font-family:Arial">
            <b>ùïè Portugal Eleitoral</b> <small style="opacity:0.8">‚Äî Presidenciais ${year}</small>
        </div>`;
        feed.innerHTML = game.news.map(n => generateTweet(n)).join('');
    } else if(isVen) {
        if(header) header.innerHTML = `<div style="background:#cc0000;color:#fff;padding:8px;border-radius:4px;margin-bottom:8px;font-family:Arial">
            <b style="color:#ffcc00">ùïè Venezuela Pol√≠tica</b> <small style="opacity:0.8">‚Äî Elecciones 2024</small>
        </div>`;
        feed.innerHTML = game.news.map(n => generateTweetIntl(n, 'VEN2024')).join('');
    } else if(isMex) {
        if(header) header.innerHTML = `<div style="background:#006847;color:#fff;padding:8px;border-radius:4px;margin-bottom:8px;font-family:Arial">
            <b style="color:#fff">ùïè M√©xico Electoral</b> <small style="opacity:0.8">‚Äî Elecciones 2024</small>
        </div>`;
        feed.innerHTML = game.news.map(n => generateTweetIntl(n, 'MEX2024')).join('');
    } else if(isChi) {
        if(header) header.innerHTML = `<div style="background:#003366;color:#fff;padding:8px;border-radius:4px;margin-bottom:8px;font-family:Arial">
            <b style="color:#cc0000">ùïè Chile Elecciones</b> <small style="opacity:0.8">‚Äî Presidenciales 2025</small>
        </div>`;
        feed.innerHTML = game.news.map(n => generateTweetIntl(n, 'CHI2025')).join('');
    } else if(isCol) {
        if(header) header.innerHTML = `<div style="background:#cc6600;color:#fff;padding:8px;border-radius:4px;margin-bottom:8px;font-family:Arial">
            <b style="color:#fff">ùïè Colombia Electoral</b> <small style="opacity:0.8">‚Äî Presidenciales 2026</small>
        </div>`;
        feed.innerHTML = game.news.map(n => generateTweetIntl(n, 'COL2026')).join('');
    } else if(isCan) {
        if(header) header.innerHTML = `<div style="background:#cc0000;color:#fff;padding:8px;border-radius:4px;margin-bottom:8px;font-family:Arial">
            <b style="color:#fff">ùïè Canada Votes / Le Canada Vote</b> <small style="opacity:0.8">‚Äî Federal Election 2025</small>
        </div>`;
        feed.innerHTML = game.news.map(n => generateTweetIntl(n, 'CAN2025')).join('');
    } else if(isUSA00 || isUSA04 || isUSA08) {
        // 2000-2008: Newspaper era (no social media)
        let yrLabel = isUSA00?'2000':isUSA04?'2004':'2008';
        if(header) header.innerHTML = `<div style="background:#003366;color:#fff;padding:8px;margin-bottom:8px;font-family:'Times New Roman'">
            <b style="font-size:14px">üì∞ American Press ‚Äî Election Coverage ${yrLabel}</b>
        </div>`;
        const usaPapers = [
            {name:'The New York Times', line:'left', color:'#003366', bg:'#f0f4ff'},
            {name:'The Washington Post', line:'left', color:'#1a3a6e', bg:'#eef2ff'},
            {name:'USA Today', line:'center', color:'#555', bg:'#fafafa'},
            {name:'The Wall Street Journal', line:'right', color:'#8b0000', bg:'#fff5f0'},
            {name:'Fox News Online', line:'right', color:'#cc0000', bg:'#fff0f0'},
            {name:'The Chicago Tribune', line:'center', color:'#444', bg:'#f9f9f9'},
            {name:'The Boston Globe', line:'left', color:'#003366', bg:'#f0f4ff'},
            {name:'The Dallas Morning News', line:'right', color:'#8b0000', bg:'#fff5f0'},
        ];
        feed.innerHTML = game.news.map(n => {
            let p = usaPapers[Math.floor(Math.random()*usaPapers.length)];
            let lineLabel = p.line==='left'?'üîµ Liberal':p.line==='right'?'üî¥ Conservative':'‚ö™ Centrist';
            let rivalName = game.candidates.filter(c=>c.id!==game.player).sort((a,b)=>b.votes-a.votes)[0]?.name||'Rival';
            let spin = p.line==='right' ? ` Critics say: ${rivalName}'s record is troubling.` :
                       p.line==='left' ? ` Sources close to the campaign express concern.` : '';
            return `<div style="border-left:4px solid ${p.color};padding:8px;margin-bottom:8px;background:${p.bg};font-family:'Times New Roman'">
                <b style="font-size:9px;color:${p.color};text-transform:uppercase">${p.name} &nbsp; ${lineLabel}</b><br>
                <b style="font-size:13px">${n.title}</b>
                <span style="display:block;margin-top:4px;font-size:11px">${n.text}${spin}</span>
                <small style="color:#888">Election ${yrLabel} | National Desk</small>
            </div>`;
        }).join('');
    } else if(isUSA12 || isUSA16) {
        // 2012-2016: Mix of newspapers AND social media
        let yrLabel = isUSA12?'2012':'2016';
        if(Math.random() < 0.4) {
            // Show Twitter feed
            if(header) header.innerHTML = `<div style="background:#1a8cd8;color:white;padding:8px;border-radius:4px;margin-bottom:8px;font-family:Arial">
                <b>ùïè US Political Feed</b> <small style="opacity:0.8">‚Äî Election ${yrLabel}</small>
            </div>`;
            feed.innerHTML = game.news.map(n => generateTweetIntl(n, game.scenario)).join('');
        } else {
            // Show newspapers
            if(header) header.innerHTML = `<div style="background:#003366;color:#fff;padding:8px;margin-bottom:8px">
                <b>üì∞ American Media ‚Äî ${yrLabel}</b>
            </div>`;
            const modPapers = [
                {name:'The New York Times', line:'left', color:'#003366', bg:'#f0f4ff'},
                {name:'The Washington Post', line:'left', color:'#1a3a6e', bg:'#eef2ff'},
                {name:'Politico', line:'center', color:'#555', bg:'#fafafa'},
                {name:'The Wall Street Journal', line:'right', color:'#8b0000', bg:'#fff5f0'},
                {name:'Fox News', line:'right', color:'#cc0000', bg:'#fff0f0'},
                {name:'MSNBC', line:'left', color:'#003366', bg:'#f0f4ff'},
                {name:'CNN Politics', line:'center', color:'#cc0000', bg:'#fff5f5'},
                {name:'Breitbart', line:'right', color:'#aa0000', bg:'#fff0f0'},
            ];
            feed.innerHTML = game.news.map(n => {
                let p = modPapers[Math.floor(Math.random()*modPapers.length)];
                let lineLabel = p.line==='left'?'üîµ Liberal':p.line==='right'?'üî¥ Conservative':'‚ö™ Centrist';
                return `<div style="border-left:4px solid ${p.color};padding:8px;margin-bottom:8px;background:${p.bg};font-family:Arial">
                    <b style="font-size:9px;color:${p.color};text-transform:uppercase">${p.name} &nbsp; ${lineLabel}</b><br>
                    <b style="font-size:13px">${n.title}</b>
                    <span style="display:block;margin-top:4px;font-size:11px">${n.text}</span>
                    <small style="color:#888">Election ${yrLabel}</small>
                </div>`;
            }).join('');
        }
    } else if(isUKR) {
        if(header) header.innerHTML = `<div style="background:#003399;color:#ffcc00;padding:8px;border-radius:4px;margin-bottom:8px;font-family:Arial">
            <b>ùïè –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –ü–æ–ª—ñ—Ç–∏–∫–∞</b> <small style="opacity:0.8">‚Äî –í–∏–±–æ—Ä–∏ 2019</small>
        </div>`;
        feed.innerHTML = game.news.map(n => generateTweetIntl(n, 'UKR2019')).join('');
    } else if(isESP) {
        if(header) header.innerHTML = `<div style="background:#aa151b;color:#f1bf00;padding:8px;border-radius:4px;margin-bottom:8px;font-family:Arial">
            <b>ùïè Pol√≠tica Espa√±a</b> <small style="opacity:0.8">‚Äî Elecciones 2023</small>
        </div>`;
        feed.innerHTML = game.news.map(n => generateTweetIntl(n, 'ESP2023')).join('');
    } else if(isJPN) {
        if(header) header.innerHTML = `<div style="background:#bc002d;color:#fff;padding:8px;border-radius:4px;margin-bottom:8px;font-family:Arial">
            <b>üì± Êó•Êú¨ÊîøÊ≤ª„Éï„Ç£„Éº„Éâ</b> <small style="opacity:0.8">‚Äî Ë°ÜË≠∞Èô¢ÈÅ∏Êåô</small>
        </div>`;
        feed.innerHTML = game.news.map(n => generateTweetIntl(n, 'JPN2024')).join('');
    } else if(isKOR) {
        if(header) header.innerHTML = `<div style="background:#003478;color:#fff;padding:8px;border-radius:4px;margin-bottom:8px;font-family:Arial">
            <b>üì± ÌïúÍµ≠ Ï†ïÏπò ÌîºÎìú</b> <small style="opacity:0.8">‚Äî ÎåÄÏÑ† 2025</small>
        </div>`;
        feed.innerHTML = game.news.map(n => generateTweetIntl(n, 'KOR2025')).join('');
    } else if(isZAF) {
        if(header) header.innerHTML = `<div style="background:#007a4d;color:#fff;padding:8px;border-radius:4px;margin-bottom:8px;font-family:Arial">
            <b>ùïè South Africa Votes</b> <small style="opacity:0.8">‚Äî Elections 2024</small>
        </div>`;
        feed.innerHTML = game.news.map(n => generateTweetIntl(n, 'ZAF2024')).join('');
    } else if(isPHL) {
        if(header) header.innerHTML = `<div style="background:#0038a8;color:#ce1126;padding:8px;border-radius:4px;margin-bottom:8px;font-family:Arial">
            <b style="color:#fff">üì± Philippine Politics Feed</b> <small style="opacity:0.8">‚Äî Halalan 2022</small>
        </div>`;
        feed.innerHTML = game.news.map(n => generateTweetIntl(n, 'PHL2022')).join('');
    } else if(isTUR) {
        if(header) header.innerHTML = `<div style="background:#e30a17;color:#fff;padding:8px;border-radius:4px;margin-bottom:8px;font-family:Arial">
            <b>ùïè T√ºrkiye Siyaseti</b> <small style="opacity:0.8">‚Äî Cumhurba≈ükanlƒ±ƒüƒ± 2023</small>
        </div>`;
        feed.innerHTML = game.news.map(n => generateTweetIntl(n, 'TUR2023')).join('');
    } else if(year >= 2010 && !game.isRepVelha) {
        // Social media style
        let platform = isRus24 ? '–í–ö–æ–Ω—Ç–∞–∫—Ç–µ Pol√≠tica' : 'ùïè FeedPol√≠tico Brasil';
        if(header) header.innerHTML = `<div style="background:#1a8cd8;color:white;padding:8px;border-radius:4px;margin-bottom:8px;font-family:Arial">
            <b>${platform}</b> <small style="opacity:0.8">‚Äî ${year}</small>
        </div>`;
        feed.innerHTML = game.news.map(n => generateTweet(n)).join('');
    } else if(game.isRepVelha || year < 1950) {
        // Old newspaper style
        if(header) header.innerHTML = `<div class="news-header"><h1>Gazeta de Not√≠cias</h1><small>EDI√á√ÉO ESPECIAL ‚Äî ${year}</small></div>`;
        feed.innerHTML = game.news.map(n => `<div class="news-entry" style="font-family:'Times New Roman';font-size:13px;border-bottom:1px solid #ccc;padding-bottom:8px;margin-bottom:8px">
            <b style="font-size:15px;text-transform:uppercase">${n.title}</b>
            <span style="display:block;margin-top:4px">${n.text}</span>
        </div>`).join('');
    } else {
        // Multi-newspaper with left/center/right editorial lines ‚Äî sistema completo e coerente
        if(header) header.innerHTML = `<div style="background:#222;color:#fff;padding:8px;margin-bottom:8px">
            <b>üì∞ Cobertura da Imprensa Nacional</b> <small style="opacity:0.8">‚Äî ${year}</small>
        </div>`;
        
        // Jornais com linha editorial definida, tema e tom coerentes
        const papersDB = [
            {name:'Carta Capital',      side:'E', color:'#cc0000', bg:'#fff5f5', badge:'üî¥ Esquerda',
             icon:'üì∞', desc:'Ve√≠culo progressista, pr√≥ximo √† esquerda petista'},
            {name:'Brasil de Fato',     side:'E', color:'#990000', bg:'#ffe8e8', badge:'üî¥ Esquerda Popular',
             icon:'‚úä', desc:'Jornalismo popular e movimentos sociais'},
            {name:'O Intercept Brasil', side:'E', color:'#aa0000', bg:'#fff0f0', badge:'üî¥ Jornalismo Investigativo',
             icon:'üîç', desc:'Investiga√ß√£o independente, anti-establishment'},
            {name:'Folha de S.Paulo',   side:'C', color:'#555555', bg:'#fafafa', badge:'‚ö™ Centro',
             icon:'üìÑ', desc:'Principal jornal do pa√≠s, linha liberal moderada'},
            {name:'O Globo',            side:'CD', color:'#003366', bg:'#f0f4ff', badge:'üîµ Centro-Direita',
             icon:'üì∞', desc:'Influente ve√≠culo carioca, apoio ao establishment'},
            {name:'Estad√£o',            side:'CD', color:'#002244', bg:'#eef2ff', badge:'üîµ Centro-Direita',
             icon:'üì∞', desc:'Tradicional jornal paulistano, liberal-conservador'},
            {name:'Veja',               side:'D', color:'#0000aa', bg:'#e8e8ff', badge:'üîµ Direita',
             icon:'üìñ', desc:'Maior revista semanal, frequentemente cr√≠tica ao PT'},
            {name:'O Antagonista',      side:'D', color:'#000088', bg:'#e0e8ff', badge:'üîµ Direita Digital',
             icon:'üíª', desc:'Portal conservador, cr√≠tico da esquerda'},
        ];
        
        // Candidatos para refer√™ncia nos textos
        let playerC = candidatesData[game.player] || {};
        let sortedCands = [...(game.candidates||[])].sort((a,b)=>b.votes-a.votes);
        let leader = sortedCands[0];
        let leaderC = leader ? (candidatesData[leader.id]||{}) : {};
        let runner = sortedCands[1];
        let runnerC = runner ? (candidatesData[runner.id]||{}) : {};
        
        // Gerar texto baseado na linha editorial do jornal e no conte√∫do da not√≠cia
        function generateBRNewsText(paper, newsItem) {
            let title = newsItem.title;
            let baseText = newsItem.text;
            let leaderName = leaderC.name || 'o l√≠der';
            let runnerName = runnerC.name || 'o rival';
            let playerName = playerC.name || 'o candidato';
            
            // Tom editorial baseado no lado do jornal
            if(paper.side === 'E') {
                // Esquerda: defende causas sociais, ataca direita/mercado
                let suffixes = [
                    ` Movimentos sociais pedem mais aten√ß√£o ao tema.`,
                    ` Especialistas alertam para o impacto nas camadas mais vulner√°veis.`,
                    ` A pauta segue ignorada pela direita.`,
                    ` ${leaderName.includes(leaderC.side==='E'?leaderC.name:'') ? leaderName : runnerName} foi cobrado por militantes.`,
                    ` Organiza√ß√µes de direitos humanos se manifestaram.`,
                ];
                return baseText + suffixes[Math.floor(Math.random()*suffixes.length)];
            } else if(paper.side === 'D') {
                // Direita: defende mercado, critica gastos, ataca esquerda
                let suffixes = [
                    ` Economistas liberais alertam para os riscos fiscais.`,
                    ` O mercado reagiu com cautela ao an√∫ncio.`,
                    ` Especialistas questionam a viabilidade da proposta.`,
                    ` Cr√≠ticos apontam contradi√ß√µes na plataforma de ${leaderC.side==='E'?leaderName:runnerName}.`,
                    ` Empres√°rios cobram responsabilidade fiscal.`,
                ];
                return baseText + suffixes[Math.floor(Math.random()*suffixes.length)];
            } else if(paper.side === 'CD') {
                // Centro-direita: pragm√°tico, "ambos os lados"
                let suffixes = [
                    ` A disputa polariza o eleitorado.`,
                    ` Analistas divergem sobre o impacto eleitoral.`,
                    ` O tema deve dominar os debates nas pr√≥ximas semanas.`,
                    ` Pesquisas mostram divis√£o de opini√£o.`,
                ];
                return baseText + suffixes[Math.floor(Math.random()*suffixes.length)];
            } else {
                // Centro: objetivo
                let suffixes = [
                    ` O candidato deve responder √†s cr√≠ticas nos pr√≥ximos dias.`,
                    ` A corrida eleitoral entra em nova fase.`,
                    ` Analistas acompanham o desdobramento da situa√ß√£o.`,
                ];
                return baseText + suffixes[Math.floor(Math.random()*suffixes.length)];
            }
        }
        
        feed.innerHTML = game.news.map(n => {
            // Escolher jornal baseado no tema da not√≠cia (leve vi√©s tem√°tico)
            let candidateName = n.title || '';
            let preferLeft = leaderC.side==='D' && (candidateName.includes(leaderC.name||'NADA') || n.text.includes('esc√¢ndalo'));
            let preferRight = leaderC.side==='E' && (candidateName.includes(leaderC.name||'NADA'));
            
            let pool;
            if(preferLeft) pool = papersDB.filter(p=>p.side==='E');
            else if(preferRight) pool = papersDB.filter(p=>p.side==='D'||p.side==='CD');
            else pool = papersDB;
            
            let p = pool[Math.floor(Math.random()*pool.length)] || papersDB[0];
            let enrichedText = generateBRNewsText(p, n);
            
            return `<div style="border-left:4px solid ${p.color};padding:8px;margin-bottom:8px;background:${p.bg};border-radius:2px">
                <div style="display:flex;align-items:center;gap:4px;margin-bottom:4px">
                    <span style="font-size:14px">${p.icon}</span>
                    <b style="font-size:10px;color:${p.color};text-transform:uppercase">${p.name}</b>
                    <span style="font-size:9px;background:${p.color};color:white;padding:1px 4px;border-radius:2px;margin-left:4px">${p.badge}</span>
                </div>
                <b style="font-size:13px;font-family:'Times New Roman'">${n.title}</b>
                <span style="display:block;margin-top:4px;font-size:11px;color:#333;line-height:1.4">${enrichedText}</span>
                <small style="color:#999;font-size:9px">Elei√ß√µes ${year} ¬∑ ${p.name}</small>
            </div>`;
        }).join('');
    }
}

const intlTweetPools = {
    'ITA2022': {
        accounts: [
            {handle:'@corriere',name:'Corriere della Sera',type:'not√≠cia'},{handle:'@repubblica',name:'La Repubblica',type:'not√≠cia'},
            {handle:'@TgLa7',name:'TG La7',type:'not√≠cia'},{handle:'@FratellidItalia',name:"Fratelli d'Italia",type:'org'},
            {handle:'@pdnetwork',name:'Partito Democratico',type:'org'},{handle:'@Mov5Stelle',name:'Movimento 5 Stelle',type:'org'},
            {handle:'@Azione_it',name:'Azione',type:'org'},{handle:'@Citizenista_IT',name:'Cittadino Italiano',type:'normal'},
            {handle:'@MeloniMemes',name:'Meme Politici IT üáÆüáπ',type:'meme'},{handle:'@ItalyPolitics',name:'Italia Politica',type:'an√°lise'},
        ],
        memes:['Meloni dice "Sono Giorgia, sono una donna, sono una madre, sono italiana, sono cristiana" #elezioni22','La sinistra ha perso ancora üíÄ','Avanti Italia! üáÆüáπü¶Ö'],
    },
    'ARG2023': {
        accounts: [
            {handle:'@LaLibertadAvanza',name:'La Libertad Avanza ü¶Å',type:'org'},{handle:'@UnionPorPatria',name:'Uni√≥n por la Patria',type:'org'},
            {handle:'@PRO_nacional',name:'PRO Argentina',type:'org'},{handle:'@clarin',name:'Clar√≠n',type:'not√≠cia'},
            {handle:'@lanacion',name:'La Naci√≥n',type:'not√≠cia'},{handle:'@pagina12',name:'P√°gina/12',type:'not√≠cia'},
            {handle:'@MileiMeme',name:'Meme Libertario ü¶Å',type:'meme'},{handle:'@ciudadanoARG',name:'Ciudadano Argentino',type:'normal'},
            {handle:'@infobae',name:'Infobae',type:'not√≠cia'},{handle:'@PoliARG',name:'An√°lisis Electoral AR',type:'an√°lise'},
        ],
        memes:['VIVA LA LIBERTAD CARAJO ü¶Åüó°Ô∏è','El Estado es una MAFIA #milei','El kirchnerismo ya fue. Fin de la historia.','¬°Afuera todos los pol√≠ticos del pasado!'],
    },
    'IND2024': {
        accounts: [
            {handle:'@BJP4India',name:'BJP India ü™∑',type:'org'},{handle:'@INCIndia',name:'Indian National Congress',type:'org'},
            {handle:'@ndtv',name:'NDTV',type:'not√≠cia'},{handle:'@republic',name:'Republic TV',type:'not√≠cia'},
            {handle:'@TheHindu',name:'The Hindu',type:'not√≠cia'},{handle:'@TimesOfIndia',name:'Times of India',type:'not√≠cia'},
            {handle:'@ModiSupporterIN',name:'Modi Bhakt üáÆüá≥',type:'meme'},{handle:'@IndianVoter',name:'Common Indian Voter',type:'normal'},
        ],
        memes:['Modi hai to mumkin hai! üôèüáÆüá≥','Phir ek baar Modi Sarkar! ü™∑','Congress ka haath, aam aadmi ke saath ‚úã','Jai Hind! üáÆüá≥'],
    },
    'UK2024': {
        accounts: [
            {handle:'@UKLabour',name:'Labour Party üåπ',type:'org'},{handle:'@Conservatives',name:'Conservative Party üå≥',type:'org'},
            {handle:'@LibDems',name:'Liberal Democrats üî∂',type:'org'},{handle:'@theSNP',name:'Scottish National Party',type:'org'},
            {handle:'@BBCPolitics',name:'BBC Politics',type:'not√≠cia'},{handle:'@guardian',name:'The Guardian',type:'not√≠cia'},
            {handle:'@Telegraph',name:'The Telegraph',type:'not√≠cia'},{handle:'@UKMemeVault',name:'UK Political Memes',type:'meme'},
            {handle:'@DailyMail',name:'Daily Mail',type:'not√≠cia'},{handle:'@BritishVoter',name:'British Voter',type:'normal'},
        ],
        memes:["It's time for change. Enough of the Tories! #VoteLabour",'14 years of Tory failure. Time to go.','Get Brexit done... oh wait, already did that üòÇ','This green and pleasant land deserves better üå≥'],
    },
    'POL2025': {
        accounts: [
            {handle:'@PiS_pl',name:'Prawo i Sprawiedliwo≈õƒá',type:'org'},{handle:'@Platforma_org',name:'Koalicja Obywatelska',type:'org'},
            {handle:'@Konfederacja_',name:'Konfederacja üáµüá±',type:'org'},{handle:'@tvpinfo',name:'TVP Info',type:'not√≠cia'},
            {handle:'@GazetaWyborcza',name:'Gazeta Wyborcza',type:'not√≠cia'},{handle:'@PolskaRazem',name:'Polak Normalny',type:'normal'},
            {handle:'@MemePolska',name:'Polska Memy üáµüá±',type:'meme'},{handle:'@PolitykaPL',name:'Polityka Polska',type:'an√°lise'},
        ],
        memes:['Polska dla Polak√≥w! üáµüá±üí™','Do≈õƒá bezmy≈õlnego unijnego pos≈Çusze≈Ñstwa! #Konfederacja','Trzaskowski to kandydat Tuska, nie Polak√≥w','Nawrocki obroni Polskƒô!'],
    },
    'VEN2024': {
        accounts: [
            {handle:'@PSUV_Vzla',name:'PSUV Venezuela üî¥',type:'org'},{handle:'@PUD_Venezuela',name:'Plataforma Unitaria üáªüá™',type:'org'},
            {handle:'@ElNacionalWeb',name:'El Nacional',type:'not√≠cia'},{handle:'@talcualdigital',name:'TalCual Digital',type:'not√≠cia'},
            {handle:'@MCMachado',name:'Mar√≠a Corina Machado',type:'pol√≠tico'},{handle:'@GobiernodeVzla',name:'Gobierno de Venezuela',type:'org'},
            {handle:'@VzlaLibre2024',name:'Venezuela Libre üó≥Ô∏è',type:'ativista'},{handle:'@exiliovenezol',name:'Venezolanos en Exilio',type:'normal'},
            {handle:'@CNE_Venezuela',name:'CNE Venezuela',type:'org'},{handle:'@VzlaMemesOK',name:'Memes Venezuela üòÇ',type:'meme'},
        ],
        memes:['VENEZUELA LIBRE! üáªüá™ #HastaElFinal','¬°67% dice Gonz√°lez! El fraude es evidente üó≥Ô∏è','Maduro fuera! El pueblo manda üí™','¬°Viva la Revoluci√≥n Bolivariana! üî¥','El chavismo no se rinde jam√°s. #PSUV'],
    },
    'MEX2024': {
        accounts: [
            {handle:'@Morena_Mexico',name:'Morena üá≤üáΩ',type:'org'},{handle:'@PANacionalMX',name:'PAN M√©xico',type:'org'},
            {handle:'@MovCiudadanoMX',name:'Movimiento Ciudadano üü†',type:'org'},{handle:'@ElUniversalMX',name:'El Universal',type:'not√≠cia'},
            {handle:'@Reforma',name:'Reforma',type:'not√≠cia'},{handle:'@SinEmbargoMx',name:'Sin Embargo',type:'not√≠cia'},
            {handle:'@ClaudiaShein',name:'Claudia Sheinbaum',type:'pol√≠tico'},{handle:'@XochitlGalvez',name:'X√≥chitl G√°lvez',type:'pol√≠tico'},
            {handle:'@CiudadanaMX',name:'Ciudadana Mexicana',type:'normal'},{handle:'@MemesMexicanos',name:'Memes Mexicanos üòÇ',type:'meme'},
            {handle:'@INEMexico',name:'INE M√©xico üó≥Ô∏è',type:'org'},{handle:'@Pol√≠ticaMX',name:'An√°lisis Electoral MX',type:'an√°lise'},
        ],
        memes:['¬°Que siga la Cuarta! #Morena üá≤üáΩ','M√©xico necesita cambio. #FrenteAmplio','¬°Claudia presidenta! Primera vez en la historia üë©‚Äçüíº','El narco gan√≥ la elecci√≥n. Trist√≠simo üò¢','¬°Viva M√©xico! Sin importar quien gane üá≤üáΩ'],
    },
    'CHI2025': {
        accounts: [
            {handle:'@RepublicanoCL',name:'Partido Republicano üá®üá±',type:'org'},{handle:'@PChileCL',name:'Partido Comunista Chile',type:'org'},
            {handle:'@ChileVamos',name:'Chile Vamos',type:'org'},{handle:'@LaTercera',name:'La Tercera',type:'not√≠cia'},
            {handle:'@ElMercurio',name:'El Mercurio',type:'not√≠cia'},{handle:'@ElDesconcierto',name:'El Desconcierto',type:'not√≠cia'},
            {handle:'@JoseAntonioKast',name:'Jos√© Antonio Kast',type:'pol√≠tico'},{handle:'@JeannetteJara',name:'Jeannette Jara',type:'pol√≠tico'},
            {handle:'@ChileanoNormal',name:'Chileno del Com√∫n',type:'normal'},{handle:'@MemesCL',name:'Memes Chile üå∂Ô∏è',type:'meme'},
            {handle:'@ServelChile',name:'SERVEL üó≥Ô∏è',type:'org'},{handle:'@CienciaPol√≠ticaCL',name:'An√°lisis Electoral CL',type:'an√°lise'},
        ],
        memes:['¬°Chile no es Venezuela! Vota Kast üá®üá±','La izquierda vuelve al poder si te quedas en casa üò§','Allende ya lo intent√≥. El comunismo no. #Kast','Boric fracas√≥. Ahora Jara? No gracias.','¬°Chile digno para todos! #UnidadParaChile üåπ'],
    },
    'COL2026': {
        accounts: [
            {handle:'@PactoHistorico',name:'Pacto Hist√≥rico üá®üá¥',type:'org'},{handle:'@CentroDemocrat',name:'Centro Democr√°tico',type:'org'},
            {handle:'@ElTiempo',name:'El Tiempo',type:'not√≠cia'},{handle:'@ElEspectador',name:'El Espectador',type:'not√≠cia'},
            {handle:'@SemanaRevista',name:'Revista Semana',type:'not√≠cia'},{handle:'@IvanCepedaCas',name:'Iv√°n Cepeda Castro',type:'pol√≠tico'},
            {handle:'@PalomaValencia',name:'Paloma Valencia',type:'pol√≠tico'},{handle:'@SergioFajardoV',name:'Sergio Fajardo',type:'pol√≠tico'},
            {handle:'@ColombianNorm',name:'Colombiano Com√∫n',type:'normal'},{handle:'@MemesColombia',name:'Memes Colombia üá®üá¥',type:'meme'},
            {handle:'@RegistColombia',name:'Registradur√≠a üó≥Ô∏è',type:'org'},{handle:'@PoliticaCOL',name:'An√°lisis Electoral COL',type:'an√°lise'},
        ],
        memes:['¬°Colombia no puede m√°s con el Petrorismo! Vota cambio','Petro destruy√≥ el pa√≠s. Ahora Cepeda? No. #CD','Medell√≠n cambi√≥ con Fajardo. Colombia puede cambiar igual','Aqu√≠ hay candidato del caribe pa la presidencia üåä #Espriella','¬°La paz total es mentira! #UribePresidente'],
    },
    'CAN2025': {
        accounts: [
            {handle:'@LiberalCa',name:'Liberal Party of Canada üçÅ',type:'org'},{handle:'@CPC_HQ',name:'Conservative Party üá®üá¶',type:'org'},
            {handle:'@NDP',name:'NDP ‚Äî Jagmeet Singh üçä',type:'org'},{handle:'@BlocQuebecois',name:'Bloc Qu√©b√©cois üîµ',type:'org'},
            {handle:'@GlobeAndMail',name:'The Globe and Mail',type:'not√≠cia'},{handle:'@torontostar',name:'Toronto Star',type:'not√≠cia'},
            {handle:'@nationalpost',name:'National Post',type:'not√≠cia'},{handle:'@LeDevoir',name:'Le Devoir',type:'not√≠cia'},
            {handle:'@CanadianVoter',name:'Canadian Voter üçÅ',type:'normal'},{handle:'@QuebecoisFier',name:'Qu√©b√©cois Fier üîµ',type:'normal'},
            {handle:'@CanadaMemes',name:'Canada Politics Memes üçÅüòÇ',type:'meme'},{handle:'@ElectionsCanada',name:'Elections Canada üó≥Ô∏è',type:'org'},
            {handle:'@CanPolAnalysis',name:'Canadian Political Analysis',type:'an√°lise'},{handle:'@CbcPolitics',name:'CBC Politics',type:'not√≠cia'},
        ],
        memes:["Carney knows the economy. Time for adults in charge üçÅ","Poilievre is Canada's Trump and we all know it üò§","Bloc Qu√©bec! On d√©fend nos int√©r√™ts! üîµ","NDP: because workers deserve representation too üçä","Canada stays Canada. No Trump North here üá®üá¶üí™"],
    },
    'USA2012': {
        accounts: [
            {handle:'@BarackObama',name:'Barack Obama',type:'pol√≠tico'},{handle:'@MittRomney',name:'Mitt Romney',type:'pol√≠tico'},
            {handle:'@TheDemocrats',name:'Democratic Party',type:'org'},{handle:'@GOP',name:'Republican Party',type:'org'},
            {handle:'@HuffPost',name:'HuffPost Politics',type:'not√≠cia'},{handle:'@politico',name:'Politico',type:'not√≠cia'},
            {handle:'@BuzzFeedNews',name:'BuzzFeed News',type:'not√≠cia'},{handle:'@nytimes',name:'The New York Times',type:'not√≠cia'},
            {handle:'@AmericanVoter',name:'American Voter',type:'normal'},{handle:'@OhioUndecided',name:'Ohio Undecided',type:'normal'},
            {handle:'@USAMemes2012',name:'Election Memes 2012',type:'meme'},{handle:'@FivethirtyEight',name:'FiveThirtyEight',type:'an√°lise'},
        ],
        memes:['47 percent. That is all. #47percent','Binders full of women üòÇ #Romney','Four more years! #Obama2012 üá∫üá∏','The private sector is doing fine... right? #Obama','Big Bird will survive! #SaveBigBird üê§'],
    },
    'USA2016': {
        accounts: [
            {handle:'@realDonaldTrump',name:'Donald J. Trump',type:'pol√≠tico'},{handle:'@HillaryClinton',name:'Hillary Clinton',type:'pol√≠tico'},
            {handle:'@GOP',name:'Republican Party',type:'org'},{handle:'@TheDemocrats',name:'Democratic Party',type:'org'},
            {handle:'@FoxNews',name:'Fox News',type:'not√≠cia'},{handle:'@nytimes',name:'The New York Times',type:'not√≠cia'},
            {handle:'@breitbart',name:'Breitbart News',type:'not√≠cia'},{handle:'@politico',name:'Politico',type:'not√≠cia'},
            {handle:'@DeplorableUSA',name:'Deplorable American üá∫üá∏',type:'meme'},{handle:'@RustweltVoter',name:'Rust Belt Voter',type:'normal'},
            {handle:'@NeverTrump2016',name:'#NeverTrump',type:'normal'},{handle:'@FivethirtyEight',name:'FiveThirtyEight',type:'an√°lise'},
        ],
        memes:['MAKE AMERICA GREAT AGAIN! üá∫üá∏üß¢ #MAGA','Nasty woman? More like NEXT PRESIDENT üíô #ImWithHer','Lock her up! Lock her up! üîí','The emails! The emails! The emails! üìß','No one expected this. No one. üò± #ElectionNight2016'],
    },
    'UKR2019': {
        accounts: [
            {handle:'@ZelenskyyUa',name:'Volodymyr Zelensky',type:'pol√≠tico'},{handle:'@poroshenko',name:'Petro Poroshenko',type:'pol√≠tico'},
            {handle:'@Ukrinform',name:'–£–∫—Ä—ñ–Ω—Ñ–æ—Ä–º',type:'not√≠cia'},{handle:'@UkrainianWeekly',name:'Ukrainian Weekly',type:'not√≠cia'},
            {handle:'@suspilne',name:'–°—É—Å–ø—ñ–ª—å–Ω–µ –ú–æ–≤–ª–µ–Ω–Ω—è',type:'not√≠cia'},{handle:'@RadioSvoboda',name:'–†–∞–¥—ñ–æ –°–≤–æ–±–æ–¥–∞',type:'not√≠cia'},
            {handle:'@UkraineVoter',name:'–ó–≤–∏—á–∞–π–Ω–∏–π –í–∏–±–æ—Ä–µ—Ü—å üá∫üá¶',type:'normal'},{handle:'@KievPolitics',name:'–ö–∏—ó–≤—Å—å–∫–∞ –ê–Ω–∞–ª—ñ—Ç–∏–∫–∞',type:'an√°lise'},
            {handle:'@UkrMemes',name:'–£–∫—Ä–∞—ó–Ω—Å—å–∫—ñ –ú–µ–º–∏ üòÇ',type:'meme'},
        ],
        memes:['–ó–µ–ª–µ–Ω—Å—å–∫–∏–π ‚Äî –Ω–µ –∞–∫—Ç–æ—Ä, –∞ –ø—Ä–µ–∑–∏–¥–µ–Ω—Ç! üá∫üá¶','–ü–æ—Ä–æ—à–µ–Ω–∫–æ, –≤–∏–π–¥–∏! –¢–≤—ñ–π —á–∞—Å –º–∏–Ω—É–≤ üé≠','–°–ª–∞–≤–∞ –£–∫—Ä–∞—ó–Ω—ñ! üá∫üá¶','–ó–µ-–∫–æ–º–∞–Ω–¥–∞ –≤–µ–¥–µ –Ω–∞—Å –¥–æ –Ñ—Ä–æ–ø–∏! üá™üá∫','–•—Ç–æ —è–∫—â–æ –Ω–µ –ó–µ–ª–µ–Ω—Å—å–∫–∏–π? ü§î'],
    },
    'ESP2023': {
        accounts: [
            {handle:'@PSOE',name:'PSOE üåπ',type:'org'},{handle:'@ppopular',name:'Partido Popular üá™üá∏',type:'org'},
            {handle:'@vox_es',name:'VOX üü¢',type:'org'},{handle:'@sumar_',name:'Sumar',type:'org'},
            {handle:'@el_pais',name:'El Pa√≠s',type:'not√≠cia'},{handle:'@elmundo_es',name:'El Mundo',type:'not√≠cia'},
            {handle:'@LaVanguardia',name:'La Vanguardia',type:'not√≠cia'},{handle:'@abc_es',name:'ABC',type:'not√≠cia'},
            {handle:'@Espa√±olNormal',name:'Ciudadano Espa√±ol',type:'normal'},{handle:'@MemesEspa√±a',name:'Memes Espa√±a üá™üá∏',type:'meme'},
            {handle:'@CISspain',name:'CIS ‚Äî Encuestas',type:'an√°lise'},
        ],
        memes:['¬°Espa√±a no se rompe! üá™üá∏ #PP','Pedro S√°nchez, dimisi√≥n! Ya basta de sanchismo','VOX o muerte. Ni un paso atr√°s üü¢','La izquierda destruye Espa√±a con sus pactos separatistas üò°','¬°Viva la democracia! Vote lo que vote üó≥Ô∏è'],
    },
    'JPN2024': {
        accounts: [
            {handle:'@jimin_koho',name:'Ëá™Áî±Ê∞ë‰∏ªÂÖöÔºàLDPÔºâ',type:'org'},{handle:'@cdp_japan',name:'Á´ãÊÜ≤Ê∞ë‰∏ªÂÖöÔºàCDPÔºâ',type:'org'},
            {handle:'@NHK_PR',name:'NHK ÊîøÊ≤ªÈÉ®',type:'not√≠cia'},{handle:'@mainichi',name:'ÊØéÊó•Êñ∞ËÅû',type:'not√≠cia'},
            {handle:'@nikkeionline',name:'Êó•ÁµåÊñ∞ËÅû',type:'not√≠cia'},{handle:'@asahi',name:'ÊúùÊó•Êñ∞ËÅû',type:'not√≠cia'},
            {handle:'@JapanVoter',name:'ÊôÆÈÄö„ÅÆÊúâÊ®©ËÄÖ üó≥Ô∏è',type:'normal'},{handle:'@JPMeme',name:'ÊîøÊ≤ª„Éü„Éº„É† üòÇ',type:'meme'},
            {handle:'@PolJapan',name:'Êó•Êú¨ÊîøÊ≤ªÂàÜÊûê',type:'an√°lise'},
        ],
        memes:['Ëá™Ê∞ëÂÖö„Å´ÂÖ•„Çå„Çã„Åó„Åã„Å™„ÅÑ‚Ä¶ üáØüáµ','ÈáéÂÖö„Çà„ÄÅ„ÇÇ„Å£„Å®„Åå„Çì„Å∞„ÇåÔºÅüí¢','ÊîøÊ≤ªÂÆ∂„ÅØ‰ø°Áî®„Åß„Åç„Å™„ÅÑüòí','‰ªäÂõû„Åì„ÅùÂ§â„Åà„Çà„ÅÜÔºÅ#ÈáéÂÖöÈÄ£Âêà','Áü≥Á†¥„ÉªÂ≤∏Áî∞„ÉªË™∞„ÅåÊú¨ÂΩì„ÅÆ„É™„Éº„ÉÄ„ÉºÔºüü§î'],
    },
    'KOR2025': {
        accounts: [
            {handle:'@TheDP_Korea',name:'ÎçîÎ∂àÏñ¥ÎØºÏ£ºÎãπ (DP)',type:'org'},{handle:'@PPP_Korea',name:'Íµ≠ÎØºÏùòÌûò (PPP)',type:'org'},
            {handle:'@KBSnews',name:'KBS Îâ¥Ïä§',type:'not√≠cia'},{handle:'@YonhapNews',name:'Ïó∞Ìï©Îâ¥Ïä§',type:'not√≠cia'},
            {handle:'@HankyorehNews',name:'ÌïúÍ≤®Î†à',type:'not√≠cia'},{handle:'@ChosunBiz',name:'Ï°∞ÏÑ†ÏùºÎ≥¥',type:'not√≠cia'},
            {handle:'@KoreaVoter',name:'ÌèâÎ≤îÌïú Ïú†Í∂åÏûê üá∞üá∑',type:'normal'},{handle:'@KorMeme',name:'Ï†ïÏπò Î∞à üòÇ',type:'meme'},
            {handle:'@KoreaPolAnalysis',name:'ÌïúÍµ≠ ÏÑ†Í±∞ Î∂ÑÏÑù',type:'an√°lise'},
        ],
        memes:['Ïù¥Ïû¨Î™ÖÏù¥ ÎåÄÌïúÎØºÍµ≠ÏùÑ Íµ¨Ìï† Í≤ÉÏù¥Îã§ üíô','Ïú§ÏÑùÏó¥ ÌÉÑÌïµ! Í≥ÑÏóÑÎ†π Î∞òÎåÄ! ‚úä','Íµ≠ÎØºÏùòÌûòÏùÄ ÎÅùÎÇ¨Îã§. ÏÉà ÏãúÏûë ÌïÑÏöî üá∞üá∑','ÎØºÏ£ºÎãπÎèÑ ÎØøÏùÑ Ïàò ÏóÜÎã§... ÎàÑÍµ¥ ÎΩëÎÇò ü§∑','ÎåÄÌïúÎØºÍµ≠ ÌååÏù¥ÌåÖ! üî•'],
    },
    'ZAF2024': {
        accounts: [
            {handle:'@MYANC',name:'African National Congress',type:'org'},{handle:'@DA_News',name:'Democratic Alliance',type:'org'},
            {handle:'@EFFSouthAfrica',name:'EFF ‚Äî Economic Freedom Fighters',type:'org'},{handle:'@MK_Party',name:'uMkhonto weSizwe Party',type:'org'},
            {handle:'@SABCNews',name:'SABC News',type:'not√≠cia'},{handle:'@dailymaverick',name:'Daily Maverick',type:'not√≠cia'},
            {handle:'@TimesLIVE',name:'Times LIVE',type:'not√≠cia'},{handle:'@SAVoter',name:'South African Voter üáøüá¶',type:'normal'},
            {handle:'@MzansiMemes',name:'Mzansi Memes üòÇ',type:'meme'},{handle:'@SAPolitics',name:'SA Political Analysis',type:'an√°lise'},
        ],
        memes:['The ANC must fall! 30 years of failure üáøüá¶','EFF! Land must be expropriated without compensation! ‚úä','DA is the only party with a plan for SA üíô','Zuma is back and the ANC is scared üò§','South Africa belongs to ALL who live in it üåà'],
    },
    'PHL2022': {
        accounts: [
            {handle:'@marcosbongbong',name:'Bongbong Marcos',type:'pol√≠tico'},{handle:'@lenirobredo',name:'Leni Robredo',type:'pol√≠tico'},
            {handle:'@ABSCBNNews',name:'ABS-CBN News',type:'not√≠cia'},{handle:'@GMANews',name:'GMA News',type:'not√≠cia'},
            {handle:'@rapplerdotcom',name:'Rappler',type:'not√≠cia'},{handle:'@PhilippineStar',name:'The Philippine Star',type:'not√≠cia'},
            {handle:'@PilipinoVoter',name:'Ordinaryong Pilipino üáµüá≠',type:'normal'},{handle:'@PHMemes',name:'PH Political Memes üáµüá≠',type:'meme'},
            {handle:'@PHElection',name:'Philippine Election Watch',type:'an√°lise'},
        ],
        memes:['BBM-Sara 2022! Bagong Pilipinas üáµüá≠','Leni Robredo, pangulo ng Pilipinas! ü©∑','Marcos pa rin? Hindi tayo marunong sa kasaysayan üò°','Solid North ang boto! BBM all the way!','Pink or Red, basta matino ang lider üó≥Ô∏è'],
    },
    'TUR2023': {
        accounts: [
            {handle:'@RTErdogan',name:'Recep Tayyip Erdoƒüan',type:'pol√≠tico'},{handle:'@kilicdarogluk',name:'Kemal Kƒ±lƒ±√ßdaroƒülu',type:'pol√≠tico'},
            {handle:'@AKParti',name:'AK Parti',type:'org'},{handle:'@CHPgenelmerkez',name:'CHP',type:'org'},
            {handle:'@anadoluajansi',name:'Anadolu Ajansƒ±',type:'not√≠cia'},{handle:'@birgunnet',name:'BirG√ºn',type:'not√≠cia'},
            {handle:'@sabah',name:'Sabah',type:'not√≠cia'},{handle:'@cumhuriyetgzt',name:'Cumhuriyet',type:'not√≠cia'},
            {handle:'@TurkishVoter',name:'T√ºrk Se√ßmen üáπüá∑',type:'normal'},{handle:'@TRMeme',name:'T√ºrkiye Memes üòÇ',type:'meme'},
            {handle:'@TRPolitikaAnaliz',name:'T√ºrkiye Siyasi Analiz',type:'an√°lise'},
        ],
        memes:['G√º√ßl√º T√ºrkiye i√ßin Erdoƒüan! üáπüá∑','Deƒüi≈üim i√ßin Kƒ±lƒ±√ßdaroƒülu! Artƒ±k yeter!','Milletle y√ºr√ºyoruz, milletle kazanƒ±yoruz üí™','Faiz sebebi deƒüil, sonucudur üòÇ #ekonomi','Her ≈üey T√ºrkiye i√ßin! üáπüá∑'],
    },
};

function generateTweetIntl(newsItem, scenario) {
    let pool = intlTweetPools[scenario];
    if(!pool) return generateTweet(newsItem);
    let roll = Math.random();
    let account = pool.accounts[Math.floor(Math.random()*pool.accounts.length)];
    let likes = Math.floor(Math.random() * 30000) + 100;
    let comments = Math.floor(Math.random() * 4000) + 20;
    let reposts = Math.floor(Math.random() * 10000) + 30;
    let tweetText;
    if(account.type==='meme' && pool.memes) {
        tweetText = pool.memes[Math.floor(Math.random()*pool.memes.length)];
    } else if(account.type==='not√≠cia'||account.type==='an√°lise') {
        tweetText = `${newsItem.title}: ${newsItem.text}`;
    } else {
        // Party propaganda or normal citizen
        let pname = account.type==='org' ? account.name : '';
        let templates = [
            `${pname} ${newsItem.title.toLowerCase()} ‚Äî nossa posi√ß√£o √© clara. #elei√ß√µes`,
            `Acompanhando: ${newsItem.title}. O que acharam?`,
            `Not√≠cia importante: ${newsItem.text.substring(0,80)}...`,
        ];
        tweetText = templates[Math.floor(Math.random()*templates.length)];
    }
    let verifiedBadge = (account.type==='not√≠cia'||account.type==='org') ? ' ‚úì' : '';
    let bgColor = account.type==='meme' ? '#fff8e1' : account.type==='not√≠cia' ? '#f8f8ff' : 'white';
    return `<div style="border:1px solid #e0e0e0;padding:8px;margin:4px 0;background:${bgColor};border-radius:4px;font-family:Arial;font-size:11px">
        <div style="display:flex;align-items:center;gap:6px;margin-bottom:4px">
            <div style="width:28px;height:28px;border-radius:50%;background:${account.type==='org'?'#003366':account.type==='not√≠cia'?'#000080':'#888'};display:flex;align-items:center;justify-content:center;color:white;font-size:10px;font-weight:bold">${account.name[0]}</div>
            <div><b style="color:#000;font-size:11px">${account.name}${verifiedBadge}</b><br><span style="color:#888;font-size:10px">${account.handle}</span></div>
        </div>
        <div style="margin:4px 0;color:#222;line-height:1.3">${tweetText}</div>
        <div style="color:#888;font-size:10px;margin-top:4px">‚ù§Ô∏è ${likes.toLocaleString('pt-BR')} &nbsp; üí¨ ${comments.toLocaleString('pt-BR')} &nbsp; üîÅ ${reposts.toLocaleString('pt-BR')}</div>
    </div>`;
}

function updateStateVotesRealTime() {
    const regionKeys = Object.keys(game.stateVotes);
    const isEC = game.isElectoralCollege;
    const isBR = !isEC && !internationalData[game.scenario] && !game.isGovernor && !game.isRepVelha;
    const sc = isEC ? (internationalData[game.scenario]) : null;
    const ecStates = sc && sc.electoralStates ? sc.electoralStates : null;
    let topR = isEC ? Object.entries(candidatesData).filter(([,c])=>c.side==='D').sort((a,b)=>b[1].start-a[1].start)[0]?.[0] : null;
    let topD = isEC ? Object.entries(candidatesData).filter(([,c])=>c.side==='E').sort((a,b)=>b[1].start-a[1].start)[0]?.[0] : null;

    if(isBR) {
        // ================================================================
        // SISTEMA BRASILEIRO ‚Äî REC√ÅLCULO DIRETO A CADA TURNO
        // L√≥gica: os estados refletem a pesquisa nacional imediatamente.
        // O l√≠der nacional ganha a maioria dos estados.
        // Traits ideol√≥gicos do estado d√£o vantagem/desvantagem regional.
        // Candidatos menores ficam limitados ao seu % nacional + pequeno extra.
        // ================================================================
        
        // Ordenar candidatos por voto nacional atual
        let natSorted = [...(game.candidates||[])].sort((a,b) => b.votes - a.votes);
        let natTotal = natSorted.reduce((sum,c) => sum + c.votes, 0) || 100;
        
        regionKeys.forEach(sid => {
            if(!game.stateVotes[sid]) return;
            let brState = allStates.find(s => s.id === sid);
            if(!brState) return;
            
            let traits = stateTraits[sid] || [];
            
            // Calcular score de cada candidato para este estado
            let stateScores = {};
            natSorted.forEach((c, rank) => {
                let cd = candidatesData[c.id];
                if(!cd) return;
                
                // Base: voto nacional (normalizado de 0-100)
                let natShare = (c.votes / natTotal) * 100;
                
                // B√¥nus/penalidade ideol√≥gica do estado via traits
                let traitBonus = 0;
                traits.forEach(t => {
                    if(t.side && cd.side === t.side) traitBonus += t.bonus * 0.8;
                    else if(t.side && cd.side !== t.side && t.bonus > 0) traitBonus -= t.bonus * 0.5;
                });
                
                // Score final = voto nacional + b√¥nus de trait + ru√≠do pequeno
                // O ru√≠do √© pequeno para manter coer√™ncia com a pesquisa nacional
                let noise = (Math.random() * 3 - 1.5); // ¬±1.5%
                let score = natShare + traitBonus + noise;
                
                // REGRA CR√çTICA: candidatos com < 5% nacional nunca podem vencer um estado
                // (teto m√°ximo = 2x o voto nacional + 3pts, nunca mais que 12%)
                if(rank >= 2) { // fora do top 2
                    let cap = Math.min(12, natShare * 1.8 + 3);
                    score = Math.min(score, cap);
                }
                
                stateScores[c.id] = Math.max(0.5, score);
            });
            
            // Normalizar para 100%
            let total = Object.values(stateScores).reduce((a,b)=>a+b, 0);
            if(total > 0) {
                Object.keys(stateScores).forEach(cid => {
                    game.stateVotes[sid][cid] = (stateScores[cid] / total) * 100;
                });
            }
        });
        return; // Sai aqui ‚Äî n√£o precisa do bloco abaixo
    }

    // ================================================================
    // ELEI√á√ïES INTERNACIONAIS E COL√âGIO ELEITORAL ‚Äî l√≥gica original
    // ================================================================
    regionKeys.forEach(sid => {
        if(!game.stateVotes[sid]) return;

        let stateLean = 'S';
        if(ecStates) {
            let ecState = ecStates.find(s => s.id === sid);
            if(ecState) stateLean = ecState.lean;
        }

        game.candidates.forEach(c => {
            let target = c.votes;
            let current = game.stateVotes[sid][c.id];
            if(current === undefined) return;
            let pullStrength;
            if(isEC) {
                if(stateLean === 'S') {
                    pullStrength = 0.10;
                } else {
                    let isWrongSide = (stateLean === 'R' && c.id === topD) || (stateLean === 'D' && c.id === topR);
                    pullStrength = isWrongSide ? 0.02 : 0.04;
                }
            } else {
                pullStrength = 0.15;
            }
            let noise = (Math.random() * 1.6 - 0.8);
            let shift = (target - current) * pullStrength + noise;
            game.stateVotes[sid][c.id] = Math.max(0.1, current + shift);
        });

        // Normalizar
        let stateSum = Object.values(game.stateVotes[sid]).reduce((a,b)=>a+b, 0);
        if(stateSum > 0) game.candidates.forEach(c => {
            if(game.stateVotes[sid][c.id] !== undefined)
                game.stateVotes[sid][c.id] = (game.stateVotes[sid][c.id]/stateSum)*100;
        });
    });
}

function nextTurn() {
    playNextTurnSound();
    game.turn++;
    // Sandbox mode: infinite resources
    if(game.mode === 'sandbox') {
        game.money = 9999; game.points = 9999;
    }
    // Pontos por turno rebalanceados: 3-5 base, cap: 16 no 1T, 24 no 2T
    let coalitionBonus = Math.floor(game.coalition.filter(p=>!p.includes('_seat')).length / 2);
    let baseGain = 3 + Math.floor(Math.random() * 3) + coalitionBonus; // 3-5 + coaliz√£o
    // Difficulty adjustment
    if(game.difficulty === 1) baseGain += 1;
    if(game.difficulty === 3) baseGain = Math.max(2, baseGain - 1);
    let spiritPts = getSpiritBonus('pts');
    // TV time bonus
    let tvBonus = 0;
    if(game.tvTime && game.tvTime[game.player]) tvBonus = Math.floor(game.tvTime[game.player] / 20);
    let pGain = baseGain + Math.round(spiritPts) + tvBonus;
    // Max total points cap
    let maxThisTurn = game.fase === 2 ? 24 : 16;
    let afterGain = game.points + pGain;
    if(afterGain > maxThisTurn) {
        pGain = Math.max(0, maxThisTurn - game.points);
    }
    game.points = Math.min(maxThisTurn, game.points + pGain);
    
    // Update date display
    updateDateDisplay();
    

    // Tick spirits
    tickSpirits();

    // Radicaliza√ß√£o ambiental aleat√≥ria por turno (polariza√ß√£o gradual da sociedade)
    let radRandDelta = 1 + Math.floor(Math.random() * 3); // 1-3 por turno (balanceado)
    // A cada 3 turnos, chance de queda leve (fadiga da polariza√ß√£o)
    if(game.turn % 3 === 0 && Math.random() > 0.6) radRandDelta = -Math.floor(Math.random()*3);
    // Se j√° muito alta (>80), mais chance de queda
    if(radicalizationLevel > 80 && Math.random() > 0.5) radRandDelta = -(1 + Math.floor(Math.random()*3));
    updateRadicalization(radRandDelta);

    // Efeito de radicaliza√ß√£o por turno
    if(radicalizationLevel > 60) {
        game.candidates.forEach(c => {
            let cd = candidatesData[c.id];
            if(cd && ['PCB','UP','PSTU','AIB','PCO','PSOL'].includes(cd.party)) {
                updateNationalVotes(c.id, 0.4);
            } else if(cd && Math.abs(cd.econ||0) + Math.abs(cd.soc||0) >= 4) {
                updateNationalVotes(c.id, 0.3);
            }
        });
    } else if(radicalizationLevel < 30) {
        game.candidates.forEach(c => {
            let cd = candidatesData[c.id];
            if(cd && ['PCB','UP','PSTU','AIB','PCO'].includes(cd.party)) {
                updateNationalVotes(c.id, -0.3);
            }
        });
    }

    // IA Estrat√©gica de Verdade
    aiStrategicTurn();

    updateStateVotesRealTime();
    updateApprovalRejection();

    // Centr√£o debt (paid from party management)
    if(game.centraoDebt && game.centraoDebt > 0) {
        let debt = Math.min(game.centraoDebt, 3);
        game.money = Math.max(0, game.money - debt);
        game.centraoDebt -= debt;
        if(debt > 0) log(`üèõÔ∏è Pagamento ao Centr√£o: -R$${debt}M. D√≠vida restante: R$${game.centraoDebt}M.`);
    }
    
    // CONSEQU√äNCIAS DE IGNORAR CRISES: esc√¢ndalo cresce se player n√£o agir
    // Se o jogador tem esc√¢ndalo > 0 e n√£o visitou a aba de crises no √∫ltimo turno,
    // o esc√¢ndalo cresce organicamente (a imprensa n√£o vai deixar barato)
    if(game.scandalLevels && game.scandalLevels[game.player] !== undefined) {
        let myScandal = game.scandalLevels[game.player] || 0;
        let lastCrisisVisit = game.lastCrisesTabTurn || 0;
        let turnsSinceCrisis = game.turn - lastCrisisVisit;
        
        if(myScandal > 0 && turnsSinceCrisis >= 2) {
            // Esc√¢ndalo cresce: mais r√°pido quanto mais alto e mais tempo ignorado
            let growthChance = Math.min(0.85, 0.3 + myScandal * 0.06 + turnsSinceCrisis * 0.05);
            if(Math.random() < growthChance) {
                let growth = myScandal >= 6 ? 2 : 1; // esc√¢ndalos altos crescem mais r√°pido
                game.scandalLevels[game.player] = Math.min(10, myScandal + growth);
                let newLevel = game.scandalLevels[game.player];
                // Penalidade de popularidade se esc√¢ndalo alto
                if(newLevel >= 5) {
                    let popLoss = 0.5 + Math.random() * 0.5;
                    updateNationalVotes(game.player, -popLoss);
                    addNews(`üì∞ ESC√ÇNDALO CRESCE: ${candidatesData[game.player]?.name}`, `A imprensa n√£o para de falar no assunto. N√≠vel de esc√¢ndalo chegou a ${newLevel}/10 ‚Äî o sil√™ncio do candidato est√° custando caro!`);
                    queueEvent('üö® ESC√ÇNDALO EM ALTA!', 
                        `Voc√™ ignorou a crise por ${turnsSinceCrisis} turnos e o esc√¢ndalo cresceu de ${myScandal} para ${newLevel}/10! A imprensa est√° usando seu sil√™ncio contra voc√™. Acesse a aba CRISES para plantar narrativa ou se defender antes que piore!`, 
                        `<button class="btn" onclick="closeModal();showTab('crises')">‚û°Ô∏è Ir para Crises</button><button class="btn" onclick="closeModal()">Ignorar (perigoso)</button>`);
                } else {
                    log(`üì∞ Esc√¢ndalo cresceu para ${newLevel}/10 ‚Äî a imprensa n√£o deixou barato o seu sil√™ncio.`);
                }
            }
        }
        // Mesmo sem esc√¢ndalo, pequena chance de SURGIR novo esc√¢ndalo a cada turno
        if(myScandal === 0 && Math.random() < 0.08) {
            game.scandalLevels[game.player] = 1;
            log(`üì∞ Uma pequena den√∫ncia surgiu na imprensa. Esc√¢ndalo: 1/10. Acompanhe pela aba Crises.`);
        }
    }
    
    // CONSEQU√äNCIAS DE INA√á√ÉO NO PARTIDO (se n√£o gerenciar por 4+ turnos)
    if(game.partyWings && game.turn > 3) {
        let turnosSemGestao = game.turn - (game.lastPartyActionTurn || 0);
        if(turnosSemGestao >= 4) {
            let pw = game.partyWings;
            // Partido deriva para o extremo da sua ideologia base
            let playerC = candidatesData[game.player];
            let sideToRadicalize = (playerC && (playerC.side === 'E' || playerC.econ < 0)) ? 'radical' : 'centrao';
            pw[sideToRadicalize] = Math.min(80, pw[sideToRadicalize] + 5);
            pw.moderate = Math.max(10, pw.moderate - 3);
            updateNationalVotes(game.player, -1);
            queueEvent('üö® PARTIDO SEM LIDERAN√áA!', `Voc√™ n√£o gerencia seu partido h√° ${turnosSemGestao} turnos! As alas internas est√£o tomando decis√µes pr√≥prias ‚Äî a ala ${sideToRadicalize === 'radical' ? 'radical' : 'do Centr√£o'} ganhou for√ßa (+5%) e sua popularidade caiu 1%. Acesse GERENCIAR PARTIDO para retomar o controle!`, `<button class="btn" onclick="closeModal();showTab('campanha')">Ir ao Partido ‚ûî</button>`);
        }
    }
    
    // CONSEQU√äNCIAS OBRIGAT√ìRIAS DAS ALAS (sempre com pop-up)
    if(game.partyWings) {
        let pw = game.partyWings;
        // Centr√£o > 55%: perde verba por turno
        if(pw.centrao > 55) {
            game.money = Math.max(0, game.money - 2);
            queueEvent('üèõÔ∏è CUSTO DO CENTR√ÉO', `O centr√£o domina ${Math.round(pw.centrao)}% do seu partido e est√° cobrando a conta. A m√°quina de favores drenou R$2M da sua campanha este turno!`, `<button class="btn" onclick="closeModal()">Entendido</button>`);
        }
        // Radical > 65%: risco de racha
        if(pw.radical > 65 && Math.random() > 0.6) {
            let lossVotes = 2 + Math.random() * 2;
            updateNationalVotes(game.player, -lossVotes);
            game.approvals[game.player].rej += 6;
            let playerC = candidatesData[game.player];
            game.scandalLevels[game.player] = Math.min(10, (game.scandalLevels[game.player]||0)+1);
            queueEvent('üí• RACHA CATASTR√ìFICO NO PARTIDO!', `A ala radical (${Math.round(pw.radical)}%) fragmentou o partido! Dissidentes anunciaram candidatura pr√≥pria. Voc√™ perdeu ${lossVotes.toFixed(1)}% nas pesquisas e a rejei√ß√£o subiu 6 pontos. Modere o partido para evitar novo racha!`, `<button class="btn" onclick="closeModal()">Grave!</button>`);
            pw.radical = Math.max(30, pw.radical - 15);
            pw.moderate = Math.min(60, pw.moderate + 10);
        }
        // Moderado > 70%: base radical migra
        if(pw.moderate > 70 && Math.random() > 0.65) {
            updateNationalVotes(game.player, -1);
            queueEvent('üïäÔ∏è BASE RADICAL SE AFASTA', `A ala moderada domina ${Math.round(pw.moderate)}% do partido. Militantes hist√≥ricos da base radical est√£o decepcionados e migrando para candidatos mais alinhados. -1% nas pesquisas.`, `<button class="btn" onclick="closeModal()">Entendido</button>`);
        }
        // Trai√ß√£o da coliga√ß√£o: baseada em risco acumulado
        if(game.coalition.length > 0 && !game.coalitionBetrayalRisk) game.coalitionBetrayalRisk = 0;
        if(game.coalition.length > 0) {
            // Risco aumenta com centr√£o alto ou partido muito radical
            if(pw.centrao > 50) game.coalitionBetrayalRisk = (game.coalitionBetrayalRisk||0) + 8;
            if(pw.radical > 60) game.coalitionBetrayalRisk = (game.coalitionBetrayalRisk||0) + 10;
            let betrayalChance = Math.max(0, (game.coalitionBetrayalRisk||0) - 50);
            if(betrayalChance > 0 && Math.random() * 100 < betrayalChance * 0.3) {
                let betrayingParties = game.coalition.filter(p => !p.includes('_seat'));
                if(betrayingParties.length > 0) {
                    let traitor = betrayingParties[Math.floor(Math.random() * betrayingParties.length)];
                    game.coalition = game.coalition.filter(p => p !== traitor && p !== traitor+'_seat');
                    // Find the party in availableParties and free it
                    let pObj = game.availableParties.find(x => x.n === traitor);
                    if(pObj) pObj.owner = null;
                    updateNationalVotes(game.player, -2);
                    game.coalitionBetrayalRisk = 0;
                    queueEvent('üî™ TRAI√á√ÉO NA COLIGA√á√ÉO!', `O partido ${traitor} abandonou sua coliga√ß√£o e est√° negociando com um rival! Sua popularidade caiu 2% com a ruptura. Pressione seus coligados regularmente para evitar trai√ß√µes.`, `<button class="btn" onclick="closeModal()">Que trai√ß√£o!</button>`);
                    addNews(`TRAI√á√ÉO: ${traitor} DEIXA COLIGA√á√ÉO`, `Aliado se afasta em momento cr√≠tico da campanha.`);
                    log(`üî™ ${traitor} traiu a coliga√ß√£o! -2%.`);
                }
            }
        }
    }
    // EVENTO DE PROPOSTA DE COLIGA√á√ÉO: partidos dispon√≠veis podem propor alian√ßa ao jogador
    if(game.fase === 1 && game.turn >= 2 && Math.random() > 0.72) {
        let freeParties = game.availableParties.filter(p => !p.owner);
        if(freeParties.length > 0) {
            let proposingParty = freeParties[Math.floor(Math.random() * freeParties.length)];
            let playerC = candidatesData[game.player];
            let compatible = (proposingParty.side === (playerC?.side||'C') || proposingParty.side === 'C' || (playerC?.side||'C') === 'C');
            let proposalType = compatible ? 'formal' : 'surpresa';
            let costMsg = compatible ? 'Custo reduzido: apenas 2p (oferta especial).' : 'Custo padr√£o: 4p.';
            let costPts = compatible ? 2 : 4;
            let votesBonus = compatible ? 2.5 + Math.random() : 1.5 + Math.random();
            let rejMsg = compatible ? 'eles acreditam em um projeto em comum' : 'est√£o dispostos a fazer concess√µes ideol√≥gicas por poder';
            queueEvent(
                `ü§ù PROPOSTA DE COLIGA√á√ÉO: ${proposingParty.n}`,
                `<div style="background:#e8f5e9;border:1px solid #4caf50;padding:10px;border-radius:4px;margin-bottom:10px">
                    <div style="font-size:20px;text-align:center;margin-bottom:6px">ü§ù</div>
                    <b style="color:#1a5c2a;font-size:13px">${proposingParty.n} quer entrar na sua coliga√ß√£o!</b>
                </div>
                O partido <b>${proposingParty.n}</b> (${proposingParty.side === 'E' ? 'üî¥ Esquerda' : proposingParty.side === 'D' ? 'üîµ Direita' : '‚ö™ Centro'}) enviou uma proposta formal de alian√ßa ‚Äî ${rejMsg}.<br><br>
                <b>Aceitar:</b> +${votesBonus.toFixed(1)}% nas pesquisas nacionais + partido na sua coliga√ß√£o.<br>
                <b>Recusar:</b> partido permanece livre para outros candidatos.<br><br>
                <i style="color:#888;font-size:10px">${costMsg}</i>`,
                `<button class="btn" style="background:#1a5c2a;color:white" onclick="aceitarPropostaColigacao('${proposingParty.n}','${proposingParty.side}',${costPts},${votesBonus.toFixed(2)})">‚úÖ Aceitar proposta (${costPts}p)</button>
                 <button class="btn" onclick="recusarPropostaColigacao('${proposingParty.n}')">‚ùå Recusar</button>`
            );
        }
    }

    // Debate cooldown (decrement each turn so after 3 turns it's 0 again)
    if(game.debateCooldown && game.debateCooldown > 0) {
        game.debateCooldown--;
        if(game.debateCooldown === 0) {
            queueEvent('üé§ DEBATE DISPON√çVEL!', `Passaram-se os turnos necess√°rios. Voc√™ pode participar de um novo debate agora! Acesse a aba Debate para escolher seu estilo.`, `<button class="btn" onclick="closeModal();showTab('debate')">Ir ao Debate ‚ûî</button>`);
        }
    }
    // Apply base eleitoral effects (satisfaction drift + vote consequences)
    applyBaseEleitoralEffects();
    // Apply coalition loyalty decay + betrayal check
    applyCoalitionLoyaltyEffects();
    // TV time fluctuates based on votes (more popular = more TV coverage)
    if(game.tvTime) {
        game.candidates.forEach(c => {
            let currentTV = game.tvTime[c.id] || 0;
            let voteShare = c.votes || 0;
            // TV time trends toward vote share * 1.5, with noise
            let target = Math.min(90, voteShare * 1.5);
            game.tvTime[c.id] = Math.max(2, Math.min(95, currentTV * 0.85 + target * 0.15 + (Math.random()*4-2)));
        });
        // Player can invest in TV time via hor√°rio eleitoral action (already adds via actionTV)
    }
    // Esc√¢ndalos causam perda cont√≠nua
    game.candidates.forEach(c => {
        let scanEffect = (game.scandalLevels[c.id]||0) >= 5 ? 0.8 : 0;
        // Spirit scandal shield
        if(c.id === game.player && hasSpiritBonus('scandal_shield') && scanEffect > 0) scanEffect *= 0.5;
        if(scanEffect > 0) updateNationalVotes(c.id, -scanEffect);
    });

    // ESC√ÇNDALO PASSIVO: se jogador tem esc√¢ndalo e n√£o acessa aba Crises, esc√¢ndalo cresce
    let playerScandal = game.scandalLevels[game.player] || 0;
    // Track max scandal reached for achievement
    if(playerScandal > (game.maxScandalReached||0)) game.maxScandalReached = playerScandal;
    if(playerScandal > 0) {
        let turnsSinceCrises = game.turn - (game.lastCrisesTabTurn || 0);
        if(turnsSinceCrises >= 2) {
            // Esc√¢ndalo cresce automaticamente: m√≠dia alimenta o fogo
            let growth = turnsSinceCrises >= 4 ? 2 : 1;
            game.scandalLevels[game.player] = Math.min(10, playerScandal + growth);
            let newScandal = game.scandalLevels[game.player];
            // Perda de votos adicional por ignorar a crise
            let extraLoss = turnsSinceCrises >= 4 ? 1.5 : 0.8;
            updateNationalVotes(game.player, -extraLoss);
            if(turnsSinceCrises === 2) {
                queueEvent('üì∞ ESC√ÇNDALO SE EXPANDE!', `Voc√™ est√° h√° ${turnsSinceCrises} turnos sem reagir ao seu esc√¢ndalo (n√≠vel ${newScandal}/10). A m√≠dia continua repercutindo as den√∫ncias e sua imagem est√° sendo corro√≠da! Acesse a aba <b>Crises</b> para plantar narrativa ou se defender.`, `<button class="btn" onclick="closeModal();showTab('crises')">Ir √†s Crises ‚ûî</button><button class="btn" onclick="closeModal()">Ignorar</button>`);
            } else if(turnsSinceCrises >= 4 && newScandal >= 7) {
                queueEvent('üö® CRISE FORA DE CONTROLE!', `Seu esc√¢ndalo atingiu n√≠vel <b>${newScandal}/10</b> e est√° destruindo sua campanha! A m√≠dia pede seu afastamento da corrida eleitoral. Voc√™ perdeu ${extraLoss.toFixed(1)}% adicional neste turno. <b>Acesse Crises IMEDIATAMENTE!</b>`, `<button class="btn" style="background:#cc0000;color:white" onclick="closeModal();showTab('crises')">üö® Ir √†s Crises AGORA ‚ûî</button>`);
                addNews(`üö® CRISE: ${candidatesData[game.player]?.name||'Candidato'}`, `Esc√¢ndalo atinge n√≠vel cr√≠tico sem resposta do candidato. Press√£o para abandono da disputa.`);
            }
        }
    }

    // Modo Hist√≥rico: FHC beneficia do Plano Real em 1994
    if(game.mode === 'historico' && game.scenario === '1994' && game.turn < 8) {
        let fhcC = game.candidates.find(c=>c.id==='fhc');
        if(fhcC) updateNationalVotes('fhc', 0.5);
    }

    // Modo Hist√≥rico 1989: Collor tem vantagem inicial
    if(game.mode === 'historico' && game.scenario === '1989' && game.turn < 6) {
        let collor = game.candidates.find(c=>c.id==='collor');
        if(collor) updateNationalVotes('collor', 0.4);
    }

    // Modo Hist√≥rico 1998: FHC reelei√ß√£o com Plano Real; crise asi√°tica pesa no meio
    if(game.mode === 'historico' && game.scenario === '1998') {
        let fhc = game.candidates.find(c=>c.id==='fhc98');
        if(fhc && game.turn <= 5) updateNationalVotes('fhc98', 0.6);
        if(fhc && game.turn >= 6 && game.turn <= 10) updateNationalVotes('fhc98', -0.2); // crise asi√°tica
    }

    // Modo Hist√≥rico 2002: Lula com momentum crescente; Ciro e Garotinho disputam 2¬∫ lugar
    if(game.mode === 'historico' && game.scenario === '2002') {
        let lula = game.candidates.find(c=>c.id==='lula02');
        if(lula) updateNationalVotes('lula02', 0.35);
        let ciro = game.candidates.find(c=>c.id==='ciro02');
        let garoto = game.candidates.find(c=>c.id==='garotinho');
        if(ciro && game.turn >= 3 && game.turn <= 8) updateNationalVotes('ciro02', 0.2);
        if(garoto && game.turn >= 3 && game.turn <= 8) updateNationalVotes('garotinho', 0.2);
        // Gafe do "espi√£o Rosa" implode Ciro no final
        if(ciro && game.turn >= 9) updateNationalVotes('ciro02', -0.4);
    }

    // Modo Hist√≥rico 2006: Mensal√£o pesa no in√≠cio, Bolsa Fam√≠lia garante no final
    if(game.mode === 'historico' && game.scenario === '2006') {
        let lula = game.candidates.find(c=>c.id==='lula06');
        if(lula && game.turn <= 4) updateNationalVotes('lula06', -0.3); // mensal√£o
        if(lula && game.turn >= 5) updateNationalVotes('lula06', 0.4);  // Bolsa Fam√≠lia
        let heloisa = game.candidates.find(c=>c.id==='heloisa');
        if(heloisa && game.turn >= 3 && game.turn <= 8) updateNationalVotes('heloisa', 0.2);
    }

    // Modo Hist√≥rico 2014: Dilma tem vantagem incumbente mas Marina sobe nos turnos m√©dios
    if(game.mode === 'historico' && game.scenario === '2014') {
        let dilma = game.candidates.find(c=>c.id==='dilma');
        let marina = game.candidates.find(c=>c.id==='marina');
        if(dilma && game.turn < 5) updateNationalVotes('dilma', 0.3);
        if(marina && game.turn >= 4 && game.turn <= 8) updateNationalVotes('marina', 0.5); // fen√¥meno Marina
    }

    // Modo Hist√≥rico 2010: Dilma cresce com heran√ßa de Lula; Marina fen√¥meno no final
    if(game.mode === 'historico' && game.scenario === '2010') {
        let dilma = game.candidates.find(c=>c.id==='dilma10');
        let marina = game.candidates.find(c=>c.id==='marina10');
        if(dilma) updateNationalVotes('dilma10', 0.3);
        if(marina && game.turn >= 5 && game.turn <= 12) updateNationalVotes('marina10', 0.3);
    }

    // Modo Hist√≥rico 2018: Bolsonaro dispara; Haddad cresce ap√≥s substitui√ß√£o de Lula
    if(game.mode === 'historico' && game.scenario === '2018') {
        let bolsonaro = game.candidates.find(c=>c.id==='bolsonaro');
        let haddad = game.candidates.find(c=>c.id==='haddad');
        if(bolsonaro && game.turn <= 10) updateNationalVotes('bolsonaro', 0.4);
        if(haddad && game.turn >= 5) updateNationalVotes('haddad', 0.3);
        let alckmin = game.candidates.find(c=>c.id==='alckmin18');
        if(alckmin && game.turn >= 6) updateNationalVotes('alckmin18', -0.3); // voto √∫til
    }

    // Modo Hist√≥rico 2022: Extrema polariza√ß√£o; Tebet e Ciro no meio
    if(game.mode === 'historico' && game.scenario === '2022') {
        let lula = game.candidates.find(c=>c.id==='lula22');
        let bolso = game.candidates.find(c=>c.id==='bolsonaro22');
        if(lula && game.turn < 8) updateNationalVotes('lula22', 0.2);
        if(bolso && game.turn >= 6) updateNationalVotes('bolsonaro22', 0.3); // surpreende pesquisas
        let tebet = game.candidates.find(c=>c.id==='tebet');
        if(tebet && game.turn >= 7) updateNationalVotes('tebet', 0.15);
    }

    // Modo Hist√≥rico 2026: Polariza√ß√£o Lula x Fl√°vio; centro fragmentado
    if(game.mode === 'historico' && game.scenario === '2026') {
        let lula = game.candidates.find(c=>c.id==='lula26');
        let flavio = game.candidates.find(c=>c.id==='flavio');
        if(lula && game.turn < 6) updateNationalVotes('lula26', 0.2);
        if(flavio) updateNationalVotes('flavio', 0.3);
    }

    // ===== AI RIVAL CAMPAIGN BEHAVIOR =====
    // All rivals take active campaign actions each turn
    game.candidates.filter(c => c.id !== game.player).forEach(rival => {
        let rivalData = candidatesData[rival.id] || {};
        let playerVotes = game.candidates.find(c=>c.id===game.player)?.votes || 50;
        let rivalVotes = rival.votes;
        let gap = rivalVotes - playerVotes;
        
        // Base AI movement: all rivals naturally grow/campaign
        let baseGain = 0.2 + Math.random() * 0.4;
        
        // Rivals that are behind work harder
        if(gap < -10) baseGain += 0.4;
        if(gap < -20) baseGain += 0.6;
        
        // Late game: rivals become more aggressive
        if(game.turn >= 10) baseGain += 0.3;
        
        // Random strong campaign burst (every ~4 turns per rival)
        if(Math.random() < 0.25) {
            let burstType = Math.floor(Math.random() * 4);
            if(burstType === 0) {
                // Rally surge
                updateNationalVotes(rival.id, 1.5 + Math.random() * 1.5);
                if(Math.random() > 0.5) addNews(`${rivalData.name || 'RIVAL'} FAZ GRANDE COM√çCIO`, `Candidato rival re√∫ne multid√£o enorme ‚Äî momentum em alta.`);
            } else if(burstType === 1) {
                // Attack player
                let attackVal = 0.8 + Math.random() * 1.2;
                updateNationalVotes(rival.id, attackVal);
                updateNationalVotes(game.player, -attackVal * 0.4);
                if(Math.random() > 0.5) addNews(`${rivalData.name || 'RIVAL'} ATACA O L√çDER`, `Campanha negativa acerta o candidato em cheio nas pesquisas.`);
            } else if(burstType === 2) {
                // Endorsement received
                updateNationalVotes(rival.id, 1.0 + Math.random() * 1.0);
                game.approvals[rival.id] = game.approvals[rival.id] || {app:50,rej:30};
                game.approvals[rival.id].app += 3;
            } else {
                // Media blitz
                updateNationalVotes(rival.id, 0.8 + Math.random() * 0.8);
            }
        } else {
            updateNationalVotes(rival.id, baseGain);
        }

        // EC specific: rivals campaign in swing states
        if(game.isElectoralCollege) {
            const sc2 = internationalData[game.scenario];
            if(sc2 && sc2.electoralStates) {
                let swings = sc2.electoralStates.filter(s => s.lean === 'S');
                let targetSwing = swings[Math.floor(Math.random() * swings.length)];
                if(targetSwing && game.stateVotes[targetSwing.id]) {
                    let stateGain = 3 + Math.random() * 5;
                    game.stateVotes[targetSwing.id][rival.id] = Math.max(1, (game.stateVotes[targetSwing.id][rival.id]||0) + stateGain);
                    let stateSum = Object.values(game.stateVotes[targetSwing.id]).reduce((a,b)=>a+b,0);
                    if(stateSum > 0) Object.keys(game.stateVotes[targetSwing.id]).forEach(k => {
                        game.stateVotes[targetSwing.id][k] = (game.stateVotes[targetSwing.id][k]/stateSum)*100;
                    });
                }
                // Also reinforce their safe states
                let safeStates = sc2.electoralStates.filter(s => {
                    let topR = Object.entries(candidatesData).filter(([,c])=>c.side==='D').sort((a,b)=>b[1].start-a[1].start)[0]?.[0];
                    let topD = Object.entries(candidatesData).filter(([,c])=>c.side==='E').sort((a,b)=>b[1].start-a[1].start)[0]?.[0];
                    return (s.lean==='R' && rival.id===topR) || (s.lean==='D' && rival.id===topD);
                });
                if(safeStates.length && Math.random() > 0.7) {
                    let safeTarget = safeStates[Math.floor(Math.random()*safeStates.length)];
                    if(game.stateVotes[safeTarget.id]) {
                        game.stateVotes[safeTarget.id][rival.id] = Math.min(85, (game.stateVotes[safeTarget.id][rival.id]||0) + 2);
                        let sum = Object.values(game.stateVotes[safeTarget.id]).reduce((a,b)=>a+b,0);
                        if(sum > 0) Object.keys(game.stateVotes[safeTarget.id]).forEach(k => {
                            game.stateVotes[safeTarget.id][k] = (game.stateVotes[safeTarget.id][k]/sum)*100;
                        });
                    }
                }
            }
        }
    });
    // ===== END AI RIVAL BEHAVIOR =====

    // Eventos hist√≥ricos reais
    checkHistoricalEvents();

    let eventChance = game.mode === 'caotico' ? 0.3 : 0.4;
    let hideRand = document.getElementById('hide-rand-events');
    let hideDebate = document.getElementById('hide-debates');
    let showRand = !spectatorMode && (!hideRand || hideRand.checked);
    let showDebate = !spectatorMode && (!hideDebate || hideDebate.checked);

    if(Math.random() > 0.5) {
        let randomNews = newsArchive[Math.floor(Math.random() * newsArchive.length)];
        addNews(randomNews.t, randomNews.d);
    }

    // Debate ao vivo a cada 4 turnos
    if(showDebate && game.turn % 4 === 0 && Math.random() > 0.3) {
        setTimeout(() => triggerDebate(), 600);
    } else if(showRand && Math.random() > eventChance) {
        setTimeout(() => triggerRandomEvent(), 600);
    }

    recordPollSnapshot();
    checkMomentum();
    generateDynamicNews();
    generateSocialMediaEvent(); // sempre gera um post por turno
    renderNews();

    let maxTurns = game.fase === 2 ? 3 : 15;
    if(game.turn > maxTurns) {
        processElection();
    } else {
        document.getElementById("turn-display").innerText = game.turn;
        document.getElementById("turn-max-display").innerText = maxTurns;
        log(`${game.fase === 2 ? '2¬∫ TURNO ‚Äî Rodada' : 'Dia'} ${game.turn}/${maxTurns}..`);
        updateUI();
    }
}

function openAllianceMenu() {
    if(game.fase === 1) {
        let html = game.availableParties.map(p => {
            let status = p.owner ? ` (Apoia ${candidatesData[p.owner].name})` : "";
            let disabled = p.owner ? "disabled" : "";
            return `<button class="btn" ${disabled} onclick="openCargoModal('${p.n}', '${p.side}')">Negociar com ${p.n}${status}</button>`;
        }).join("");
        html += `<hr>`;
        showModal("MESA DE NEGOCIA√á√ÉO", "Partidos d√£o pontos extras por turno. Ofere√ßa cargos para garantir apoio!", html + `<button class="btn" onclick="closeModal()">Sair</button>`);
    } else {
        let html = game.defeatedCandidates.map(c => {
            return `<button class="btn" onclick="convinceCandidate('${c.id}')">Pedir apoio de ${c.name} (${c.party})</button>`;
        }).join("");
        showModal("ALIAN√áAS DE 2¬∫ TURNO", "Tente convencer quem saiu da disputa.", html + `<button class="btn" onclick="closeModal()">Sair</button>`);
    }
}

function openCargoModal(partyName, side) {
    closeModal();
    let html = `
        <b>Ofere√ßa um cargo ao ${partyName}:</b><hr>
        <button class="btn" onclick="signAllianceWithCargo('${partyName}','${side}','fazenda')">üí∞ Minist√©rio da Fazenda (+2 econ, custa R$5M)</button>
        <button class="btn" onclick="signAllianceWithCargo('${partyName}','${side}','congresso')">üèõÔ∏è Espa√ßo no Congresso (+pontos/turno)</button>
        <button class="btn" onclick="signAllianceWithCargo('${partyName}','${side}','educacao')">üìö Minist√©rio da Educa√ß√£o (+aprova√ß√£o geral)</button>
        <button class="btn" onclick="signAllianceWithCargo('${partyName}','${side}','saude')">üè• Minist√©rio da Sa√∫de (+aprova√ß√£o popular)</button>
        <button class="btn" onclick="signAllianceWithCargo('${partyName}','${side}','obras')">üî® Minist√©rio das Obras (+votos regionais)</button>
        <button class="btn" onclick="signAllianceWithCargo('${partyName}','${side}','defesa')">‚öîÔ∏è Minist√©rio da Defesa (+estabilidade)</button>
        <button class="btn" onclick="signAlliance('${partyName}','${side}')">ü§ù Sem cargo (chance menor)</button>
        <button class="btn" onclick="closeModal()">Cancelar</button>
    `;
    showModal(`NEGOCIAR: ${partyName}`, "Custo: 4 pontos.", html);
}

function signAllianceWithCargo(name, side, cargo) {
    if(game.points < 4) return;
    let playerSide = candidatesData[game.player].side;
    let compatible = (side === playerSide || side === 'C' || playerSide === 'C');
    if(!compatible && cargo !== 'vice') {
        showModal("REJEITADO", `O ${name} rejeitou mesmo com cargo. Diferen√ßa ideol√≥gica intranspon√≠vel.`, `<button class="btn" onclick="closeModal()">Entendido</button>`);
        return;
    }
    game.points -= 4;
    let p = game.availableParties.find(x => x.n === name);
    p.owner = game.player;
    game.coalition.push(name);
    let bonus = 3;
    let msg = "";
    if(cargo === 'fazenda') { 
        game.money -= 5; bonus = 4; 
        msg = "Minist√©rio da Fazenda concedido. +Estabilidade econ√¥mica na campanha."; 
        updateNationalVotes(game.player, 3);
    } else if(cargo === 'vice') { 
        bonus = 5; 
        msg = "Vice-Presid√™ncia prometida. Alta visibilidade, mas poss√≠vel trai√ß√£o no 2¬∫ turno.";
        updateNationalVotes(game.player, 4);
    } else if(cargo === 'congresso') { 
        bonus = 2;
        game.coalition.push(name+"_seat");
        msg = "Espa√ßo garantido no Congresso. Pontos extras por turno.";
        updateNationalVotes(game.player, 2);
    } else if(cargo === 'educacao') {
        bonus = 3;
        game.approvals[game.player].app = Math.min(95, game.approvals[game.player].app + 5);
        game.approvals[game.player].rej = Math.max(0, game.approvals[game.player].rej - 3);
        msg = "Minist√©rio da Educa√ß√£o prometido. +Aprova√ß√£o geral da popula√ß√£o.";
        updateNationalVotes(game.player, 2.5);
    } else if(cargo === 'saude') {
        bonus = 3;
        game.approvals[game.player].app = Math.min(95, game.approvals[game.player].app + 6);
        msg = "Minist√©rio da Sa√∫de prometido. Alta aprova√ß√£o popular, especialmente entre idosos.";
        updateNationalVotes(game.player, 2.5);
    } else if(cargo === 'obras') {
        bonus = 3;
        game.money -= 3;
        msg = "Minist√©rio das Obras prometido. Votos regionais garantidos com projetos de infraestrutura.";
        updateNationalVotes(game.player, 3.5);
    } else if(cargo === 'defesa') {
        bonus = 3;
        gainSpirit('maquina_partido');
        msg = "Minist√©rio da Defesa prometido. +Estabilidade e apoio institucional.";
        updateNationalVotes(game.player, 2);
    }
    document.getElementById("my-coalition").innerHTML += `<span class="party-tag">${name} (${cargo})</span>`;
    // Track coalition loyalty
    if(!game.coalitionLoyalty) game.coalitionLoyalty = {};
    game.coalitionLoyalty[name] = { loyalty: 70, cargo: cargo, betrayalWarned: false };
    showModal("ALIAN√áA FIRMADA!", msg, `<button class="btn" onclick="closeModal()">Excelente!</button>`);
    playAllianceSound();
    updateUI();
}

function signAlliance(name, side) {
    if(game.points < 4) return;
    game.points -= 4;
    let playerSide = candidatesData[game.player].side;
    let compatible = (side === playerSide || side === 'C' || playerSide === 'C');
    
    if(!compatible) {
        showModal("REJEITADO", `O ${name} rejeitou a alian√ßa. "Nossas ideologias s√£o incompat√≠veis para um projeto nacional", declarou o partido.`, `<button class="btn" onclick="closeModal()">Entendido</button>`);
        return;
    }
    
    let p = game.availableParties.find(x => x.n === name);
    p.owner = game.player;
    game.coalition.push(name);
    updateNationalVotes(game.player, 2.5);
    document.getElementById("my-coalition").innerHTML += `<span class="party-tag">${name}</span>`;
    
    showModal("ACEITO!", `O ${name} aceitou entrar na coliga√ß√£o! Sua campanha ganha tempo de TV e influ√™ncia regional.`, `<button class="btn" onclick="closeModal()">Excelente!</button>`);
    updateUI();
}

function convinceCandidate(cid) {
    if(game.points < 5) return;
    game.points -= 5;
    let cand = candidatesData[cid];
    let rand = Math.random();
    
    let resultTitle, resultText;

    if(rand > 0.6) {
        updateNationalVotes(game.player, 5);
        addNews("Apoio de Peso", `${cand.name} declara voto em ${candidatesData[game.player].name}!`);
        resultTitle = "APOIO CONQUISTADO!";
        resultText = `<b style="color:green">${cand.name} aceitou apoiar voc√™!</b><br>Os eleitores dele agora tendem a migrar para sua candidatura.`;
    } else if (rand > 0.3) {
        addNews("Neutralidade", `${cand.name} prefere se manter neutro no 2¬∫ turno.`);
        resultTitle = "NEUTRALIDADE";
        resultText = `<b style="color:gray">${cand.name} decidiu n√£o apoiar ningu√©m.</b><br>"Meus eleitores s√£o livres", declarou o candidato.`;
    } else {
        let rival = game.candidates.find(c => c.id !== game.player);
        updateNationalVotes(rival.id, 4);
        addNews("Trai√ß√£o!", `${cand.name} decidiu apoiar ${rival.name}!`);
        resultTitle = "REJEI√á√ÉO E TRAI√á√ÉO";
        resultText = `<b style="color:red">${cand.name} n√£o s√≥ recusou voc√™ como apoiar√° seu rival!</b><br>Isso ter√° um impacto negativo nas urnas.`;
    }
    
    game.defeatedCandidates = game.defeatedCandidates.filter(x => x.id !== cid);
    showModal(resultTitle, resultText, `<button class="btn" onclick="closeModal()">Entendido</button>`);
    updateUI();
}

function triggerRandomEvent() {
    let playerC = candidatesData[game.player];
    let pName = playerC ? playerC.name : 'Candidato';
    const events = [
        {t: "üì∫ DEBATE NACIONAL NA TV", d: "O debate nacional esquentou e todos os olhos est√£o em voc√™. √â hora de se destacar.", b: [{n: "Atacar o l√≠der (+3%)", f: () => { updateNationalVotes(game.player, 3); updateRadicalization(5); }}, {n: "Apresentar plano de governo (+2%)", f: () => { updateNationalVotes(game.player, 2); game.approvals[game.player].app+=4; }}, {n: "Adotar postura moderada (+1.5%)", f: () => { updateNationalVotes(game.player, 1.5); game.approvals[game.player].rej-=3; }}]},
        {t: "üìä DADOS DE INFLA√á√ÉO DIVULGADOS", d: "Os √≠ndices oficiais de infla√ß√£o foram divulgados. A economia domina o debate p√∫blico.", b: [{n: "Elogiar a pol√≠tica econ√¥mica (+2%)", f: () => { updateNationalVotes(game.player, 2); }}, {n: "Criticar a gest√£o econ√¥mica (+3%, -moral)", f: () => { updateNationalVotes(game.player, 3); game.approvals[game.player].rej+=3; updateRadicalization(5); }}, {n: "Propor solu√ß√£o t√©cnica (+1.5%)", f: () => { updateNationalVotes(game.player, 1.5); game.money+=5; }}]},
        {t: "üîç ACUSA√á√ÉO AN√îNIMA", d: "Rumores sobre irregularidades no seu passado surgiram na m√≠dia. Como voc√™ reage?", b: [{n: "Processar por difama√ß√£o (-$10M, +moral)", f: () => { game.money -= 10; game.approvals[game.player].rej -= 3; }}, {n: "Ignorar (-1%)", f: () => { updateNationalVotes(game.player, -1); }}, {n: "Admitir e pedir desculpas (-0.5%, +moral)", f: () => { updateNationalVotes(game.player, -0.5); game.approvals[game.player].app += 4; }}]},
        {t: "üè≠ APOIO DO SETOR EMPRESARIAL", d: "L√≠deres empresariais oferecem financiamento para a campanha. Mas h√° riscos.", b: [{n: "Aceitar (+$25M, risco)", f: () => { game.money += 25; if(Math.random()>0.5){game.scandalLevels[game.player]=(game.scandalLevels[game.player]||0)+1;} }}, {n: "Recusar (+moral, +0.5%)", f: () => { updateNationalVotes(game.player, 0.5); game.approvals[game.player].app+=3; gainSpirit('boca_a_boca'); }}]},
        {t: "üì£ MANIFESTA√á√ïES POPULARES", d: "A popula√ß√£o est√° nas ruas. A situa√ß√£o exige uma posi√ß√£o clara do seu candidato.", b: [{n: "Apoiar os manifestantes (+2%)", f: () => { updateNationalVotes(game.player, 2); updateRadicalization(8); gainSpirit('onda_popular'); }}, {n: "Pedir ordem e di√°logo (+1%)", f: () => { updateNationalVotes(game.player, 1); }}, {n: "Criticar os excessos (+1.5%)", f: () => { updateNationalVotes(game.player, 1.5); updateRadicalization(-5); }}]},
        {t: "üìâ DESEMPREGO EM ALTA", d: "Novos dados mostram aumento do desemprego. Os eleitores est√£o preocupados com a economia.", b: [{n: "Proposta de emprego e renda (+2%)", f: () => { updateNationalVotes(game.player, 2); game.approvals[game.player].app+=3; }}, {n: "Culpar o governo atual (+3%)", f: () => { updateNationalVotes(game.player, 3); game.approvals[game.player].rej+=4; updateRadicalization(5); }}, {n: "Apresentar plano t√©cnico (+1.5%)", f: () => { updateNationalVotes(game.player, 1.5); gainSpirit('maquina_partido'); }}]},
        {t: "üåü ENDOSSO DE CELEBRIDADE", d: `Uma celebridade famosa acabou de apoiar sua campanha! As redes sociais explodem.`, b: [{n: "Capitalizar com evento (+2%)", f: () => { updateNationalVotes(game.player, 2); gainSpirit('momentum_midias'); }}, {n: "Manter dist√¢ncia das celebridades", f: () => { updateNationalVotes(game.player, 0.5); game.approvals[game.player].app+=2; }}]},
        {t: "üìä PESQUISA BOMB√ÅSTICA DIVULGADA", d: "Uma nova grande pesquisa muda o panorama ‚Äî margens al√©m da margem de erro.", b: [{n: "Usar como impulso (+1.5%)", f: () => { updateNationalVotes(game.player, 1.5); }}, {n: "Questionar a metodologia (0%)", f: () => { log("Metodologia questionada. Eleitores divididos."); }}, {n: "Ignorar e seguir trabalhando (+1%, +2pts)", f: () => { updateNationalVotes(game.player, 1); game.points += 2; }}]},
        {t: "üí∞ VAQUINHA POPULAR", d: "Sua equipe prop√µe uma campanha de arrecada√ß√£o popular de base.", b: [{n: "Lan√ßar a campanha (+$12M, +1%)", f: () => { game.money += 12; updateNationalVotes(game.player, 1); gainSpirit('caixa_cheio'); }}, {n: "Fazer com√≠cio presencial (+2%, -$5M)", f: () => { game.money -= 5; updateNationalVotes(game.player, 2); }}]},
        {t: "üí• RIVAL ENVOLVIDO EM ESC√ÇNDALO", d: `Um candidato rival est√° envolto em pol√™mica. Como voc√™ reage?`, b: [{n: "Atacar: 'Isso n√£o √© lideran√ßa!' (+2%)", f: () => { let rival = game.candidates.filter(c=>c.id!==game.player).sort((a,b)=>b.votes-a.votes)[0]; if(rival){updateNationalVotes(rival.id,-1.5);updateNationalVotes(game.player,2);} }}, {n: "Ficar calado e focar (+1pt)", f: () => { game.points+=1; }}, {n: "Pedir investiga√ß√£o (+1.5%)", f: () => { updateNationalVotes(game.player, 1.5); } }]},
        {t: "üé§ COM√çCIO SURPRESA ‚Äî MULTID√ÉO HIST√ìRICA", d: "Voc√™ tem a chance de fazer um com√≠cio improvisado em uma cidade estrat√©gica.", b: [{n: "Fazer o com√≠cio (3pts, +3%)", f: () => { if(game.points>=3){game.points-=3; updateNationalVotes(game.player,3); gainSpirit('onda_popular'); } }}, {n: "Circuito de entrevistas na m√≠dia (+2%)", f: () => { updateNationalVotes(game.player, 2); game.approvals[game.player].app+=3; }}]},
        {t: "üö® CRISE DE SEGURAN√áA P√öBLICA", d: "Estat√≠sticas de criminalidade dominam o debate nacional. A popula√ß√£o exige resposta.", b: [{n: "Postura dura: lei e ordem (+2%)", f: () => { updateNationalVotes(game.player, 2); updateRadicalization(8); }}, {n: "Investimento social e preven√ß√£o (+1.5%)", f: () => { updateNationalVotes(game.player, 1.5); }}, {n: "Proposta apartid√°ria (+1%, +aprova√ß√£o)", f: () => { updateNationalVotes(game.player, 1); game.approvals[game.player].app+=4; }}]},
        {t: "üî• POLARIZA√á√ÉO RECORDE NAS REDES", d: "As redes sociais explodem! Grupos radicais se enfrentam online. A radicaliza√ß√£o dispara.", b: [{n: "Surfar na onda da polariza√ß√£o (+2%, +rad.)", f: () => { updateNationalVotes(game.player, 2); updateRadicalization(15); gainSpirit('onda_popular'); }}, {n: "Pedir modera√ß√£o (-rad., +aprova√ß√£o)", f: () => { updateRadicalization(-12); game.approvals[game.player].app+=5; updateNationalVotes(game.player, 0.5); }}, {n: "Ignorar, focar em pol√≠tica (+1%)", f: () => { updateNationalVotes(game.player, 1); }}]},
        {t: "üåä ONDA DE ORGULHO NACIONAL", d: "Um evento desperta sentimento patri√≥tico profundo. Uma chance de conectar-se com a alma nacional.", b: [{n: "Discurso arrebatador (Esp√≠rito Nacional!)", f: () => { gainSpirit('onda_popular'); gainSpirit('momentum_midias'); updateNationalVotes(game.player, 1.5); }}, {n: "Evento p√∫blico simb√≥lico (+1%, +aprova√ß√£o)", f: () => { updateNationalVotes(game.player, 1); game.approvals[game.player].app+=4; }}, {n: "Focar na agenda econ√¥mica (+2pts)", f: () => { game.points+=2; }}]},
        {t: "‚ö° ESC√ÇNDALO NO GOVERNO", d: "Um esc√¢ndalo abala o governo. A sociedade est√° em polvorosa ‚Äî candidatos podem ganhar ou pagar o pre√ßo.", b: [{n: "Atacar o governo (+3%, +rad.)", f: () => { updateNationalVotes(game.player, 3); updateRadicalization(12); }}, {n: "Propor comiss√£o parlamentar (+1.5%)", f: () => { updateNationalVotes(game.player, 1.5); game.approvals[game.player].app+=3; }}, {n: "Sil√™ncio estrat√©gico (+2pts)", f: () => { game.points+=2; }}]},
        {t: "üéñÔ∏è L√çDER HIST√ìRICO APOIA SUA CAMPANHA", d: `Uma figura amplamente respeitada elogiou ${pName} publicamente. Um momento de ouro para o esp√≠rito nacional!`, b: [{n: "Amplificar o endosso (Esp√≠rito Nacional!)", f: () => { gainSpirit('grande_lider'); updateNationalVotes(game.player, 1.5); }}, {n: "Evento conjunto ao vivo (+2%)", f: () => { updateNationalVotes(game.player, 2); gainSpirit('momentum_midias'); }}, {n: "Agradecer e manter o foco (+aprova√ß√£o)", f: () => { updateNationalVotes(game.player, 0.5); game.approvals[game.player].app+=4; }}]},
        {t: "üì± V√çDEO VIRAL", d: `Um v√≠deo de ${pName} viralizou! Milh√µes de compartilhamentos em horas. Todos est√£o falando de voc√™.`, b: [{n: "Fazer live imediatamente (+2%, +rad.)", f: () => { updateNationalVotes(game.player, 2); updateRadicalization(8); gainSpirit('momentum_midias'); }}, {n: "Lan√ßar campanha de marketing (+1.5%)", f: () => { updateNationalVotes(game.player, 1.5); game.approvals[game.player].app+=3; }}, {n: "Deixar o momento viral trabalhar (+1%)", f: () => { updateNationalVotes(game.player, 1); }}]},
        {t: "‚õ™ L√çDER RELIGIOSO SE MANIFESTA", d: "Uma figura religiosa influente pediu aos fi√©is que votem conforme seus valores. Como voc√™ reage?", b: [{n: "Buscar endosso religioso (+2%, +rad.)", f: () => { updateNationalVotes(game.player, 2); updateRadicalization(7); }}, {n: "Defender separa√ß√£o entre Igreja e Estado (+1%, -rad.)", f: () => { updateNationalVotes(game.player, 1); updateRadicalization(-5); game.approvals[game.player].app+=2; }}, {n: "N√£o tomar posi√ß√£o (+0.5%)", f: () => { updateNationalVotes(game.player, 0.5); }}]},
        {t: "üèüÔ∏è COM√çCIO HIST√ìRICO ‚Äî MULTID√ÉO RECORDE", d: `Centenas de milhares se re√∫nem por ${pName}! O esp√≠rito nacional est√° no auge!`, b: [{n: "Discurso hist√≥rico (2x Esp√≠rito Nacional!)", f: () => { gainSpirit('onda_popular'); gainSpirit('grande_lider'); updateNationalVotes(game.player, 2); updateRadicalization(10); }}, {n: "Moderado e inclusivo (+aprova√ß√£o, -rad.)", f: () => { updateNationalVotes(game.player, 1.5); game.approvals[game.player].app+=6; game.approvals[game.player].rej-=4; updateRadicalization(-5); }}]},
        {t: "üì∞ CAMPANHA DE DESINFORMA√á√ÉO CONTRA VOC√ä", d: "Hist√≥rias falsas se espalham sobre sua campanha, causando confus√£o e polariza√ß√£o.", b: [{n: "Desmentir publicamente (-rad. -5, +moral)", f: () => { updateRadicalization(-5); game.approvals[game.player].app+=3; updateNationalVotes(game.player, 0.5); }}, {n: "Contratar equipe de verifica√ß√£o (-$5M, +1%)", f: () => { game.money-=5; updateNationalVotes(game.player, 1); game.approvals[game.player].rej-=3; }}, {n: "Usar a pol√™mica a seu favor (+rad., +1.5%)", f: () => { updateNationalVotes(game.player, 1.5); updateRadicalization(10); }}]},
        {t: "üåø CRISE AMBIENTAL REPERCUTE", d: "Um desastre ambiental ou crise clim√°tica domina as manchetes. Os eleitores pedem posi√ß√£o.", b: [{n: "Propor agenda verde ambiciosa (+2%, +aprova√ß√£o)", f: () => { updateNationalVotes(game.player, 2); game.approvals[game.player].app+=4; }}, {n: "Equilibrar meio ambiente e economia (+1.5%)", f: () => { updateNationalVotes(game.player, 1.5); }}, {n: "Priorizar empregos e crescimento (+2%, -aprova√ß√£o)", f: () => { updateNationalVotes(game.player, 2); game.approvals[game.player].rej+=3; }}]},
        {t: "üè• CRISE NO SISTEMA DE SA√öDE", d: "Filas e falta de insumos nos hospitais viram pauta nacional. A popula√ß√£o exige solu√ß√µes.", b: [{n: "Propor reforma do sistema (+2%, +aprova√ß√£o)", f: () => { updateNationalVotes(game.player, 2); game.approvals[game.player].app+=5; }}, {n: "Atacar a gest√£o atual (+2.5%, +rejei√ß√£o)", f: () => { updateNationalVotes(game.player, 2.5); game.approvals[game.player].rej+=4; updateRadicalization(5); }}, {n: "Proposta t√©cnica apartid√°ria (+1.5%)", f: () => { updateNationalVotes(game.player, 1.5); gainSpirit('maquina_partido'); }}]},
        {t: "üì° VAZAMENTO DE CONVERSAS PRIVADAS", d: "Conversas privadas entre membros da sua equipe vazaram. Como voc√™ controla o dano?", b: [{n: "Demitir respons√°veis e pedir desculpas (-esc√¢ndalo +moral)", f: () => { game.scandalLevels[game.player]=Math.max(0,(game.scandalLevels[game.player]||0)-1); game.approvals[game.player].app+=3; }}, {n: "Negar e contra-atacar (-1%, +esc√¢ndalo)", f: () => { updateNationalVotes(game.player, -1); game.scandalLevels[game.player]=(game.scandalLevels[game.player]||0)+2; }}, {n: "Desviar aten√ß√£o com novo an√∫ncio (+0.5%)", f: () => { updateNationalVotes(game.player, 0.5); }}]},
    ];
    let evIdx = Math.floor(Math.random() * events.length);
    let ev = events[evIdx];
    currentEvents = events;

    let btns = ev.b.map((btn, btnIdx) => 
        `<button class="btn" onclick="executeEvent(${evIdx}, ${btnIdx})">${btn.n}</button>`
    ).join("");
    
    queueEvent(ev.t, ev.d, btns);
}

function executeEvent(eIdx, bIdx) {
    if(currentEvents[eIdx] && currentEvents[eIdx].b[bIdx]) {
        currentEvents[eIdx].b[bIdx].f();
    }
    closeModal();
    isShowingEvent = false;
    setTimeout(() => processNextEvent(), 200);
    updateUI();
}

function aceitarPropostaColigacao(partyName, side, costPts, votesBonus) {
    if(game.points < costPts) {
        closeModal();
        queueEvent('‚ö†Ô∏è PONTOS INSUFICIENTES', `Voc√™ n√£o tem pontos suficientes para aceitar a proposta do ${partyName}. Voc√™ precisa de ${costPts}p.`, `<button class="btn" onclick="closeModal()">Entendido</button>`);
        return;
    }
    game.points -= costPts;
    let p = game.availableParties.find(x => x.n === partyName);
    if(p) p.owner = game.player;
    game.coalition.push(partyName);
    updateNationalVotes(game.player, votesBonus);
    if(!game.coalitionLoyalty) game.coalitionLoyalty = {};
    game.coalitionLoyalty[partyName] = { loyalty: 75, cargo: 'acordo espont√¢neo', betrayalWarned: false };
    document.getElementById('my-coalition').innerHTML += `<span class="party-tag">${partyName}</span>`;
    addNews(`ALIAN√áA FIRMADA: ${partyName}`, `${partyName} oficializa apoio a ${candidatesData[game.player]?.name || 'candidato'}. Coliga√ß√£o se fortalece.`);
    log(`ü§ù Proposta aceita! ${partyName} entrou na coliga√ß√£o. +${votesBonus.toFixed(1)}%`);
    closeModal();
    isShowingEvent = false;
    setTimeout(() => processNextEvent(), 200);
    updateUI();
}

function recusarPropostaColigacao(partyName) {
    log(`‚ùå Proposta do ${partyName} recusada. Partido permanece livre.`);
    // Small chance the party goes to a rival
    if(Math.random() > 0.5) {
        let rivals = game.candidates.filter(c => c.id !== game.player);
        if(rivals.length > 0) {
            let rival = rivals[Math.floor(Math.random() * rivals.length)];
            let p = game.availableParties.find(x => x.n === partyName);
            if(p) p.owner = rival.id;
            updateNationalVotes(rival.id, 1.5);
            addNews(`${partyName} APOIA ${candidatesData[rival.id]?.name||'rival'}`, `Ap√≥s recusa, partido anuncia alian√ßa com candidato rival.`);
        }
    }
    closeModal();
    isShowingEvent = false;
    setTimeout(() => processNextEvent(), 200);
}

function processElection() {
    let sorted = [...game.candidates].sort((a,b) => b.votes - a.votes);
    let winner = sorted[0];

    // Check noSecondRound flag (Rep√∫blica Velha, some old scenarios)
    let sc = scenariosData[game.scenario] || internationalData[game.scenario];
    let noSecond = game.isRepVelha || (sc && sc.noSecondRound);
    let year = parseInt(game.scenario) || 2000;
    // Elections before 1965 in Brazil had no second round system
    if(!noSecond && !game.isElectoralCollege && year >= 1945 && year <= 1964) noSecond = true;

    // --- REP√öBLICA VELHA / ELEI√á√ïES SEM 2¬∫ TURNO ---
    if(noSecond && !game.isElectoralCollege) {
        finishGame(winner, "Vencedor por maioria simples ‚Äî sem segundo turno.");
        return;
    }

    // --- ELECTORAL COLLEGE ---
    if(game.isElectoralCollege) {
        let evCounts = getEVCounts();
        let evSorted = Object.entries(evCounts).sort((a,b)=>b[1]-a[1]);
        let winnerEV = evSorted[0];
        let winnerCand = game.candidates.find(c=>c.id===winnerEV[0]) || winner;
        let evMsg = `Col√©gio Eleitoral: ${winnerEV[1]} votos (270 necess√°rios)`;
        if(winnerEV[1] < 270) evMsg = `Sem maioria! ${winnerEV[1]} EV ‚Äî Elei√ß√£o contestada!`;
        finishGame(winnerCand, evMsg);
        return;
    }

    // --- INTERNATIONAL WITHOUT EC (Russia etc.) ---
    if(internationalData[game.scenario] && !game.isElectoralCollege) {
        finishGame(winner, "Vencedor por maioria absoluta.");
        return;
    }

    if(game.fase === 1) {
        // --- VIT√ìRIA NO 1¬∫ TURNO ---
        if(winner.votes > 50) {
            finishGame(winner, "Eleito no Primeiro Turno!");
            return;
        }

        let top2 = [sorted[0], sorted[1]];
        let isPlayerIn = top2.some(c => c.id === game.player);
        let eliminated = game.candidates.filter(c => c.id !== sorted[0].id && c.id !== sorted[1].id);
        game.defeatedCandidates = eliminated;

        if(!isPlayerIn) {
            // --- PLAYER N√ÉO FOI AO 2T ---
            let playerFinal = sorted.find(c => c.id === game.player) || sorted[2];
            // Oferecer escolha: simular tudo OU apoiar candidato (gameplay especial)
            showEliminatedChoice(sorted[0], sorted[1], playerFinal, sorted, eliminated);
            return;
        }

        // --- PLAYER VAI AO 2¬∫ TURNO ---
        game.fase = 2;
        game.turn = 0; // nextTurn far√° turn++ imediatamente
        game.candidates = [sorted[0], sorted[1]];
        allStates.forEach(s => {
            game.stateVotes[s.id] = {};
            game.candidates.forEach(c => game.stateVotes[s.id][c.id] = 50 + (Math.random()*10 - 5));
        });
        applyIdeologicalMigration();
        document.getElementById("fase-label").innerText = "2¬∫ TURNO";
        document.getElementById("btn-alliance").innerText = "Convencer Candidatos (5p)";
        showModal(
            "‚öîÔ∏è SEGUNDO TURNO!",
            `A disputa final √© entre <b>${sorted[0].name}</b> e <b>${sorted[1].name}</b>!<br>
            <small style="color:red">‚ö†Ô∏è Aten√ß√£o: apenas <b>3 rodadas</b>. Cada a√ß√£o √© crucial.</small><br>
            <small>Eleitores dos eliminados migraram por afinidade ideol√≥gica.</small>`,
            `<button class="btn" onclick="closeModal()">Avan√ßar para o 2¬∫ Turno</button>`
        );
        updateUI();

    } else {
        // --- FIM DO 2¬∫ TURNO ---
        finishGame(winner, "Vencedor do Segundo Turno!");
    }
}

// ============================================================
// MODO DE APOIO NO 2¬∫ TURNO ‚Äî quando o player √© eliminado
// ============================================================
let supportGame = {
    candA: null, candB: null, chosen: null, opponent: null,
    turn: 0, maxTurns: 5, resources: 0, influence: 0,
    log: [], allSorted: [], playerFinal: null, eliminated: [],
    eventHistory: [], crisisStack: 0, scandalRisk: 0,
    pollHistory: [], playerFinalObj: null
};

function showEliminatedChoice(cA, cB, playerFinal, allSorted, eliminated) {
    let cdA = candidatesData[cA.id] || {};
    let cdB = candidatesData[cB.id] || {};
    let playerCd = candidatesData[game.player] || {};

    document.getElementById("game-screen").classList.remove("active");
    document.getElementById("end-screen").classList.add("active");

    // Usar result-desc para exibir a tela de escolha (modo tempor√°rio)
    document.getElementById("result-title").innerText = "üíÄ ELIMINADO NO 1¬∫ TURNO";
    document.getElementById("result-subtitle").innerText = "O QUE DESEJA FAZER?";

    let posicao = allSorted.findIndex(c => c.id === game.player) + 1;

    document.getElementById("result-desc").innerHTML = `
        <div style="font-family:'MS Sans Serif',Arial;font-size:13px;max-width:560px;margin:0 auto">
            <div style="background:#ffeeee;border:2px solid #cc0000;padding:12px;margin-bottom:14px;border-radius:3px">
                <b style="color:#cc0000;font-size:15px">‚ùå ${playerCd.name||game.player} eliminado</b><br>
                Voc√™ terminou em <b>${posicao}¬∫ lugar</b> com <b>${playerFinal.votes.toFixed(1)}%</b>.<br>
                N√£o h√° votos suficientes para o 2¬∫ turno.
            </div>
            <div style="background:#e8f4e8;border:2px solid #228b22;padding:10px;margin-bottom:14px;border-radius:3px">
                <b>‚öîÔ∏è O 2¬∫ TURNO SER√Å ENTRE:</b><br>
                <div style="display:flex;justify-content:space-around;margin-top:8px">
                    <div style="text-align:center"><div style="font-size:20px;font-weight:bold;color:${cdA.color||'#000'}">${cA.name}</div><div style="font-size:11px">${cdA.party||''} ‚Äî ${cA.votes.toFixed(1)}%</div><div style="font-size:10px;color:#555">${cdA.ideologia||''}</div></div>
                    <div style="font-size:22px;line-height:40px;color:#888">VS</div>
                    <div style="text-align:center"><div style="font-size:20px;font-weight:bold;color:${cdB.color||'#000'}">${cB.name}</div><div style="font-size:11px">${cdB.party||''} ‚Äî ${cB.votes.toFixed(1)}%</div><div style="font-size:10px;color:#555">${cdB.ideologia||''}</div></div>
                </div>
            </div>
            <b style="font-size:13px">O que deseja fazer?</b><hr style="margin:8px 0">
            <button class="btn" style="background:#555;color:white;margin-bottom:8px" onclick="autoSimulate2T()" >
                ‚è© SIMULAR AUTOMATICAMENTE<br><small style="font-weight:normal">O 2¬∫ turno √© simulado sem sua interven√ß√£o. Resultado imediato.</small>
            </button>
            <button class="btn" style="background:#000080;color:white" onclick="startSupportGameplay('${cA.id}','${cB.id}')">
                üó≥Ô∏è APOIAR UM CANDIDATO ‚Äî GAMEPLAY ESPECIAL<br>
                <small style="font-weight:normal">‚ö†Ô∏è DIF√çCIL: Tome decis√µes para eleger seu candidato preferido no 2¬∫ turno. Seu sucesso depende de escolhas estrat√©gicas duras.</small>
            </button>
        </div>
    `;
    document.getElementById("candidate-bio").innerHTML = '';
    document.getElementById("congress-bars").innerHTML = '';
    document.getElementById("congress-gov").innerHTML = '';
    document.getElementById("ranking-content").innerHTML = '';
    document.getElementById("congress-section").style.display = 'none';
    document.getElementById("ranking-section").style.display = 'none';

    // Guardar dados para uso posterior
    supportGame.candA = {...cA}; supportGame.candB = {...cB};
    supportGame.allSorted = allSorted; supportGame.playerFinal = playerFinal;
    supportGame.eliminated = eliminated || [];
}

function autoSimulate2T() {
    let cA = {...supportGame.candA}, cB = {...supportGame.candB};
    (supportGame.eliminated || []).forEach(dc => {
        let dA = getIdeologyDistance(dc.id, cA.id);
        let dB = getIdeologyDistance(dc.id, cB.id);
        let share = dc.votes * 0.55;
        if(dA < dB) cA.votes += share;
        else if(dB < dA) cB.votes += share;
        else { cA.votes += share/2; cB.votes += share/2; }
    });
    cA.votes += (Math.random()*6 - 3);
    let tot = cA.votes + cB.votes;
    cA.votes = (cA.votes/tot)*100;
    cB.votes = 100 - cA.votes;
    let winner2T = cA.votes > cB.votes ? cA : cB;
    let loser2T  = cA.votes > cB.votes ? cB : cA;
    showEliminatedScreen(winner2T, loser2T, supportGame.playerFinal, supportGame.allSorted);
}

function startSupportGameplay(idA, idB) {
    let cdA = candidatesData[idA] || {}; let cdB = candidatesData[idB] || {};
    let playerCd = candidatesData[game.player] || {};

    // Ideologia mais pr√≥xima = pr√©-sugest√£o
    let distA = getIdeologyDistance(game.player, idA);
    let distB = getIdeologyDistance(game.player, idB);

    document.getElementById("result-desc").innerHTML = `
        <div style="font-family:'MS Sans Serif',Arial;font-size:13px;max-width:560px;margin:0 auto">
            <div style="background:#fff3cd;border:2px solid #cc8800;padding:10px;margin-bottom:12px">
                <b>‚ö†Ô∏è MODO DE APOIO ‚Äî REGRAS:</b><br>
                <small>‚Ä¢ Voc√™ tem <b>5 rodadas</b> e recursos limitados para influenciar o 2¬∫ turno.<br>
                ‚Ä¢ As pesquisas s√£o inicialmente adversas. Reverter o cen√°rio √© DIF√çCIL.<br>
                ‚Ä¢ Cada a√ß√£o tem custo e pode ter consequ√™ncias negativas inesperadas.<br>
                ‚Ä¢ Esc√¢ndalos, crises e trai√ß√µes podem destruir seu esfor√ßo a qualquer momento.<br>
                ‚Ä¢ Seu candidato precisa de <b>mais de 50%</b> para vencer. Boa sorte.</small>
            </div>
            <b>Escolha quem apoiar:</b><hr style="margin:6px 0">
            <div style="display:flex;gap:10px">
                <button class="btn" style="flex:1;background:${cdA.color||'#000080'};color:white;padding:10px" onclick="confirmSupportChoice('${idA}','${idB}')">
                    <b>${cdA.name||idA}</b><br><small>${cdA.party||''} ‚Äî ${cdA.ideologia||''}</small><br>
                    <small style="opacity:0.8">${distA < distB ? '‚òÖ Mais pr√≥ximo de voc√™' : ''}</small>
                </button>
                <button class="btn" style="flex:1;background:${cdB.color||'#cc0000'};color:white;padding:10px" onclick="confirmSupportChoice('${idB}','${idA}')">
                    <b>${cdB.name||idB}</b><br><small>${cdB.party||''} ‚Äî ${cdB.ideologia||''}</small><br>
                    <small style="opacity:0.8">${distB < distA ? '‚òÖ Mais pr√≥ximo de voc√™' : ''}</small>
                </button>
            </div>
            <button class="btn" style="margin-top:10px;background:#888;color:white" onclick="autoSimulate2T()">‚Üê Voltar / Simular automaticamente</button>
        </div>`;
}

function confirmSupportChoice(chosenId, opponentId) {
    let cdC = candidatesData[chosenId] || {};
    let cdO = candidatesData[opponentId] || {};

    // Inicializar estado do mini-jogo
    supportGame.chosen = chosenId;
    supportGame.opponent = opponentId;
    supportGame.turn = 0;
    supportGame.maxTurns = 5;
    supportGame.resources = 8; // recursos de influ√™ncia (escassos!)
    supportGame.influence = 0; // b√¥nus de influ√™ncia acumulado
    supportGame.log = [];
    supportGame.eventHistory = [];
    supportGame.crisisStack = 0;
    supportGame.scandalRisk = 0;
    supportGame.pollHistory = [];

    // Votos iniciais: distribui√ß√£o com migra√ß√£o ideol√≥gica (adversa ao jogador)
    let baseChosen = supportGame.candA.id === chosenId ? supportGame.candA.votes : supportGame.candB.votes;
    let baseOpp    = supportGame.candA.id === chosenId ? supportGame.candB.votes : supportGame.candA.votes;

    // Migra√ß√£o dos eliminados
    (supportGame.eliminated || []).forEach(dc => {
        let dC = getIdeologyDistance(dc.id, chosenId);
        let dO = getIdeologyDistance(dc.id, opponentId);
        let share = dc.votes * 0.55;
        if(dC < dO) baseChosen += share;
        else if(dO < dC) baseOpp += share;
        else { baseChosen += share/2; baseOpp += share/2; }
    });

    let tot = baseChosen + baseOpp;
    baseChosen = (baseChosen/tot)*100;
    baseOpp = 100 - baseChosen;

    // Adiciona vari√¢ncia negativa inicial (dificultar)
    baseChosen += (Math.random() * 8 - 6); // normalmente desvantagem
    baseOpp = 100 - baseChosen;
    baseChosen = Math.max(35, Math.min(65, baseChosen));
    baseOpp = 100 - baseChosen;

    supportGame.chosenVotes = baseChosen;
    supportGame.opponentVotes = baseOpp;
    supportGame.pollHistory.push({turn:0, chosen: baseChosen, opp: baseOpp});

    renderSupportGameplay();
}

function renderSupportGameplay() {
    let cdC = candidatesData[supportGame.chosen] || {};
    let cdO = candidatesData[supportGame.opponent] || {};
    let sc = scenariosData[game.scenario] || {};

    let winColor = supportGame.chosenVotes > 50 ? '#006600' : supportGame.chosenVotes > 48 ? '#cc8800' : '#cc0000';
    let statusText = supportGame.chosenVotes > 52 ? '‚úÖ Na frente ‚Äî mantenha a press√£o!' :
                     supportGame.chosenVotes > 50 ? 'üü° Leve vantagem ‚Äî fr√°gil!' :
                     supportGame.chosenVotes > 46 ? 'üü† Atr√°s ‚Äî a√ß√£o urgente!' :
                     'üî¥ DESVANTAGEM CR√çTICA ‚Äî tudo ou nada!';
    let turnsLeft = supportGame.maxTurns - supportGame.turn;

    // Gera os eventos dispon√≠veis nesta rodada
    let actions = generateSupportActions();

    // Mini hist√≥rico de pesquisas
    let chartHtml = '<div style="display:flex;align-items:flex-end;gap:2px;height:40px;margin:4px 0">';
    supportGame.pollHistory.forEach((p, i) => {
        let h = Math.round((p.chosen / 100) * 40);
        let col = p.chosen > 50 ? '#006600' : '#cc0000';
        chartHtml += `<div title="T${p.turn}: ${p.chosen.toFixed(1)}%" style="width:18px;background:${col};height:${h}px;display:inline-block;border:1px solid #333"></div>`;
    });
    chartHtml += '</div>';

    let logHtml = supportGame.log.slice(-5).reverse().map(l => `<div style="font-size:9px;border-bottom:1px solid #333;padding:2px 0;color:#0f0">&gt; ${l}</div>`).join('');

    document.getElementById("result-desc").innerHTML = `
    <div style="font-family:'MS Sans Serif',Arial;font-size:11px;max-width:640px;margin:0 auto">
        <!-- CABE√áALHO -->
        <div style="background:#000080;color:white;padding:6px 10px;display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
            <span>üó≥Ô∏è APOIO AO 2¬∫ TURNO ‚Äî Rodada ${supportGame.turn}/${supportGame.maxTurns}</span>
            <span>üíº Recursos: <b>${supportGame.resources}</b> | ‚ö†Ô∏è Crise: ${supportGame.crisisStack}/5</span>
        </div>

        <!-- PAINEL DE VOTOS -->
        <div style="display:grid;grid-template-columns:1fr 60px 1fr;gap:4px;margin-bottom:8px;background:#f0f0f0;padding:8px;border:2px inset #888">
            <div style="text-align:center">
                <div style="font-weight:bold;color:${cdC.color||'#000080'};font-size:13px">${cdC.name||supportGame.chosen} ‚òÖ</div>
                <div style="font-size:22px;font-weight:bold;color:${winColor}">${supportGame.chosenVotes.toFixed(1)}%</div>
                <div style="height:10px;background:#ddd;border:1px solid #999;margin:2px 0"><div style="width:${supportGame.chosenVotes.toFixed(0)}%;height:100%;background:${winColor}"></div></div>
                <div style="font-size:9px;color:#555">${cdC.party||''} ¬∑ ${cdC.ideologia||''}</div>
            </div>
            <div style="text-align:center;padding-top:10px;color:#888;font-size:16px">VS</div>
            <div style="text-align:center">
                <div style="font-weight:bold;color:${cdO.color||'#cc0000'};font-size:13px">${cdO.name||supportGame.opponent}</div>
                <div style="font-size:22px;font-weight:bold;color:${supportGame.opponentVotes > 50 ? '#cc0000' : '#333'}">${supportGame.opponentVotes.toFixed(1)}%</div>
                <div style="height:10px;background:#ddd;border:1px solid #999;margin:2px 0"><div style="width:${supportGame.opponentVotes.toFixed(0)}%;height:100%;background:${cdO.color||'#cc0000'}"></div></div>
                <div style="font-size:9px;color:#555">${cdO.party||''} ¬∑ ${cdO.ideologia||''}</div>
            </div>
        </div>

        <!-- STATUS -->
        <div style="background:${supportGame.chosenVotes > 50 ? '#e8ffe8' : '#fff3cd'};border:1px solid ${supportGame.chosenVotes > 50 ? '#006600' : '#cc8800'};padding:5px 8px;margin-bottom:8px;font-size:11px">
            ${statusText} &nbsp;&nbsp; <b>${turnsLeft} rodada(s) restante(s)</b>
            ${supportGame.scandalRisk > 3 ? `<br><span style="color:#cc0000">üî• Risco de esc√¢ndalo elevado! Evite a√ß√µes agressivas.</span>` : ''}
            ${supportGame.crisisStack >= 4 ? `<br><span style="color:#cc0000">‚ö†Ô∏è CRISE EM FORMA√á√ÉO ‚Äî pr√≥xima rodada pode ser catastr√≥fica!</span>` : ''}
        </div>

        <!-- MINI-GR√ÅFICO -->
        <div style="background:#111;padding:4px 8px;margin-bottom:8px;border:1px solid #333">
            <div style="color:#0f0;font-size:9px;margin-bottom:2px">üìä Evolu√ß√£o das pesquisas</div>
            ${chartHtml}
        </div>

        <!-- A√á√ïES -->
        <div style="margin-bottom:8px">
            <b>‚öôÔ∏è ESCOLHA UMA A√á√ÉO (Rodada ${supportGame.turn + 1}):</b><hr style="margin:4px 0">
            ${actions.map((a, i) => `
                <button class="btn" ${supportGame.resources < a.cost ? 'disabled' : ''} onclick="executeSupportAction(${i})" style="text-align:left;margin-bottom:4px;background:${a.risky ? '#fff5e8' : '#f9f9f9'};border-color:${a.risky ? '#cc8800 #886600 #886600 #cc8800' : ''}">
                    <b>${a.risky ? '‚ö†Ô∏è ' : ''}${a.label}</b> (üíº ${a.cost} recurso${a.cost !== 1 ? 's' : ''})<br>
                    <small style="font-weight:normal;color:#555">${a.desc}</small>
                </button>`).join('')}
        </div>

        <!-- LOG -->
        <div style="background:#111;color:#0f0;font-family:'Courier New',monospace;font-size:9px;height:70px;overflow-y:auto;padding:5px;border:1px solid #333;margin-bottom:8px">
            ${logHtml || '<span style="color:#0f0">&gt; Pronto para agir. Escolha com sabedoria.</span>'}
        </div>

        <button class="btn" style="background:#888;color:white;font-size:10px" onclick="autoSimulate2T()">üè≥Ô∏è Desistir e simular automaticamente</button>
    </div>`;
    document.getElementById("candidate-bio").innerHTML = '';
    document.getElementById("congress-bars").innerHTML = '';
    document.getElementById("congress-gov").innerHTML = '';
    document.getElementById("ranking-content").innerHTML = '';
    if(document.getElementById("congress-section")) document.getElementById("congress-section").style.display = 'none';
    if(document.getElementById("ranking-section")) document.getElementById("ranking-section").style.display = 'none';
}

function generateSupportActions() {
    let cdC = candidatesData[supportGame.chosen] || {};
    let gap = supportGame.chosenVotes - supportGame.opponentVotes;
    let turnsLeft = supportGame.maxTurns - supportGame.turn;

    let pool = [
        {
            label: 'üì¢ Com√≠cio de Apoio',
            desc: `Organiza com√≠cio p√∫blico em nome de ${cdC.name||'seu candidato'}. +1% a +3%, mas custo alto e resultado incerto.`,
            cost: 3,
            risky: false,
            fn: () => {
                let r = Math.random();
                if(r > 0.45) {
                    let gain = 1 + Math.random() * 2;
                    supportGame.chosenVotes = Math.min(65, supportGame.chosenVotes + gain);
                    supportGame.opponentVotes = 100 - supportGame.chosenVotes;
                    supportLog(`üì¢ Com√≠cio bem-sucedido! +${gain.toFixed(1)}% para ${cdC.name||'candidato'}.`);
                } else if(r > 0.2) {
                    supportLog(`üì¢ Com√≠cio com p√∫blico fraco. Impacto m√≠nimo.`);
                } else {
                    let loss = 0.5 + Math.random();
                    supportGame.chosenVotes = Math.max(30, supportGame.chosenVotes - loss);
                    supportGame.opponentVotes = 100 - supportGame.chosenVotes;
                    supportGame.scandalRisk++;
                    supportLog(`üì¢ ‚ö†Ô∏è Com√≠cio virou palco de confus√£o! -${loss.toFixed(1)}%. Risco de esc√¢ndalo aumentou.`);
                }
            }
        },
        {
            label: 'üì∞ Nota de Imprensa',
            desc: 'Divulga comunicado da imprensa apoiando o candidato. Efeito moderado e seguro (+0.5% a +1.5%).',
            cost: 1,
            risky: false,
            fn: () => {
                let gain = 0.5 + Math.random();
                supportGame.chosenVotes = Math.min(65, supportGame.chosenVotes + gain);
                supportGame.opponentVotes = 100 - supportGame.chosenVotes;
                supportLog(`üì∞ Nota de imprensa publicada. +${gain.toFixed(1)}%.`);
            }
        },
        {
            label: 'ü§ù Negociar Apoio de L√≠deres Regionais',
            desc: 'Tenta convencer l√≠deres locais a declararem apoio. Alta vari√¢ncia ‚Äî pode ser √≥timo ou desastroso.',
            cost: 2,
            risky: true,
            fn: () => {
                let r = Math.random();
                if(r > 0.55) {
                    let gain = 2 + Math.random() * 2.5;
                    supportGame.chosenVotes = Math.min(65, supportGame.chosenVotes + gain);
                    supportGame.opponentVotes = 100 - supportGame.chosenVotes;
                    supportLog(`ü§ù L√≠deres declararam apoio! +${gain.toFixed(1)}%.`);
                } else if(r > 0.3) {
                    supportLog(`ü§ù Reuni√£o sem resultado. L√≠deres permanecem neutros.`);
                } else {
                    let loss = 1 + Math.random() * 2;
                    supportGame.chosenVotes = Math.max(30, supportGame.chosenVotes - loss);
                    supportGame.opponentVotes = 100 - supportGame.chosenVotes;
                    supportGame.crisisStack++;
                    supportLog(`ü§ù ‚ùå L√≠deres rejeitaram ‚Äî alguns foram para o advers√°rio! -${loss.toFixed(1)}%. Crise +1.`);
                }
            }
        },
        {
            label: 'üí∏ Financiar Campanha do Candidato',
            desc: `Destina recursos financeiros √† campanha de ${cdC.name||'candidato'}. Bom retorno, mas pode gerar suspeita.`,
            cost: 3,
            risky: true,
            fn: () => {
                let r = Math.random();
                if(r > 0.4) {
                    let gain = 1.5 + Math.random() * 1.5;
                    supportGame.chosenVotes = Math.min(65, supportGame.chosenVotes + gain);
                    supportGame.opponentVotes = 100 - supportGame.chosenVotes;
                    supportLog(`üí∏ Financiamento foi bem. Candidato ganhou tra√ß√£o. +${gain.toFixed(1)}%.`);
                } else {
                    supportGame.scandalRisk += 2;
                    supportLog(`üí∏ ‚ö†Ô∏è Financiamento foi investigado pela imprensa! Risco de esc√¢ndalo +2. Efeito neutro.`);
                }
            }
        },
        {
            label: 'üì± Campanha Digital de Apoio',
            desc: 'Lan√ßa campanha nas redes sociais. Pode viralizar ou gerar pol√™mica.',
            cost: 2,
            risky: false,
            fn: () => {
                let r = Math.random();
                if(r > 0.5) {
                    let gain = 1.5 + Math.random() * 2;
                    supportGame.chosenVotes = Math.min(65, supportGame.chosenVotes + gain);
                    supportGame.opponentVotes = 100 - supportGame.chosenVotes;
                    supportLog(`üì± Post viral! +${gain.toFixed(1)}% nas pesquisas.`);
                } else if(r > 0.25) {
                    let gain = 0.5;
                    supportGame.chosenVotes = Math.min(65, supportGame.chosenVotes + gain);
                    supportGame.opponentVotes = 100 - supportGame.chosenVotes;
                    supportLog(`üì± Campanha digital com engajamento moderado. +${gain.toFixed(1)}%.`);
                } else {
                    let loss = 0.5 + Math.random();
                    supportGame.chosenVotes = Math.max(30, supportGame.chosenVotes - loss);
                    supportGame.opponentVotes = 100 - supportGame.chosenVotes;
                    supportGame.scandalRisk++;
                    supportLog(`üì± ‚ö†Ô∏è Post pol√™mico causou rea√ß√£o negativa. -${loss.toFixed(1)}%.`);
                }
            }
        },
        {
            label: 'üéØ Atacar Advers√°rio pela Imprensa',
            desc: 'Divulga cr√≠ticas ao candidato advers√°rio. Alto risco de retalia√ß√£o e crise.',
            cost: 2,
            risky: true,
            fn: () => {
                let r = Math.random();
                if(r > 0.5) {
                    let gain = 2 + Math.random() * 2;
                    let lossOpp = 1 + Math.random();
                    supportGame.chosenVotes = Math.min(65, supportGame.chosenVotes + gain);
                    supportGame.opponentVotes = Math.max(35, supportGame.opponentVotes - lossOpp);
                    let total = supportGame.chosenVotes + supportGame.opponentVotes;
                    supportGame.chosenVotes = (supportGame.chosenVotes/total)*100;
                    supportGame.opponentVotes = 100 - supportGame.chosenVotes;
                    supportLog(`üéØ Ataque foi certeiro! +${gain.toFixed(1)}%, advers√°rio -${lossOpp.toFixed(1)}%.`);
                } else if(r > 0.25) {
                    supportGame.crisisStack++;
                    supportGame.scandalRisk += 2;
                    let loss = 1 + Math.random() * 1.5;
                    supportGame.chosenVotes = Math.max(30, supportGame.chosenVotes - loss);
                    supportGame.opponentVotes = 100 - supportGame.chosenVotes;
                    supportLog(`üéØ ‚ùå Ataque saiu pela culatra! Retalia√ß√£o veio forte. -${loss.toFixed(1)}%. Crise +1, risco +2.`);
                } else {
                    supportGame.crisisStack += 2;
                    let loss = 2 + Math.random() * 2;
                    supportGame.chosenVotes = Math.max(30, supportGame.chosenVotes - loss);
                    supportGame.opponentVotes = 100 - supportGame.chosenVotes;
                    supportLog(`üéØ üí• DESASTRE! Ataque destruiu sua credibilidade. -${loss.toFixed(1)}%. Crise +2!`);
                }
            }
        },
        {
            label: 'üõ°Ô∏è Gerenciar Crise de Imagem',
            desc: 'Tenta reduzir o n√≠vel de crise. Sem efeito nos votos, mas previne cat√°strofes futuras.',
            cost: 2,
            risky: false,
            fn: () => {
                if(supportGame.crisisStack > 0 || supportGame.scandalRisk > 0) {
                    supportGame.crisisStack = Math.max(0, supportGame.crisisStack - 2);
                    supportGame.scandalRisk = Math.max(0, supportGame.scandalRisk - 2);
                    supportLog(`üõ°Ô∏è Crise controlada. N√≠vel de crise e risco reduzidos.`);
                } else {
                    let gain = 0.3;
                    supportGame.chosenVotes = Math.min(65, supportGame.chosenVotes + gain);
                    supportGame.opponentVotes = 100 - supportGame.chosenVotes;
                    supportLog(`üõ°Ô∏è Sem crise ativa. Gest√£o preventiva deu leve b√¥nus de imagem. +${gain.toFixed(1)}%.`);
                }
            }
        },
        {
            label: 'üìä Contratar Pesquisa de Opini√£o',
            desc: 'Descobre onde h√° mais votos indecisos. D√° 1 recurso b√¥nus na pr√≥xima rodada e pequeno ganho.',
            cost: 1,
            risky: false,
            fn: () => {
                supportGame.resources += 1;
                let gain = 0.3 + Math.random() * 0.5;
                supportGame.chosenVotes = Math.min(65, supportGame.chosenVotes + gain);
                supportGame.opponentVotes = 100 - supportGame.chosenVotes;
                supportLog(`üìä Pesquisa revelou regi√µes com indecisos. +${gain.toFixed(1)}% e +1 recurso b√¥nus.`);
            }
        },
        {
            label: 'üé¨ Produ√ß√£o de Conte√∫do Audiovisual',
            desc: 'Financia v√≠deo institucional do candidato. Efeito m√©dio, sem risco.',
            cost: 2,
            risky: false,
            fn: () => {
                let gain = 0.8 + Math.random() * 1.2;
                supportGame.chosenVotes = Math.min(65, supportGame.chosenVotes + gain);
                supportGame.opponentVotes = 100 - supportGame.chosenVotes;
                supportLog(`üé¨ V√≠deo bem produzido aumentou aprova√ß√£o. +${gain.toFixed(1)}%.`);
            }
        },
        {
            label: 'üïµÔ∏è Opera√ß√£o de Intelig√™ncia Eleitoral',
            desc: '‚ö†Ô∏è ALTO RISCO: Vazamento estrat√©gico de informa√ß√µes sens√≠veis. Pode ser devastador ‚Äî em ambos os lados.',
            cost: 4,
            risky: true,
            fn: () => {
                let r = Math.random();
                if(r > 0.6) {
                    let gain = 4 + Math.random() * 3;
                    let lossOpp = 2 + Math.random() * 2;
                    supportGame.chosenVotes = Math.min(65, supportGame.chosenVotes + gain);
                    supportGame.opponentVotes = Math.max(35, supportGame.opponentVotes - lossOpp);
                    let total = supportGame.chosenVotes + supportGame.opponentVotes;
                    supportGame.chosenVotes = (supportGame.chosenVotes/total)*100;
                    supportGame.opponentVotes = 100 - supportGame.chosenVotes;
                    supportLog(`üïµÔ∏è OPERA√á√ÉO BEM-SUCEDIDA! Revela√ß√£o destruiu advers√°rio. +${gain.toFixed(1)}%, oponente -${lossOpp.toFixed(1)}%!`);
                } else {
                    supportGame.crisisStack += 3;
                    supportGame.scandalRisk += 4;
                    let loss = 3 + Math.random() * 3;
                    supportGame.chosenVotes = Math.max(28, supportGame.chosenVotes - loss);
                    supportGame.opponentVotes = 100 - supportGame.chosenVotes;
                    supportLog(`üïµÔ∏è üí• OPERA√á√ÉO EXPOSTA! Esc√¢ndalo massivo. -${loss.toFixed(1)}%. Crise +3, risco +4. Desastre.`);
                }
            }
        },
    ];

    // Selecionar 4 a√ß√µes dispon√≠veis com base na situa√ß√£o
    let available = [...pool];
    if(supportGame.crisisStack < 2 && supportGame.scandalRisk < 3) {
        available = available.filter(a => a.label !== 'üõ°Ô∏è Gerenciar Crise de Imagem');
    }
    // Filtrar por recurso
    // Embaralhar e pegar 5
    available = available.sort(() => Math.random() - 0.5).slice(0, 5);
    // Garantir sempre ao menos 1 a√ß√£o barata (custo 1)
    if(!available.some(a => a.cost <= 1)) {
        available[4] = pool.find(p => p.cost === 1);
    }
    return available;
}

function supportLog(msg) {
    supportGame.log.push(msg);
}

function executeSupportAction(idx) {
    let actions = generateSupportActions();
    let action = actions[idx];
    if(!action) return;
    if(supportGame.resources < action.cost) {
        supportLog(`‚ùå Recursos insuficientes! Precisa de ${action.cost}, tem ${supportGame.resources}.`);
        renderSupportGameplay();
        return;
    }
    supportGame.resources -= action.cost;
    action.fn();

    // Avan√ßar turno
    supportGame.turn++;

    // IA advers√°ria (oponente reage)
    applySupportAITurn();

    // Evento aleat√≥rio de crise (mais frequente se crisisStack ou scandalRisk alto)
    let crisisChance = 0.2 + (supportGame.crisisStack * 0.08) + (supportGame.scandalRisk * 0.06);
    if(Math.random() < crisisChance) {
        triggerSupportCrisisEvent();
    }

    // Ganho de recursos m√≠nimo por rodada (muito escasso)
    supportGame.resources += 1 + (supportGame.turn % 2 === 0 ? 1 : 0);

    // Registrar no hist√≥rico
    supportGame.pollHistory.push({
        turn: supportGame.turn,
        chosen: supportGame.chosenVotes,
        opp: supportGame.opponentVotes
    });

    // Verificar fim
    if(supportGame.turn >= supportGame.maxTurns) {
        endSupportGameplay();
        return;
    }

    // Clamp
    supportGame.chosenVotes = Math.max(28, Math.min(72, supportGame.chosenVotes));
    supportGame.opponentVotes = 100 - supportGame.chosenVotes;

    renderSupportGameplay();
}

function applySupportAITurn() {
    // IA do oponente reage ‚Äî sempre agressiva e tende a recuperar
    let cdO = candidatesData[supportGame.opponent] || {};
    let r = Math.random();
    let aiGain = 0.5 + Math.random() * 1.5;

    if(supportGame.chosenVotes > 52) {
        // Oponente est√° atr√°s ‚Äî reage forte
        aiGain += 0.8 + Math.random() * 1.5;
        supportGame.chosenVotes = Math.max(28, supportGame.chosenVotes - aiGain * 0.6);
        supportGame.opponentVotes = 100 - supportGame.chosenVotes;
        supportLog(`‚öîÔ∏è ${cdO.name||'Advers√°rio'} lan√ßou contra-ofensiva! Ganhou terreno (-${(aiGain*0.6).toFixed(1)}% no seu candidato).`);
    } else if(r > 0.3) {
        supportGame.opponentVotes = Math.min(72, supportGame.opponentVotes + aiGain * 0.4);
        supportGame.chosenVotes = 100 - supportGame.opponentVotes;
        supportLog(`‚öîÔ∏è ${cdO.name||'Advers√°rio'} avan√ßa nas pesquisas. +${(aiGain*0.4).toFixed(1)}%.`);
    } else {
        supportLog(`‚öîÔ∏è ${cdO.name||'Advers√°rio'} mant√©m posi√ß√£o. Sem novidades.`);
    }
}

function triggerSupportCrisisEvent() {
    let events = [
        { msg: 'üí• ESC√ÇNDALO: Apoio seu foi ligado a financiamento irregular! -2% autom√°ticos.', effect: () => { supportGame.chosenVotes = Math.max(28, supportGame.chosenVotes - 2); supportGame.opponentVotes = 100 - supportGame.chosenVotes; supportGame.scandalRisk = Math.max(0, supportGame.scandalRisk - 2); } },
        { msg: 'üóûÔ∏è IMPRENSA hostil publicou reportagem contra seu candidato! -1.5%.', effect: () => { supportGame.chosenVotes = Math.max(28, supportGame.chosenVotes - 1.5); supportGame.opponentVotes = 100 - supportGame.chosenVotes; } },
        { msg: 'üò° ALIADO seu declarou neutralidade publicamente! -1% e moral abalada.', effect: () => { supportGame.chosenVotes = Math.max(28, supportGame.chosenVotes - 1); supportGame.opponentVotes = 100 - supportGame.chosenVotes; supportGame.crisisStack++; } },
        { msg: 'üìâ PESQUISA desfavor√°vel vaza! Candidato perde 2.5% em 24 horas.', effect: () => { supportGame.chosenVotes = Math.max(28, supportGame.chosenVotes - 2.5); supportGame.opponentVotes = 100 - supportGame.chosenVotes; } },
        { msg: '‚ö° DEBATE emergencial: seu candidato saiu mal. -1.8%.', effect: () => { supportGame.chosenVotes = Math.max(28, supportGame.chosenVotes - 1.8); supportGame.opponentVotes = 100 - supportGame.chosenVotes; } },
    ];
    let ev = events[Math.floor(Math.random() * events.length)];
    ev.effect();
    supportGame.crisisStack = Math.max(0, supportGame.crisisStack - 1);
    supportLog(`üö® CRISE: ${ev.msg}`);
}

function endSupportGameplay() {
    let cdC = candidatesData[supportGame.chosen] || {};
    let cdO = candidatesData[supportGame.opponent] || {};
    let won = supportGame.chosenVotes > 50;

    let winner2T = won
        ? {...(supportGame.candA.id === supportGame.chosen ? supportGame.candA : supportGame.candB), votes: supportGame.chosenVotes}
        : {...(supportGame.candA.id === supportGame.opponent ? supportGame.candA : supportGame.candB), votes: supportGame.opponentVotes};
    let loser2T = won
        ? {...(supportGame.candA.id === supportGame.opponent ? supportGame.candA : supportGame.candB), votes: supportGame.opponentVotes}
        : {...(supportGame.candA.id === supportGame.chosen ? supportGame.candA : supportGame.candB), votes: supportGame.chosenVotes};

    winner2T.votes = won ? supportGame.chosenVotes : supportGame.opponentVotes;
    loser2T.votes  = won ? supportGame.opponentVotes : supportGame.chosenVotes;

    let resultColor = won ? '#006600' : '#cc0000';
    let resultEmoji = won ? 'üèÜ' : 'üíÄ';
    let resultTitle = won ? `${resultEmoji} MISS√ÉO CUMPRIDA!` : `${resultEmoji} MISS√ÉO FRACASSADA`;
    let resultMsg = won
        ? `Gra√ßas √† sua articula√ß√£o, <b>${cdC.name||supportGame.chosen}</b> venceu o 2¬∫ turno com <b>${supportGame.chosenVotes.toFixed(1)}%</b>!`
        : `Apesar dos seus esfor√ßos, <b>${cdO.name||supportGame.opponent}</b> venceu com <b>${supportGame.opponentVotes.toFixed(1)}%</b>. ${cdC.name||'Seu candidato'} perdeu.`;

    showEliminatedScreen(winner2T, loser2T, supportGame.playerFinal, supportGame.allSorted, resultTitle, resultMsg, won);
}

function showEliminatedScreen(winner2T, loser2T, playerFinal, allSorted, customTitle, customMsg, supportWon) {
    document.getElementById("game-screen").classList.remove("active");
    document.getElementById("end-screen").classList.add("active");
    let sc = scenariosData[game.scenario] || scenariosData["1994"];
    let playerCd = candidatesData[game.player] || {};
    let w2cd = candidatesData[winner2T.id] || winner2T;
    let l2cd = candidatesData[loser2T.id]  || loser2T;

    // Mostrar se√ß√µes de ranking/congress de volta
    if(document.getElementById("congress-section")) document.getElementById("congress-section").style.display = '';
    if(document.getElementById("ranking-section")) document.getElementById("ranking-section").style.display = '';

    let supportBadge = '';
    if(customTitle) {
        let badgeColor = supportWon ? '#006600' : '#cc0000';
        let badgeText = supportWon ? 'üèÜ Sua articula√ß√£o foi decisiva!' : 'üíÄ Sua miss√£o de apoio falhou.';
        supportBadge = `<div style="background:${badgeColor};color:white;padding:6px 10px;border-radius:3px;margin-bottom:10px;font-weight:bold">${badgeText}</div>`;
    }

    document.getElementById("result-title").innerText = customTitle || "üíÄ ELIMINADO NO 1¬∫ TURNO";
    document.getElementById("result-subtitle").innerText = customTitle ? "RESULTADO DO 2¬∫ TURNO" : "EDI√á√ÉO EXTRA";

    if(customMsg) {
        document.getElementById("result-desc").innerHTML = `${supportBadge}${customMsg}<br><br>
        <small>Voc√™ terminou em ${allSorted.findIndex(c=>c.id===game.player)+1}¬∫ lugar no 1¬∫ turno com <b>${playerFinal.votes.toFixed(1)}%</b>.</small><br><br>
        Resultado final do 2¬∫ turno:
        <table style="margin:10px auto;font-family:'Times New Roman';font-size:15px;border-collapse:collapse">
            <tr><td style="padding:5px;color:${w2cd.color||'#000'}">&nbsp;<b>${winner2T.name} (${w2cd.party||''})</b></td><td style="padding:5px"><b>${winner2T.votes.toFixed(1)}% ‚úÖ</b></td></tr>
            <tr><td style="padding:5px;color:${l2cd.color||'#000'}">&nbsp;${loser2T.name} (${l2cd.party||''})</td><td style="padding:5px">${loser2T.votes.toFixed(1)}%</td></tr>
        </table>`;
    } else {
        document.getElementById("result-desc").innerHTML = `
            <b style="color:#cc0000">${playerCd.name||game.player} n√£o avan√ßou ao 2¬∫ turno.</b><br>
            <small>Voc√™ terminou em ${allSorted.findIndex(c=>c.id===game.player)+1}¬∫ lugar com ${playerFinal.votes.toFixed(1)}% dos votos.</small><br><br>
            O segundo turno foi disputado entre <b>${winner2T.name}</b> e <b>${loser2T.name}</b>:
            <table style="margin:10px auto;font-family:'Times New Roman';font-size:15px;border-collapse:collapse">
                <tr><td style="padding:5px;color:${w2cd.color||'#000'}">&nbsp;<b>${winner2T.name} (${w2cd.party||''})</b></td><td style="padding:5px"><b>${winner2T.votes.toFixed(1)}% ‚úÖ</b></td></tr>
                <tr><td style="padding:5px;color:${l2cd.color||'#000'}">&nbsp;${loser2T.name} (${l2cd.party||''})</td><td style="padding:5px">${loser2T.votes.toFixed(1)}%</td></tr>
            </table>
        `;
    }
    document.getElementById("candidate-bio").innerHTML = `
        <p><b>BRAS√çLIA, ${sc.endYear||game.scenario}.</b> A campanha de ${playerCd.name||game.player} n√£o resistiu ao voto √∫til e n√£o conseguiu construir uma coliga√ß√£o suficientemente ampla para disputar o segundo turno.</p>
        <p><b>${winner2T.name}</b> √© eleito Presidente da Rep√∫blica. ${w2cd.bio||''}</p>
        ${customTitle ? '' : '<p><i>Na pr√≥xima campanha: invista mais em estados piv√¥, construa alian√ßas cedo e n√£o negligencie a energia. Chegar ao 2¬∫ turno √© o primeiro passo para a vit√≥ria.</i></p>'}
    `;
    generateCongress(winner2T);
    let supportNote = customTitle
        ? `<div class="rank-item">${supportWon ? 'üèÜ' : 'üíÄ'} <b>Miss√£o de apoio:</b> ${supportWon ? 'CUMPRIDA' : 'FRACASSADA'}</div>`
        : '';
    document.getElementById('ranking-content').innerHTML = `
        <div style="color:#cc0000;font-weight:bold;font-size:16px;margin-bottom:8px">‚ùå Eliminado no 1¬∫ Turno</div>
        <div class="rank-item">üìä <b>Sua vota√ß√£o:</b> ${playerFinal.votes.toFixed(1)}%</div>
        <div class="rank-item">üèÖ <b>Posi√ß√£o:</b> ${allSorted.findIndex(c=>c.id===game.player)+1}¬∫ de ${allSorted.length}</div>
        <div class="rank-item">ü§ù <b>Coliga√ß√£o montada:</b> ${game.coalition.filter(p=>!p.includes('_seat')).length} partidos</div>
        <div class="rank-item">üéØ <b>Modo:</b> ${game.mode === 'caotico' ? 'Ca√≥tico' : 'Hist√≥rico'}</div>
        ${supportNote}
        <div style="margin-top:10px;font-size:13px;color:#555">Tente novamente e chegue ao 2¬∫ turno!</div>
    `;
}

function finishGame(winner, context) {
    document.getElementById("game-screen").classList.remove("active");
    document.getElementById("end-screen").classList.add("active");
    let isPlayer = winner.id === game.player;
    let cData = candidatesData[winner.id];

    // Check achievements
    if(isPlayer) {
        checkAchievements(winner.id, winner.votes, game.scenario);
        playVictoryFanfare();
    } else {
        playDefeatSound();
    }

    if(game.isGovernor) {
        const g = governorData[currentGovernorKey];
        document.getElementById("result-title").innerText = isPlayer ? `üèÜ ELEITO GOVERNADOR!` : `RESULTADO ‚Äî ${g.stateFullName.toUpperCase()}`;
        document.getElementById("result-desc").innerHTML = `<b>${winner.name} (${cData.party})</b> √© eleito Governador de <b>${g.stateFullName}</b> com <b>${winner.votes.toFixed(1)}%</b>.<br><small>${context}</small>`;
        document.getElementById("candidate-bio").innerHTML = `<p><b>${g.stateFullName}, ${g.year}.</b> ${winner.name} √© o novo governador. ${cData.bio}</p>`;
        document.getElementById("congress-bars").innerHTML = '<b>RESULTADO REGIONAL</b>';
        document.getElementById("congress-gov").innerHTML = `Governador eleito: <b>${winner.name}</b> (${cData.party})`;
        document.getElementById("ranking-content").innerHTML = `
            <div class="rank-item">${isPlayer?'üèÜ':'üìä'} <b>${isPlayer?'ELEITO':'Resultado'}: ${winner.name}</b></div>
            <div class="rank-item">üìä <b>Sua vota√ß√£o:</b> ${(game.candidates.find(c=>c.id===game.player)||{votes:0}).votes.toFixed(1)}%</div>
            <div class="rank-item">üó∫Ô∏è <b>Estado:</b> ${g.stateFullName}</div>`;
        return;
    }

    if(game.isRepVelha) {
        const sc = scenariosData[game.scenario];
        document.getElementById("result-title").innerText = isPlayer ? `üèÜ ELEITO PRESIDENTE!` : `RESULTADO DE ${sc ? sc.year : game.scenario}`;
        document.getElementById("result-desc").innerHTML = `<b>${winner.name} (${cData.party})</b> √© eleito Presidente da Rep√∫blica com <b>${winner.votes.toFixed(1)}%</b> dos votos.<br><small>${context}</small>`;
        document.getElementById("candidate-bio").innerHTML = `<p><b>RIO DE JANEIRO, ${sc ? sc.year : ''}</b> ‚Äî ${cData.bio}</p>`;
        document.getElementById("congress-bars").innerHTML = '<b>RESULTADO DA REP√öBLICA VELHA</b>';
        document.getElementById("congress-gov").innerHTML = `Presidente eleito: <b>${winner.name}</b> ‚Äî Sem 2¬∫ turno, voto masculino direto.`;
        document.getElementById("ranking-content").innerHTML = `<div class="rank-item">${isPlayer?'üèÜ':'üìä'} <b>${winner.name}</b> eleito pelo voto direto</div>`;
        return;
    }

    if(game.isElectoralCollege) {
        let evCounts = getEVCounts();
        let playerEV = evCounts[game.player] || 0;
        let winnerEV = evCounts[winner.id] || 0;
        document.getElementById("result-title").innerText = isPlayer ? `üèÜ ELEITO PRESIDENTE DOS EUA!` : `RESULTADO DAS ELEI√á√ïES EUA 2024`;
        document.getElementById("result-desc").innerHTML = `<b>${winner.name} (${cData.party})</b> vence a elei√ß√£o presidencial com <b>${winnerEV} votos eleitorais</b>.<br><small>${context}</small>`;
        document.getElementById("candidate-bio").innerHTML = `<p><b>WASHINGTON D.C., 2024.</b> ${cData.bio}</p><p>${isPlayer?'Voc√™ fez hist√≥ria!':'Mais sorte na pr√≥xima!'}</p>`;
        let evBar = `<b>RESULTADO DO COL√âGIO ELEITORAL</b><div class="congress-bar" style="height:30px;margin-top:8px">`;
        [...game.candidates].sort((a,b)=>(evCounts[b.id]||0)-(evCounts[a.id]||0)).forEach(c => {
            let ev = evCounts[c.id]||0;
            let pct = ev/538*100;
            evBar += `<div class="congress-segment" style="width:${pct}%;background:${c.color}" title="${c.name}: ${ev} EV">${ev>30?c.name+': '+ev+' EV':ev>15?ev:''}</div>`;
        });
        evBar += '</div>';
        document.getElementById("congress-bars").innerHTML = evBar;
        document.getElementById("congress-gov").innerHTML = `<b>${winner.name}</b>: ${winnerEV} votos eleitorais. ${winnerEV>=270?'‚úÖ Maioria obtida.':'‚ùå Sem maioria ‚Äî elei√ß√£o contestada!'}`;
        document.getElementById("ranking-content").innerHTML = `
            <div class="rank-item">${isPlayer?'üèÜ':'‚ùå'} <b>${isPlayer?'ELEITO':'N√£o eleito'}</b></div>
            <div class="rank-item">üó≥Ô∏è <b>Seus votos eleitorais:</b> ${playerEV}/538</div>
            <div class="rank-item">üá∫üá∏ 270 necess√°rios para vencer</div>`;
        return;
    }

    // International non-EC (Russia etc.)
    if(internationalData[game.scenario]) {
        const sc = internationalData[game.scenario];
        // Parliamentary system: calculate seats
        if(sc.isParliamentary && sc.parliamentSeats) {
            let seats = {};
            let totalVotes = game.candidates.reduce((a,c)=>a+c.votes,0);
            // Threshold of 5% for seat allocation (proportional)
            let qualified = game.candidates.filter(c => c.votes/totalVotes >= 0.05);
            let qualifiedTotal = qualified.reduce((a,c)=>a+c.votes,0);
            qualified.forEach(c => {
                seats[c.id] = Math.round(c.votes/qualifiedTotal * sc.parliamentSeats);
            });
            // Adjust rounding to exactly parliamentSeats
            let seatSum = Object.values(seats).reduce((a,b)=>a+b,0);
            let diff = sc.parliamentSeats - seatSum;
            if(diff !== 0) {
                let topId = Object.entries(seats).sort((a,b)=>b[1]-a[1])[0]?.[0];
                if(topId) seats[topId] = (seats[topId]||0) + diff;
            }
            let majority = sc.majoritySeats || Math.floor(sc.parliamentSeats/2)+1;
            let winnerSeats = seats[winner.id] || 0;
            let hasM = winnerSeats >= majority;
            document.getElementById("result-title").innerText = isPlayer ? `üèÜ ${hasM?'MAIORIA PARLAMENTAR!':'MAIOR BANCADA!'}` : `RESULTADO ‚Äî ${sc.title}`;
            document.getElementById("result-desc").innerHTML = `<b>${winner.name} (${cData.party})</b> obt√©m <b>${winner.votes.toFixed(1)}%</b> dos votos e <b>${winnerSeats} assentos</b> de ${sc.parliamentSeats}.<br>
                ${hasM?'<span style="color:#44aa44">‚úÖ Maioria absoluta conquistada!</span>':'<span style="color:#cc8800">‚ö†Ô∏è Sem maioria absoluta ‚Äî necessita de coaliz√£o.</span>'}<br>
                <small>${context}</small>`;
            document.getElementById("candidate-bio").innerHTML = `<p><b>${sc.year}.</b> ${cData.bio}</p>${isPlayer?`<p><i>Voc√™ ${hasM?'conquistou maioria absoluta':'obteve a maior bancada'} ‚Äî ${hasM?'governo solo garantido!':'precisar√° negociar coaliz√£o.'}</i></p>`:''}`;
            // Parliament bar
            let parBar = `<b>DISTRIBUI√á√ÉO DE ASSENTOS ‚Äî ${sc.parliamentSeats} CADEIRAS (maioria: ${majority})</b>
                <div class="congress-bar" style="height:36px;margin-top:6px">`;
            [...game.candidates].sort((a,b)=>(seats[b.id]||0)-(seats[a.id]||0)).forEach(c => {
                let s = seats[c.id]||0;
                let pct = s/sc.parliamentSeats*100;
                if(pct > 0) parBar += `<div class="congress-segment" style="width:${pct}%;background:${c.color}" title="${c.name}: ${s} assentos (${pct.toFixed(1)}%)">${s>20?c.name.substring(0,6)+': '+s:s>8?s:''}</div>`;
            });
            parBar += `</div><div style="margin-top:4px;font-size:10px;color:#888">Linha dourada = maioria necess√°ria (${majority})</div>`;
            document.getElementById("congress-bars").innerHTML = parBar;
            document.getElementById("congress-gov").innerHTML = game.candidates.map(c=>{
                let s = seats[c.id]||0;
                return `<span style="color:${c.color}">‚ñ† ${c.name}: <b>${s}</b> cadeiras</span>`;
            }).join(' &nbsp;|&nbsp; ');
            document.getElementById("ranking-content").innerHTML = `
                <div class="rank-item">${isPlayer?'üèÜ':'üìä'} <b>${winner.name}</b> ‚Äî ${winnerSeats} assentos</div>
                <div class="rank-item">üó≥Ô∏è <b>Sua vota√ß√£o:</b> ${(game.candidates.find(c=>c.id===game.player)||{votes:0}).votes.toFixed(1)}% | ${seats[game.player]||0} cadeiras</div>
                <div class="rank-item">üèõÔ∏è Maioria necess√°ria: ${majority} cadeiras</div>`;
            return;
        }
        document.getElementById("result-title").innerText = isPlayer ? `üèÜ ELEITO!` : `RESULTADO ‚Äî ${sc.title}`;
        document.getElementById("result-desc").innerHTML = `<b>${winner.name} (${cData.party})</b> vence a elei√ß√£o com <b>${winner.votes.toFixed(1)}%</b> dos votos.<br><small>${context}</small>`;
        document.getElementById("candidate-bio").innerHTML = `<p><b>${sc.year}.</b> ${cData.bio}</p>`;
        document.getElementById("congress-bars").innerHTML = `<b>RESULTADO FINAL</b>`;
        document.getElementById("congress-gov").innerHTML = `Vencedor: <b>${winner.name}</b> (${cData.party}) ‚Äî ${winner.votes.toFixed(1)}%`;
        document.getElementById("ranking-content").innerHTML = `
            <div class="rank-item">${isPlayer?'üèÜ':'üìä'} <b>${winner.name}</b></div>
            <div class="rank-item">üó≥Ô∏è <b>Sua vota√ß√£o:</b> ${(game.candidates.find(c=>c.id===game.player)||{votes:0}).votes.toFixed(1)}%</div>`;
        return;
    }

    let sc = scenariosData[game.scenario] || scenariosData["1994"];
    let cityName = sc.country === 'usa' ? 'WASHINGTON D.C.' : (sc.newsHeader?.includes('Gazeta') ? 'RIO DE JANEIRO' : 'BRAS√çLIA');
    let yearLabel = sc.endYear || sc.year || game.scenario;
    document.getElementById("result-title").innerText = isPlayer ? "VIT√ìRIA HIST√ìRICA!" : "RESULTADO DAS URNAS";
    let subtitle = document.getElementById("result-subtitle");
    if(subtitle) subtitle.innerText = `EDI√á√ÉO EXTRA ‚Äî ${yearLabel}`;
    document.getElementById("result-desc").innerHTML = `<b>${winner.name} (${cData.party})</b> √© eleito Presidente da Rep√∫blica com <b>${winner.votes.toFixed(1)}%</b> dos votos v√°lidos.<br><small>${context}</small>`;
    let coligText = game.coalition.filter(p=>!p.includes('_seat')).length > 0 ? `apoiado pela coliga√ß√£o composta por ${game.coalition.filter(p=>!p.includes('_seat')).join(", ")}` : "em uma campanha solo";
    document.getElementById("candidate-bio").innerHTML = `
        <p><b>${cityName}, ${yearLabel}.</b> Em uma vota√ß√£o que parou o pa√≠s, o candidato <b>${winner.name}</b> confirmou seu favoritismo. 
        Defendendo uma ideologia de <b>${cData.ideologia}</b>, o novo presidente conseguiu vencer as resist√™ncias regionais e consolidar sua base.</p>
        <p>${cData.bio}</p>
        <p>A campanha, ${coligText}, foi marcada por intensos debates sobre o futuro do pa√≠s.</p>
    `;
    generateCongress(winner);
    generateFinalRanking(winner, context);
}

function updateNationalVotes(id, val) {
    let c = game.candidates.find(x => x.id === id);
    if(c) c.votes += val;
    // Clamp all to 0
    game.candidates.forEach(x => { if(x.votes < 0) x.votes = 0; });
    let sum = game.candidates.reduce((a,b) => a + b.votes, 0);
    if(sum > 0) game.candidates.forEach(x => x.votes = (x.votes/sum)*100);
    
    // For Electoral College: propagate to states, but with STRONG lean resistance
    if(game.isElectoralCollege && val !== 0) {
        const sc = internationalData[game.scenario];
        if(!sc || !sc.electoralStates) return;
        let topR = Object.entries(candidatesData).filter(([,c])=>c.side==='D').sort((a,b)=>b[1].start-a[1].start)[0]?.[0];
        let topD = Object.entries(candidatesData).filter(([,c])=>c.side==='E').sort((a,b)=>b[1].start-a[1].start)[0]?.[0];
        sc.electoralStates.forEach(s => {
            if(!game.stateVotes[s.id]) return;
            let resistFactor = s.lean === 'S' ? 0.55 : 0.08;
            if(s.lean === 'R' && id === topD) resistFactor *= 0.4;
            if(s.lean === 'D' && id === topR) resistFactor *= 0.4;
            let stateNoise = (Math.random() * 0.8 - 0.4);
            let stateVal = val * resistFactor + stateNoise;
            game.stateVotes[s.id][id] = Math.max(1, (game.stateVotes[s.id][id]||0) + stateVal);
            let stateSum = Object.values(game.stateVotes[s.id]).reduce((a,b)=>a+b,0);
            if(stateSum > 0) Object.keys(game.stateVotes[s.id]).forEach(k => game.stateVotes[s.id][k] = (game.stateVotes[s.id][k]/stateSum)*100);
        });
        return;
    }
    
    // For Brazilian national elections: propagate to states with trait-aware resistance
    if(!game.isElectoralCollege && !game.isGovernor && !game.isRepVelha && val !== 0 && allStates) {
        let cd = candidatesData[id];
        if(!cd) return;
        allStates.forEach(s => {
            if(!game.stateVotes[s.id] || game.stateVotes[s.id][id] === undefined) return;
            
            // Calculate how well this candidate fits this state ideologically
            let econDiff = Math.abs((cd.econ||0) - (s.econ||0));
            let socDiff  = Math.abs((cd.soc||0)  - (s.soc||0));
            let ideoDiff = econDiff + socDiff;
            
            // Trait factor: if this state strongly favors opposite side, candidate barely gains here
            let traits = stateTraits[s.id] || [];
            let favorableTraits = traits.filter(t => t.side === cd.side).reduce((a,t) => a+t.bonus, 0);
            let oppositeTraits  = traits.filter(t => t.side !== cd.side && t.side !== null).reduce((a,t) => a+t.bonus, 0);
            let traitBalance = favorableTraits - oppositeTraits; // positive = state likes this candidate
            
            // Resistance: states with strong opposite traits barely move for this candidate
            // States with matching ideology move proportionally
            let baseFactor = 0.15;
            if(ideoDiff >= 4) baseFactor = 0.05;       // very different ideology ‚Üí barely propagates
            if(traitBalance >= 5) baseFactor += 0.08;   // state loves this candidate ‚Üí propagates more
            if(traitBalance <= -5) baseFactor *= 0.25;  // state hates this candidate ‚Üí barely moves
            
            // Per-state noise so states don't all move identically
            let noise = (Math.random() * 1.2 - 0.6);
            let stateVal = val * baseFactor + noise;
            game.stateVotes[s.id][id] = Math.max(0.5, (game.stateVotes[s.id][id]||0) + stateVal);
            let stateSum = Object.values(game.stateVotes[s.id]).reduce((a,b)=>a+b,0);
            if(stateSum > 0) Object.keys(game.stateVotes[s.id]).forEach(k => game.stateVotes[s.id][k] = (game.stateVotes[s.id][k]/stateSum)*100);
        });
    }
}

function renderMap() {
    const map = document.getElementById("map-container");
    map.innerHTML = "";
    // Em mobile, aumenta ligeiramente os n√≥s para touch
    const isMobile = window.innerWidth < 900;
    allStates.forEach(s => {
        const div = document.createElement("div");
        div.className = "state-node"; div.id = "node-" + s.id;
        div.style.left = s.x + "%"; div.style.top = s.y + "%";
        if(isMobile) { div.style.width='26px'; div.style.height='18px'; div.style.fontSize='8px'; }
        div.innerText = s.id; div.onclick = () => selectState(s);
        map.appendChild(div);
    });
}

function selectState(s) {
    let votes = Object.entries(game.stateVotes[s.id]).sort((a,b) => b[1] - a[1]);
    let leaderId = votes[0][0];
    let leaderName = candidatesData[leaderId] ? candidatesData[leaderId].name : "Ningu√©m";
    let pivot = isPivotState(s.id);
    let pivotHtml = pivot ? `<div style="background:var(--gold);padding:3px;margin:3px 0;font-size:10px">‚≠ê ESTADO PIV√î: ${pivotStates[s.id].desc}</div>` : '';
    let top3 = votes.slice(0,3).map(([id,v]) => `<span style="color:${candidatesData[id]?candidatesData[id].color:'#000'}">${candidatesData[id]?candidatesData[id].name:id}</span>: ${v.toFixed(1)}%`).join(' | ');
    let year = parseInt(game.scenario)||2000;
    let isOld = game.isRepVelha || year < 1960;

    // Traits badge
    let traits = stateTraits[s.id] || [];
    let traitsHtml = traits.length ? `<div style="margin:3px 0">` + traits.map(t => {
        let color = t.side==='E'?'#cc2200':t.side==='D'?'#2200cc':'#555';
        return `<span class="state-trait-badge" style="background:${color};color:white" title="${t.desc}">${t.label}</span>`;
    }).join('') + '</div>' : '';

    let stateActions = `
        <div style="display:flex;flex-wrap:wrap;gap:3px;margin-top:4px">
            <button class="btn" style="width:auto;font-size:10px" onclick="campaignState('${s.id}',2,4)">üé§ Com√≠cio (2p, R$4M)</button>
            <button class="btn" style="width:auto;font-size:10px" onclick="stateGrasroots('${s.id}')">üö∂ Corpo a Corpo (1p, R$2M)</button>
            ${!isOld ? `<button class="btn" style="width:auto;font-size:10px" onclick="stateAd('${s.id}')">üì∫ An√∫ncio Local (2p, R$6M)</button>` : ''}
            <button class="btn" style="width:auto;font-size:10px" onclick="stateInvestment('${s.id}')">üèóÔ∏è Promessa de Obras (2p, R$8M)</button>
            <button class="btn" style="width:auto;font-size:10px" onclick="stateCoronelismo('${s.id}')">ü§ù Articula√ß√£o Local (3p)</button>
            ${pivot ? `<button class="btn" style="width:auto;font-size:10px;background:#cc9900;color:#000" onclick="statePivotPush('${s.id}')">‚≠ê OFENSIVA PIV√î (4p, R$10M)</button>` : ''}
        </div>`;
    document.getElementById("state-details").innerHTML = `<b>${s.n}</b> (${s.r})${pivot?' <span class="pivot-badge">PIV√î</span>':''}<br><small>${top3}</small>${traitsHtml}${pivotHtml}${stateActions}`;
}

function stateGrasroots(sid) {
    if(game.points < 1 || game.money < 2) { log("Pontos/verba insuficientes."); return; }
    game.points -= 1; game.money -= 2;
    let gain = 5 + Math.random() * 4;
    game.stateVotes[sid][game.player] = (game.stateVotes[sid][game.player]||0) + gain;
    updateNationalVotes(game.player, 0.2);
    log(`üö∂ Corpo a corpo em ${sid}. +${gain.toFixed(1)} pontos locais.`);
    updateUI();
}

function stateAd(sid) {
    if(game.points < 2 || game.money < 6) { log("Pontos/verba insuficientes."); return; }
    game.points -= 2; game.money -= 6;
    let bonus = isPivotState(sid) ? 1.3 : 1.0;
    let gain = 10 * bonus;
    game.stateVotes[sid][game.player] = (game.stateVotes[sid][game.player]||0) + gain;
    updateNationalVotes(game.player, 0.3 * bonus);
    log(`üì∫ An√∫ncio local em ${sid}. +${gain.toFixed(1)} pontos locais.`);
    updateUI();
}

function stateInvestment(sid) {
    if(game.points < 2 || game.money < 8) { log("Pontos/verba insuficientes."); return; }
    game.points -= 2; game.money -= 8;
    let gain = 18 + Math.random() * 8;
    game.stateVotes[sid][game.player] = (game.stateVotes[sid][game.player]||0) + gain;
    updateNationalVotes(game.player, 0.6);
    game.approvals[game.player].app += 2;
    log(`üèóÔ∏è Promessa de obras em ${sid}. +${gain.toFixed(1)} pontos locais e +2 aprova√ß√£o.`);
    updateUI();
}

function stateCoronelismo(sid) {
    if(game.points < 3) { log("Pontos insuficientes."); return; }
    game.points -= 3;
    let roll = Math.random();
    if(roll > 0.3) {
        let gain = 15 + Math.random() * 10;
        game.stateVotes[sid][game.player] = (game.stateVotes[sid][game.player]||0) + gain;
        updateNationalVotes(game.player, 0.4);
        log(`ü§ù Articula√ß√£o local em ${sid} bem-sucedida! +${gain.toFixed(1)} pontos.`);
    } else {
        log(`ü§ù Articula√ß√£o local em ${sid} falhou ‚Äî lideran√ßa local rejeitou a proposta.`);
    }
    updateUI();
}

function statePivotPush(sid) {
    if(!isPivotState(sid)) return;
    if(game.points < 4 || game.money < 10) { log("Pontos/verba insuficientes para ofensiva piv√¥."); return; }
    game.points -= 4; game.money -= 10;
    let gain = 35 + Math.random() * 15;
    game.stateVotes[sid][game.player] = (game.stateVotes[sid][game.player]||0) + gain;
    updateNationalVotes(game.player, 1.5);
    addNews(`OFENSIVA EM ${sid}`, `${candidatesData[game.player].name} lan√ßa campanha massiva no estado piv√¥ ${sid}.`);
    gainSpirit('onda_popular');
    log(`‚≠ê OFENSIVA PIV√î em ${sid}! +${gain.toFixed(1)} pontos locais, +1.5% nacional!`);
    updateUI();
}

function campaignState(sid, p, m) {
    if(game.points < p || game.money < m) return;
    game.points -= p; game.money -= m;
    let bonus = isPivotState(sid) ? 1.5 : 1.0;
    let gain = 14 * bonus;
    game.stateVotes[sid][game.player] = (game.stateVotes[sid][game.player]||0) + gain;
    updateNationalVotes(game.player, 0.6 * bonus);
    let pivotMsg = isPivotState(sid) ? ` (ESTADO PIV√î! B√¥nus x1.5)` : '';
    playSound(440, 80, 'square', 0.15);
    log(`üé§ Com√≠cio em ${sid}.${pivotMsg}`);
    updateUI();
}

function actionTV() { 
    let year = parseInt(game.scenario) || parseInt(currentScenario) || 2000;
    // Rep√∫blica Velha or pre-1965 elections - no TV
    if(game.isRepVelha || year < 1960) {
        log("üì∫ Televis√£o n√£o existe ainda nessa √©poca. Use r√°dio ou com√≠cios!");
        return;
    }
    if(game.points>=6 && game.money>=12) { 
        game.points-=6; game.money-=12; 
        let gain = 4;
        updateNationalVotes(game.player, gain);
        // Boost TV time significantly
        if(game.tvTime) {
            game.tvTime[game.player] = Math.min(95, (game.tvTime[game.player]||0) + 15);
        }
        addNews(`${candidatesData[game.player].name} NO HOR√ÅRIO ELEITORAL`, `Candidato domina a grade de programa√ß√£o com hor√°rio eleitoral amplo.`);
        log(`üì∫ Hor√°rio eleitoral exibido! +${gain.toFixed(1)}% e +15 Tempo de TV.`);
        updateUI(); 
    } else { log("Pontos ou verba insuficientes."); }
}

function actionComicioPra√ßa() {
    // Era-specific rally for old elections
    if(game.points < 3 || game.money < 4) { log("Pontos/verba insuficientes."); return; }
    game.points -= 3; game.money -= 4;
    let gain = 2.5 ;
    updateNationalVotes(game.player, gain);
    log(`üé∫ Com√≠cio na pra√ßa central! +${gain.toFixed(1)}% nas inten√ß√µes.`);
    updateUI();
}

function actionJornal() {
    // Newspaper campaign - always available, more effective in old elections
    let year = parseInt(game.scenario) || 2000;
    if(game.points < 2 || game.money < 5) { log("Pontos/verba insuficientes."); return; }
    game.points -= 2; game.money -= 5;
    let bonus = (game.isRepVelha || year < 1970) ? 1.8 : 1.0;
    let gain = 1.5  * bonus;
    updateNationalVotes(game.player, gain);
    log(`üì∞ An√∫ncio em jornais. +${gain.toFixed(1)}%${bonus > 1 ? ' (era do jornal!)' : ''}.`);
    updateUI();
}
function actionCaixa() { if(game.points>=2) { game.points-=2; game.money+=15; log("Arrecada√ß√£o de fundos conclu√≠da."); updateUI(); } }

function renderAdversaries() {
    const list = document.getElementById("adversary-list");
    if(!game.partyRelations) game.partyRelations = {};
    list.innerHTML = game.candidates.filter(c => c.id !== game.player).map(c => {
        let dist = getIdeologyDistance(game.player, c.id);
        let distLabel = dist <= 2 ? 'üü¢ Pr√≥ximo' : dist <= 4 ? 'üü° M√©dio' : 'üî¥ Distante';
        let rel = game.partyRelations[c.id] || 0;
        let relLabel = rel >= 70 ? 'üíö Ali√°vel' : rel >= 40 ? 'ü§ù Neutro' : '‚ùå Hostil';
        return `<div style="margin-bottom:10px;border:1px solid #ccc;padding:6px;background:#fafafa"><b>${c.name}</b> (${c.party})<br>
        <small>${distLabel} | Rela√ß√£o: ${relLabel} (${rel})</small><br>
        <button class="btn" style="margin-top:4px" onclick="attackCand('${c.id}')">‚öîÔ∏è Atacar (3p)</button>
        <button class="btn" style="background:#e8ffe8;margin-top:2px" onclick="supportCand('${c.id}')">ü§ù Apoiar (2p, +rela√ß√£o)</button>
        </div>`;
    }).join("");
}
function attackCand(id) { 
    if(game.points>=3) { 
        game.points-=3; 
        updateNationalVotes(id, -2.5); 
        if(game.approvals[id]) game.approvals[id].rej = Math.min(95, game.approvals[id].rej + 3);
        if(game.approvals[game.player]) game.approvals[game.player].rej = Math.min(95, game.approvals[game.player].rej + 1);
        if(!game.partyRelations) game.partyRelations = {};
        game.partyRelations[id] = Math.max(-100, (game.partyRelations[id]||0) - 20);
        log(`‚öîÔ∏è Ataque contra ${id} disparado. Rela√ß√£o com ${id}: ${game.partyRelations[id]}.`); 
        updateUI(); 
    } else { log("Pontos insuficientes (3p)."); }
}
function supportCand(id) {
    if(!game.partyRelations) game.partyRelations = {};
    if(game.points < 2) { log("Pontos insuficientes (2p)."); return; }
    game.points -= 2;
    updateNationalVotes(id, 1);
    updateNationalVotes(game.player, 0.8);
    game.partyRelations[id] = Math.min(100, (game.partyRelations[id]||0) + 15);
    let rel = game.partyRelations[id];
    let msg = rel >= 70 ? ' ‚úÖ Boa rela√ß√£o estabelecida!' : '';
    log(`ü§ù Voc√™ apoiou ${id}. +1% para ${id}, +0.8% para voc√™. Rela√ß√£o: ${rel}.${msg}`);
    updateUI();
}

// === SISTEMA DE FADIGA ===
// === NOVAS A√á√ïES ===
function actionRadio() {
    if(game.points < 3 || game.money < 6) { log("Pontos/verba insuficientes."); return; }
    game.points -= 3; game.money -= 6;
    let gain = 2.0 ;
    updateNationalVotes(game.player, gain);
    log(`üìª Inser√ß√µes de r√°dio veiculadas. +${gain.toFixed(1)}% nas pesquisas.`);
    updateUI();
}

function actionEntrevista() {
    if(game.points < 4) { log("Pontos insuficientes."); return; }
    game.points -= 4;
    // Entrevista pode ser boa ou ruim dependendo de performance
    let roll = Math.random();
    if(roll > 0.6) {
        let gain = 3.0 ;
        updateNationalVotes(game.player, gain);
        game.approvals[game.player].app += 5;
        addNews(`ENTREVISTA DE ${candidatesData[game.player].name}`, "Candidato se sai bem e impressiona o p√∫blico.");
        log(`üéôÔ∏è Entrevista excelente! +${gain.toFixed(1)}%.`);
    } else if(roll > 0.3) {
        let gain = 1.0 ;
        updateNationalVotes(game.player, gain);
        log(`üéôÔ∏è Entrevista razo√°vel. +${gain.toFixed(1)}%.`);
    } else {
        updateNationalVotes(game.player, -1.5);
        game.approvals[game.player].rej += 4;
        addNews(`GAFE DE ${candidatesData[game.player].name}`, "Candidato comete erro em entrevista ao vivo.");
        log(`üéôÔ∏è Entrevista problem√°tica! -1.5%.`);
    }
    updateUI();
}

function actionCaixaEmpresarial() {
    if(game.points < 2) { log("Pontos insuficientes."); return; }
    game.points -= 2;
    let roll = Math.random();
    if(roll > 0.7) {
        game.money += 30;
        log(`üè≠ Empres√°rios doam R$30M! Mas pode gerar suspeitas...`);
        // pequena chance de esc√¢ndalo
        if(Math.random() > 0.6) {
            game.scandalLevels[game.player] = Math.min(10, (game.scandalLevels[game.player]||0) + 1);
            addNews(`FINANCIAMENTO EMPRESARIAL`, `Doa√ß√£o ao ${candidatesData[game.player].name} levanta quest√µes sobre conflito de interesses.`);
        }
    } else {
        game.money += 18;
        log(`üè≠ Arrecada√ß√£o empresarial: R$18M.`);
    }
    updateUI();
}

function actionCaixaSindical() {
    if(game.points < 2) { log("Pontos insuficientes."); return; }
    let playerSide = candidatesData[game.player].side;
    game.points -= 2;
    if(playerSide === 'D') {
        game.money += 8;
        game.approvals[game.player].rej += 3;
        log(`‚öíÔ∏è Sindicatos desconfiaram. R$8M apenas.`);
    } else {
        game.money += 20;
        updateNationalVotes(game.player, 1);
        log(`‚öíÔ∏è Sindicatos abra√ßaram a causa! R$20M + +1%.`);
    }
    updateUI();
}

function actionCaixaPopular() {
    if(game.points < 1) { log("Pontos insuficientes."); return; }
    game.points -= 1;
    game.money += 8;
    updateNationalVotes(game.player, 0.5);
    game.approvals[game.player].app += 2;
    log(`üèòÔ∏è Vaquinha popular arrecadou R$8M. +0.5% org√¢nico.`);
    updateUI();
}

function actionRedesSociais() {
    if(game.points < 2 || game.money < 4) { log("Pontos/verba insuficientes."); return; }
    game.points -= 2; game.money -= 4;
    let roll = Math.random();
    if(roll > 0.5) {
        let gain = (2.5 + Math.random()*2) ;
        updateNationalVotes(game.player, gain);
        addNews(`VIRAL: ${candidatesData[game.player].name}`, `Post do candidato viraliza com milh√µes de compartilhamentos.`);
        log(`üì± Conte√∫do viral! +${gain.toFixed(1)}%.`);
    } else if(roll > 0.2) {
        let gain = 1.2 ;
        updateNationalVotes(game.player, gain);
        log(`üì± Engajamento nas redes. +${gain.toFixed(1)}%.`);
    } else {
        updateNationalVotes(game.player, -0.5);
        addNews(`POL√äMICA: ${candidatesData[game.player].name}`, `Post controverso nas redes gera cr√≠ticas e rea√ß√£o negativa.`);
        log(`üì± Post pol√™mico! -0.5%.`);
    }
    updateUI();
}

function actionPanfleto() {
    if(game.points < 1 || game.money < 2) { log("Pontos/verba insuficientes."); return; }
    game.points -= 1; game.money -= 2;
    let gain = 0.8 ;
    updateNationalVotes(game.player, gain);
    log(`üìã Panfletagem! +${gain.toFixed(1)}%.`);
    updateUI();
}

function actionLiveStream() {
    if(game.points < 3) { log("Pontos insuficientes."); return; }
    game.points -= 3;
    let roll = Math.random();
    if(roll > 0.55) {
        let gain = (2.5 + Math.random()*2) ;
        updateNationalVotes(game.player, gain);
        addNews(`LIVE DE ${candidatesData[game.player].name}`, "Live bate recorde de audi√™ncia. Candidato interage com cidad√£os.");
        gainSpirit('momentum_midias');
        log(`üé¨ Live viral! +${gain.toFixed(1)}%. Esp√≠rito Momentum ativado!`);
    } else if(roll > 0.25) {
        let gain = 1.5 ;
        updateNationalVotes(game.player, gain);
        log(`üé¨ Live com boa audi√™ncia. +${gain.toFixed(1)}%.`);
    } else {
        updateNationalVotes(game.player, -0.5);
        addNews(`LIVE DE ${candidatesData[game.player].name} TEM PROBLEMAS`, "Problemas t√©cnicos e respostas imprecisas causam constrangimento.");
        log(`üé¨ Live problem√°tica. -0.5%.`);
    }
    updateUI();
}

function actionPodcast() {
    if(game.points < 2) { log("Pontos insuficientes."); return; }
    game.points -= 2;
    let gain = (1.2 + Math.random()*1.5) ;
    updateNationalVotes(game.player, gain);
    game.approvals[game.player].app += 3;
    log(`üéß Podcast. +${gain.toFixed(1)}% e aprova√ß√£o +3.`);
    updateUI();
}

function actionEventoGala() {
    if(game.points < 3 || game.money < 5) { log("Pontos/verba insuficientes."); return; }
    game.points -= 3; game.money -= 5;
    let raised = 35 + Math.floor(Math.random() * 15);
    game.money += raised;
    let roll = Math.random();
    if(roll > 0.7) {
        game.scandalLevels[game.player] = Math.min(10, (game.scandalLevels[game.player]||0) + 1);
        addNews(`GALA DE ${candidatesData[game.player].name}`, `Evento de gala arrecada fortunas. Cr√≠ticos falam em elitismo.`);
        log(`üé© Gala! +R$${raised}M, mas suspeita de elitismo.`);
    } else {
        log(`üé© Jantar de gala! +R$${raised}M.`);
    }
    updateUI();
}

function openPartyManagement() {
    if(game.points < 2) { log("Pontos insuficientes (2p)."); return; }
    game.points -= 2;
    game.lastPartyActionTurn = game.turn; // Track last time player managed party
    let playerC = candidatesData[game.player];
    let pw = game.partyWings;
    let modW = Math.round(pw.moderate);
    let radW = Math.round(pw.radical);
    let cenW = Math.round(pw.centrao);
    
    // Warnings
    let warnings = '';
    if(radW > 55) warnings += '<div style="color:#cc0000;font-weight:bold;margin:3px 0">‚ö†Ô∏è ALA RADICAL DOMINANTE: risco de racha catastr√≥fico!</div>';
    if(cenW > 50) warnings += '<div style="color:#cc6600;font-weight:bold;margin:3px 0">‚ö†Ô∏è CENTR√ÉO EXCESSIVO: verba vazando por turno!</div>';
    if(modW > 65) warnings += '<div style="color:#0000aa;font-weight:bold;margin:3px 0">‚ö†Ô∏è PARTIDO MUITO MODERADO: base radical migrando para outros.</div>';
    
    // Coalition betrayal check
    let coalitionInfo = '';
    if(game.coalition.length > 0) {
        let betrayableParties = game.coalition.filter(p => !p.includes('_seat'));
        if(betrayableParties.length > 0) {
            coalitionInfo = `<div style="background:#fff8e8;border:1px solid #cc9900;padding:6px;margin:4px 0;font-size:10px">
                <b>ü§ù Coliga√ß√£o atual:</b> ${betrayableParties.join(', ')}<br>
                <small style="color:#888">Partidos coligados podem trair se o centr√£o for muito negligenciado ou se voc√™ radicalizar demais.</small>
            </div>`;
        }
    }
    
    let html = `<div style="font-size:11px">
        <b>üèõÔ∏è GERENCIAMENTO DO PARTIDO: ${playerC.party}</b><hr>
        <div style="background:#f0f0f0;padding:6px;margin:4px 0">
            <b>Alas do Partido:</b>
            <div style="margin:6px 0">
                <div style="display:flex;align-items:center;gap:6px;margin:3px 0">
                    <span style="width:90px;font-size:10px;text-align:right">Ala Moderada</span>
                    <div style="flex:1;height:10px;background:#ddd;border:1px solid #aaa;position:relative">
                        <div style="width:${modW}%;height:100%;background:#3366ff;max-width:100%"></div>
                    </div>
                    <span style="font-size:10px;width:30px">${modW}%</span>
                </div>
                <div style="display:flex;align-items:center;gap:6px;margin:3px 0">
                    <span style="width:90px;font-size:10px;text-align:right">Ala Radical</span>
                    <div style="flex:1;height:10px;background:#ddd;border:1px solid #aaa;position:relative">
                        <div style="width:${Math.min(100,radW)}%;height:100%;background:#cc0000;max-width:100%"></div>
                    </div>
                    <span style="font-size:10px;width:30px">${radW}%</span>
                </div>
                <div style="display:flex;align-items:center;gap:6px;margin:3px 0">
                    <span style="width:90px;font-size:10px;text-align:right">Centr√£o</span>
                    <div style="flex:1;height:10px;background:#ddd;border:1px solid #aaa;position:relative">
                        <div style="width:${Math.min(100,cenW)}%;height:100%;background:#888;max-width:100%"></div>
                    </div>
                    <span style="font-size:10px;width:30px">${cenW}%</span>
                </div>
            </div>
            ${warnings}
        </div>
        ${coalitionInfo}
        <div style="background:#fffde8;border:1px solid #cc9900;padding:6px;margin:4px 0;font-size:10px">
            <b>‚ö†Ô∏è Consequ√™ncias das Alas:</b><br>
            üî¥ <b>Radical > 60%</b> ‚Üí Risco de racha catastr√≥fico (-popularidade dr√°stica)<br>
            ‚¨õ <b>Centr√£o > 55%</b> ‚Üí Perde R$2M/turno em favores<br>
            üîµ <b>Moderados > 65%</b> ‚Üí Base radical abandona e migra a rivais<br>
            <b>Qualquer consequ√™ncia vem com aviso pop-up!</b>
        </div>
        <b>A√ß√µes dispon√≠veis:</b>
    </div>`;
    let btns = `
        <button class="btn" onclick="partyAction('complacentar')">ü§ù Complacentar Centr√£o (+R$10M, +centr√£o, risco de verba/turno)</button>
        <button class="btn" onclick="partyAction('radicalizar')">üî• Radicalizar Partido (+ala radical ${radW}%‚Üí${Math.min(100,radW+10)}%, risco de racha)</button>
        <button class="btn" onclick="partyAction('moderar')">üïäÔ∏è Moderar Partido (+aprova√ß√£o, -radical ${radW}%‚Üí${Math.max(0,radW-8)}%)</button>
        <button class="btn" onclick="partyAction('unificar')">üí™ Reuni√£o de Unidade (+2p, reequilibra alas)</button>
        <button class="btn" onclick="partyAction('fortalecer_centrao')">üèõÔ∏è Fortalecer Centr√£o (-radical, +recursos, custo R$2M)</button>
        <button class="btn" onclick="partyAction('pressionar_coligados')">üó£Ô∏è Pressionar Coligados (prevenir trai√ß√£o, 2p)</button>
        <button class="btn" onclick="partyAction('limpar_corrupcao')">üßπ Limpar Corrup√ß√£o Interna (-esc√¢ndalo, 3p)</button>
        <button class="btn" onclick="closeModal()">Fechar</button>
    `;
    showModal('üèõÔ∏è GERENCIAMENTO DO PARTIDO', html, btns);
    updateUI();
}

function partyAction(type) {
    closeModal();
    if(!game.partyWings) game.partyWings = { moderate: 40, radical: 25, centrao: 35 };
    let pw = game.partyWings;
    let playerC = candidatesData[game.player];
    
    if(type === 'complacentar') {
        game.money += 10;
        pw.centrao = Math.min(65, pw.centrao + 6);
        pw.moderate = Math.max(5, pw.moderate - 3);
        pw.radical = Math.max(5, pw.radical - 3);
        // CONSEQU√äNCIA: Muito centr√£o faz perder verba por turno
        if(!game.centraoDebt) game.centraoDebt = 0;
        game.centraoDebt += 2; // paga R$2M por turno pelos pr√≥ximos turnos
        if(Math.random() > 0.5) {
            game.scandalLevels[game.player] = Math.min(10, (game.scandalLevels[game.player]||0)+1);
            addNews(`CENTR√ÉO COBRADO`, `Aliados do ${playerC.party} exigem cargos e benef√≠cios. Verbas sendo distribu√≠das.`);
        }
        queueEvent('ü§ù CENTR√ÉO COMPLACENTE', `O centr√£o aceitou sua oferta e liberou R$10M agora! Mas ficar√° cobrando R$2M por turno pelos pr√≥ximos turnos. Centr√£o agora em ${Math.round(pw.centrao)}%. Cuidado: centr√£o > 55% drena sua campanha!`, `<button class="btn" onclick="closeModal()">Entendido</button>`);
        log(`ü§ù Centr√£o complacente. +R$10M agora, mas -R$2M/turno pelos pr√≥ximos turnos. Centr√£o: ${Math.round(pw.centrao)}%.`);
    } else if(type === 'radicalizar') {
        pw.radical = Math.min(75, pw.radical + 12);
        pw.moderate = Math.max(5, pw.moderate - 8);
        pw.centrao = Math.max(5, pw.centrao - 4);
        updateNationalVotes(game.player, 1.5);
        updateRadicalization(12);
        
        // CONSEQU√äNCIA SEVERA: Se ala radical > 60%, risco de racha catastr√≥fico
        if(pw.radical > 60 && Math.random() > 0.4) {
            let lossVotes = 3 + Math.random() * 3;
            updateNationalVotes(game.player, -lossVotes);
            game.scandalLevels[game.player] = Math.min(10, (game.scandalLevels[game.player]||0)+2);
            game.approvals[game.player].rej += 8;
            queueEvent('üí• RACHA CATASTR√ìFICO NO PARTIDO!', `Radicalismo extremo fragmentou o partido! Candidatos dissidentes anunciaram candidatura pr√≥pria. Voc√™ perdeu ${lossVotes.toFixed(1)}% nas pesquisas e a rejei√ß√£o subiu 8 pontos. Ala radical agora em ${Math.round(pw.radical)}%. Considere moderar o partido urgentemente!`, `<button class="btn" onclick="closeModal()">Grave!</button>`);
            addNews(`üí• RACHA NO ${playerC.party}!`, `Radicalismo extremo fragmenta o partido. Candidatos dissidentes anunciam candidatura pr√≥pria.`);
            log(`üí• RACHA CATASTR√ìFICO! Ala moderada abandonou o partido! -${lossVotes.toFixed(1)}%. Rejei√ß√£o +8.`);
        } else if(Math.random() > 0.6) {
            updateNationalVotes(game.player, -1);
            queueEvent('üî• TENS√ÉO INTERNA ‚Äî RACHA MODERADO', `A radicaliza√ß√£o para ${Math.round(pw.radical)}% causou uma divis√£o: moderados amea√ßam romper com a candidatura. -1% nas pesquisas. Mais radicaliza√ß√µes podem provocar um racha catastr√≥fico!`, `<button class="btn" onclick="closeModal()">Entendido</button>`);
            addNews(`RACHA NO ${playerC.party}`, `Moderados rompem com a candidatura ap√≥s radicaliza√ß√£o do discurso.`);
            log(`üî• Partido radicalizado ‚Äî racha moderado. Radical: ${Math.round(pw.radical)}%.`);
        } else {
            // SEMPRE mostra popup mesmo sem racha
            queueEvent('üî• PARTIDO RADICALIZADO', `A ala radical cresceu para ${Math.round(pw.radical)}% do partido. +1.5% nas pesquisas, mas a radicaliza√ß√£o est√° aumentando. Cuidado: acima de 60%, o risco de racha catastr√≥fico √© real!`, `<button class="btn" onclick="closeModal()">Entendido</button>`);
            log(`üî• Partido radicalizado! Radical: ${Math.round(pw.radical)}%. Risco de racha cresce.`);
        }
    } else if(type === 'moderar') {
        pw.radical = Math.max(5, pw.radical - 8);
        pw.moderate = Math.min(70, pw.moderate + 6);
        pw.centrao = Math.max(10, pw.centrao + 2);
        game.approvals[game.player].app += 5;
        game.approvals[game.player].rej -= 3;
        updateNationalVotes(game.player, 0.5);
        updateRadicalization(-8);
        // CONSEQU√äNCIA: Modera√ß√£o pode alienar base radical (-votos da base)
        if(pw.radical < 15 && Math.random() > 0.5) {
            updateNationalVotes(game.player, -1);
            queueEvent('üïäÔ∏è BASE RADICAL DESCONTENTE', `A modera√ß√£o do partido decepcionou sua base mais fiel. Militantes radicais amea√ßam migrar para candidatos mais alinhados. -1% nas pesquisas. Moderada: ${Math.round(pw.moderate)}%.`, `<button class="btn" onclick="closeModal()">Entendido</button>`);
            log(`üïäÔ∏è Moderado ‚Äî mas base radical decepcionada. -1%. Moderada: ${Math.round(pw.moderate)}%.`);
        } else {
            queueEvent('üïäÔ∏è PARTIDO MODERADO', `A modera√ß√£o do partido surtiu efeito. Eleitores de centro se aproximam e a aprova√ß√£o subiu. +0.5% nas pesquisas e +5 aprova√ß√£o. Moderada: ${Math.round(pw.moderate)}%.`, `<button class="btn" onclick="closeModal()">√ìtimo!</button>`);
            log(`üïäÔ∏è Partido moderado. +aprova√ß√£o. Moderada: ${Math.round(pw.moderate)}%, Radical: ${Math.round(pw.radical)}%.`);
        }
    } else if(type === 'unificar') {
        game.points += 2;
        let avg = (pw.moderate + pw.radical + pw.centrao) / 3;
        pw.moderate = pw.moderate * 0.7 + avg * 0.3;
        pw.radical = pw.radical * 0.7 + avg * 0.3;
        pw.centrao = 100 - pw.moderate - pw.radical;
        gainSpirit('maquina_partido');
        queueEvent('üí™ REUNI√ÉO DE UNIDADE PARTID√ÅRIA', `A reuni√£o de unidade foi um sucesso! As alas internas reequilibraram e a m√°quina do partido voltou a funcionar com efici√™ncia. +2p e esp√≠rito "M√°quina do Partido" ativado!`, `<button class="btn" onclick="closeModal()">√ìtimo!</button>`);
        log(`üí™ Reuni√£o de unidade. +2p. Esp√≠rito M√°quina ativado! Alas reequilibradas.`);
    } else if(type === 'pressionar_coligados') {
        if(game.points < 2) { log("Pontos insuficientes (2p)."); updateUI(); return; }
        game.points -= 2;
        if(game.coalition.length === 0) {
            queueEvent('üó£Ô∏è SEM COLIGADOS', `Voc√™ n√£o tem partidos coligados no momento. Negocie alian√ßas primeiro para poder pressionar coligados.`, `<button class="btn" onclick="closeModal()">Entendido</button>`);
            log('Nenhum partido coligado para pressionar.');
        } else {
            // Reset betrayal risk
            game.coalitionBetrayalRisk = Math.max(0, (game.coalitionBetrayalRisk||0) - 30);
            let coName = game.coalition.filter(p=>!p.includes('_seat'))[0] || 'aliados';
            queueEvent('üó£Ô∏è PRESS√ÉO NA COLIGA√á√ÉO', `Voc√™ pressionou os coligados. O ${coName} e aliados reafirmaram o compromisso. Risco de trai√ß√£o reduzido em 30 pontos!`, `<button class="btn" onclick="closeModal()">Entendido</button>`);
            log('üó£Ô∏è Coligados pressionados. Risco de trai√ß√£o reduzido.');
        }
    } else if(type === 'limpar_corrupcao') {
        if(game.points < 3) { log("Pontos insuficientes (3p)."); updateUI(); return; }
        game.points -= 3;
        let myScandal = game.scandalLevels[game.player]||0;
        let reduction = Math.min(myScandal, 2);
        game.scandalLevels[game.player] = Math.max(0, myScandal - reduction);
        game.approvals[game.player].rej = Math.max(0, game.approvals[game.player].rej - 4);
        updateNationalVotes(game.player, 0.5);
        queueEvent('üßπ LIMPEZA INTERNA', `Sua campanha identificou e afastou elementos corruptos. Esc√¢ndalo reduzido em ${reduction} pontos, rejei√ß√£o -4. +0.5% nas pesquisas!`, `<button class="btn" onclick="closeModal()">√ìtimo!</button>`);
        log(`üßπ Corrup√ß√£o interna eliminada. Esc√¢ndalo: ${game.scandalLevels[game.player]}/10. +0.5%.`);
    } else if(type === 'fortalecer_centrao') {
        pw.centrao = Math.min(60, pw.centrao + 8);
        pw.radical = Math.max(5, pw.radical - 8);
        // CONSEQU√äNCIA: Fortalecer centr√£o demais = perda de verbas por favores
        game.money = Math.max(0, game.money - 5);
        game.money += 3; // net -2 mas recebe de aliados
        game.approvals[game.player].rej = Math.max(0, game.approvals[game.player].rej - 2);
        if(pw.centrao >= 50) {
            queueEvent('üèõÔ∏è CENTR√ÉO FORTALECIDO ‚Äî ALERTA!', `O centr√£o cresceu para ${Math.round(pw.centrao)}% do partido! Eles est√£o cobrando favores ‚Äî custo l√≠quido de R$2M. Cuidado: se o centr√£o ultrapassar 55%, come√ßar√° a drenar sua campanha automaticamente todo turno!`, `<button class="btn" onclick="closeModal()">Entendido</button>`);
        } else {
            queueEvent('üèõÔ∏è CENTR√ÉO FORTALECIDO', `Voc√™ fortaleceu o centr√£o para ${Math.round(pw.centrao)}% do partido. Isso reduziu a rejei√ß√£o, mas custou R$2M l√≠quido em favores. O centr√£o √© poderoso ‚Äî use com modera√ß√£o.`, `<button class="btn" onclick="closeModal()">Ok</button>`);
        }
        log(`üèõÔ∏è Centr√£o fortalecido. Centr√£o: ${Math.round(pw.centrao)}%. Custo de favores: R$2M l√≠quido.`);
    }
    // Normalize to 100%
    let total = pw.moderate + pw.radical + pw.centrao;
    pw.moderate = (pw.moderate/total)*100;
    pw.radical = (pw.radical/total)*100;
    pw.centrao = (pw.centrao/total)*100;
    updateUI();
}



// === SISTEMA DE DEBATE AO VIVO ===
// ============================================================
// SISTEMA DE DEBATES ‚Äî TAB DEDICADA
// ============================================================
function renderDebateTab() {
    let statsDiv = document.getElementById('debate-stats');
    let actionsDiv = document.getElementById('debate-actions');
    if(!statsDiv || !actionsDiv) return;
    
    let dWon = game.debatesWon || 0;
    let dTotal = game.debatesTotal || 0;
    let dLost = dTotal - dWon;
    
    let playerC = candidatesData[game.player];
    let rivals = game.candidates.filter(c => c.id !== game.player).sort((a,b) => b.votes - a.votes);
    let mainRival = rivals[0];
    
    statsDiv.innerHTML = `
        <b>üìä Hist√≥rico de Debates:</b> ${dWon}/${dTotal} vit√≥rias
        ${dTotal > 0 ? `<div style="width:100%;height:6px;background:#ddd;margin:3px 0"><div style="width:${(dWon/dTotal*100).toFixed(0)}%;height:100%;background:#00aa00"></div></div>` : ''}
        <span style="font-size:9px;color:#666">Debates impactam diretamente as pesquisas nacionais. Use sabiamente!</span>`;
    
    // Check if debate is cooling down
    if(game.debateCooldown && game.debateCooldown > 0) {
        actionsDiv.innerHTML = `<div style="background:#fff0e0;border:1px solid #cc8800;padding:8px;border-radius:3px">
            ‚è≥ <b>Pr√≥ximo debate dispon√≠vel em ${game.debateCooldown} turno(s)</b><br>
            <small>Debates frequentes s√£o menos eficazes. Prepare-se para o pr√≥ximo!</small>
        </div>
        <hr>
        <b>üéØ Prepara√ß√£o para pr√≥ximo debate (opcional):</b>
        <div style="display:flex;flex-direction:column;gap:4px;margin-top:6px">
            <button class="btn" onclick="debatePrepAttack()" style="text-align:left;padding:6px">
                ‚öîÔ∏è <b>Estudar pontos fracos do rival</b> (1p)<br><small style="font-weight:normal;color:#666">Prepara ataque certeiro. +30% chance de acerto no pr√≥ximo debate.</small>
            </button>
            <button class="btn" onclick="debatePrepDefend()" style="text-align:left;padding:6px">
                üõ°Ô∏è <b>Treinar respostas defensivas</b> (1p)<br><small style="font-weight:normal;color:#666">Reduz chances de sair mal sa√≠do. -40% chance de errar no pr√≥ximo debate.</small>
            </button>
        </div>
        ${game.debatePrep ? `<div style="background:#e0ffe0;border:1px solid #00aa00;padding:4px;margin-top:6px;font-size:10px">‚úÖ Prepara√ß√£o ativa: ${game.debatePrep === 'attack' ? '‚öîÔ∏è Ataque preparado (+30% acerto)' : 'üõ°Ô∏è Defesa preparada (-40% erro)'}</div>` : ''}`;
    } else {
        actionsDiv.innerHTML = `<b>üé§ Iniciar Debate Agora:</b>
        <div style="font-size:10px;color:#888;margin-bottom:6px">Rival principal: <b style="color:${mainRival ? (candidatesData[mainRival.id]||{}).color:'#000'}">${mainRival ? mainRival.name : 'N/A'}</b></div>
        <div style="display:flex;flex-direction:column;gap:4px">
            <button class="btn" onclick="triggerDebateFromTab('attack')" style="text-align:left;padding:6px;background:#ffe8e8">
                ‚öîÔ∏è <b>Debate Agressivo</b> (0p)<br><small style="font-weight:normal">Alto risco, alto retorno. Ataque direto ao rival. Pode dar +5% ou -2%.</small>
            </button>
            <button class="btn" onclick="triggerDebateFromTab('program')" style="text-align:left;padding:6px">
                üìã <b>Apresentar Programa</b> (0p)<br><small style="font-weight:normal">Seguro. +aprova√ß√£o e ganho moderado garantido (+2% a +3%).</small>
            </button>
            <button class="btn" onclick="triggerDebateFromTab('moderate')" style="text-align:left;padding:6px;background:#e8f0ff">
                üòå <b>Postura Conciliadora</b> (0p)<br><small style="font-weight:normal">Menos votos, mas reduz rejei√ß√£o e atrai indecisos.</small>
            </button>
            <button class="btn" onclick="triggerDebateFromTab('emotional')" style="text-align:left;padding:6px;background:#fff8e8">
                üé≠ <b>Apelo Emocional</b> (0p)<br><small style="font-weight:normal">Aposta na emo√ß√£o. Alta vari√¢ncia: pode ser hist√≥rico ou fiasco.</small>
            </button>
            <button class="btn" onclick="triggerDebateFromTab('economy')" style="text-align:left;padding:6px;background:#e8ffe8">
                üí∞ <b>Debate Econ√¥mico</b> (0p, R$2M) <br><small style="font-weight:normal">Contrate especialistas. Demonstra compet√™ncia t√©cnica. B√¥nus em crises.</small>
            </button>
            <button class="btn" style="background:#ddd" onclick="skipDebateTab()">‚è≠Ô∏è Pular Debate (sem pontos)</button>
        </div>
        ${game.debatePrep ? `<div style="background:#e0ffe0;border:1px solid #00aa00;padding:4px;margin-top:6px;font-size:10px">‚úÖ Prepara√ß√£o ativa: ${game.debatePrep === 'attack' ? '‚öîÔ∏è Ataque preparado (+30% acerto)' : 'üõ°Ô∏è Defesa preparada (-40% erro)'}</div>` : ''}`;
    }
}

function debatePrepAttack() {
    if(game.points < 1) { log("Sem pontos para prepara√ß√£o."); return; }
    game.points -= 1;
    game.debatePrep = 'attack';
    log("‚öîÔ∏è Prepara√ß√£o ofensiva: pr√≥ximo debate ter√° +30% de chance de acerto.");
    renderDebateTab();
    updateUI();
}

function debatePrepDefend() {
    if(game.points < 1) { log("Sem pontos para prepara√ß√£o."); return; }
    game.points -= 1;
    game.debatePrep = 'defend';
    log("üõ°Ô∏è Prepara√ß√£o defensiva: pr√≥ximo debate ter√° -40% de chance de errar.");
    renderDebateTab();
    updateUI();
}

function skipDebateTab() {
    game.debateCooldown = 2;
    log("‚è≠Ô∏è Debate pulado. Pr√≥ximo dispon√≠vel em 2 turnos.");
    renderDebateTab();
}

function triggerDebateFromTab(style) {
    let rivals = game.candidates.filter(c => c.id !== game.player).sort((a,b) => b.votes - a.votes);
    let mainRival = rivals[0];
    let playerC = candidatesData[game.player];
    let prep = game.debatePrep;
    game.debatePrep = null; // consume preparation
    if(!game.debatesTotal) game.debatesTotal = 0;
    if(!game.debatesWon) game.debatesWon = 0;
    game.debatesTotal++;
    game.debateCooldown = 3; // can only do dedicated debate every 3 turns
    
    let attackBonus = prep === 'attack' ? 0.3 : 0;
    let defendBonus = prep === 'defend' ? 0.4 : 0;
    
    let result = '';
    let won = false;
    
    if(style === 'attack') {
        let roll = Math.random() + attackBonus;
        if(roll > 0.45) {
            let gain = 3 + Math.random() * 3;
            updateNationalVotes(game.player, gain);
            updateNationalVotes(mainRival.id, -1.5);
            addNews(`ATAQUE DE ${playerC.name} REPERCUTE`, `Candidato domina debate com ataques certeiros ao rival.`);
            result = `üí• DEBATE AGRESSIVO ‚Äî VIT√ìRIA! +${gain.toFixed(1)}%, rival -1.5%`; won = true;
        } else if(Math.random() > defendBonus + 0.3) {
            updateNationalVotes(game.player, -1.5);
            game.approvals[game.player].rej += 6;
            addNews(`DEBATE: ${playerC.name} SAI MAL`, `Agressividade excessiva gera reprova√ß√£o do eleitorado.`);
            result = `üí• Ataque saiu pela culatra! -1.5% e +6 rejei√ß√£o`;
        } else {
            updateNationalVotes(game.player, 0.5);
            result = `üí• Debate neutro. Sem destaque. +0.5%`;
        }
    } else if(style === 'program') {
        let gain = 1.8 + Math.random() * 1.5;
        updateNationalVotes(game.player, gain);
        game.approvals[game.player].app += 6;
        addNews(`${playerC.name} APRESENTA PROPOSTAS`, `Candidato impressiona com programa detalhado no debate.`);
        result = `üìã Programa apresentado! +${gain.toFixed(1)}% e +6 aprova√ß√£o`; won = true;
    } else if(style === 'moderate') {
        let gain = 0.8 + Math.random() * 0.8;
        updateNationalVotes(game.player, gain);
        game.approvals[game.player].rej = Math.max(0, game.approvals[game.player].rej - 3);
        result = `üòå Postura moderada. +${gain.toFixed(1)}% e -3 rejei√ß√£o`; won = gain > 1.2;
    } else if(style === 'emotional') {
        let roll = Math.random() + (attackBonus * 0.5);
        if(roll > 0.4) {
            let gain = 3 + Math.random() * 4;
            updateNationalVotes(game.player, gain);
            game.approvals[game.player].app += 9;
            addNews(`MOMENTO MARCANTE DE ${playerC.name}`, `Discurso emocional viraliza e comove o pa√≠s.`);
            result = `üé≠ MOMENTO HIST√ìRICO! +${gain.toFixed(1)}% e +9 aprova√ß√£o`; won = true;
        } else {
            updateNationalVotes(game.player, 0.3);
            result = `üé≠ Apelo emocional n√£o ressoou. +0.3%`;
        }
    } else if(style === 'economy') {
        if(game.money < 2) { log("Sem verba para debate econ√¥mico."); game.debatesTotal--; game.debateCooldown = 0; renderDebateTab(); return; }
        game.money -= 2;
        let gain = 2 + Math.random() * 2;
        updateNationalVotes(game.player, gain);
        game.approvals[game.player].app += 5;
        addNews(`DEBATE ECON√îMICO: ${playerC.name} SE DESTACA`, `Candidato demonstra dom√≠nio t√©cnico sobre economia.`);
        result = `üí∞ Debate econ√¥mico! +${gain.toFixed(1)}%, +5 aprova√ß√£o`; won = true;
    }
    
    if(won) game.debatesWon++;
    log(`üé§ DEBATE: ${result}. (${game.debatesWon}/${game.debatesTotal} vit√≥rias em debates)`);
    playDebateSound();
    renderDebateTab();
    updateUI();
}

function triggerDebate() {
    let rivals = game.candidates.filter(c => c.id !== game.player).sort((a,b)=>b.votes-a.votes);
    let mainRival = rivals[0];
    let playerC = candidatesData[game.player];
    
    let options = [
        {
            label: `‚öîÔ∏è ATAQUE DIRETO a ${mainRival.name}`,
            desc: "Alto risco, alto retorno. Pode sair pela culatra.",
            exec: () => {
                let roll = Math.random();
                if(roll > 0.45) {
                    let gain = (4 + Math.random()*2) ;
                    updateNationalVotes(game.player, gain);
                    updateNationalVotes(mainRival.id, -2);
                    addNews(`ATAQUE DE ${playerC.name} REPERCUTE`, `Candidato parte para o confronto e sobe nas pesquisas.`);
                    log(`üí• Ataque bem-sucedido! +${gain.toFixed(1)}%.`);
                } else {
                    updateNationalVotes(game.player, -1.5);
                    game.approvals[game.player].rej += 5;
                    addNews(`ATAQUE DE ${playerC.name} SAI PELA CULATRA`, `Candidato √© criticado por postura agressiva no debate.`);
                    log(`üí• Ataque fracassou. -1.5% e rejei√ß√£o aumentou.`);
                }
            }
        },
        {
            label: `üìã APRESENTAR PROGRAMA DE GOVERNO`,
            desc: "Seguro. Aumenta aprova√ß√£o, ganho moderado.",
            exec: () => {
                let gain = (2 + Math.random()*1.5) ;
                updateNationalVotes(game.player, gain);
                game.approvals[game.player].app += 6;
                addNews(`${playerC.name} APRESENTA PROPOSTAS`, `Candidato impressiona com proposta concreta no debate.`);
                log(`üìã Programa apresentado. +${gain.toFixed(1)}% e aprova√ß√£o +6.`);
            }
        },
        {
            label: `üòå POSTURA MODERADA E CONCILIADORA`,
            desc: "Menos votos imediatos, mas menos rejei√ß√£o.",
            exec: () => {
                let gain = 1.0 ;
                updateNationalVotes(game.player, gain);
                game.approvals[game.player].app += 3;
                game.approvals[game.player].rej = Math.max(0, game.approvals[game.player].rej - 2);
                log(`üòå Postura moderada. +${gain.toFixed(1)}% com menos rejei√ß√£o.`);
            }
        },
        {
            label: `üé≠ MOMENTO EMOCIONAL / APELO POPULAR`,
            desc: "Aposta na emo√ß√£o. Funciona bem para candidatos carism√°ticos.",
            exec: () => {
                let roll = Math.random();
                if(roll > 0.4) {
                    let gain = (3 + Math.random()*3) ;
                    updateNationalVotes(game.player, gain);
                    game.approvals[game.player].app += 8;
                    addNews(`MOMENTO MARCANTE DE ${playerC.name}`, `Discurso emocional viraliza e comove o pa√≠s.`);
                    log(`üé≠ Momento emocional hist√≥rico! +${gain.toFixed(1)}%.`);
                } else {
                    updateNationalVotes(game.player, 0.5);
                    log(`üé≠ Apelo emocional n√£o funcionou como esperado. +0.5%.`);
                }
            }
        }
    ];
    
    window._debateOptions = options;
    let btnHtml = options.map((o,i) => 
        `<div class="action-card"><b>${o.label}</b><br><small style="color:#666">${o.desc}</small><br>
        <button class="btn" style="margin-top:3px;width:auto" onclick="executeDebateOption(${i})">ESCOLHER</button></div>`
    ).join('');
    
    queueEvent("üé§ DEBATE AO VIVO", `Voc√™ est√° no palco. Como vai se sair?<hr>`, btnHtml + `<button class="btn" onclick="skipDebate()">Evitar o debate</button>`);
}

function skipDebate() {
    closeModal();
    isShowingEvent = false;
    setTimeout(() => processNextEvent(), 200);
}

function executeDebateOption(i) {
    window._debateOptions[i].exec();
    closeModal();
    isShowingEvent = false;
    setTimeout(() => processNextEvent(), 200);
    updateUI();
}

// === ESTADOS PIV√îS ===
const pivotStates = {
    "SP": {name:"S√£o Paulo", weight:23, desc:"Estado decisivo. 23% do eleitorado nacional. Vencer SP √© quase garantia de vit√≥ria."},
    "MG": {name:"Minas Gerais", weight:11, desc:"'Minas √© a caixa registradora do Brasil.' Quem vence Minas vence o pa√≠s."},
    "BA": {name:"Bahia", weight:8, desc:"Portal do Nordeste. Vit√≥ria na BA arrasta os estados vizinhos."},
    "RJ": {name:"Rio de Janeiro", weight:9, desc:"Capital pol√≠tica informal. Forte influ√™ncia nacional de m√≠dia."},
    "RS": {name:"Rio G. do Sul", weight:7, desc:"Estado ga√∫cho historicamente disputado entre direita e esquerda."}
};

function isPivotState(sid) { return pivotStates.hasOwnProperty(sid); }

// === VERIFICAR EVENTOS HIST√ìRICOS ===
function checkHistoricalEvents() {
    if(game.mode !== 'historico') return;
    let hideHist = document.getElementById('hide-hist-events');
    if(spectatorMode || (hideHist && !hideHist.checked)) return;
    let events = historicalEvents[game.scenario] || [];
    events.forEach((ev, idx) => {
        if(ev.turn === game.turn && !game.firedHistoricalEvents.includes(idx)) {
            game.firedHistoricalEvents.push(idx);
            let btns = ev.b.map((btn, btnIdx) => 
                `<button class="btn" onclick="executeHistoricalEvent(${idx}, ${btnIdx})">${btn.n}</button>`
            ).join("");
            // Use event queue to prevent overlap
            queueEvent(`üì∞ EVENTO HIST√ìRICO: ${ev.t}`, 
                `<span style="color:red;font-size:10px">‚òÖ ACONTECIMENTO REAL DE ${game.scenario}</span><br><br>${ev.d}`, 
                btns);
        }
    });
}

function executeHistoricalEvent(evIdx, btnIdx) {
    let events = historicalEvents[game.scenario] || [];
    if(events[evIdx]) {
        events[evIdx].b[btnIdx].f();
    }
    closeModal();
    isShowingEvent = false;
    setTimeout(() => processNextEvent(), 200);
    updateUI();
}

function recordPollSnapshot() {
    let snap = {turn: game.turn, votes: {}};
    game.candidates.forEach(c => snap.votes[c.id] = c.votes);
    game.pollHistory.push(snap);
}

function getIdeologyDistance(id1, id2) {
    let a = candidatesData[id1], b = candidatesData[id2];
    return Math.abs((a.econ||0)-(b.econ||0)) + Math.abs((a.soc||0)-(b.soc||0)) + Math.abs((a.nat||0)-(b.nat||0));
}

function actionInvestigar() {
    if(game.points < 4) { log("Pontos insuficientes para investigar."); return; }
    game.points -= 4;
    let rivals = game.candidates.filter(c => c.id !== game.player);
    let target = rivals[Math.floor(Math.random() * rivals.length)];
    game.scandalLevels[target.id] = Math.min(10, (game.scandalLevels[target.id]||0) + 3);
    let dmg = game.scandalLevels[target.id] >= 5 ? 3 : 1.5;
    updateNationalVotes(target.id, -dmg);
    addNews(`ESC√ÇNDALO: ${target.name}`, `Investiga√ß√£o revela irregularidades na campanha de ${target.name}. N√≠vel de esc√¢ndalo: ${game.scandalLevels[target.id]}/10`);
    log(`Investiga√ß√£o exp√¥s ${target.name}! Esc√¢ndalo +3.`);
    if(game.scandalLevels[target.id] >= 8) {
        addNews(`CPI CONTRA ${target.name}`, `Congresso abre CPI para investigar candidato ap√≥s s√©rie de den√∫ncias!`);
    }
    updateUI();
}

function actionAbafar() {
    if(game.money < 15) { log("Verba insuficiente."); return; }
    let myScandal = game.scandalLevels[game.player]||0;
    if(myScandal === 0) { log("Nenhum esc√¢ndalo para abafar."); return; }
    game.money -= 15;
    let reduction = Math.min(myScandal, 3);
    game.scandalLevels[game.player] = myScandal - reduction;
    game.approvals[game.player].rej = Math.max(0, game.approvals[game.player].rej - 2);
    log(`Esc√¢ndalo abafado. N√≠vel reduzido para ${game.scandalLevels[game.player]}.`);
    updateUI();
}

// ===== VICE PRESIDENCY SYSTEM =====
function getCountryViceCandidates() {
    let sc = game.scenario || '';
    let isUSA = sc.startsWith('USA') || sc === 'USA2020' || sc === 'USA2024';
    let isArg = sc.startsWith('ARG');
    let isMex = sc.startsWith('MEX');
    let isUK = sc.startsWith('UK') && !sc.startsWith('UKR');
    let isFra = sc.startsWith('FRA');
    let isDE = sc.startsWith('GER');
    let isIta = sc.startsWith('ITA');
    let isIndia = sc.startsWith('IND');
    let isRus = sc.startsWith('RUS');
    let isCol = sc.startsWith('COL');
    let isChi = sc.startsWith('CHI');
    let isUKR = sc.startsWith('UKR');
    let isESP = sc.startsWith('ESP');
    let isKOR = sc.startsWith('KOR');
    let isZAF = sc.startsWith('ZAF');
    let isPHL = sc.startsWith('PHL');
    let isTUR = sc.startsWith('TUR');

    if(isUSA) return [
        {id:'vc_us_midwest',    name:'Senator from Ohio',        region:'Midwest',      bonus:'midwest',   effect:3, cost:15, desc:'Critical swing state ally. Bridges Rust Belt voters.', ideology:'C'},
        {id:'vc_us_south',      name:'Governor of Florida',      region:'South',        bonus:'south',     effect:4, cost:20, desc:'Key swing state powerhouse with massive electoral votes.', ideology:'D'},
        {id:'vc_us_hispanic',   name:'Senator from Texas (Hispanic)', region:'Southwest', bonus:'hispanic', effect:3, cost:12, desc:'Appeals to growing Hispanic electorate and Southern conservatives.', ideology:'C'},
        {id:'vc_us_military',   name:'Retired General',          region:'National',     bonus:'military',  effect:2, cost:10, desc:'Military credibility. Appeals to veterans and moderate Republicans.', ideology:'D'},
        {id:'vc_us_progressive',name:'Progressive Senator (Vermont)', region:'Northeast', bonus:'progressive', effect:3, cost:15, desc:'Energizes the progressive base and young voters.', ideology:'E'},
        {id:'vc_us_woman',      name:'Senator from California',  region:'West',         bonus:'women',     effect:3, cost:18, desc:'Historic pick. Mobilizes women voters and West Coast donors.', ideology:'E'},
        {id:'vc_us_techcrat',   name:'Treasury Secretary (former)', region:'National',  bonus:'market',    effect:2, cost:12, desc:'Reassures Wall Street and fiscal conservatives.', ideology:'C'},
        {id:'vc_us_evangelical',name:'Governor of Indiana',      region:'Midwest',      bonus:'evangelical', effect:3, cost:14, desc:'Deep evangelical appeal and Midwest credibility.', ideology:'D'},
    ];
    if(isArg) return [
        {id:'vc_arg_bsas',     name:'Gobernador de Buenos Aires',  region:'Buenos Aires', bonus:'bsas', effect:4, cost:20, desc:'El estado m√°s poblado. Control clave.', ideology:'C'},
        {id:'vc_arg_sindical', name:'L√≠der Sindical CGT',          region:'Nacional',     bonus:'sindical', effect:3, cost:15, desc:'Respaldo obrero y peronista.', ideology:'E'},
        {id:'vc_arg_tecnoc',   name:'Economista del FMI',          region:'Nacional',     bonus:'mercado', effect:2, cost:12, desc:'Confianza de los mercados.', ideology:'D'},
        {id:'vc_arg_interior', name:'Gobernador del NOA',          region:'Interior',     bonus:'interior', effect:3, cost:10, desc:'Conecta con el electorado del norte.', ideology:'C'},
    ];
    if(isMex) return [
        {id:'vc_mex_norte',    name:'Gobernador del Norte',        region:'Norte',       bonus:'norte',    effect:3, cost:15, desc:'Frontera, industria, voto conservador.', ideology:'D'},
        {id:'vc_mex_sur',      name:'L√≠der Social del Sur',        region:'Sur',         bonus:'sur',      effect:3, cost:12, desc:'Ind√≠genas, base morenista.', ideology:'E'},
        {id:'vc_mex_ciudad',   name:'Ex-Jefa de Gobierno CDMX',   region:'Centro',      bonus:'centro',   effect:4, cost:18, desc:'La capital y sus millones de votos.', ideology:'E'},
        {id:'vc_mex_empresario',name:'Empresario del Noreste',     region:'Norte',       bonus:'mercado',  effect:2, cost:14, desc:'Confianza del sector privado.', ideology:'D'},
    ];
    if(isUK) return [
        {id:'vc_uk_scotland',  name:'Scottish MP',                 region:'Scotland',    bonus:'scotland', effect:3, cost:12, desc:'Keeps Scotland from going SNP.', ideology:'C'},
        {id:'vc_uk_north',     name:'Northern England MP',         region:'North',       bonus:'north',    effect:3, cost:15, desc:'Red Wall territory ‚Äî critical seats.', ideology:'E'},
        {id:'vc_uk_business',  name:'Business Secretary (Shadow)', region:'London',      bonus:'business', effect:2, cost:10, desc:'City of London confidence.', ideology:'D'},
        {id:'vc_uk_nhs',       name:'NHS Champion MP',             region:'National',    bonus:'nhs',      effect:3, cost:14, desc:'Healthcare credibility with voters.', ideology:'E'},
    ];
    if(isDE) return [
        {id:'vc_de_ost',       name:'Ministerpr√§sident Ostdeutschland', region:'Ost',   bonus:'ost',      effect:3, cost:12, desc:'Verbindet mit entt√§uschten W√§hlern im Osten.', ideology:'C'},
        {id:'vc_de_wirtschaft',name:'Wirtschaftsminister a.D.',   region:'National',     bonus:'wirtschaft', effect:2, cost:15, desc:'Vertrauen der Wirtschaft.', ideology:'D'},
        {id:'vc_de_gruen',     name:'Klimaministerin',             region:'National',     bonus:'gruen',    effect:3, cost:14, desc:'Gr√ºne W√§hler und Klimaaktivisten.', ideology:'E'},
        {id:'vc_de_bayer',     name:'CSU-Ministerpr√§sident Bayern',region:'Bayern',      bonus:'bayer',    effect:3, cost:15, desc:'Bayern-Stimmen und konservativer Fl√ºgel.', ideology:'D'},
    ];
    if(isFra) return [
        {id:'vc_fr_sud',       name:'√âlu du Sud (PACA)',           region:'Sud',         bonus:'sud',      effect:3, cost:12, desc:'C≈ìur de la droite m√©diterran√©enne.', ideology:'D'},
        {id:'vc_fr_syndicat',  name:'Leader Syndical',             region:'National',    bonus:'syndicat', effect:3, cost:14, desc:'Mobilise la gauche travailliste.', ideology:'E'},
        {id:'vc_fr_√Æle_de_fr', name:'Pr√©sidente d\'√éle-de-France', region:'Paris',       bonus:'idf',      effect:4, cost:20, desc:'La r√©gion la plus peupl√©e.', ideology:'C'},
    ];
    if(isCol) return [
        {id:'vc_col_costa',    name:'Senadora de la Costa',        region:'Caribe',      bonus:'caribe',   effect:3, cost:12, desc:'Barranquilla y las ciudades caribe√±as.', ideology:'C'},
        {id:'vc_col_paisa',    name:'Exalcalde de Medell√≠n',       region:'Antioquia',   bonus:'paisa',    effect:4, cost:15, desc:'Capital industrial, referente de transformaci√≥n.', ideology:'D'},
        {id:'vc_col_bog',      name:'Senador de Bogot√°',           region:'Bogot√°',      bonus:'bogota',   effect:3, cost:14, desc:'Capital y 8 millones de habitantes.', ideology:'E'},
    ];
    if(isChi) return [
        {id:'vc_chi_rm',       name:'Alcalde de Santiago',         region:'R. Metropolitana', bonus:'santiago', effect:4, cost:18, desc:'Capital y mayor ciudad de Chile.', ideology:'C'},
        {id:'vc_chi_minero',   name:'L√≠der Minero del Norte',      region:'Norte',        bonus:'norte',    effect:3, cost:12, desc:'Atacama y Antofagasta ‚Äî voto minero.', ideology:'E'},
        {id:'vc_chi_empresario',name:'Empresario del Agro',        region:'Sur',          bonus:'sur',      effect:3, cost:14, desc:'Votantes del sur conservador.', ideology:'D'},
    ];
    if(isESP) return [
        {id:'vc_esp_catalan',  name:'Portavoz Catal√°n',            region:'Catalu√±a',     bonus:'catalan',  effect:3, cost:14, desc:'Clave para negociar con el bloque progresista catal√°n.', ideology:'C'},
        {id:'vc_esp_andaluz',  name:'L√≠der Andaluza',              region:'Andaluc√≠a',    bonus:'sur',      effect:4, cost:18, desc:'El mayor electorado regional de Espa√±a.', ideology:'D'},
        {id:'vc_esp_sindical', name:'Secretario General UGT',      region:'Nacional',     bonus:'sindical', effect:3, cost:12, desc:'Base trabajadora y voto progresista.', ideology:'E'},
    ];
    if(isKOR) return [
        {id:'vc_kor_busan',    name:'Mayor of Busan',              region:'Southeast',    bonus:'busan',    effect:3, cost:12, desc:'Second largest city; conservative heartland.', ideology:'D'},
        {id:'vc_kor_jeolla',   name:'Governor of Jeolla',          region:'Southwest',    bonus:'jeolla',   effect:3, cost:14, desc:'Progressive stronghold; loyalist base.', ideology:'E'},
        {id:'vc_kor_tech',     name:'Tech Industry Leader',        region:'National',     bonus:'tech',     effect:2, cost:10, desc:'Appeals to young voters and the digital economy crowd.', ideology:'C'},
    ];
    if(isZAF) return [
        {id:'vc_zaf_kwazulu',  name:'KwaZulu-Natal Premier',       region:'KZN',          bonus:'kwazulu',  effect:4, cost:15, desc:'Critical Zulu vote bloc.', ideology:'C'},
        {id:'vc_zaf_gauteng',  name:'Gauteng ANC Leader',          region:'Gauteng',      bonus:'gauteng',  effect:3, cost:14, desc:'Johannesburg and Pretoria ‚Äî economic heartland.', ideology:'E'},
        {id:'vc_zaf_cape',     name:'Cape Town Alliance Figure',   region:'Western Cape', bonus:'cape',     effect:3, cost:12, desc:'Bridge to coloured and liberal white voters.', ideology:'D'},
    ];
    if(isPHL) return [
        {id:'vc_phl_cebu',     name:'Governor of Cebu',            region:'Visayas',      bonus:'cebu',     effect:3, cost:12, desc:'Largest voting bloc outside Luzon.', ideology:'C'},
        {id:'vc_phl_mindanao', name:'Mayor of Davao',              region:'Mindanao',     bonus:'mindanao', effect:4, cost:15, desc:'Powerful southern alliance.', ideology:'D'},
        {id:'vc_phl_activist', name:'Human Rights Lawyer',         region:'National',     bonus:'hrights',  effect:3, cost:14, desc:'Civil society and diaspora appeal.', ideology:'E'},
    ];
    if(isTUR) return [
        {id:'vc_tur_istanbul', name:'ƒ∞stanbul ƒ∞l Ba≈ükanƒ±',         region:'ƒ∞stanbul',     bonus:'istanbul', effect:4, cost:18, desc:'En kalabalƒ±k ≈üehir ‚Äî kritik se√ßmen bloƒüu.', ideology:'C'},
        {id:'vc_tur_kurdi',    name:'K√ºrt Koalisyonu Temsilcisi',  region:'G√ºneydoƒüu',    bonus:'kurdi',    effect:3, cost:12, desc:'K√ºrt se√ßmen bloƒüu.', ideology:'E'},
        {id:'vc_tur_milliyetci',name:'Milliyet√ßi Eski Bakan',     region:'ƒ∞√ß Anadolu',   bonus:'milliyetci',effect:3, cost:14, desc:'MHP tabanƒ±na yakƒ±n se√ßmenler.', ideology:'D'},
    ];
    if(isIndia) return [
        {id:'vc_ind_up',       name:'Chief Minister UP',           region:'Uttar Pradesh',bonus:'up',       effect:4, cost:20, desc:'Most populous state ‚Äî game-changing alliance.', ideology:'D'},
        {id:'vc_ind_minority', name:'Muslim Minority Leader',      region:'National',     bonus:'minority', effect:3, cost:12, desc:'Mobilizes minority communities and secular voters.', ideology:'E'},
        {id:'vc_ind_south',    name:'Tamil Nadu Leader',           region:'South India',  bonus:'south',    effect:3, cost:15, desc:'Crucial Dravidian alliance for southern states.', ideology:'C'},
        {id:'vc_ind_dalit',    name:'Dalit Rights Activist',       region:'National',     bonus:'dalit',    effect:3, cost:14, desc:'SC/ST communities ‚Äî critical electoral base.', ideology:'E'},
    ];
    if(isRus) return [
        {id:'vc_rus_siberia',  name:'–°–∏–±–∏—Ä—Å–∫–∏–π –ì—É–±–µ—Ä–Ω–∞—Ç–æ—Ä',        region:'Siberia',      bonus:'siberia',  effect:3, cost:12, desc:'–†–µ—Å—É—Ä—Å–Ω—ã–π —Ä–µ–≥–∏–æ–Ω –∏ –ª–æ—è–ª—å–Ω—ã–π —ç–ª–µ–∫—Ç–æ—Ä–∞—Ç.', ideology:'D'},
        {id:'vc_rus_kprf',     name:'–î–µ—è—Ç–µ–ª—å –ö–ü–†–§',                region:'–ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π', bonus:'kprf',     effect:3, cost:14, desc:'–ö–æ–º–º—É–Ω–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –±–∞–∑–∞ ‚Äî –≥–æ–ª–æ—Å–∞ –ø—Ä–æ—Ç–µ—Å—Ç–∞.', ideology:'E'},
        {id:'vc_rus_moscow',   name:'–ú—ç—Ä –ú–æ—Å–∫–≤—ã',                  region:'–ú–æ—Å–∫–≤–∞',       bonus:'moscow',   effect:4, cost:18, desc:'–°—Ç–æ–ª–∏—Ü–∞ ‚Äî –∫–ª—é—á–µ–≤–æ–π —ç–ª–µ–∫—Ç–æ—Ä–∞—Ç.', ideology:'C'},
    ];
    // Portugal
    if(sc.startsWith('POR')) return [
        {id:'vc_por_norte',    name:'Autarca do Norte',            region:'Norte',        bonus:'norte',    effect:3, cost:12, desc:'Regi√£o mais conservadora, base do PSD.', ideology:'D'},
        {id:'vc_por_lisboa',   name:'Autarca de Lisboa',           region:'Lisboa',       bonus:'lisboa',   effect:4, cost:18, desc:'Capital e maior cidade ‚Äî vital para qualquer candidatura.', ideology:'C'},
        {id:'vc_por_sindicato',name:'L√≠der Sindical CGTP',         region:'Nacional',     bonus:'sindical', effect:3, cost:14, desc:'Base trabalhista e eleitorado de esquerda.', ideology:'E'},
    ];
    // Italy
    if(isIta) return [
        {id:'vc_ita_milano',    name:'Sindaco di Milano',          region:'Nord',         bonus:'nord',     effect:4, cost:18, desc:'Centro finanziario ‚Äî voto moderato e industriale.', ideology:'C'},
        {id:'vc_ita_napoli',    name:'Governatore della Campania', region:'Sud',          bonus:'sud',      effect:3, cost:14, desc:'Sud Italia ‚Äî blocco di voti chiave.', ideology:'E'},
        {id:'vc_ita_industriale',name:'Presidente Confindustria',  region:'Nazionale',    bonus:'mercato',  effect:2, cost:12, desc:'Supporto del mondo degli affari.', ideology:'D'},
    ];
    // Venezuela
    if(sc.startsWith('VEN')) return [
        {id:'vc_ven_estado',   name:'Gobernador del Zulia',        region:'Zulia',        bonus:'zulia',    effect:4, cost:15, desc:'El estado petrolero m√°s importante.', ideology:'D'},
        {id:'vc_ven_obrero',   name:'L√≠der Sindical Chavista',     region:'Nacional',     bonus:'obrero',   effect:3, cost:12, desc:'Base laboral del chavismo.', ideology:'E'},
        {id:'vc_ven_centro',   name:'Ex-Ministro Moderado',        region:'Nacional',     bonus:'moderado', effect:2, cost:10, desc:'Atrae a chavistas desencantados.', ideology:'C'},
    ];
    // Ukraine
    if(isUKR) return [
        {id:'vc_ukr_east',     name:'Donbas Region Leader',        region:'East',         bonus:'donbas',   effect:3, cost:12, desc:'Russian-speaking eastern voters.', ideology:'C'},
        {id:'vc_ukr_west',     name:'Lviv Regional Governor',      region:'West',         bonus:'galicia',  effect:3, cost:14, desc:'Pro-EU western nationalist vote.', ideology:'D'},
        {id:'vc_ukr_kyiv',     name:'Kyiv City Council Chair',     region:'Kyiv',         bonus:'kyiv',     effect:4, cost:18, desc:'Capital city ‚Äî essential ally.', ideology:'E'},
    ];
    // Japan
    if(sc.startsWith('JAP')) return [
        {id:'vc_jap_osaka',    name:'Osaka Governor (Nippon Ishin)',region:'Kinki',       bonus:'osaka',    effect:3, cost:14, desc:'Populist reform movement in western Japan.', ideology:'C'},
        {id:'vc_jap_keidanren',name:'Keidanren Business Rep.',     region:'National',     bonus:'business', effect:2, cost:12, desc:'Corporate Japan and fiscal conservatives.', ideology:'D'},
        {id:'vc_jap_rengo',    name:'RENGO Labor Federation Chair', region:'National',    bonus:'labor',    effect:3, cost:14, desc:'Organized labor ‚Äî key opposition base.', ideology:'E'},
    ];
    // Poland
    if(sc.startsWith('POL')) return [
        {id:'vc_pol_krakow',   name:'Mayor of Krak√≥w',             region:'Ma≈Çopolska',   bonus:'krakow',   effect:3, cost:12, desc:'Catholic conservative south.', ideology:'D'},
        {id:'vc_pol_warsaw',   name:'Warsaw City Council Rep.',    region:'Mazovian',     bonus:'warsaw',   effect:4, cost:18, desc:'Capital city ‚Äî largest electorate.', ideology:'E'},
        {id:'vc_pol_farmer',   name:'Farmers Party (PSL) Leader', region:'Rural',        bonus:'rural',    effect:3, cost:14, desc:'Rural vote and agricultural communities.', ideology:'C'},
    ];
    // Canada
    if(sc.startsWith('CAN')) return [
        {id:'vc_can_ontario',  name:'Ontario MP',                  region:'Ontario',      bonus:'ontario',  effect:4, cost:20, desc:'The most populous province ‚Äî essential.', ideology:'C'},
        {id:'vc_can_quebec',   name:'Quebec Moderate MP',          region:'Quebec',       bonus:'quebec',   effect:3, cost:15, desc:'Bridge to Quebec soft nationalists.', ideology:'C'},
        {id:'vc_can_west',     name:'Prairie Province MP',         region:'West',         bonus:'west',     effect:3, cost:12, desc:'Alberta and Saskatchewan conservative base.', ideology:'D'},
        {id:'vc_can_ndp',      name:'NDP-Aligned Union Leader',   region:'National',     bonus:'labor',    effect:3, cost:14, desc:'Progressive labor and youth vote.', ideology:'E'},
    ];
    // Default: Brazil
    return viceCandidates;
}

const viceCandidates = [
    {id:'vc_nordeste', name:'Senador do Nordeste', region:'Nordeste', bonus:'nordeste', effect:3, cost:15, desc:'Base s√≥lida no Nordeste. Garante votos nas √°reas mais populosas da regi√£o.', ideology:'E'},
    {id:'vc_sul', name:'Empres√°ria do Sul', region:'Sul', bonus:'sul', effect:3, cost:12, desc:'Conecta com o eleitorado empresarial do Sul e interior conservador.', ideology:'D'},
    {id:'vc_sudeste', name:'Ex-Governador de SP', region:'Sudeste', bonus:'sudeste', effect:4, cost:20, desc:'Alian√ßa poderosa com o estado mais populoso do Brasil.', ideology:'C'},
    {id:'vc_militar', name:'General Reformado', region:'Nacional', bonus:'militar', effect:2, cost:10, desc:'Apelo √† direita, militares e ordem. Pode assustar o centro.', ideology:'D'},
    {id:'vc_academico', name:'Professora Universit√°ria', region:'Nacional', bonus:'academico', effect:2, cost:8, desc:'Credibilidade intelectual e apelo a jovens e classe m√©dia alta.', ideology:'E'},
    {id:'vc_religioso', name:'Pastor Evang√©lico', region:'Nacional', bonus:'religioso', effect:3, cost:15, desc:'Acesso √† enorme base evang√©lica brasileira.', ideology:'D'},
    {id:'vc_feminino', name:'Prefeita do Rio', region:'Sudeste', bonus:'feminino', effect:3, cost:12, desc:'Apelo feminino e progressista na maior metr√≥pole do pa√≠s.', ideology:'E'},
    {id:'vc_indigena', name:'L√≠der Ind√≠gena', region:'Norte', bonus:'indigena', effect:2, cost:8, desc:'Apelo hist√≥rico e ambiental. Desagrada o agroneg√≥cio.', ideology:'E'},
    {id:'vc_empresario', name:'Bilion√°rio do Agro', region:'Centro-Oeste', bonus:'agro', effect:3, cost:18, desc:'Acesso a doa√ß√µes massivas e votos do agroneg√≥cio.', ideology:'D'},
    {id:'vc_tecnico', name:'Economista do Mercado', region:'Nacional', bonus:'mercado', effect:2, cost:12, desc:'Tranquiliza mercados financeiros e eleitores pragm√°ticos.', ideology:'C'},
];

function renderViceTab() {
    const div = document.getElementById('vice-content');
    if(!div) return;
    if(!game.vice) {
        div.innerHTML = `<div style="background:#fff8e8;border:1px solid #cc9900;padding:10px;border-radius:3px;font-size:11px;color:#555">
            <b>Nenhum vice negociado ainda.</b><br>
            V√° √† aba <b>A√á√ïES ‚Üí Negociar Alian√ßas</b> e negocie um vice-presidente para desbloquear esta aba.
        </div>`;
        return;
    }
    let vc = game.vice;
    let actions = [
        {name:'üì£ Com√≠cio Conjunto', desc:'O vice faz com√≠cios em sua base regional.', cost_p:2, effect:()=>{ updateNationalVotes(game.player, 2.5); log(`Com√≠cio conjunto com ${vc.name}: +2.5%`); }},
        {name:'üì∫ Entrevista em Rede', desc:'O vice aparece no hor√°rio eleitoral.', cost_p:3, effect:()=>{ updateNationalVotes(game.player, 3); log(`Entrevista do vice ${vc.name}: +3%`); }},
        {name:'ü§ù Mobilizar Base Regional', desc:`Ativa a rede regional do vice (${vc.region}).`, cost_p:2, cost_m:8, effect:()=>{ updateNationalVotes(game.player, 4); log(`Base regional de ${vc.name} mobilizada: +4%`); }},
        {name:'üì± Post Conjunto nas Redes', desc:'Conte√∫do viral conjunto.', cost_p:1, effect:()=>{ updateNationalVotes(game.player, 1.5); log(`Redes sociais do vice: +1.5%`); }},
        {name:'üó£Ô∏è Vice Debate Rival', desc:'O vice ataca o rival no debate.', cost_p:3, effect:()=>{
            let rivals = game.candidates.filter(c=>c.id!==game.player);
            if(!rivals.length) return;
            let target = rivals[Math.floor(Math.random()*rivals.length)];
            updateNationalVotes(target.id, -2);
            log(`Vice atacou ${target.name} no debate: -2% para o rival!`);
        }},
    ];
    let html = `<div style="background:#e8f4e8;border:1px solid #228b22;padding:8px;border-radius:3px;margin-bottom:10px">
        <b>üëî Vice-Presidente: ${vc.name}</b><br>
        <small style="color:#555">üåç ${vc.region} | ${vc.ideology==='E'?'üî¥ Esquerda':vc.ideology==='D'?'üîµ Direita':'‚ö™ Centro'}</small><br>
        <small>${vc.desc}</small>
    </div>
    <b>A√ß√µes do Vice-Presidente</b><hr>`;
    actions.forEach((a,i) => {
        let costStr = [];
        if(a.cost_p) costStr.push(`${a.cost_p}p`);
        if(a.cost_m) costStr.push(`R$${a.cost_m}M`);
        html += `<button class="btn" onclick="doViceAction(${i})">${a.name} (${costStr.join(', ')})<br><small style="font-weight:normal;color:#555">${a.desc}</small></button>`;
    });
    div.innerHTML = html;
    div._actions = actions;
}

function doViceAction(idx) {
    const div = document.getElementById('vice-content');
    const actions = div._actions || [];
    const a = actions[idx];
    if(!a) return;
    if(a.cost_p && game.points < a.cost_p) { log('Pontos insuficientes.'); return; }
    if(a.cost_m && game.money < a.cost_m) { log('Verba insuficiente.'); return; }
    if(a.cost_p) game.points -= a.cost_p;
    if(a.cost_m) game.money -= a.cost_m;
    a.effect();
    updateUI();
    renderViceTab();
}

function openViceNegotiation() {
    let available = getCountryViceCandidates().filter(vc => !game.vice || game.vice.id !== vc.id);
    let html = `<div style="font-size:11px;max-height:400px;overflow-y:auto">
    <p style="color:#555">Escolha um vice-presidente. Isso requer pontos e verba de negocia√ß√£o. O vice traz b√¥nus regionais e a√ß√µes especiais.</p>`;
    available.forEach(vc => {
        html += `<div style="border:1px solid #ccc;padding:6px;margin-bottom:6px;border-radius:2px;cursor:pointer;background:#f9f9f9" onclick="negotiateVice('${vc.id}')">
            <b>${vc.name}</b> ‚Äî <small>${vc.region} | ${vc.ideology==='E'?'üî¥ Esq':vc.ideology==='D'?'üîµ Dir':'‚ö™ Centro'}</small><br>
            <small style="color:#444">${vc.desc}</small><br>
            <span style="color:#006600;font-size:10px">Custo: 6p + R$${vc.cost}M | B√¥nus inicial: +${vc.effect}%</span>
        </div>`;
    });
    html += '</div>';
    showModal('üëî NEGOCIAR VICE-PRESIDENTE', html, `<button class="btn" onclick="closeModal()">Cancelar</button>`);
}

function negotiateVice(vcId) {
    let vc = getCountryViceCandidates().find(v=>v.id===vcId);
    if(!vc) return;
    if(game.points < 6) { log('Pontos insuficientes para negociar vice (6p).'); closeModal(); return; }
    if(game.money < vc.cost) { log(`Verba insuficiente para negociar vice (R$${vc.cost}M).`); closeModal(); return; }
    game.points -= 6;
    game.money -= vc.cost;
    game.vice = vc;
    updateNationalVotes(game.player, vc.effect);
    // Unlock vice tab
    const btn = document.getElementById('tab-btn-vice');
    if(btn) btn.style.display = '';
    addNews('VICE-PRESIDENTE ANUNCIADO', `${candidatesData[game.player]?.name} anuncia ${vc.name} como vice-presidente. Alian√ßa regional fortalece a candidatura!`);
    log(`Vice-presidente ${vc.name} negociado! +${vc.effect}% nacional.`);
    closeModal();
    showTab('vice');
    updateUI();
}

// ===== CORRUPTION SYSTEM =====
function renderCorrupcaoTab() {
    const div = document.getElementById('corrupcao-content');
    if(!div) return;
    let year = parseInt(game.scenario) || 2000;
    let isOld = year < 1989;
    let baseRisk = isOld ? 0.12 : 0.22; // menor risco em eras antigas
    let corruptFund = game.corruptFund || 0;
    
    let html = `<div style="background:#1a1a1a;color:#00ff88;padding:8px;border-radius:3px;font-size:11px;margin-bottom:8px;font-family:monospace">
        üí∞ Caixa 2: <b>R$${corruptFund}M</b> &nbsp;|&nbsp; üîç Risco detectado: <b style="color:${baseRisk>0.2?'#ff4444':'#ffaa00'}">${Math.round(baseRisk*100)}%/a√ß√£o</b>
    </div>`;
    
    if(corruptFund === 0) {
        html += `<div style="background:#330000;color:#ffaa00;padding:8px;border-radius:3px;font-size:10px;margin-bottom:8px">
            Voc√™ n√£o tem Caixa 2. Use <b>"Criar Caixa 2"</b> para come√ßar a operar na sombra.
        </div>`;
    }
    
    let actions = [
        {name:'üíº Criar Caixa 2 (Desvio)', cost_m:20, desc:'Desvia R$20M do caixa oficial para opera√ß√µes clandestinas.', risk:0, 
         effect:()=>{ game.money-=20; game.corruptFund=(game.corruptFund||0)+20; log('Caixa 2 criado: R$20M desviados.'); }},
        {name:'üó≥Ô∏è Comprar Votos ‚Äî Favelas', cost_c:8, desc:'Distribui dinheiro e g√™neros aliment√≠cios. Efeito forte nas periferias.', risk:baseRisk+0.1,
         effect:()=>{ game.corruptFund-=8; updateNationalVotes(game.player,4); log('Compra de votos: +4% nas periferias!'); }},
        {name:'üó≥Ô∏è Comprar Votos ‚Äî Interior', cost_c:10, desc:'Coronelismo moderno. Garante votos no interior do pa√≠s.', risk:baseRisk,
         effect:()=>{ game.corruptFund-=10; updateNationalVotes(game.player,3.5); log('Compra de votos no interior: +3.5%!'); }},
        {name:'üì∞ Subornar Jornalista', cost_c:5, desc:'Garante cobertura positiva por 3 turnos.', risk:baseRisk,
         effect:()=>{ game.corruptFund-=5; game.mediaBonus=(game.mediaBonus||0)+3; updateNationalVotes(game.player,1); log('Jornalista subornado: cobertura positiva garantida!'); }},
        {name:'üèõÔ∏è Subornar Juiz Eleitoral', cost_c:15, desc:'Reduz risco de investiga√ß√µes por 5 turnos.', risk:baseRisk-0.05,
         effect:()=>{ game.corruptFund-=15; game.corruptImunidade=(game.corruptImunidade||0)+5; log('Juiz subornado: imunidade tempor√°ria contra investiga√ß√µes!'); }},
        {name:'üî™ Sabotagem de Rival', cost_c:12, desc:'Vaza documentos falsos contra rival principal.', risk:baseRisk+0.08,
         effect:()=>{
             let rivals = game.candidates.filter(c=>c.id!==game.player).sort((a,b)=>b.votes-a.votes);
             if(!rivals.length) return;
             game.corruptFund-=12;
             updateNationalVotes(rivals[0].id, -4);
             addNews('VAZA DOCUMENTOS BOMB√ÅSTICO', `Documentos revelam irregularidades na campanha de ${rivals[0].name}!`);
             log(`Sabotagem: ${rivals[0].name} perdeu 4%!`);
         }},
    ];
    
    actions.forEach((a,i) => {
        let costStr = a.cost_m ? `R$${a.cost_m}M do caixa oficial` : `R$${a.cost_c}M do Caixa 2`;
        let riskStr = a.risk > 0 ? `‚ö†Ô∏è Risco: ${Math.round(a.risk*100)}%` : '‚úÖ Sem risco';
        let disabled = (a.cost_m && game.money < a.cost_m) || (a.cost_c && corruptFund < a.cost_c);
        html += `<button class="btn" style="background:#1a0000;color:#ffcc00;border:1px solid #660000${disabled?';opacity:0.4':''}" 
            onclick="doCorruptAction(${i})" ${disabled?'disabled':''}>${a.name}<br>
            <small style="font-weight:normal;color:#aaa">${a.desc}</small><br>
            <small style="color:#ff8888">${costStr} | ${riskStr}</small>
        </button>`;
    });
    
    div.innerHTML = html;
    div._actions = actions;
    div._baseRisk = baseRisk;
}

function doCorruptAction(idx) {
    const div = document.getElementById('corrupcao-content');
    const actions = div._actions || [];
    const baseRisk = div._baseRisk || 0.2;
    const a = actions[idx];
    if(!a) return;
    
    let corruptFund = game.corruptFund || 0;
    if(a.cost_m && game.money < a.cost_m) { log('Verba insuficiente.'); return; }
    if(a.cost_c && corruptFund < a.cost_c) { log('Caixa 2 insuficiente.'); return; }
    
    // Check if caught (imunidade reduces risk)
    let imune = game.corruptImunidade || 0;
    let finalRisk = Math.max(0, a.risk - (imune > 0 ? 0.1 : 0));
    if(imune > 0) game.corruptImunidade--;
    
    if(a.risk > 0 && Math.random() < finalRisk) {
        // CAUGHT!
        let year = parseInt(game.scenario)||2000;
        game.scandalLevels[game.player] = 10;
        updateNationalVotes(game.player, -15);
        addNews('üö® ESQUEMA DESCOBERTO!', `A campanha de ${candidatesData[game.player]?.name} √© flagrada em esquema de corrup√ß√£o! A TSE investiga e pode desqualificar o candidato!`);
        log('‚ö†Ô∏è DESCOBERTOS! Corrup√ß√£o exposta. -15% e esc√¢ndalo m√°ximo!');
        // Chance of disqualification (higher in modern era)
        let year2 = parseInt(game.scenario)||2000;
        let disqProb = year2 >= 1989 ? 0.45 : 0.15;
        if(Math.random() < disqProb) {
            setTimeout(()=>{
                showModal('üö® DESQUALIFICA√á√ÉO!', `<div style="background:#cc0000;color:white;padding:10px;text-align:center;font-size:14px">
                    <b>‚öñÔ∏è VOC√ä FOI DESQUALIFICADO!</b><br><br>
                    O Tribunal Superior Eleitoral desqualificou sua candidatura por comprova√ß√£o de corrup√ß√£o eleitoral.<br><br>
                    <b>GAME OVER</b>
                </div>`, `<button class="btn" onclick="closeModal();goToMainMenu()">Voltar ao Menu</button>`);
            }, 500);
            return;
        }
        updateUI();
        renderCorrupcaoTab();
        return;
    }
    
    a.effect();
    updateUI();
    renderCorrupcaoTab();
}

// ===== ENHANCED REGIONS =====
function renderRegions() {
    const container = document.getElementById("region-list");
    container.innerHTML = "";
    if(game.isGovernor || game.isRepVelha || game.isElectoralCollege) {
        let html = '';
        Object.keys(game.stateVotes).forEach(rid => {
            let votes = game.stateVotes[rid];
            if(!votes) return;
            let sorted = Object.entries(votes).sort((a,b)=>b[1]-a[1]);
            let leaderId = sorted[0][0];
            let cd = candidatesData[leaderId];
            if(!cd) return;
            let evInfo = '';
            if(game.isElectoralCollege) {
                let sc = internationalData[game.scenario];
                let es = sc && sc.electoralStates && sc.electoralStates.find(s=>s.id===rid);
                if(es) evInfo = ` (${es.ev} EV)`;
            }
            let barHtml = sorted.slice(0,3).map(([cid,v])=>{
                let c2 = candidatesData[cid]; if(!c2) return '';
                return `<span style="display:inline-block;background:${c2.color};color:white;padding:1px 4px;border-radius:2px;font-size:9px;margin-right:2px">${c2.name||cid}: ${v.toFixed(0)}%</span>`;
            }).join('');
            html += `<div class="region-card" style="padding:6px;margin-bottom:4px;border:1px solid #ddd;border-radius:3px">
                <b>${rid}${evInfo}</b>: <span style="color:${cd.color}">${cd.name}</span> lidera<br>
                <div style="margin-top:3px">${barHtml}</div>
                <button class="btn" style="width:auto;font-size:9px;padding:1px 5px;margin-top:3px" onclick="doRegionalRally('${rid}')">üé∫ Com√≠cio (3p, R$5M)</button>
            </div>`;
        });
        container.innerHTML = html || '<div style="font-size:10px;color:#888">Nenhuma regi√£o carregada ainda.</div>';
    } else {
        let regionDefs = {
            'Norte':      {ideoBias:'E', biasLabel:'üî¥ Tend√™ncia Esquerdista (Amaz√¥nia)', icon:'üåø'},
            'Nordeste':   {ideoBias:'E', biasLabel:'üî¥ Base Forte da Esquerda', icon:'‚òÄÔ∏è'},
            'Sudeste':    {ideoBias:'C', biasLabel:'‚ö™ Disputado (SP conservador, RJ vol√°til)', icon:'üèôÔ∏è'},
            'Sul':        {ideoBias:'D', biasLabel:'üîµ Base Conservadora / Direita', icon:'üåæ'},
            'Centro-Oeste':{ideoBias:'D', biasLabel:'üîµ Agroneg√≥cio / Direita', icon:'üåµ'},
        };
        let html = '';
        ["Norte", "Nordeste", "Sudeste", "Sul", "Centro-Oeste"].forEach(reg => {
            let rdef = regionDefs[reg] || {};
            let states = allStates.filter(s => s.r === reg);
            let regionalScores = {};
            game.candidates.forEach(c => regionalScores[c.id] = 0);
            states.forEach(s => { if(game.stateVotes[s.id]) game.candidates.forEach(c => regionalScores[c.id] += (game.stateVotes[s.id][c.id]||0)); });
            let sorted = Object.entries(regionalScores).sort((a,b) => b[1] - a[1]);
            let leaderId = sorted[0][0];
            let cd = candidatesData[leaderId];
            let total = sorted.reduce((s,[,v])=>s+v,0)||1;
            let barHtml = sorted.slice(0,4).map(([cid,v])=>{
                let c2 = candidatesData[cid]; if(!c2) return '';
                let pct = (v/total*100).toFixed(0);
                return `<span style="display:inline-block;background:${c2.color};color:white;padding:1px 4px;border-radius:2px;font-size:9px;margin-right:2px">${c2.name}: ${pct}%</span>`;
            }).join('');
            html += `<div class="region-card" style="padding:6px;margin-bottom:5px;border:1px solid #ccc;border-radius:3px;background:#fafafa">
                <b>${rdef.icon||''} ${reg}</b>: <span style="color:${cd?.color||'#000'}">${cd?.name||leaderId}</span> lidera<br>
                <small style="color:#666">${rdef.biasLabel||''}</small><br>
                <div style="margin-top:3px">${barHtml}</div>
                <button class="btn" style="width:auto;font-size:9px;padding:1px 5px;margin-top:3px" onclick="doRegionalRallyBR('${reg}')">üé∫ Com√≠cio (3p, R$5M)</button>
            </div>`;
        });
        container.innerHTML = html;
    }
}


// ===== BASE ELEITORAL SYSTEM =====
function renderBaseEleitoral() {
    const div = document.getElementById('base-content');
    if(!div) return;
    if(!game.baseEleitoral) initBaseEleitoral();
    const be = game.baseEleitoral;

    const actions = [
        { label:'üèòÔ∏è Programa Habita√ß√£o Popular', desc:'Beneficia classe baixa. +10 sat. baixa, -5 sat. alta.', cost_p:3, cost_m:8,
          effect:()=>{ be.baixa.satisfacao=Math.min(100,be.baixa.satisfacao+10); be.alta.satisfacao=Math.max(0,be.alta.satisfacao-5); updateNationalVotes(game.player,1.5); log('üèòÔ∏è Habita√ß√£o popular: baixa +10, alta -5'); }},
        { label:'üìö Bolsas de Estudo Universit√°rias', desc:'Beneficia classe m√©dia. +8 sat. m√©dia, +2 baixa.', cost_p:2, cost_m:5,
          effect:()=>{ be.media.satisfacao=Math.min(100,be.media.satisfacao+8); be.baixa.satisfacao=Math.min(100,be.baixa.satisfacao+2); updateNationalVotes(game.player,1); log('üìö Bolsas: m√©dia +8'); }},
        { label:'üí∞ Redu√ß√£o de Impostos p/ Empresas', desc:'Beneficia classe alta. +10 sat. alta, -4 sat. baixa.', cost_p:2,
          effect:()=>{ be.alta.satisfacao=Math.min(100,be.alta.satisfacao+10); be.baixa.satisfacao=Math.max(0,be.baixa.satisfacao-4); updateNationalVotes(game.player,1); log('üí∞ Redu√ß√£o fiscal: alta +10, baixa -4'); }},
        { label:'‚öïÔ∏è SUS Universal', desc:'Beneficia classes baixa e m√©dia. +6 ambas.', cost_p:3, cost_m:10,
          effect:()=>{ be.baixa.satisfacao=Math.min(100,be.baixa.satisfacao+6); be.media.satisfacao=Math.min(100,be.media.satisfacao+6); updateNationalVotes(game.player,1.2); log('‚öïÔ∏è SUS: baixa e m√©dia +6'); }},
        { label:'üèóÔ∏è Obras de Infraestrutura', desc:'Beneficia todas as classes igualmente. +5 todas.', cost_p:3, cost_m:12,
          effect:()=>{ Object.values(be).forEach(c=>{ c.satisfacao=Math.min(100,c.satisfacao+5); }); updateNationalVotes(game.player,1.5); log('üèóÔ∏è Infraestrutura: todas +5'); }},
        { label:'üìà Pol√≠tica de Valoriza√ß√£o do Sal√°rio M√≠nimo', desc:'Beneficia classe baixa. +12 sat. baixa, -3 alta.', cost_p:2,
          effect:()=>{ be.baixa.satisfacao=Math.min(100,be.baixa.satisfacao+12); be.alta.satisfacao=Math.max(0,be.alta.satisfacao-3); updateNationalVotes(game.player,1.8); log('üìà Sal√°rio m√≠nimo: baixa +12, alta -3'); }},
        { label:'üõ°Ô∏è Programa de Seguran√ßa P√∫blica', desc:'Beneficia classes m√©dia e alta. +7 m√©dia, +6 alta.', cost_p:2, cost_m:6,
          effect:()=>{ be.media.satisfacao=Math.min(100,be.media.satisfacao+7); be.alta.satisfacao=Math.min(100,be.alta.satisfacao+6); updateNationalVotes(game.player,1); log('üõ°Ô∏è Seguran√ßa: m√©dia +7, alta +6'); }},
        { label:'üåø Agenda Ambiental Progressista', desc:'Popular entre classe m√©dia urbana. +9 m√©dia, leve impacto alta.', cost_p:2,
          effect:()=>{ be.media.satisfacao=Math.min(100,be.media.satisfacao+9); be.alta.satisfacao=Math.max(0,be.alta.satisfacao-2); updateNationalVotes(game.player,0.8); log('üåø Agenda verde: m√©dia +9'); }},
    ];

    // Calculate vote impact from satisfaction
    let totalVoteBonus = 0;
    let warnings = [];
    Object.entries(be).forEach(([key, c]) => {
        let delta = (c.satisfacao - 50) / 50; // -1 to +1
        totalVoteBonus += delta * 2;
        if(c.satisfacao < 30) warnings.push(`‚ö†Ô∏è ${c.desc} MUITO INSATISFEITA ‚Äî ${c.satisfacao.toFixed(0)}%`);
        if(c.satisfacao > 80) warnings.push(`‚úÖ ${c.desc} MUITO SATISFEITA ‚Äî ${c.satisfacao.toFixed(0)}%`);
    });

    let html = `<div style="background:#f0f8ff;border:1px solid #336;padding:8px;border-radius:3px;margin-bottom:8px;font-size:11px">
        <b>üó≥Ô∏è Base Eleitoral ‚Äî Satisfa√ß√£o por Classe</b><br>
        <small style="color:#555">Manter equil√≠brio √© essencial. Classes muito insatisfeitas migram para rivais. B√¥nus de votos: <b style="color:${totalVoteBonus>=0?'#006600':'#cc0000'}">${totalVoteBonus>=0?'+':''}${totalVoteBonus.toFixed(1)}%</b></small>
    </div>`;

    if(warnings.length) {
        html += `<div style="background:#fff3cd;border:1px solid #ffc107;padding:6px;border-radius:3px;margin-bottom:8px;font-size:11px">
            ${warnings.join('<br>')}
        </div>`;
    }

    Object.entries(be).forEach(([key, c]) => {
        let pct = c.satisfacao;
        let barColor = pct >= 70 ? '#2e7d32' : pct >= 40 ? '#cc8800' : '#cc0000';
        let voteImpact = ((pct - 50) / 50 * 2).toFixed(1);
        html += `<div class="base-class-card" style="background:${pct < 30?'#fff5f5':pct > 70?'#f5fff5':'#fafafa'}">
            <b>${c.icon} ${c.desc}</b> <span style="float:right;color:${barColor};font-weight:bold">${pct.toFixed(0)}%</span><br>
            <div class="base-class-bar"><div class="base-class-fill" style="width:${pct}%;background:${barColor}"></div></div>
            <small style="color:#666">Impacto em votos: <b style="color:${parseFloat(voteImpact)>=0?'#006600':'#cc0000'}">${parseFloat(voteImpact)>=0?'+':''}${voteImpact}%</b> | ${pct < 30?'üî¥ CR√çTICO ‚Äî Perdendo votos rapidamente':pct < 50?'üü° Insatisfeita':pct < 70?'üü¢ Satisfeita':'üåü Muito Satisfeita'}</small>
        </div>`;
    });

    html += `<b style="font-size:10px">A√á√ïES DE POL√çTICA P√öBLICA:</b><hr style="margin:4px 0">`;
    actions.forEach((a, i) => {
        let costStr = [];
        if(a.cost_p) costStr.push(`${a.cost_p}p`);
        if(a.cost_m) costStr.push(`R$${a.cost_m}M`);
        let canAfford = (!a.cost_p || game.points >= a.cost_p) && (!a.cost_m || game.money >= a.cost_m);
        html += `<button class="btn" onclick="doBaseAction(${i})" ${canAfford?'':'disabled'} style="text-align:left">
            ${a.label} (${costStr.join(', ')})<br>
            <small style="font-weight:normal;color:#555">${a.desc}</small>
        </button>`;
    });

    div.innerHTML = html;
    div._actions = actions;
}

function doBaseAction(idx) {
    const div = document.getElementById('base-content');
    const actions = div._actions || [];
    const a = actions[idx];
    if(!a) return;
    if(a.cost_p && game.points < a.cost_p) { log('Pontos insuficientes.'); return; }
    if(a.cost_m && game.money < a.cost_m) { log('Verba insuficiente.'); return; }
    if(a.cost_p) game.points -= a.cost_p;
    if(a.cost_m) game.money -= a.cost_m;
    a.effect();
    updateUI();
    renderBaseEleitoral();
}

// Apply base eleitoral effects each turn (called in nextTurn)
function applyBaseEleitoralEffects() {
    if(!game.baseEleitoral) return;
    const be = game.baseEleitoral;
    
    // Track neglect: if player hasn't visited base tab recently
    if(!game.baseTabVisited) game.baseTabVisited = 0;
    let turnsNeglected = game.turn - game.baseTabVisited;
    
    // Natural satisfaction decay - faster if neglected
    let decayRate = turnsNeglected >= 4 ? 0.12 : 0.05; // heavy decay if neglected 4+ turns
    Object.values(be).forEach(c => {
        c.satisfacao += (50 - c.satisfacao) * decayRate;
        // Additional active decay from neglect (satisfaction falls below 50 when neglected)
        if(turnsNeglected >= 3) {
            c.satisfacao = Math.max(0, c.satisfacao - (turnsNeglected * 0.8));
        }
    });
    
    // NEGLECT CONSEQUENCES: Serious penalties for not managing base
    if(turnsNeglected >= 4 && game.turn >= 5) {
        let penaltyPerTurn = Math.min(3.5, turnsNeglected * 0.5);
        updateNationalVotes(game.player, -penaltyPerTurn);
        
        if(turnsNeglected === 4) {
            queueEvent('‚ö†Ô∏è BASE ELEITORAL INSATISFEITA',
                `Voc√™ n√£o gerencia sua <b>base eleitoral</b> h√° <b>${turnsNeglected} turnos</b>!<br><br>` +
                `As classes sociais est√£o perdendo confian√ßa em sua campanha. Voc√™ est√° perdendo <b>${penaltyPerTurn.toFixed(1)}%</b> por turno.<br><br>` +
                `Se continuar ignorando a aba üìä BASE, grupos de eleitores ir√£o migrar para seus rivais!`,
                `<button class="btn" onclick="closeModal();showTab('base')">üìä Ir √† Base Eleitoral</button><button class="btn" onclick="closeModal()">Ignorar (Risco!)</button>`
            );
        }
        if(turnsNeglected >= 7) {
            // Severe: a class openly breaks from player
            let worstClass = Object.entries(be).sort((a,b)=>a[1].satisfacao-b[1].satisfacao)[0];
            if(worstClass) {
                let rivals = game.candidates.filter(c=>c.id!==game.player);
                if(rivals.length) {
                    let bestRival = rivals.sort((a,b)=>b.votes-a.votes)[0];
                    updateNationalVotes(bestRival.id, 1.5);
                    addNews(`${worstClass[1].desc.toUpperCase()} ABANDONA ${(candidatesData[game.player]?.name||'CANDIDATO').toUpperCase()}`,
                        `Classe insatisfeita migra para rivais. Neglig√™ncia na gest√£o da base eleitoral tem consequ√™ncias s√©rias.`);
                }
            }
        }
    }
    
    // Very low satisfaction causes vote loss
    Object.entries(be).forEach(([key, c]) => {
        if(c.satisfacao < 25) {
            updateNationalVotes(game.player, -1.5);
            addNews(`${c.desc.toUpperCase()} EM REVOLTA`, `A ${c.desc.toLowerCase()} est√° extremamente insatisfeita com ${candidatesData[game.player]?.name}. Migra√ß√£o de votos para rivais.`);
        } else if(c.satisfacao > 85) {
            updateNationalVotes(game.player, 0.5);
        }
    });
}

// ===== COLIGA√á√ïES SYSTEM =====
function renderColigacoes() {
    const div = document.getElementById('coligacoes-content');
    if(!div) return;
    if(!game.coalitionLoyalty) game.coalitionLoyalty = {};

    let coalitionParties = game.coalition.filter(p => !p.includes('_seat'));

    if(coalitionParties.length === 0) {
        div.innerHTML = `<div style="background:#fff8e8;border:1px solid #cc9900;padding:10px;font-size:11px;border-radius:3px">
            <b>Nenhum partido na coliga√ß√£o ainda.</b><br>
            Use <b>A√á√ïES ‚Üí ü§ù Negociar Alian√ßas</b> para convidar partidos.
        </div>`;
        return;
    }

    const partyActions = [
        { label:'üéôÔ∏è Evento Conjunto', desc:'Com√≠cio com representante do partido. +15 lealdade.', cost_p:2, cost_m:3, loyaltyGain:15 },
        { label:'üí¨ Reuni√£o de C√∫pula', desc:'Reafirma compromissos. +10 lealdade. Custo: 2p.', cost_p:2, loyaltyGain:10 },
        { label:'üìã Concess√£o Pol√≠tica', desc:'Cede espa√ßo nas propostas. +20 lealdade, -votos leve.', cost_p:1, loyaltyGain:20, votesCost:0.5 },
        { label:'üí∞ Repasse Financeiro', desc:'Transfere verba para o partido. +18 lealdade.', cost_m:10, loyaltyGain:18 },
    ];

    let html = `<div style="background:#f0fff0;border:1px solid #228b22;padding:8px;border-radius:3px;margin-bottom:8px;font-size:11px">
        <b>ü§ù Coliga√ß√£o: ${coalitionParties.length} partido(s)</b><br>
        <small style="color:#555">Lealdade abaixo de 30% = risco de trai√ß√£o. Mantenha os aliados satisfeitos com eventos e concess√µes!</small>
    </div>`;

    coalitionParties.forEach(partyName => {
        let loyalty = game.coalitionLoyalty[partyName] || { loyalty: 70, cargo: 'indefinido', betrayalWarned: false };
        let lPct = Math.min(100, Math.max(0, loyalty.loyalty));
        let barColor = lPct >= 60 ? '#2e7d32' : lPct >= 35 ? '#cc8800' : '#cc0000';
        let status = lPct >= 70 ? 'üíö Muito Leal' : lPct >= 50 ? 'üü° Confi√°vel' : lPct >= 30 ? 'üü† Vacilante' : 'üî¥ TRAI√á√ÉO IMINENTE';

        html += `<div class="coalition-party-card" style="border-color:${barColor};background:${lPct<30?'#fff5f5':lPct>70?'#f5fff5':'#fafafa'}">
            <b>${partyName}</b> <span style="font-size:9px;color:#666">(${loyalty.cargo||'sem cargo'})</span>
            <span style="float:right;color:${barColor};font-weight:bold">${lPct.toFixed(0)}%</span><br>
            <div class="coalition-loyalty-bar"><div class="coalition-loyalty-fill" style="width:${lPct}%;background:${barColor}"></div></div>
            <small>${status}</small><br>
            <div style="display:flex;flex-wrap:wrap;gap:3px;margin-top:4px">
                ${partyActions.map((a,i) => {
                    let costStr = [];
                    if(a.cost_p) costStr.push(`${a.cost_p}p`);
                    if(a.cost_m) costStr.push(`R$${a.cost_m}M`);
                    let canAfford = (!a.cost_p||game.points>=a.cost_p) && (!a.cost_m||game.money>=a.cost_m);
                    return `<button class="btn" style="width:auto;font-size:9px;padding:2px 5px" onclick="doCoalitionAction('${partyName}',${i})" ${canAfford?'':'disabled'}>${a.label} (${costStr.join(',')||'gr√°tis'})</button>`;
                }).join('')}
            </div>
        </div>`;
    });

    div.innerHTML = html;
    div._partyActions = partyActions;
}

function doCoalitionAction(partyName, idx) {
    const div = document.getElementById('coligacoes-content');
    const actions = div._partyActions || [];
    const a = actions[idx];
    if(!a) return;
    if(a.cost_p && game.points < a.cost_p) { log('Pontos insuficientes.'); return; }
    if(a.cost_m && game.money < a.cost_m) { log('Verba insuficiente.'); return; }
    if(a.cost_p) game.points -= a.cost_p;
    if(a.cost_m) game.money -= a.cost_m;

    if(!game.coalitionLoyalty[partyName]) game.coalitionLoyalty[partyName] = {loyalty:70, cargo:'indefinido', betrayalWarned:false};
    game.coalitionLoyalty[partyName].loyalty = Math.min(100, game.coalitionLoyalty[partyName].loyalty + a.loyaltyGain);
    game.coalitionLoyalty[partyName]._actedThisTurn = true; // marca que agiu ‚Üí menos decaimento
    if(a.extraPts) game.points += a.extraPts;
    if(a.votesCost) updateNationalVotes(game.player, -a.votesCost);

    log(`ü§ù ${a.label} com ${partyName}. Lealdade: +${a.loyaltyGain} ‚Üí ${game.coalitionLoyalty[partyName].loyalty.toFixed(0)}%`);
    updateUI();
    renderColigacoes();
}

// Apply coalition effects each turn (loyalty decay + betrayal check)
function applyCoalitionLoyaltyEffects() {
    if(!game.coalitionLoyalty) return;
    const toRemove = [];
    Object.entries(game.coalitionLoyalty).forEach(([partyName, loyalty]) => {
        // DECAIMENTO PESADO: -12 por turno se player n√£o agiu, -4 se agiu
        const didAct = loyalty._actedThisTurn;
        loyalty._actedThisTurn = false; // reset for next turn
        const decay = didAct ? 4 : 12;
        loyalty.loyalty = Math.max(0, loyalty.loyalty - decay);

        // AVISO: lealdade abaixo de 45%
        if(loyalty.loyalty < 45 && loyalty.loyalty >= 25 && !loyalty.betrayalWarned) {
            loyalty.betrayalWarned = true;
            addNews(`‚ö†Ô∏è ${partyName} INSATISFEITO`, `${partyName} est√° perdendo confian√ßa. Risco de trai√ß√£o crescente! Acesse COLIG. para agir.`);
            log(`‚ö†Ô∏è ${partyName} vacilante (${loyalty.loyalty.toFixed(0)}%). ATEN√á√ÉO!`);
            queueEvent(`‚ö†Ô∏è ${partyName} EST√Å INSATISFEITO`,
                `A lealdade do <b style="color:#cc6600">${partyName}</b> caiu para <b>${loyalty.loyalty.toFixed(0)}%</b>!<br><br>` +
                `Se voc√™ n√£o tomar a√ß√µes concretas (Aba ü§ù COLIG.), este partido pode trair sua coliga√ß√£o nos pr√≥ximos turnos.<br><br>` +
                `<b>Decay atual:</b> ${decay}% por turno sem a√ß√£o.`,
                `<button class="btn" onclick="closeModal();showTab('coligacoes')">ü§ù Ir √†s Coliga√ß√µes</button>`
            );
        }
        // Reset do aviso se lealdade recuperar
        if(loyalty.loyalty >= 50) loyalty.betrayalWarned = false;

        // ZONA CR√çTICA: abaixo de 20%, chance alta de trai√ß√£o
        if(loyalty.loyalty < 20) {
            const betrayChance = loyalty.loyalty < 10 ? 0.6 : 0.35;
            if(Math.random() < betrayChance) {
                toRemove.push(partyName);
                let pObj = game.availableParties ? game.availableParties.find(p => p.n === partyName) : null;
                if(pObj) pObj.owner = null;
                game.coalition = game.coalition.filter(p => p !== partyName && p !== partyName+'_seat');

                let rivals = game.candidates.filter(c => c.id !== game.player);
                let traitorTarget = rivals.length > 0 ? rivals[Math.floor(Math.random()*rivals.length)] : null;
                updateNationalVotes(game.player, -4);

                if(traitorTarget) {
                    updateNationalVotes(traitorTarget.id, 3);
                    if(pObj) pObj.owner = traitorTarget.id;
                }

                const playerName = candidatesData[game.player]?.name || 'Voc√™';
                const targetName = traitorTarget ? (traitorTarget.name || candidatesData[traitorTarget.id]?.name || 'um rival') : 'a oposi√ß√£o';

                // POPUP DRAM√ÅTICO DE TRAI√á√ÉO
                queueEvent(
                    `üí• TRAI√á√ÉO! ${partyName} ROMPEU COM VOC√ä!`,
                    `<div style="text-align:center;padding:10px;background:#1a0000;border-radius:6px;margin-bottom:12px">
                        <div style="font-size:28px;margin-bottom:4px">üí•üî™üí•</div>
                        <div style="color:#ff4444;font-weight:bold;font-size:15px">TRAI√á√ÉO CONSUMADA</div>
                    </div>
                    O partido <b style="color:#cc0000">${partyName}</b> abandonou a coliga√ß√£o de <b>${playerName}</b> e declarou apoio p√∫blico a <b style="color:#cc0000">${targetName}</b>!<br><br>
                    <b>Consequ√™ncias imediatas:</b><br>
                    üìâ <b>-4%</b> nas pesquisas nacionais<br>
                    üìà <b>+3%</b> para ${targetName}<br>
                    üóûÔ∏è Crise midi√°tica instalada<br>
                    üö´ ${partyName} saiu da sua coliga√ß√£o<br><br>
                    <i style="color:#888;font-size:10px">Negligenciar a aba COLIG. por muitos turnos abre espa√ßo para trai√ß√µes. Cuide da lealdade dos seus parceiros!</i>`,
                    `<button class="btn" style="background:#8b0000;color:white" onclick="closeModal()">üò° Que trai√ß√£o!</button>
                     <button class="btn" onclick="closeModal();openAllianceMenu()">ü§ù Buscar Novo Aliado</button>`
                );

                addNews(`üí• TRAI√á√ÉO: ${partyName} ABANDONA COLIGA√á√ÉO`, `${partyName} rompeu com ${playerName} e foi para ${targetName}. Crise pol√≠tica instala caos na campanha.`);
                log(`üí• TRAI√á√ÉO! ${partyName} ‚Üí ${targetName}. -4% pesquisas!`);

                // Atualiza exibi√ß√£o da coliga√ß√£o
                const coalDiv = document.getElementById('my-coalition');
                if(coalDiv) {
                    let parts = game.coalition.filter(p=>!p.includes('_seat'));
                    coalDiv.innerHTML = parts.map(p=>`<span class="party-tag">${p}</span>`).join('') || '<span style="color:#888;font-size:10px">Sem coliga√ß√£o</span>';
                }
            }
        }
    });
    // Remove partidos traidores
    toRemove.forEach(p => delete game.coalitionLoyalty[p]);
}

function doRegionalRally(regionId) {
    if(game.points < 3) { log('Pontos insuficientes para com√≠cio (3p).'); return; }
    if(game.money < 5) { log('Verba insuficiente para com√≠cio (R$5M).'); return; }
    game.points -= 3; game.money -= 5;
    if(!game.stateVotes[regionId]) game.stateVotes[regionId] = {};
    game.stateVotes[regionId][game.player] = (game.stateVotes[regionId][game.player] || 0) + 5;
    // Renormalize
    let stateSum = Object.values(game.stateVotes[regionId]).reduce((a,b)=>a+b,0);
    if(stateSum > 0) Object.keys(game.stateVotes[regionId]).forEach(cid => { game.stateVotes[regionId][cid] = (game.stateVotes[regionId][cid]/stateSum)*100; });
    updateNationalVotes(game.player, 1.5);
    log(`üé∫ Com√≠cio em ${regionId}! +5pts local (normalizado), +1.5% nacional.`);
    updateUI(); renderRegions();
}

function doRegionalRallyBR(region) {
    if(game.points < 3) { log('Pontos insuficientes para com√≠cio (3p).'); return; }
    if(game.money < 5) { log('Verba insuficiente para com√≠cio (R$5M).'); return; }
    game.points -= 3; game.money -= 5;
    let states = allStates.filter(s => s.r === region);
    states.forEach(s => {
        if(!game.stateVotes[s.id]) return;
        // Adiciona votos brutos ao candidato
        game.stateVotes[s.id][game.player] = (game.stateVotes[s.id][game.player] || 0) + 4;
        // Renormaliza os votos do estado para somarem 100%
        let stateSum = Object.values(game.stateVotes[s.id]).reduce((a,b)=>a+b,0);
        if(stateSum > 0) {
            Object.keys(game.stateVotes[s.id]).forEach(cid => {
                game.stateVotes[s.id][cid] = (game.stateVotes[s.id][cid] / stateSum) * 100;
            });
        }
    });
    updateNationalVotes(game.player, 2);
    log(`üé∫ Grande com√≠cio no ${region}! +4pts nos estados da regi√£o (normalizados), +2% nacional.`);
    updateUI(); renderRegions(); renderMap();
}

// ===== IMPROVED POLL CHART =====
function showChart() {
    const modal = document.getElementById('chart-modal');
    modal.style.display = 'flex';
    const canvas = document.getElementById('poll-chart');
    const ctx = canvas.getContext('2d');
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    const W = canvas.width, H = canvas.height;
    const padL = 38, padB = 28, padT = 20, padR = 20;
    const chartW = W - padL - padR;
    const chartH = H - padB - padT;
    const maxT = Math.max(game.pollHistory.length - 1, 1);
    
    // Background
    ctx.fillStyle = '#f8f8f8';
    ctx.fillRect(padL, padT, chartW, chartH);
    
    // Grid lines & Y labels
    ctx.font = '9px monospace';
    [0,10,20,30,40,50,60,70,80,90,100].forEach(pct => {
        let y = padT + chartH - (pct/100)*chartH;
        ctx.strokeStyle = pct%20===0 ? '#bbb' : '#e0e0e0';
        ctx.lineWidth = pct%20===0 ? 1 : 0.5;
        ctx.beginPath(); ctx.moveTo(padL, y); ctx.lineTo(W-padR, y); ctx.stroke();
        if(pct%20===0) {
            ctx.fillStyle = '#555';
            ctx.fillText(pct+'%', 0, y+3);
        }
    });
    
    // X grid / turn labels
    for(let i=0; i<=maxT; i++) {
        let x = padL + (i/maxT)*chartW;
        ctx.strokeStyle = '#ddd'; ctx.lineWidth = 0.5;
        ctx.beginPath(); ctx.moveTo(x, padT); ctx.lineTo(x, padT+chartH); ctx.stroke();
        ctx.fillStyle='#666'; ctx.font='8px monospace';
        ctx.fillText('T'+(i+1), x-5, H-8);
    }
    
    // Border
    ctx.strokeStyle = '#888'; ctx.lineWidth = 1;
    ctx.strokeRect(padL, padT, chartW, chartH);
    
    // Draw lines with glow effect for player
    game.candidates.forEach(c => {
        let cd = candidatesData[c.id];
        let isPlayer = c.id === game.player;
        ctx.strokeStyle = cd.color;
        ctx.lineWidth = isPlayer ? 3 : 1.5;
        if(isPlayer) {
            ctx.shadowColor = cd.color; ctx.shadowBlur = 6;
        } else {
            ctx.shadowBlur = 0;
        }
        ctx.beginPath();
        game.pollHistory.forEach((snap, i) => {
            let x = padL + (i / maxT) * chartW;
            let y = padT + chartH - (snap.votes[c.id]||0)/100 * chartH;
            i === 0 ? ctx.moveTo(x, y) : ctx.lineTo(x, y);
        });
        ctx.stroke();
        ctx.shadowBlur = 0;
        // Dot at last point
        if(game.pollHistory.length > 0) {
            let last = game.pollHistory[game.pollHistory.length-1];
            let x = padL + ((game.pollHistory.length-1) / maxT) * chartW;
            let y = padT + chartH - (last.votes[c.id]||0)/100 * chartH;
            ctx.fillStyle = cd.color;
            ctx.beginPath(); ctx.arc(x, y, isPlayer?4:2.5, 0, Math.PI*2); ctx.fill();
            // Label
            ctx.fillStyle = '#222'; ctx.font = isPlayer?'bold 9px monospace':'9px monospace';
            ctx.fillText(`${cd.name||c.id}: ${(last.votes[c.id]||0).toFixed(1)}%`, x+5, y);
        }
    });
    
    // Legend
    const legend = document.getElementById('chart-legend');
    legend.innerHTML = `<b>Turno atual: ${game.turn}</b> &nbsp;&nbsp;` + game.candidates.map(c => 
        `<span style="color:${c.color};font-weight:${c.id===game.player?'bold':'normal'}">‚ñ† ${c.name}: ${c.votes.toFixed(1)}%</span>`
    ).join('&nbsp;&nbsp;');
}

function generateSocialMediaEvent() {
    if(!socialMediaEvents || socialMediaEvents.length === 0) return;
    // Sem eventos de redes sociais em cen√°rios anteriores a 2010
    let yr = parseInt(game.scenario) || 2000;
    if(yr < 2010 && !game.isElectoralCollege) return;
    let sorted = [...game.candidates].sort((a,b) => b.votes - a.votes);
    let candidates = sorted.slice(0, 3); // top 3 candidates
    
    // Pick a random candidate to be featured (player weighted more)
    let featuredCand;
    let roll = Math.random();
    if(roll < 0.45) {
        featuredCand = game.candidates.find(c => c.id === game.player);
    } else {
        featuredCand = candidates[Math.floor(Math.random() * candidates.length)];
    }
    if(!featuredCand) return;
    
    let isPlayer = featuredCand.id === game.player;
    let event = socialMediaEvents[Math.floor(Math.random() * socialMediaEvents.length)];
    let opp = sorted.find(c => c.id !== featuredCand.id);
    
    let candName = featuredCand.name || candidatesData[featuredCand.id]?.name || featuredCand.id;
    let oppName = opp ? (opp.name || candidatesData[opp.id]?.name || opp.id) : 'rival';
    
    let tweet = event.gen(candName, oppName);
    let effect = event.effect(featuredCand.id, isPlayer);
    let newsTitle = event.news(candName);
    
    updateNationalVotes(featuredCand.id, effect * 0.7); // social media effect is moderate
    addNews(newsTitle, tweet.replace(/^[üî•üö´ü§ñüì∏üßµ#Ô∏è‚É£üéôÔ∏è]+\s*[A-Z]+:\s*/, '').substring(0, 120));
    
    // Add to social feed if it exists
    if(game.socialFeed) {
        game.socialFeed.unshift({
            text: tweet,
            turn: game.turn,
            type: event.type,
            effect: effect
        });
        if(game.socialFeed.length > 20) game.socialFeed.pop();
    } else {
        game.socialFeed = [{text: tweet, turn: game.turn, type: event.type, effect: effect}];
    }
}
function aiStrategicTurn() {
    let sorted = [...game.candidates].sort((a,b) => b.votes - a.votes);
    let leader = sorted[0];
    let totalVotes = game.candidates.reduce((s,c) => s + c.votes, 0);
    let turnsLeft = (game.fase === 1 ? 15 : 3) - game.turn;
    
    game.candidates.forEach(c => {
        if(c.id === game.player) return;
        let cd = candidatesData[c.id];
        if(!cd) return;
        
        let isLeader = c.id === leader.id;
        let voteShare = c.votes / Math.max(1, totalVotes);
        let rankPos = sorted.findIndex(s => s.id === c.id);
        
        // Base gain: leaders grow slower (gravity), underdogs have more variance
        let baseMin = isLeader ? 0.2 : 0.4;
        let baseMax = isLeader ? 1.2 : (rankPos >= 3 ? 2.5 : 1.8);
        let gain = baseMin + Math.random() * (baseMax - baseMin);
        
        // Difficulty scaling
        gain += (game.difficulty - 2) * 0.2;
        
        // Late-game momentum: leaders get consolidation effect, trailing get pressure
        if(turnsLeft <= 4) {
            if(isLeader) gain += 0.5; // frontrunner momentum
            if(rankPos === 1) gain += 0.3; // second place push
        }
        
        // Ideological consistency: candidate more aligned with current radicalization level
        if(radicalizationLevel > 60 && (Math.abs(cd.econ||0) + Math.abs(cd.soc||0) >= 3)) gain += 0.4;
        if(radicalizationLevel < 30 && (Math.abs(cd.econ||0) <= 1)) gain += 0.2; // moderate voters prefer center
        
        // Attack strategy: challengers in 2nd/3rd place attack leader
        if(!isLeader && rankPos <= 2 && Math.random() > 0.55) {
            let attack = 0.5 + Math.random() * 1.0;
            updateNationalVotes(leader.id, -attack);
            gain += attack * 0.4;
        }
        
        // Ca√≥tico mode
        if(game.mode === 'caotico') gain += Math.random() * 2.5 - 0.5;
        
        // Esc√¢ndalos penalizam severamente
        let scandalPenalty = (game.scandalLevels[c.id] || 0) * 0.25;
        gain -= scandalPenalty;
        
        // Approval/rejection reality check: high rejection = ceiling effect
        let approval = game.approvals[c.id] || {app:50, rej:30};
        if(approval.rej > 60) gain -= 0.5;
        if(approval.app > 70) gain += 0.2;
        
        // Dead heat detection: if within 3% of player, tighten race
        let playerVotes = (game.candidates.find(p => p.id === game.player) || {votes:0}).votes;
        let diff = Math.abs(c.votes - playerVotes);
        if(diff < 3 && rankPos <= 1) gain += 0.3; // tight race intensifies
        
        // Very small parties have natural ceiling
        if(c.votes > 15 && rankPos >= 3) gain *= 0.6;
        
        updateNationalVotes(c.id, Math.max(-2, gain));
        
        // Strategic alliances (every ~3 turns, ideologically coherent)
        if(Math.random() > 0.8 && game.availableParties.length > 0) {
            let compatible = game.availableParties.filter(p => {
                if(p.owner) return false;
                if(cd.side === 'E') return p.side === 'E' || p.side === 'C';
                if(cd.side === 'D') return p.side === 'D' || p.side === 'C';
                return true;
            });
            if(compatible.length > 0) {
                let chosen = compatible[Math.floor(Math.random() * compatible.length)];
                chosen.owner = c.id;
                updateNationalVotes(c.id, 1.2);
                addNews(`ALIAN√áA: ${chosen.n} APOIA ${cd.name}`, `O ${chosen.n} anuncia apoio formal √† candidatura de ${cd.name}.`);
            }
        }
    });
    
    // Natural regression to mean: extreme votes get pulled toward competitive range
    game.candidates.forEach(c => {
        if(c.id === game.player) return;
        if(c.votes > 55) updateNationalVotes(c.id, -0.5); // nobody gets too dominant
        if(c.votes < 1 && candidatesData[c.id] && candidatesData[c.id].start > 5) {
            updateNationalVotes(c.id, 0.3); // rescue parties with historical relevance
        }
    });
}

// Atualiza aprova√ß√£o/rejei√ß√£o
function updateApprovalRejection() {
    game.candidates.forEach(c => {
        if(!game.approvals[c.id]) game.approvals[c.id] = {app:50, rej:30};
        let sorted = [...game.candidates].sort((a,b)=>b.votes-a.votes);
        let isLeader = sorted[0].id === c.id;
        // TV aumenta aprova√ß√£o do player
        game.approvals[c.id].app = Math.min(95, game.approvals[c.id].app + (isLeader ? 0.5 : 0));
        game.approvals[c.id].rej = Math.max(0, Math.min(95, game.approvals[c.id].rej + (isLeader ? 0.5 : -0.2)));
        // Esc√¢ndalos aumentam rejei√ß√£o
        if(game.scandalLevels[c.id] > 0) {
            game.approvals[c.id].rej = Math.min(95, game.approvals[c.id].rej + game.scandalLevels[c.id]*0.3);
        }
    });
}

// Checagem de momentum
function checkMomentum() {
    if(game.pollHistory.length < 3) return;
    let prev = game.pollHistory[game.pollHistory.length-3];
    let curr = game.pollHistory[game.pollHistory.length-1];
    game.candidates.forEach(c => {
        let delta = (curr.votes[c.id]||0) - (prev.votes[c.id]||0);
        if(!game.momentumTracker[c.id]) game.momentumTracker[c.id] = [];
        game.momentumTracker[c.id].push(delta);
        if(game.momentumTracker[c.id].length > 3) game.momentumTracker[c.id].shift();
        let totalDelta = game.momentumTracker[c.id].reduce((a,b)=>a+b,0);
        if(totalDelta > 5) {
            addNews(`ONDA DE ${candidatesData[c.id].name}`, `${candidatesData[c.id].name} cresce ${totalDelta.toFixed(1)}% em dois turnos! Analistas falam em fen√¥meno eleitoral.`);
            if(c.id === game.player) {
                updateNationalVotes(c.id, 1); // bonus momentum
                log(`üî• MOMENTUM! B√¥nus autom√°tico de +1% pela onda de crescimento.`);
            }
        }
    });
}


function actionMeetup() {
    if(game.points < 4 || game.money < 8) { log("Pontos/verba insuficientes (4p, R$8M)."); return; }
    game.points -= 4; game.money -= 8;
    let roll = Math.random();
    if(roll > 0.5) {
        let gain = 3.5 + Math.random() * 2;
        updateNationalVotes(game.player, gain);
        game.approvals[game.player].app += 7;
        addNews(`COM√çCIO DE ${candidatesData[game.player].name} LOTA EST√ÅDIO`, `Multid√£o supera expectativas. Candidato faz discurso hist√≥rico.`);
        log(`üèüÔ∏è Com√≠cio de massa! Est√°dio lotado. +${gain.toFixed(1)}% e +7 aprova√ß√£o.`);
    } else {
        let gain = 1.5 + Math.random();
        updateNationalVotes(game.player, gain);
        log(`üèüÔ∏è Com√≠cio realizado. P√∫blico razo√°vel. +${gain.toFixed(1)}%.`);
    }
    updateUI();
}

function actionPressKit() {
    if(game.points < 2) { log("Pontos insuficientes (2p)."); return; }
    game.points -= 2;
    // Press kit improves media coverage for 2 turns (via approval)
    game.approvals[game.player].app += 4;
    let gain = 1.0 + Math.random() * 1.5;
    updateNationalVotes(game.player, gain);
    addNews(`KIT DE IMPRENSA: ${candidatesData[game.player].name}`, `Candidato distribui material profissional √† imprensa nacional. Cobertura melhora.`);
    log(`üì∞ Kit de imprensa distribu√≠do. +${gain.toFixed(1)}% e melhor cobertura da m√≠dia.`);
    updateUI();
}

function actionDocumentario() {
    if(game.points < 4) { log("Pontos insuficientes (4p)."); return; }
    if(game.money < 5) { log("Verba insuficiente (R$5M)."); return; }
    game.points -= 4;
    game.money -= 5;
    let roll = Math.random();
    let playerC = candidatesData[game.player];
    if(roll > 0.3) {
        let gain = 2.5 + Math.random() * 2;
        updateNationalVotes(game.player, gain);
        game.approvals[game.player].app += 5;
        gainSpirit('momentum_midias');
        addNews(`üé¨ DOCUMENT√ÅRIO DE ${playerC.name} BOMBA`, `Produ√ß√£o audiovisual mostra lado humano do candidato. Viralizou nas redes e na TV por assinatura.`);
        log(`üé¨ Document√°rio foi um sucesso! +${gain.toFixed(1)}% e esp√≠rito midi√°tico ativado.`);
    } else {
        let gain = 0.5;
        updateNationalVotes(game.player, gain);
        addNews(`üé¨ DOCUMENT√ÅRIO DE ${playerC.name}`, `Produ√ß√£o bem-feita mas sem grande repercuss√£o imediata.`);
        log(`üé¨ Document√°rio bem-feito mas sem grande impacto imediato. +${gain.toFixed(1)}%.`);
    }
    updateUI();
}

function actionInfluenciadores() {
    if(game.points < 3) { log("Pontos insuficientes (3p)."); return; }
    if(game.money < 3) { log("Verba insuficiente (R$3M)."); return; }
    game.points -= 3;
    game.money -= 3;
    let roll = Math.random();
    let playerC = candidatesData[game.player];
    if(roll > 0.35) {
        let gain = 2.0 + Math.random() * 2.5;
        updateNationalVotes(game.player, gain);
        gainSpirit('momentum_midias');
        addNews(`ü§≥ INFLUENCIADORES APOIAM ${playerC.name}`, `Parceria com criadores de conte√∫do digital repercute entre jovens eleitores. Engajamento recorde.`);
        log(`ü§≥ Influenciadores engajaram com autenticidade! +${gain.toFixed(1)}% nas pesquisas.`);
    } else {
        updateNationalVotes(game.player, -0.5);
        game.approvals[game.player].rej += 3;
        addNews(`ü§≥ CAMPANHA COM INFLUENCERS GERA POL√äMICA`, `Eleitores criticam marketing digital como tentativa for√ßada. Autenticidade questionada.`);
        log(`ü§≥ Parceria pareceu for√ßada. -0.5% e +3 rejei√ß√£o. Eleitores perceberam o marketing.`);
    }
    updateUI();
}

function actionCriseMediatica() {
    if(game.points < 3) { log("Pontos insuficientes (3p)."); return; }
    game.points -= 3;
    let playerC = candidatesData[game.player];
    let scandalLevel = game.scandalLevels[game.player] || 0;
    let rejBefore = game.approvals[game.player].rej;
    // Reduces scandal and rejection
    let rejReduction = 3 + Math.floor(Math.random() * 4);
    game.approvals[game.player].rej = Math.max(0, game.approvals[game.player].rej - rejReduction);
    if(scandalLevel > 0) {
        game.scandalLevels[game.player] = Math.max(0, scandalLevel - 1);
        log(`üõ°Ô∏è Crise midi√°tica gerenciada! Esc√¢ndalo reduzido. Rejei√ß√£o -${rejReduction} pontos.`);
        addNews(`üõ°Ô∏è ASSESSORIA DE IMAGEM DE ${playerC.name} ATUA`, `Equipe de comunica√ß√£o apaga inc√™ndio midi√°tico. Candidato retoma narrativa.`);
    } else {
        // No scandal - builds positive media armor
        gainSpirit('escudo_midiatico');
        log(`üõ°Ô∏è Estrat√©gia preventiva! Escudo midi√°tico ativado. Rejei√ß√£o -${rejReduction} pontos.`);
        addNews(`üõ°Ô∏è ${playerC.name} BLINDADO MIDIATICAMENTE`, `Campanha implementa estrat√©gia de comunica√ß√£o defensiva proativa.`);
    }
    updateUI();
}

function actionInfluencerPaid() {
    if(game.points < 3 || game.money < 6) { log("Pontos/verba insuficientes (3p, R$6M)."); return; }
    game.points -= 3; game.money -= 6;
    let roll = Math.random();
    if(roll > 0.4) {
        let gain = 2.5 + Math.random() * 2;
        updateNationalVotes(game.player, gain);
        addNews(`INFLUENCER VIRALIZA APOIO A ${candidatesData[game.player].name}`, `Post patrocinado vira org√¢nico. Alcance exponencial nas redes.`);
        log(`üåü Influencer engajou! +${gain.toFixed(1)}% nas pesquisas.`);
    } else {
        updateNationalVotes(game.player, -1);
        game.approvals[game.player].rej += 4;
        addNews(`PARCERIA PAGA GERA POL√äMICA`, `Eleitores criticam marketing disfar√ßado de apoio genu√≠no.`);
        log(`üåü Influencer pareceu for√ßado. Eleitores perceberam o patroc√≠nio. -1% e +4 rejei√ß√£o.`);
    }
    updateUI();
}

function actionCrowdfunding() {
    if(game.points < 2) { log("Pontos insuficientes (2p)."); return; }
    game.points -= 2;
    let base = 12 + Math.floor(Math.random() * 15);
    game.money += base;
    updateNationalVotes(game.player, 0.8);
    game.approvals[game.player].app += 3;
    addNews(`CROWDFUNDING DE ${candidatesData[game.player].name} ARRECADA R$${base}M`, `Campanha popular demonstra engajamento real da base.`);
    log(`üí≥ Crowdfunding digital arrecadou R$${base}M! +0.8% org√¢nico.`);
    updateUI();
}

function actionONGParcerias() {
    if(game.points < 2) { log("Pontos insuficientes (2p)."); return; }
    game.points -= 2;
    let playerSide = candidatesData[game.player].side;
    if(playerSide === 'D') {
        // Conservadores t√™m acesso diferente
        game.money += 10;
        game.approvals[game.player].app += 3;
        log(`üå± Parcerias com entidades do setor privado e igrejas: R$10M e +3 aprova√ß√£o.`);
    } else {
        game.money += 8;
        let gain = 1.2;
        updateNationalVotes(game.player, gain);
        game.approvals[game.player].app += 5;
        addNews(`${candidatesData[game.player].name} FIRMA PARCERIA COM ONGs`, `Candidato anuncia agenda social com organiza√ß√µes da sociedade civil.`);
        log(`üå± Parceria com ONGs: R$8M e +${gain}% pela mobiliza√ß√£o da sociedade civil.`);
    }
    updateUI();
}

function actionLeilaoArte() {
    if(game.points < 3 || game.money < 3) { log("Pontos/verba insuficientes (3p, R$3M)."); return; }
    game.points -= 3; game.money -= 3;
    let raised = 20 + Math.floor(Math.random() * 25);
    game.money += raised;
    game.approvals[game.player].app += 4;
    addNews(`LEIL√ÉO BENEFICENTE ARRECADA R$${raised}M`, `Evento de luxo da campanha de ${candidatesData[game.player].name} re√∫ne personalidades.`);
    log(`üñºÔ∏è Leil√£o beneficente! Custo R$3M, arrecada√ß√£o R$${raised}M. Lucro l√≠quido R$${raised-3}M.`);
    updateUI();
}

function actionDebateRegional() {
    if(game.points < 3 || game.money < 5) { log("Pontos/verba insuficientes (3p, R$5M)."); return; }
    game.points -= 3; game.money -= 5;
    // Bonus em regi√µes onde candidato √© fraco
    let sorted = [...game.candidates].sort((a,b) => b.votes - a.votes);
    let gain = 2 + Math.random() * 2;
    updateNationalVotes(game.player, gain);
    game.approvals[game.player].app += 5;
    addNews(`TOUR REGIONAL DE ${candidatesData[game.player].name}`, `Candidato percorre regi√µes estrat√©gicas intensificando presen√ßa local.`);
    log(`üó∫Ô∏è Tour regional conclu√≠do. Visitou estados-chave. +${gain.toFixed(1)}% e +5 aprova√ß√£o.`);
    updateUI();
}

// Jornal din√¢mico
function generateDynamicNews() {
    let sorted = [...game.candidates].sort((a,b)=>b.votes-a.votes);
    let leader = sorted[0];
    let second = sorted[1];
    let playerC = game.candidates.find(c=>c.id===game.player);
    let sc = internationalData[game.scenario] || scenariosData[game.scenario];
    let year = sc ? (sc.year || sc.endYear || game.scenario) : game.scenario;
    let isBR = !game.isElectoralCollege && !game.isGovernor && !game.isRepVelha;
    let isIntl = game.isElectoralCollege || (internationalData[game.scenario] && !game.isElectoralCollege);

    // Determine newspaper identity based on scenario
    function getPaperName(lean) {
        if(game.scenario && game.scenario.startsWith('USA')) {
            return lean==='L' ? 'The New York Times' : lean==='R' ? 'The Wall Street Journal' : 'The Associated Press';
        } else if(game.scenario && game.scenario.startsWith('GER')) {
            return lean==='L' ? 'Der Spiegel' : lean==='R' ? 'Die Welt' : 'Frankfurter Allgemeine';
        } else if(game.scenario && game.scenario.startsWith('UK')) {
            return lean==='L' ? 'The Guardian' : lean==='R' ? 'The Daily Telegraph' : 'The Times';
        } else if(game.scenario && game.scenario.startsWith('FRA')) {
            return lean==='L' ? 'Le Monde' : lean==='R' ? 'Le Figaro' : 'Le Parisien';
        } else if(game.scenario && game.scenario.startsWith('ARG')) {
            return lean==='L' ? 'P√°gina 12' : lean==='R' ? 'La Naci√≥n' : 'Clar√≠n';
        } else if(game.scenario && game.scenario.startsWith('RUS')) {
            return lean==='L' ? 'Novaya Gazeta' : lean==='R' ? 'Rossiyskaya Gazeta' : 'Kommersant';
        } else if(isBR) {
            return lean==='L' ? 'Brasil de Fato' : lean==='R' ? 'O Globo / Veja' : 'Folha de S.Paulo';
        }
        return lean==='L' ? 'The Progressive' : lean==='R' ? 'The Conservative Tribune' : 'National Dispatch';
    }

    // Generate politically slanted headlines
    let leaderCd = candidatesData[leader.id] || {};
    let secCd = candidatesData[second.id] || {};
    let leaderSide = leaderCd.side || 'C'; // E=left, D=right, C=center
    
    // Left-leaning paper
    let leftPaper = getPaperName('L');
    let rightPaper = getPaperName('R');
    let centerPaper = getPaperName('C');
    
    // Left paper: supports left candidates, attacks right ones
    if(Math.random() > 0.5) {
        let leftCand = sorted.find(c=>(candidatesData[c.id]||{}).side==='E') || leader;
        let rightCand = sorted.find(c=>(candidatesData[c.id]||{}).side==='D') || second;
        let leftCdN = (candidatesData[leftCand.id]||{}).name || 'Progressive candidate';
        let rightCdN = (candidatesData[rightCand.id]||{}).name || 'Conservative candidate';
        let headlines = [
            `${leftCdN} DEFENDS WORKERS AND SOCIAL RIGHTS ‚Äî VOTERS RALLY`,
            `${rightCdN} UNDER FIRE: ECONOMIC PLAN WOULD HURT THE POOR, EXPERTS WARN`,
            `GRASSROOTS MOMENTUM GROWS FOR ${leftCdN} CAMPAIGN`,
            `ANALYSIS: ${rightCdN}'s POLICIES FAVOR THE WEALTHY OVER EVERYONE ELSE`,
            `${leftCdN}: 'THIS ELECTION IS ABOUT JUSTICE AND EQUALITY'`,
        ];
        if(isBR) headlines = [
            `${leftCdN} DEFENDE TRABALHADORES E DIREITOS SOCIAIS ‚Äî BASE CRESCE`,
            `${rightCdN} SOB PRESS√ÉO: PLANO ECON√îMICO PREJUDICARIA OS MAIS POBRES`,
            `MOBILIZA√á√ÉO POPULAR EM TORNO DE ${leftCdN}`,
            `AN√ÅLISE: PROGRAMA DE ${rightCdN} FAVORECE ELITE, ALERTAM ESPECIALISTAS`,
            `${leftCdN}: 'ESTA ELEI√á√ÉO √â SOBRE JUSTI√áA E IGUALDADE'`,
        ];
        addNews(`üì∞ ${leftPaper}`, headlines[Math.floor(Math.random()*headlines.length)]);
    }
    
    // Right paper: supports right candidates, attacks left ones
    if(Math.random() > 0.5) {
        let leftCand = sorted.find(c=>(candidatesData[c.id]||{}).side==='E') || leader;
        let rightCand = sorted.find(c=>(candidatesData[c.id]||{}).side==='D') || second;
        let leftCdN = (candidatesData[leftCand.id]||{}).name || 'Progressive candidate';
        let rightCdN = (candidatesData[rightCand.id]||{}).name || 'Conservative candidate';
        let headlines = [
            `${rightCdN} STRONG ON SECURITY AND ECONOMIC GROWTH, POLL SHOWS`,
            `${leftCdN}'s SPENDING PROMISES: WHO WILL PAY THE BILL?`,
            `BUSINESS LEADERS BACK ${rightCdN}'s PRO-GROWTH AGENDA`,
            `${leftCdN}: RADICAL ECONOMIC IDEAS THREATEN STABILITY, WARNS MARKET`,
            `${rightCdN} LEADS AMONG SUBURBAN AND RURAL VOTERS ‚Äî KEY COALITION`,
        ];
        if(isBR) headlines = [
            `${rightCdN} FORTE EM SEGURAN√áA E CRESCIMENTO ECON√îMICO, APONTA PESQUISA`,
            `PROMESSAS DE GASTOS DE ${leftCdN}: QUEM VAI PAGAR A CONTA?`,
            `SETOR EMPRESARIAL APOIA AGENDA PR√ì-CRESCIMENTO DE ${rightCdN}`,
            `${leftCdN}: IDEIAS ECON√îMICAS RADICAIS AMEA√áAM ESTABILIDADE`,
            `${rightCdN} LIDERA ENTRE ELEITORES DO INTERIOR E CLASSE M√âDIA`,
        ];
        addNews(`üì∞ ${rightPaper}`, headlines[Math.floor(Math.random()*headlines.length)]);
    }

    // Center/objective paper
    let headlines = [
        () => `${(candidatesData[leader.id]||{}).name||'LEADER'} LEADS WITH ${leader.votes.toFixed(1)}% ‚Äî RACE STILL OPEN`,
        () => { 
            let diff = leader.votes - second.votes;
            return diff < 5 ? `NECK AND NECK: ONLY ${diff.toFixed(1)}% SEPARATES TOP TWO` : null;
        },
        () => {
            if(playerC && playerC.votes > 20 && playerC.id !== leader.id) return `${(candidatesData[playerC.id]||{}).name||'CANDIDATE'} SURGE SURPRISES ANALYSTS`;
            return null;
        },
        () => {
            let biggest = Object.entries(game.scandalLevels).sort((a,b)=>b[1]-a[1])[0];
            if(biggest && biggest[1] >= 5) return `CRISIS IN ${((candidatesData[biggest[0]]||{}).name||'CANDIDATE').toUpperCase()}'S CAMPAIGN`;
            return null;
        }
    ];
    if(isBR) headlines = [
        () => `${(candidatesData[leader.id]||{}).name||'L√çDER'} LIDERA COM ${leader.votes.toFixed(1)}% ‚Äî CORRIDA ABERTA`,
        () => { 
            let diff = leader.votes - second.votes;
            return diff < 5 ? `EMPATE T√âCNICO: APENAS ${diff.toFixed(1)}% SEPARA OS DOIS PRIMEIROS` : null;
        },
        () => {
            if(playerC && playerC.votes > 20 && playerC.id !== leader.id) return `CRESCIMENTO DE ${(candidatesData[playerC.id]||{}).name||'CANDIDATO'} SURPREENDE ANALISTAS`;
            return null;
        },
        () => {
            let biggest = Object.entries(game.scandalLevels).sort((a,b)=>b[1]-a[1])[0];
            if(biggest && biggest[1] >= 5) return `CRISE NA CAMPANHA DE ${(candidatesData[biggest[0]]||{}).name||'CANDIDATO'}`;
            return null;
        }
    ];
    headlines.forEach(fn => {
        let h = fn();
        if(h && Math.random() > 0.4) addNews(`üì∞ ${centerPaper} ‚Äî Turn ${game.turn}`, h);
    });
}

function renderApprovalBars() {
    const div = document.getElementById('approval-bars');
    if(!div) return;
    div.innerHTML = game.candidates.map(c => {
        let ap = game.approvals[c.id]||{app:50,rej:30};
        let scandal = game.scandalLevels[c.id]||0;
        let scanHtml = scandal > 0 ? `<span style="color:red;font-size:9px"> üí•${scandal}</span>` : '';
        return `<div class="approval-row"><span style="color:${c.color};width:40px;display:inline-block;font-size:9px">${c.name}</span>
            <span style="color:green">‚úì</span><div class="mini-bar"><div class="approve-fill" style="width:${Math.min(100,ap.app)}%"></div></div>
            <span style="color:red">‚úó</span><div class="mini-bar"><div class="reject-fill" style="width:${Math.min(100,ap.rej)}%"></div></div>${scanHtml}</div>`;
    }).join('');
}

// Votos do 2¬∫ turno com migra√ß√£o ideol√≥gica
function applyIdeologicalMigration() {
    if(game.fase !== 2 || !game.defeatedCandidates) return;
    game.defeatedCandidates.forEach(dc => {
        let dcData = candidatesData[dc.id];
        let candidates2 = game.candidates;
        if(candidates2.length < 2) return;
        let distA = getIdeologyDistance(dc.id, candidates2[0].id);
        let distB = getIdeologyDistance(dc.id, candidates2[1].id);
        // Eleitores migram para candidato mais pr√≥ximo ideologicamente
        let migBonus = 2;
        if(distA < distB) {
            updateNationalVotes(candidates2[0].id, migBonus);
        } else if(distB < distA) {
            updateNationalVotes(candidates2[1].id, migBonus);
        }
    });
}

// Gera congresso simulado
function generateCongress(winner) {
    let seats = {[winner.id]: 50};
    game.coalition.forEach((partyName, i) => {
        seats[winner.id] = (seats[winner.id]||0) + 5;
    });
    game.candidates.filter(c=>c.id!==winner.id).forEach(c => {
        seats[c.id] = Math.max(5, Math.round(c.votes * 1.2));
    });
    // Ajusta total
    let total = Object.values(seats).reduce((a,b)=>a+b,0);
    Object.keys(seats).forEach(k => seats[k] = Math.round(seats[k]/total*513));
    game.congressSeats = seats;
    
    const barsDiv = document.getElementById('congress-bars');
    if(!barsDiv) return;
    barsDiv.innerHTML = '<b>C√ÇMARA DOS DEPUTADOS (513 cadeiras)</b>';
    let bar = document.createElement('div');
    bar.className = 'congress-bar';
    Object.entries(seats).forEach(([id, n]) => {
        let seg = document.createElement('div');
        seg.className = 'congress-segment';
        seg.style.width = (n/513*100)+'%';
        seg.style.background = candidatesData[id] ? candidatesData[id].color : '#888';
        seg.title = `${candidatesData[id]?candidatesData[id].name:id}: ${n} cadeiras`;
        seg.innerText = n > 30 ? n : '';
        bar.appendChild(seg);
    });
    barsDiv.appendChild(bar);
    
    let wSeats = seats[winner.id]||0;
    let govDiv = document.getElementById('congress-gov');
    if(govDiv) {
        let govText = wSeats >= 257 ? '‚úÖ MAIORIA ABSOLUTA - Governabilidade garantida!' 
                    : wSeats >= 180 ? '‚ö†Ô∏è MINORIA RELATIVA - Negocia√ß√£o necess√°ria.'
                    : '‚ùå MINORIA FRACA - Crise de governabilidade prevista!';
        govDiv.innerHTML = `<b>${candidatesData[winner.id].name}:</b> ${wSeats} cadeiras. ${govText}`;
    }
}

function generateFinalRanking(winner, context) {
    let isPlayer = winner.id === game.player;
    if(!isPlayer) { document.getElementById('ranking-content').innerHTML = ''; return; }
    let statesWon = allStates.filter(s => {
        let v = Object.entries(game.stateVotes[s.id]).sort((a,b)=>b[1]-a[1]);
        return v[0][0] === game.player;
    }).length;
    let turnBonus = Math.max(0, 16 - game.turn);
    let coaBonus = game.coalition.length * 5;
    let stateBonus = statesWon * 2;
    let modeBonus = game.mode === 'caotico' ? 20 : 0;
    let diffBonus = game.difficulty * 10;
    let total = turnBonus + coaBonus + stateBonus + modeBonus + diffBonus;
    let rank = total >= 80 ? 'Estrategista Supremo üèÜ' : total >= 60 ? 'Pol√≠tico Habilidoso ‚≠ê' : total >= 40 ? 'Candidato Competente üëç' : 'Democrata Iniciante üìã';
    let fase = game.fase === 1 && winner.votes > 50 ? '1¬∫ Turno' : '2¬∫ Turno';
    document.getElementById('ranking-content').innerHTML = `
        <div class="rank-item">üó∫Ô∏è <b>Estados conquistados:</b> ${statesWon}/27</div>
        <div class="rank-item">üèÖ <b>Vit√≥ria no:</b> ${fase}</div>
        <div class="rank-item">ü§ù <b>Partidos na coliga√ß√£o:</b> ${game.coalition.length}</div>
        <div class="rank-item">‚ö° <b>Turnos restantes:</b> ${Math.max(0, 15-game.turn)}</div>
        <div class="rank-item">üéØ <b>Modo:</b> ${game.mode === 'caotico' ? 'Ca√≥tico (+20)' : 'Hist√≥rico'}</div>
        <div class="rank-item">üíØ <b>Pontua√ß√£o:</b> ${total}</div>
        <div style="margin-top:10px;font-size:18px;font-weight:bold;color:#000080">Classifica√ß√£o: ${rank}</div>
    `;
}

function updateUI() {
    document.getElementById("turn-display").innerText = game.turn;
    let tmx = document.getElementById("turn-max-display");
    if(tmx) tmx.innerText = game.fase === 2 ? 3 : 15;
    document.getElementById("money-display").innerText = game.money;
    document.getElementById("points-display").innerText = game.points;
    
    updateDateDisplay();
    renderSpiritsDisplay();
    updateAbstentionDisplay();
    updateRadicalizationBar();
    
    // Fatigue bar pointer

    let table = document.getElementById("polling-body");
    table.innerHTML = "<tr><th>Candidato</th><th>%</th><th>Œî</th></tr>";
    
    [...game.candidates].sort((a,b)=>b.votes-a.votes).forEach(c => {
        let r = table.insertRow(); if(c.id === game.player) r.className = "player-row";
        let prevSnap = game.pollHistory.length > 1 ? game.pollHistory[game.pollHistory.length-2] : null;
        let delta = prevSnap ? (c.votes - (prevSnap.votes[c.id]||c.votes)).toFixed(1) : '‚Äî';
        let deltaColor = delta > 0 ? 'green' : delta < 0 ? 'red' : '#888';
        let deltaStr = delta !== '‚Äî' ? `<span style="color:${deltaColor}">${delta>0?'+':''}${delta}</span>` : '‚Äî';
        let scandal = game.scandalLevels[c.id]||0;
        let scanIcon = scandal >= 5 ? ' üí•' : scandal > 0 ? ' ‚ö†Ô∏è' : '';
        r.innerHTML = `<td><span style="color:${c.color}">‚ñ†</span> ${c.name}${scanIcon}</td><td>${c.votes.toFixed(1)}%</td><td>${deltaStr}</td>`;
    });
    // Show abstention and null votes as non-candidate indicator rows
    let absR = table.insertRow();
    absR.style.cssText = 'background:#f5f5f5;color:#888;font-style:italic;';
    absR.innerHTML = `<td colspan="3" style="font-size:9px;border-top:2px dashed #ccc;padding-top:4px;"><i>N√£o s√£o candidatos ‚Äî apenas indicadores do eleitorado:</i></td>`;
    let absRow = table.insertRow();
    absRow.style.cssText = 'background:#f0f0f0;color:#666;';
    absRow.innerHTML = `<td style="font-size:9px">üö´ Absten√ß√£o (est.)</td><td style="font-size:9px">~${Math.round(abstentionRate*100)}%</td><td style="font-size:9px">‚Äî</td>`;
    let nullRow = table.insertRow();
    nullRow.style.cssText = 'background:#f0f0f0;color:#666;';
    nullRow.innerHTML = `<td style="font-size:9px">‚¨õ Voto Nulo (est.)</td><td style="font-size:9px">~${Math.round(nullVoteRate*100)}%</td><td style="font-size:9px">‚Äî</td>`;

    if(game.isGovernor) {
        updateGovernorMap();
    } else if(game.isRepVelha && scenariosData[game.scenario]) {
        updateRegionalMap(scenariosData[game.scenario].regions);
    } else if(game.isElectoralCollege && internationalData[game.scenario]) {
        updateECMapColors(internationalData[game.scenario]);
    } else if(!game.isElectoralCollege && internationalData[game.scenario] && internationalData[game.scenario].regions) {
        updateRegionalMap(internationalData[game.scenario].regions);
    } else {
        allStates.forEach(s => {
            let votesArr = Object.entries(game.stateVotes[s.id]||{}).sort((a,b)=>b[1]-a[1]);
            if(votesArr.length > 0) {
                let leaderId = votesArr[0][0];
                let margin = votesArr.length > 1 ? votesArr[0][1] - votesArr[1][1] : 50;
                let node = document.getElementById("node-"+s.id);
                if(node && candidatesData[leaderId]) {
                    let baseColor = candidatesData[leaderId].color;
                    // Use brightness to indicate margin: close race = darker, dominant = normal
                    let brightness = Math.min(1.2, 0.6 + (margin / 30) * 0.6);
                    node.style.backgroundColor = baseColor;
                    node.style.opacity = '1';
                    node.style.filter = `brightness(${brightness.toFixed(2)})`;
                    node.style.border = isPivotState(s.id) ? '2px solid var(--gold)' : '1px solid black';
                    node.style.width = isPivotState(s.id) ? '26px' : '22px';
                }
            }
        });
    }

    renderApprovalBars();
    renderTVTime();
}

function renderTVTime() {
    let tvSection = document.getElementById('tv-time-section');
    let tvBars = document.getElementById('tv-time-bars');
    let tvEffect = document.getElementById('tv-time-effect');
    let tvLabel = document.getElementById('player-tv-label');
    if(!tvBars || !game.tvTime) return;
    let year = parseInt(game.scenario) || 2000;
    if(game.isRepVelha || year < 1960) {
        if(tvSection) tvSection.style.display = 'none';
        return;
    }
    if(tvSection) tvSection.style.display = 'block';
    
    let playerTV = Math.round(game.tvTime[game.player] || 0);
    if(tvLabel) tvLabel.innerText = playerTV + '% tempo';
    
    let tvBonus = Math.floor(playerTV / 10);
    if(tvEffect) {
        if(playerTV >= 50) tvEffect.innerHTML = `‚úÖ <b>B√¥nus ativo:</b> +${tvBonus}p/turno e visibilidade alta`;
        else if(playerTV >= 25) tvEffect.innerHTML = `üü° Tempo moderado: +${tvBonus}p/turno`;
        else tvEffect.innerHTML = `üî¥ Pouco tempo de TV ‚Äî invista em hor√°rio eleitoral`;
    }
    
    let sorted = [...game.candidates].sort((a,b) => (game.tvTime[b.id]||0) - (game.tvTime[a.id]||0));
    tvBars.innerHTML = sorted.slice(0, 4).map(c => {
        let tv = game.tvTime[c.id] || 0;
        let color = c.id === game.player ? '#0000aa' : (candidatesData[c.id]?.color || '#888');
        return `<div style="display:flex;align-items:center;gap:4px;margin:2px 0">
            <span style="width:60px;font-size:9px;overflow:hidden;white-space:nowrap">${c.name}</span>
            <div style="flex:1;height:8px;background:#ddd;border:1px solid #aaa">
                <div style="width:${Math.min(100,tv).toFixed(0)}%;height:100%;background:${color}"></div>
            </div>
            <span style="width:28px;font-size:9px;text-align:right">${tv.toFixed(0)}%</span>
        </div>`;
    }).join('');
}
function log(m) { document.getElementById("terminal-log").innerHTML = `> ${m}<br>` + document.getElementById("terminal-log").innerHTML; }
function showModal(t, d, b) { document.getElementById("modal-overlay").style.display="flex"; document.getElementById("modal-title").innerText=t; document.getElementById("modal-text").innerHTML=d; document.getElementById("modal-buttons").innerHTML=b; }
function closeModal() { document.getElementById("modal-overlay").style.display="none"; isShowingEvent = false; setTimeout(() => processNextEvent(), 150); }
// === MODO ESPECTADOR ===
let spectatorMode = false;

function toggleSpectatorMode(enabled) {
    spectatorMode = enabled;
    log(enabled ? 'üé≠ Modo Espectador ATIVADO ‚Äî eventos ser√£o ignorados.' : 'üé≠ Modo Espectador desativado.');
}

// ============================================================
// SISTEMA DE FILA DE EVENTOS (evita sobreposi√ß√£o)
// ============================================================
let eventQueue = [];
let isShowingEvent = false;

function queueEvent(title, content, buttons) {
    eventQueue.push({title, content, buttons});
    if(!isShowingEvent) processNextEvent();
}

function processNextEvent() {
    if(eventQueue.length === 0) { isShowingEvent = false; return; }
    isShowingEvent = true;
    let ev = eventQueue.shift();
    // Wrap buttons to process next event after closing
    let wrappedBtns = ev.buttons + `<div style="font-size:9px;color:#888;margin-top:6px;text-align:right">${eventQueue.length > 0 ? `‚è≥ ${eventQueue.length} evento(s) pendente(s)` : ''}</div>`;
    showModal(ev.title, ev.content, wrappedBtns);
}

function closeModalAndNext() {
    closeModal();
    setTimeout(() => processNextEvent(), 200);
}

// ============================================================
// SISTEMA DE ESP√çRITOS NACIONAIS
// ============================================================
const spiritDefs = {
    'onda_popular':     {name:'Onda Popular',       emoji:'üåä', desc:'Com√≠cios rendem +50% por 3 turnos', bonus:{rally:1.5}, duration:3},
    'maquina_partido':  {name:'M√°quina do Partido',  emoji:'‚öôÔ∏è', desc:'+1 ponto extra por turno', bonus:{pts:1}, duration:5},
    'momentum_midias':  {name:'Momentum nas M√≠dias', emoji:'üì°', desc:'TV e redes sociais rendem +2% extra', bonus:{media:2}, duration:3},
    'voto_util':        {name:'Voto √ötil',           emoji:'üéØ', desc:'Absorve votos de candidatos menores', bonus:{absorb:true}, duration:2},
    'caixa_cheio':      {name:'Caixa Cheio',         emoji:'üí∞', desc:'Arrecada√ß√£o rende +50%', bonus:{money:1.5}, duration:3},
    'boca_a_boca':      {name:'Boca a Boca',         emoji:'üë•', desc:'Crescimento org√¢nico de 0.5%/turno', bonus:{organic:0.5}, duration:4},
    'escudo_midiatico': {name:'Escudo Midi√°tico',    emoji:'üõ°Ô∏è', desc:'Esc√¢ndalos t√™m -50% de efeito', bonus:{scandal_shield:true}, duration:3},
    'aliado_poderoso':  {name:'Aliado Poderoso',     emoji:'ü§ù', desc:'Aliados cedem 2% extras', bonus:{alliance:2}, duration:2},
};

let activeSpirits = []; // {id, turnsLeft}

function gainSpirit(spiritId) {
    let def = spiritDefs[spiritId];
    if(!def) return;
    let existing = activeSpirits.find(s => s.id === spiritId);
    if(existing) { existing.turnsLeft = def.duration; }
    else {
        activeSpirits.push({id: spiritId, turnsLeft: def.duration});
        // Track unique spirits for achievement
        if(!game.spiritsActivatedSet) game.spiritsActivatedSet = new Set();
        game.spiritsActivatedSet.add(spiritId);
        game.spiritsActivated = game.spiritsActivatedSet.size;
    }
    addNews(`‚ú® ESP√çRITO NACIONAL: ${def.emoji} ${def.name}`, def.desc);
    log(`‚ú® Esp√≠rito "${def.name}" ativado por ${def.duration} turnos!`);
    playSpiritSound();
    renderSpiritsDisplay();
}

function updateRadicalizationBar() {
    let lvl = Math.round(radicalizationLevel);
    let fill = document.getElementById('radical-bar-fill');
    let label = document.getElementById('radical-bar-label');
    if(!fill || !label) return;
    fill.style.width = lvl + '%';
    let color = lvl >= 80 ? '#cc0000' : lvl >= 60 ? '#ff8800' : lvl >= 40 ? '#ccaa00' : lvl >= 20 ? '#00aa00' : '#3366ff';
    fill.style.background = color;
    label.textContent = lvl;
    label.style.color = color;
}

function tickSpirits() {
    activeSpirits = activeSpirits.filter(s => { s.turnsLeft--; return s.turnsLeft > 0; });
    // Cooldown: if there's a chosen spirit still active, keep cooldown at turnsLeft; else reset
    let chosenActive = activeSpirits.find(s => s.chosen);
    if(chosenActive) {
        // Keep cooldown synced with chosen spirit's remaining turns
        game.spiritCooldown = chosenActive.turnsLeft;
    } else {
        // No chosen spirit active: reset cooldown so player can pick again
        game.spiritCooldown = 0;
    }
    // Apply organic bonus
    activeSpirits.forEach(s => {
        let def = spiritDefs[s.id];
        if(def && def.bonus.organic) updateNationalVotes(game.player, def.bonus.organic);
        if(def && def.bonus.absorb) {
            // Absorb a bit from weakest candidate
            let weak = [...game.candidates].filter(c=>c.id!==game.player).sort((a,b)=>a.votes-b.votes)[0];
            if(weak && weak.votes > 5) { updateNationalVotes(weak.id, -0.5); updateNationalVotes(game.player, 0.3); }
        }
    });
    renderSpiritsDisplay();
}

function hasSpiritBonus(bonusKey) {
    return activeSpirits.some(s => spiritDefs[s.id] && spiritDefs[s.id].bonus[bonusKey] !== undefined);
}

function getSpiritBonus(bonusKey) {
    let total = 0;
    activeSpirits.forEach(s => {
        let def = spiritDefs[s.id];
        if(def && def.bonus[bonusKey] !== undefined) {
            let val = def.bonus[bonusKey];
            if(typeof val === 'number') total += val;
        }
    });
    return total;
}

function getSpiritMultiplier(bonusKey) {
    let mult = 1;
    activeSpirits.forEach(s => {
        let def = spiritDefs[s.id];
        if(def && def.bonus[bonusKey] !== undefined && def.bonus[bonusKey] > 1) mult *= def.bonus[bonusKey];
    });
    return mult;
}

function renderSpiritsDisplay() {
    let div = document.getElementById('spirits-display');
    if(!div) return;
    if(activeSpirits.length === 0) { div.textContent = 'Nenhum esp√≠rito ativo.'; return; }
    div.innerHTML = activeSpirits.map(s => {
        let def = spiritDefs[s.id];
        return `<span class="spirit-badge">${def.emoji} ${def.name} (${s.turnsLeft}t)</span>`;
    }).join(' ');
}

function renderSpiritsTab() {
    renderSpiritsDisplay();
    let legend = document.getElementById('spirits-legend');
    if(!legend) return;
    
    // Check cooldown: spirits last 3 turns and can't choose another during that time
    // Clean up expired spirits
    activeSpirits = activeSpirits.filter(s => s.turnsLeft > 0);
    let cooldown = game.spiritCooldown || 0;
    let canChoose = cooldown <= 0;
    
    let chooseHtml = '';
    if(canChoose) {
        chooseHtml = `<div style="background:#fffde8;border:2px solid #cc9900;padding:8px;margin-bottom:8px;border-radius:4px">
            <b>‚ú® Escolha um Esp√≠rito Nacional (dura 3 turnos):</b>
            <div style="margin-top:6px;display:flex;flex-wrap:wrap;gap:4px">
            ${Object.entries(spiritDefs).map(([id, def]) => {
                let already = activeSpirits.find(s => s.id === id);
                if(already) return '';
                return `<button class="btn" style="width:auto;padding:4px 8px;font-size:10px" onclick="chooseSpirit('${id}')">${def.emoji} ${def.name}</button>`;
            }).join('')}
            </div>
        </div>`;
    } else {
        let sp = activeSpirits.find(s => s.chosen);
        let def = sp ? spiritDefs[sp.id] : null;
        chooseHtml = `<div style="background:#fffde8;border:2px solid #cc9900;padding:8px;margin-bottom:8px;border-radius:4px">
            <b>üîí Esp√≠rito em cooldown</b>${def ? ': ' + def.emoji + ' ' + def.name : ''} ‚Äî <span style="color:#cc7700">Aguarde ${cooldown} turno(s) para escolher outro</span>
        </div>`;
    }
    
    legend.innerHTML = chooseHtml + `<b style="font-size:10px;display:block;margin-bottom:4px">Todos os Esp√≠ritos:</b>` + Object.entries(spiritDefs).map(([id, def]) => {
        let active = activeSpirits.find(s => s.id === id);
        let bg = active ? 'background:#fffde8;border:1px solid #cc9900;' : 'background:#f5f5f5;border:1px solid #ccc;';
        return `<div style="${bg}padding:5px;margin:2px;border-radius:3px">
            <span class="spirit-badge">${def.emoji} ${def.name}</span> ${active ? `<b style="color:#00aa00">(ATIVO ‚Äî ${active.turnsLeft}t)</b>` : ''}
            <span style="font-size:9px;display:block;margin-top:2px;color:#888">${def.desc} | Dura√ß√£o: ${def.duration} turnos</span>
        </div>`;
    }).join('');
}

function chooseSpirit(spiritId) {
    let def = spiritDefs[spiritId];
    if(!def) return;
    if(game.spiritCooldown && game.spiritCooldown > 0) { log('Esp√≠rito em cooldown! Aguarde ' + game.spiritCooldown + ' turno(s).'); return; }
    // Remove any expired chosen spirits first
    activeSpirits = activeSpirits.filter(s => s.turnsLeft > 0);
    // Add chosen spirit that lasts 3 turns
    activeSpirits.push({id: spiritId, turnsLeft: 3, chosen: true});
    game.spiritCooldown = 3;
    addNews(`‚ú® ESP√çRITO: ${def.emoji} ${def.name}`, `${def.desc} ‚Äî ativo por 3 turnos.`);
    log(`‚ú® Esp√≠rito "${def.name}" ativado por 3 turnos! N√£o poder√° escolher outro enquanto estiver ativo.`);
    renderSpiritsTab();
    updateUI();
    playSound(600, 200);
    setTimeout(() => playSound(800, 200), 220);
    setTimeout(() => playSound(1000, 300), 440);
}

// ============================================================
// SISTEMA DE ABSTEN√á√ÉO E VOTO NULO
// ============================================================
let abstentionRate = 0.20;
let nullVoteRate = 0.03;

function initAbstention(scenario) {
    // Historical abstention rates
    const rates = {
        '1994':0.12,'1998':0.14,'2002':0.11,'2006':0.13,'2010':0.12,
        '2014':0.13,'2018':0.15,'2022':0.13,'2026':0.14,
        'USA2024':0.25,'RUS2024':0.22,'GER2025':0.15,'FRA2022':0.18,
    };
    abstentionRate = rates[scenario] || 0.20;
    nullVoteRate = 0.02 + Math.random() * 0.03;
    updateAbstentionDisplay();
}

function updateAbstentionDisplay() {
    let pct = document.getElementById('abstention-pct');
    let nullP = document.getElementById('null-vote-pct');
    let mini = document.getElementById('abstention-mini-text');
    if(pct) pct.textContent = `Absten√ß√£o: ${Math.round(abstentionRate*100)}%`;
    if(nullP) nullP.textContent = `Voto Nulo: ${Math.round(nullVoteRate*100)}%`;
    if(mini) mini.textContent = `Absten√ß√£o: ~${Math.round(abstentionRate*100)}% | Nulo: ~${Math.round(nullVoteRate*100)}%`;
}

function actionAumentarEngajamento() {
    if(game.points < 3) { log("Pontos insuficientes."); return; }
    game.points -= 3;
    let reduction = 0.01 + Math.random() * 0.02;
    abstentionRate = Math.max(0.05, abstentionRate - reduction);
    updateNationalVotes(game.player, 0.8);
    updateAbstentionDisplay();
    log(`üì£ Engajamento c√≠vico! Absten√ß√£o caiu ${Math.round(reduction*100)}%.`);
    updateUI();
}

// ============================================================
// SISTEMA DE DATAS REAIS NOS TURNOS
// ============================================================
function getTurnDate(turn, fase) {
    // 1¬∫ turno: sempre 2 de outubro (15 dias antes = 17 de setembro para turno 1)
    // Os 15 turnos representam os 15 dias antes do 2/10
    // Turno 1 = dia 17/09, Turno 15 = dia 01/10, Elei√ß√£o = 02/10
    // 2¬∫ turno: sempre 30 de outubro, 3 turnos antes = 27, 28, 29 de outubro
    // Turno 1 do 2T = 27/10, Turno 3 = 29/10, Elei√ß√£o = 30/10
    let sc = scenariosData[game.scenario] || internationalData[game.scenario];
    let year = sc ? sc.year : (game.scenario || '2022');
    // For international elections, just show round/turn
    if(game.isElectoralCollege || internationalData[game.scenario]) {
        return `Rodada ${turn} | ${year}`;
    }
    if(fase === 1) {
        let dayOfMonth = 17 + (turn - 1); // 17 set + turn offset
        let month, day;
        if(dayOfMonth <= 13) { month = 'Set'; day = 17 + (turn-1); }
        else if(dayOfMonth <= 30) { month = 'Set'; day = dayOfMonth; }
        else { month = 'Out'; day = dayOfMonth - 30; }
        // Simpler: Sep 17 + turn - 1
        let date = new Date(parseInt(year), 8, 17 + (turn-1)); // month 8 = September
        let days = ['Dom','Seg','Ter','Qua','Qui','Sex','S√°b'];
        let months = ['Jan','Fev','Mar','Abr','Mai','Jun','Jul','Ago','Set','Out','Nov','Dez'];
        return `${days[date.getDay()]}, ${date.getDate()} ${months[date.getMonth()]} ${year}`;
    } else {
        // 2¬∫ turno: Oct 27, 28, 29
        let date = new Date(parseInt(year), 9, 27 + (turn - 1)); // month 9 = October
        let days = ['Dom','Seg','Ter','Qua','Qui','Sex','S√°b'];
        let months = ['Jan','Fev','Mar','Abr','Mai','Jun','Jul','Ago','Set','Out','Nov','Dez'];
        return `${days[date.getDay()]}, ${date.getDate()} ${months[date.getMonth()]} ${year}`;
    }
}

function updateDateDisplay() {
    let dd = document.getElementById('date-display');
    if(!dd) return;
    let sc = scenariosData[game.scenario] || internationalData[game.scenario];
    if(sc && !game.isElectoralCollege && !internationalData[game.scenario]) {
        dd.textContent = `üìÖ ${getTurnDate(game.turn, game.fase)}`;
    } else if(internationalData[game.scenario]) {
        dd.textContent = `üìÖ ${(sc && sc.year) || ''}`;
    } else {
        dd.textContent = '';
    }
}

// ============================================================
// SISTEMA DE RADICALIZA√á√ÉO
// ============================================================
let radicalizationLevel = 30; // 0-100

function updateRadicalization(delta) {
    let prevLevel = radicalizationLevel;
    radicalizationLevel = Math.max(0, Math.min(100, radicalizationLevel + delta));
    // Track max radicalization for achievement
    if(radicalizationLevel > (game.maxRadicalization||0)) game.maxRadicalization = radicalizationLevel;
    // Track peacemaker: went from 90+ to below 50
    if(prevLevel >= 90 && radicalizationLevel < 50) game.peacemakerAchieved = true;
    updateRadicalizationBar();
    // Update radical tab if visible
    let radTab = document.getElementById('tab-radical');
    if(radTab && radTab.style.display !== 'none') renderRadicalTab();
}

function autoSimulateAll() {
    let maxT = game.fase === 2 ? 3 : 15;
    let remaining = maxT - game.turn;
    if(remaining <= 0) { log('Jogo j√° encerrado.'); return; }
    let i = 0;
    function step() {
        if(i++ >= remaining) return;
        game.turn++;
        aiStrategicTurn();
        updateApprovalRejection();
        updateStateVotesRealTime();
        checkHistoricalEvents();
        recordPollSnapshot();
        checkMomentum();
        generateDynamicNews();
        updateUI();
        let maxTNow = game.fase === 2 ? 3 : 15;
        if(game.turn > maxTNow) { processElection(); return; }
        setTimeout(step, 150);
    }
    step();
}

// ============================================================
// SISTEMA DE ELEI√á√ÉO INDIRETA
// ============================================================
let indirectGame = {
    scenario: null, player: null, turn: 1, maxTurns: 10,
    points: 5, candidates: {}, factions: [], news: [],
    firedEvents: [], totalVotes: 0,
    // New: track negotiation history, deals, compromises
    deals: {}, // candidateId -> list of deals made
    lastNegotiated: {}, // faction -> last turn negotiated
    regionalAlliances: 0,
    pressureLevel: 0, // external pressure (crowds, media) 0-10
    militarySupport: 0, // relevant for military regimes
    publicOpinion: 50, // 0-100 scale
    round: 1, // voting round (some indirect elections have multiple rounds)
    maxRounds: 1
};

function startIndirectGame(key) {
    const sc = scenariosData[key];
    indirectGame.scenario = key;
    indirectGame.turn = 1;
    indirectGame.maxTurns = 10;
    indirectGame.points = 5;
    indirectGame.news = [];
    indirectGame.firedEvents = [];
    indirectGame.deals = {};
    indirectGame.lastNegotiated = {};
    indirectGame.regionalAlliances = 0;
    indirectGame.pressureLevel = sc.year <= 1970 ? 3 : 5; // More open later
    indirectGame.militarySupport = sc.year <= 1985 ? 7 : 2;
    indirectGame.publicOpinion = 50;
    indirectGame.round = 1;
    indirectGame.maxRounds = sc.maxRounds || 1;
    indirectGame.totalVotes = sc.totalVotes;
    indirectGame.candidates = JSON.parse(JSON.stringify(sc.candidates));
    indirectGame.factions = JSON.parse(JSON.stringify(sc.factions));

    // Show candidate selection modal with enhanced info
    let html = `<div style="background:#1a1a0a;border:1px solid #8b6914;padding:8px;margin-bottom:10px;font-size:11px;color:#f4d03f">
        <b>üèõÔ∏è ${sc.title} ‚Äî ${sc.year}</b><br>
        <span style="color:#ccc">${sc.context}</span>
    </div>
    <div style="background:#e8ffe8;padding:6px;margin-bottom:8px;border-left:3px solid #006600;font-size:10px">
        <b>üìã COMO FUNCIONA:</b> Voc√™ articular√° votos no Congresso usando Influ√™ncia (pontos). 
        Cada rodada, fac√ß√µes podem ser negociadas, press√£o externa pode ajudar, e eventos hist√≥ricos determinar√£o o resultado final. 
        Maioria necess√°ria: <b>${Math.floor(sc.totalVotes/2)+1} votos</b> de ${sc.totalVotes}.
    </div>
    <b>Escolha seu candidato para articular:</b><br><br>`;
    html += `<div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">` + Object.entries(sc.candidates).map(([id, c]) =>
        `<div style="background:${c.color}22;border:2px solid ${c.color};padding:8px;cursor:pointer;border-radius:4px" onclick="confirmIndirectPlayer('${key}','${id}')">
            <b style="color:${c.color}">${c.name}</b> <small style="color:#888">(${c.party})</small><br>
            <small style="color:#aaa">${c.ideologia}</small><br>
            <small style="color:#ccc">${c.bio?.substring(0,80)}...</small><br>
            <div style="margin-top:4px;background:#111;padding:3px;border-radius:2px;font-size:9px">
                üìä Votos iniciais: <b style="color:#f4d03f">${c.start}</b> / ${sc.totalVotes}
            </div>
        </div>`
    ).join('') + `</div>`;
    html += `<br><button class="btn" onclick="closeModal();goToScenarios()">‚Üê Voltar</button>`;
    showModal(`üèõÔ∏è ${sc.title}`, html, '');
}

function confirmIndirectPlayer(key, playerId) {
    closeModal();
    indirectGame.player = playerId;
    document.getElementById("scenario-screen").classList.remove("active");
    document.getElementById("indirect-screen").classList.add("active");
    
    const sc = scenariosData[key];
    document.getElementById("indirect-title-text").textContent = `üèõÔ∏è CONGRESSO ‚Äî ${sc.year} | ${sc.title.toUpperCase()}`;
    document.getElementById("indirect-context").textContent = sc.context;
    
    indirectAddNews(`SESS√ÉO DO CONGRESSO INSTALADA`, `${sc.year} ‚Äî Os parlamentares se re√∫nem para eleger o pr√≥ximo presidente. Articula√ß√µes come√ßam nas sombras do Congresso.`);
    renderIndirectActions();
    renderFactions();
    renderIndirectScoreboard();
    drawHemicycle();
    document.getElementById("ind-turn").textContent = indirectGame.turn;
    document.getElementById("ind-points").textContent = indirectGame.points;
}

function indirectAddNews(t, d) {
    indirectGame.news.unshift(`<div style="border-bottom:1px solid #333;padding:4px 0"><b style="color:#f4d03f">${t}</b><br><span>${d}</span></div>`);
    if(indirectGame.news.length > 12) indirectGame.news.pop();
    const div = document.getElementById("indirect-news");
    if(div) div.innerHTML = indirectGame.news.join('');
}

function indirectLog(m) {
    const div = document.getElementById("indirect-log");
    if(div) div.innerHTML = `> ${m}<br>` + div.innerHTML;
}

function indirectShiftVotes(candidateId, amount) {
    if(!indirectGame.candidates[candidateId]) return;
    let others = Object.entries(indirectGame.candidates).filter(([id]) => id !== candidateId);
    others.sort((a,b) => b[1].start - a[1].start);
    let transferred = 0;
    others.forEach(([id, c]) => {
        let take = Math.min(amount - transferred, Math.floor(c.start * 0.15));
        if(take > 0 && transferred < amount) {
            c.start -= take;
            transferred += take;
        }
    });
    indirectGame.candidates[candidateId].start += transferred;
    renderIndirectScoreboard();
    drawHemicycle();
}

function indirectShiftFaction(factionName, amount, candidateId) {
    let faction = indirectGame.factions.find(f => f.name === factionName);
    if(!faction) return;
    faction.leans = candidateId;
    Object.keys(indirectGame.candidates).forEach(id => { indirectGame.candidates[id].start = 0; });
    indirectGame.factions.forEach(f => {
        if(f.leans && indirectGame.candidates[f.leans]) {
            indirectGame.candidates[f.leans].start += f.votes;
        }
    });
    renderIndirectScoreboard();
    drawHemicycle();
}

function renderIndirectActions() {
    const sc = scenariosData[indirectGame.scenario];
    const player = indirectGame.player;
    if(!indirectGame.candidates[player]) return;
    const playerName = indirectGame.candidates[player].name;
    const actionsDiv = document.getElementById("indirect-actions");
    const totalVotes = indirectGame.totalVotes;
    const myVotes = indirectGame.candidates[player]?.start || 0;
    const majority = Math.floor(totalVotes/2) + 1;
    const needMore = majority - myVotes;
    
    // Determine which actions make sense in this historical context
    const year = parseInt(sc.year) || 1970;
    const isDemocratic = year >= 1985;
    const isMilitary = year < 1985 && year >= 1964;
    
    const actions = [
        {
            label:"üí¨ Discurso no Plen√°rio",
            cost: 2,
            emoji: 'üé§',
            desc: `Fa√ßa um discurso persuasivo no Congresso.`,
            exec: () => {
                let base = 2 + Math.floor(Math.random()*5);
                let bonus = indirectGame.pressureLevel >= 5 ? 2 : 0; // More effective with public pressure
                let gain = base + bonus;
                indirectShiftVotes(player, gain);
                let quotes = ["'Este √© o momento da democracia!'", "'A na√ß√£o espera nossa decis√£o!'", "'O povo clama por mudan√ßa!'", "'Votemos com a consci√™ncia!'"];
                let quote = quotes[Math.floor(Math.random()*quotes.length)];
                indirectAddNews("DISCURSO HIST√ìRICO", `${playerName} discursa: ${quote}. ${gain} parlamentares indecisos impressionados.`);
                indirectLog(`Discurso: +${gain} votos. ${bonus>0?'(+b√¥nus press√£o popular)':''}`);
            }
        },
        {
            label:"ü§ù Articular com Bancada",
            cost: 3,
            emoji: 'üèõÔ∏è',
            desc: `Negocie diretamente com uma fac√ß√£o parlamentar.`,
            exec: () => {
                // Find best target: undecided or smallest rival faction
                let targets = indirectGame.factions.filter(f => !f.leans || f.leans !== player);
                targets.sort((a,b) => a.votes - b.votes); // Start with smaller factions
                let faction = targets[0];
                if(!faction) { indirectLog("Sem fac√ß√µes dispon√≠veis para articular!"); return; }
                
                // Cooldown check
                if(indirectGame.lastNegotiated[faction.name] && indirectGame.lastNegotiated[faction.name] >= indirectGame.turn - 1) {
                    let gain = Math.floor(faction.votes * 0.06);
                    indirectShiftVotes(player, gain);
                    indirectAddNews("RENEGOCIA√á√ÉO", `Bancada "${faction.name}" resistiu inicialmente mas cedeu parcialmente. +${gain} votos.`);
                    indirectLog(`${faction.name} j√° negociado ‚Äî efeito reduzido: +${gain} votos.`);
                } else {
                    let gain = Math.floor(faction.votes * 0.18);
                    indirectGame.lastNegotiated[faction.name] = indirectGame.turn;
                    indirectShiftVotes(player, gain);
                    indirectAddNews("ARTICULA√á√ÉO", `Negocia√ß√£o com "${faction.name}" conclui com ${gain} parlamentares comprometidos.`);
                    indirectLog(`Articula√ß√£o com "${faction.name}": +${gain} votos.`);
                }
            }
        },
        {
            label:"üìú Proposta de Governo",
            cost: 3,
            emoji: 'üìã',
            desc: `Ofere√ßa minist√©rios e cargos em troca de apoio.`,
            exec: () => {
                // Make a deal with largest undecided/rival faction
                let undecided = indirectGame.factions.find(f => !f.leans);
                let target = undecided || indirectGame.factions.filter(f=>f.leans!==player).sort((a,b)=>b.votes-a.votes)[0];
                if(!target) { indirectLog("Sem destinat√°rio para proposta!"); return; }
                let gain = Math.floor(target.votes * 0.25);
                if(!indirectGame.deals[player]) indirectGame.deals[player] = [];
                indirectGame.deals[player].push(target.name);
                target.leans = player;
                indirectShiftFaction(target.name, gain, player);
                indirectAddNews("ACORDO POL√çTICO", `${playerName} oferece ${target.name} minist√©rios/cargos. Bancada muda apoio! +${gain} votos comprometidos.`);
                indirectLog(`Proposta aceita: "${target.name}" muda para ${playerName}. +${gain} votos.`);
            }
        },
        {
            label:"üì∞ Manifesto P√∫blico",
            cost: 1,
            emoji: 'üì¢',
            desc: `Lance manifesto para pressionar parlamentares via opini√£o p√∫blica.`,
            exec: () => {
                indirectGame.publicOpinion = Math.min(100, indirectGame.publicOpinion + 5);
                indirectGame.pressureLevel = Math.min(10, indirectGame.pressureLevel + 1);
                let gain = 1 + Math.floor(Math.random()*3);
                indirectShiftVotes(player, gain);
                indirectAddNews("MANIFESTO", `${playerName} publica manifesto. Press√£o popular aumenta (n√≠vel ${indirectGame.pressureLevel}/10).`);
                indirectLog(`Manifesto: +${gain} votos. Press√£o popular: ${indirectGame.pressureLevel}/10.`);
            }
        },
        {
            label:"üîç Expor Rival",
            cost: 2,
            emoji: 'üîé',
            desc: `Revele contradi√ß√µes ou falhas do advers√°rio principal.`,
            exec: () => {
                let rivals = Object.entries(indirectGame.candidates).filter(([id])=>id!==player).sort((a,b)=>b[1].start-a[1].start);
                if(!rivals.length) { indirectLog("Sem rivais!"); return; }
                let [rid, rc] = rivals[0];
                let dmg = 2 + Math.floor(Math.random()*4);
                let gain = Math.floor(dmg * 0.6);
                rc.start = Math.max(0, rc.start - dmg);
                indirectShiftVotes(player, gain);
                indirectAddNews("DEN√öNCIA POL√çTICA", `Campanha de ${playerName} exp√µe vulnerabilidades de ${rc.name}. ${dmg} votos perdidos pelo rival.`);
                indirectLog(`${rc.name} perde ${dmg} votos; voc√™ ganha ${gain}.`);
            }
        },
        {
            label: isDemocratic ? "üèòÔ∏è Mobiliza√ß√£o Popular" : isMilitary ? "‚≠ê Apoio Militar" : "üì£ Press√£o Externa",
            cost: 3,
            emoji: isDemocratic ? 'üë•' : '‚≠ê',
            desc: isDemocratic ? `Mobilize a popula√ß√£o para pressionar o Congresso.` : `Garanta apoio dos quart√©is para fortalecer sua candidatura.`,
            exec: () => {
                if(isDemocratic) {
                    indirectGame.pressureLevel = Math.min(10, indirectGame.pressureLevel + 2);
                    indirectGame.publicOpinion = Math.min(100, indirectGame.publicOpinion + 10);
                    let gain = 3 + Math.floor(indirectGame.pressureLevel * 0.5);
                    indirectShiftVotes(player, gain);
                    indirectAddNews("MANIFESTA√á√ÉO POPULAR", `Milhares nas ruas apoiam ${playerName}. Parlamentares indecisos sentem press√£o. +${gain} votos.`);
                    indirectLog(`Press√£o popular: n√≠vel ${indirectGame.pressureLevel}/10. +${gain} votos.`);
                } else {
                    // Military support
                    indirectGame.militarySupport = Math.min(10, indirectGame.militarySupport + 1);
                    let gain = 5 + Math.floor(Math.random()*6);
                    indirectShiftVotes(player, gain);
                    indirectAddNews("SUPORTE MILITAR", `Generais reafirmam apoio a ${playerName}. Congressistas amedrontados ampliam suporte. +${gain} votos.`);
                    indirectLog(`Apoio militar: ${indirectGame.militarySupport}/10. +${gain} votos.`);
                }
            }
        },
        {
            label:"üèõÔ∏è Alian√ßa Regional",
            cost: 3,
            emoji: 'üó∫Ô∏è',
            desc: `Conquiste bancadas estaduais com promessas de investimento.`,
            exec: () => {
                indirectGame.regionalAlliances++;
                let baseGain = 5 + Math.floor(Math.random()*6);
                let gain = Math.max(2, Math.floor(baseGain / Math.sqrt(indirectGame.regionalAlliances)));
                indirectShiftVotes(player, gain);
                indirectAddNews("ALIAN√áA REGIONAL", `Bancadas estaduais recebem promessas de infraestrutura. ${gain} parlamentares aderem a ${playerName}.`);
                indirectLog(`Alian√ßa #${indirectGame.regionalAlliances}: +${gain} votos (retorno decrescente).`);
            }
        }
    ];

    // Status display
    let statusColor = myVotes >= majority ? '#44ff44' : myVotes >= majority*0.8 ? '#ffaa00' : '#ff4444';
    let statusText = myVotes >= majority ? '‚úÖ MAIORIA GARANTIDA' : `‚ö†Ô∏è Faltam ${Math.max(0,needMore)} votos para maioria`;
    
    actionsDiv.innerHTML = `
        <div style="background:#111;padding:5px;border-radius:3px;margin-bottom:8px;font-size:10px">
            <div style="color:${statusColor};font-weight:bold">${statusText}</div>
            <div style="color:#888;font-size:9px">Press√£o popular: ${'‚óè'.repeat(indirectGame.pressureLevel)}${'‚óã'.repeat(10-indirectGame.pressureLevel)}</div>
        </div>
    ` + actions.map((a, i) =>
        `<button class="indirect-action" onclick="executeIndirectAction(${i})" ${indirectGame.points < a.cost ? 'disabled style="opacity:0.4"':''}>
            ${a.emoji} ${a.label} <span style="color:#f4d03f;float:right">${a.cost}p</span><br>
            <small style="color:#bba">${a.desc}</small>
        </button>`
    ).join('');
    window._indirectActions = actions;
}

function executeIndirectAction(i) {
    const action = window._indirectActions[i];
    if(indirectGame.points < action.cost) { indirectLog("Influ√™ncia insuficiente!"); return; }
    indirectGame.points -= action.cost;
    action.exec();
    document.getElementById("ind-points").textContent = indirectGame.points;
    renderFactions();
    renderIndirectActions();
}

function renderIndirectScoreboard() {
    const div = document.getElementById("indirect-scoreboard");
    if(!div) return;
    const total = indirectGame.totalVotes;
    const majority = Math.floor(total/2) + 1;
    const sorted = Object.entries(indirectGame.candidates).sort((a,b) => b[1].start - a[1].start);

    div.innerHTML = `<div style="text-align:center;font-size:10px;color:#888;margin-bottom:6px">
        Total: <b style="color:#f4d03f">${total}</b> votos &nbsp;|&nbsp; Maioria: <b style="color:#f4d03f">${majority}</b>
    </div>` + sorted.map(([id, c]) => {
        let votes = Math.round(c.start);
        let pct = Math.min(100, Math.round(votes / total * 100));
        let majPct = majority / total * 100;
        let isPlayer = id === indirectGame.player;
        let hasMajority = votes >= majority;
        return `<div style="margin:5px 0;padding:3px;background:${isPlayer?'rgba(244,208,63,0.08)':'transparent'};border-radius:3px;">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:3px;">
                <span style="font-size:11px;font-weight:bold;color:${isPlayer?'#f4d03f':c.color}">${isPlayer?'‚ñ∂ ':''} ${c.name} <small style="color:#888;font-weight:normal">(${c.party})</small></span>
                <span style="font-family:monospace;font-size:11px;color:${hasMajority?'#44ff44':'#ccc'}">${votes} / ${total} ${hasMajority?'‚úì':''}</span>
            </div>
            <div style="height:14px;background:#111;border:1px solid #333;border-radius:2px;position:relative;overflow:hidden;">
                <div style="height:100%;background:${c.color};width:${pct}%;transition:width 0.5s ease;"></div>
                <div style="position:absolute;top:0;left:${majPct}%;width:2px;height:100%;background:#f4d03f;opacity:0.8;"></div>
                <span style="position:absolute;top:1px;left:4px;font-size:9px;color:white;font-weight:bold;text-shadow:1px 1px 2px black;">${pct}%</span>
            </div>
        </div>`;
    }).join('');
}

// Spectator mode for indirect elections
let indirectSpectatorMode = false;

function indirectAutoSimulate() {
    let remaining = indirectGame.maxTurns - indirectGame.turn;
    if(remaining <= 0) { finishIndirectGame(); return; }
    indirectSpectatorMode = true;
    if(document.getElementById('indirect-spectator')) document.getElementById('indirect-spectator').checked = true;
    let step = () => {
        if(indirectGame.turn >= indirectGame.maxTurns) { finishIndirectGame(); return; }
        indirectNextTurn();
        setTimeout(step, 200);
    };
    step();
}

function renderFactions() {
    const div = document.getElementById("faction-list");
    if(!div) return;
    div.innerHTML = indirectGame.factions.map(f => {
        let lean = f.leans ? indirectGame.candidates[f.leans] : null;
        let leanColor = lean ? lean.color : '#888';
        return `<div style="margin-bottom:8px;border:1px solid #333;padding:5px;border-radius:2px">
            <div style="font-weight:bold;font-size:10px;color:#f4d03f">${f.name}</div>
            <div style="font-size:9px;color:#999;margin:2px 0">${f.desc}</div>
            <div style="display:flex;align-items:center;gap:4px;margin-top:3px">
                <span style="background:${leanColor};color:white;padding:1px 4px;font-size:9px;border-radius:2px">${lean ? lean.name : 'Indeciso'}</span>
                <span style="color:#aaa;font-size:9px">${f.votes} votos</span>
            </div>
        </div>`;
    }).join('');
}

function drawHemicycle() {
    const canvas = document.getElementById("hemicycle-canvas");
    if(!canvas) return;
    const ctx = canvas.getContext("2d");
    const W = canvas.width, H = canvas.height;
    ctx.clearRect(0, 0, W, H);
    ctx.fillStyle = "#0d0d1a";
    ctx.fillRect(0, 0, W, H);

    const total = indirectGame.totalVotes;
    const sorted = Object.entries(indirectGame.candidates).sort((a,b) => b[1].start - a[1].start);

    // Build ordered seat color array (grouped by candidate, not shuffled, for clear visual)
    let seats = [];
    sorted.forEach(([id, c]) => {
        let count = Math.max(0, Math.round(c.start));
        for(let i = 0; i < count; i++) seats.push(c.color);
    });
    // Ensure length matches total
    while(seats.length < total) seats.push('#333');
    if(seats.length > total) seats = seats.slice(0, total);

    // Hemicycle layout: rows from outer to inner
    const cx = W / 2;
    const cy = H - 8;
    const dotR = 4;
    const gap = 2;
    const dotStep = dotR * 2 + gap;

    // Calculate how many dots per row based on arc length
    let rowConfigs = [];
    let totalSlots = 0;
    const numRows = 9;
    for(let row = 0; row < numRows; row++) {
        let radius = 55 + row * (dotStep + 1);
        let arcLen = Math.PI * radius;
        let count = Math.floor(arcLen / dotStep);
        count = Math.max(8, Math.min(count, 70));
        rowConfigs.push({radius, count});
        totalSlots += count;
    }

    // If total seats > totalSlots, scale down
    // Distribute seats proportionally across rows
    let seatIdx = 0;

    for(let row = 0; row < numRows; row++) {
        const {radius, count} = rowConfigs[row];
        for(let s = 0; s < count; s++) {
            if(seatIdx >= seats.length) break;
            // angle from PI (left) to 0 (right), evenly distributed
            let angle = Math.PI - (s / (count - 1 || 1)) * Math.PI;
            let x = cx + radius * Math.cos(angle);
            let y = cy + radius * Math.sin(angle);
            ctx.beginPath();
            ctx.arc(x, y, dotR, 0, Math.PI * 2);
            ctx.fillStyle = seats[seatIdx];
            ctx.fill();
            // subtle outline
            ctx.strokeStyle = 'rgba(0,0,0,0.4)';
            ctx.lineWidth = 0.5;
            ctx.stroke();
            seatIdx++;
        }
        if(seatIdx >= seats.length) break;
    }

    // Majority line
    const majority = Math.floor(total / 2) + 1;
    let majIdx = majority;
    // Draw a vertical line at the center as majority indicator
    ctx.strokeStyle = '#f4d03f';
    ctx.lineWidth = 2;
    ctx.setLineDash([4, 3]);
    ctx.beginPath();
    ctx.moveTo(cx, cy - 10);
    ctx.lineTo(cx, cy - 160);
    ctx.stroke();
    ctx.setLineDash([]);

    // Labels at bottom
    ctx.font = 'bold 10px monospace';
    ctx.fillStyle = '#f4d03f';
    ctx.textAlign = 'center';
    ctx.fillText(`Maioria: ${majority}`, cx, cy - 2);

    // Candidate legend inside canvas (bottom corners)
    let lx = 6, ly = 12;
    ctx.textAlign = 'left';
    sorted.forEach(([id, c]) => {
        ctx.fillStyle = c.color;
        ctx.fillRect(lx, ly - 9, 10, 10);
        ctx.fillStyle = '#ddd';
        ctx.font = '9px monospace';
        ctx.fillText(`${c.name}: ${Math.round(c.start)}`, lx + 13, ly);
        ly += 13;
        if(ly > H - 15) { ly = 12; lx += 130; }
    });
}

function indirectNextTurn() {
    if(indirectGame.turn >= indirectGame.maxTurns) {
        finishIndirectGame();
        return;
    }
    indirectGame.turn++;
    document.getElementById("ind-turn").textContent = indirectGame.turn;

    // Earn points (increases over time as session heats up)
    let ptGain = 3 + (indirectGame.turn > 5 ? 1 : 0);
    indirectGame.points += ptGain;
    document.getElementById("ind-points").textContent = indirectGame.points;

    // AI moves - smarter: target player's closest followers
    const sc = scenariosData[indirectGame.scenario];
    const player = indirectGame.player;
    const playerVotes = indirectGame.candidates[player]?.start || 0;
    const majority = Math.floor(indirectGame.totalVotes/2)+1;
    
    Object.entries(indirectGame.candidates).forEach(([id, c]) => {
        if(id !== player) {
            // AI aggressiveness: higher if player near majority
            let urgency = playerVotes >= majority*0.9 ? 1.5 : 1;
            let gain = Math.floor((2 + Math.floor(Math.random()*4)) * urgency);
            // But AI also steals from each other
            let aiRivals = Object.entries(indirectGame.candidates).filter(([rid])=>rid!==id && rid!==player);
            if(aiRivals.length > 0 && Math.random() > 0.5) {
                let [rivalId, rival] = aiRivals[Math.floor(Math.random()*aiRivals.length)];
                let steal = Math.min(gain, Math.floor(rival.start*0.05));
                rival.start = Math.max(0, rival.start - steal);
                c.start += steal;
            } else {
                // AI pulls from player
                let steal = Math.min(gain, Math.floor(playerVotes*0.03));
                if(steal > 0) {
                    indirectGame.candidates[player].start = Math.max(0, indirectGame.candidates[player].start - Math.floor(steal*0.5));
                    c.start += steal;
                }
            }
        }
    });

    // Random mid-game event descriptions
    const midEvents = [
        `Bastidores do Congresso fervilham. Parlamentares trocam de lado em meio √† press√£o.`,
        `Rumores de acordos de √∫ltima hora circulam pelos corredores.`,
        `Bancadas indecisas recebem abordagens de todos os candidatos.`,
        `Tens√£o cresce. A vota√ß√£o se aproxima e a maioria ainda n√£o est√° definida.`,
        `Negocia√ß√µes intensas acontecem nos bastidores do Congresso Nacional.`,
        `Press√£o da sociedade civil faz parlamentares reverem posi√ß√µes.`,
    ];

    if(!indirectSpectatorMode) {
        const sc = scenariosData[indirectGame.scenario];
        if(sc.events) {
            sc.events.forEach((ev, idx) => {
                if(ev.turn === indirectGame.turn && !indirectGame.firedEvents.includes(idx)) {
                    indirectGame.firedEvents.push(idx);
                    let btns = ev.b.map((btn, bi) =>
                        `<button class="btn" onclick="executeIndirectEvent('${indirectGame.scenario}',${idx},${bi})">${btn.n}</button>`
                    ).join('');
                    setTimeout(() => showModal(`üì∞ EVENTO: ${ev.t}`, `<div style="background:#1a1a0a;padding:6px;border-left:3px solid #f4d03f;margin-bottom:8px"><span style="color:#f4d03f;font-size:10px">‚òÖ ACONTECIMENTO HIST√ìRICO REAL</span></div><br>${ev.d}`, btns), 300);
                }
            });
        }
    }

    let eventMsg = midEvents[Math.floor(Math.random()*midEvents.length)];
    indirectAddNews(`RODADA ${indirectGame.turn} ‚Äî ARTICULA√á√ïES`, eventMsg);
    renderFactions();
    renderIndirectScoreboard();
    renderIndirectActions();
    drawHemicycle();

    if(indirectGame.turn >= indirectGame.maxTurns) {
        setTimeout(finishIndirectGame, 500);
    }
}

function executeIndirectEvent(scenarioKey, evIdx, btnIdx) {
    const sc = scenariosData[scenarioKey];
    if(sc.events && sc.events[evIdx]) {
        sc.events[evIdx].b[btnIdx].f();
    }
    closeModal();
    renderIndirectScoreboard();
    drawHemicycle();
    renderFactions();
}

function finishIndirectGame() {
    const sorted = Object.entries(indirectGame.candidates).sort((a,b) => b[1].start - a[1].start);
    const winner = sorted[0];
    const winnerId = winner[0];
    const winnerData = winner[1];
    const total = indirectGame.totalVotes;
    const majority = Math.floor(total/2) + 1;
    const isPlayer = winnerId === indirectGame.player;
    const sc = scenariosData[indirectGame.scenario];
    const myData = indirectGame.candidates[indirectGame.player];

    document.getElementById("indirect-screen").classList.remove("active");
    document.getElementById("end-screen").classList.add("active");
    
    document.getElementById("result-title").textContent = isPlayer ? `üèÜ ELEITO PELO CONGRESSO!` : `üèõÔ∏è RESULTADO DA ELEI√á√ÉO INDIRETA`;
    document.getElementById("result-desc").innerHTML = `
        <b>${winnerData.name} (${winnerData.party})</b> √© eleito Presidente da Rep√∫blica com <b>${winnerData.start} votos</b> de ${total} (${Math.round(winnerData.start/total*100)}%).<br>
        <small>Maioria necess√°ria: ${majority} votos | Elei√ß√£o indireta ‚Äî ${sc.year}</small>
        ${isPlayer ? '<br><span style="color:#44ff44">üéä Parab√©ns! Voc√™ articulou com maestria!</span>' : ''}`;
    document.getElementById("candidate-bio").innerHTML = `
        <p><b>BRAS√çLIA, ${sc.year}</b> ‚Äî Em sess√£o do Congresso Nacional, ${winnerData.name} √© eleito presidente.</p>
        <p>${winnerData.bio}</p>
        ${isPlayer ? `<p><i>Voc√™ fez ${(indirectGame.deals[indirectGame.player]||[]).length} acordos de governo e usou ${7-indirectGame.points} pontos de influ√™ncia estrategicamente.</i></p>` : ''}`;
    
    // Congress-style result bar
    document.getElementById("congress-bars").innerHTML = `<b>RESULTADO DA VOTA√á√ÉO NO CONGRESSO</b>`;
    let bar = document.createElement('div');
    bar.className = 'congress-bar';
    bar.style.height = '36px';
    sorted.forEach(([id, c]) => {
        let pct = c.start / total * 100;
        let seg = document.createElement('div');
        seg.className = 'congress-segment';
        seg.style.width = pct + '%';
        seg.style.background = c.color;
        seg.title = `${c.name}: ${c.start} votos (${Math.round(pct)}%)`;
        seg.textContent = c.start > 15 ? `${c.name.substring(0,6)}: ${c.start}` : c.start > 5 ? c.start : '';
        bar.appendChild(seg);
    });
    document.getElementById("congress-bars").appendChild(bar);
    // Majority marker
    let majLine = document.createElement('div');
    majLine.style.cssText = `position:relative;margin-top:2px;font-size:9px;color:#f4d03f`;
    majLine.textContent = `‚¨Ü Linha de maioria: ${majority} votos (${Math.round(majority/total*100)}%)`;
    document.getElementById("congress-bars").appendChild(majLine);

    document.getElementById("congress-gov").innerHTML = sorted.map(([id,c])=>
        `<span style="color:${c.color}">‚ñ† ${c.name}: <b>${c.start}</b> votos</span>`
    ).join(' &nbsp;|&nbsp; ');
    document.getElementById("ranking-content").innerHTML = `
        <div class="rank-item">${isPlayer?'üèÜ':'‚ùå'} <b>${isPlayer?'ELEITO':'N√£o eleito'} pelo Congresso</b></div>
        <div class="rank-item">üó≥Ô∏è <b>Seus votos:</b> ${myData?.start||0} / ${total}</div>
        <div class="rank-item">üèõÔ∏è <b>Per√≠odo Hist√≥rico:</b> ${sc.year} ‚Äî Elei√ß√£o Indireta</div>
        <div class="rank-item">üìä <b>Fac√ß√µes controladas:</b> ${indirectGame.factions.filter(f=>f.leans===indirectGame.player).length}</div>`;

    // Achievement checks for indirect
    if(isPlayer) {
        let earned = [];
        if(!achievements['indirect_master']) { achievements['indirect_master']=true; earned.push('indirect_master'); }
        let startVotes = scenariosData[indirectGame.scenario]?.candidates[indirectGame.player]?.start||0;
        if(startVotes < total*0.25 && !achievements['indirect_underdog']) { achievements['indirect_underdog']=true; earned.push('indirect_underdog'); }
        if(!(indirectGame.deals[indirectGame.player]?.length > 0) && !achievements['no_deals']) { achievements['no_deals']=true; earned.push('no_deals'); }
        if(indirectGame.pressureLevel>=8 && !achievements['pressure_wins']) { achievements['pressure_wins']=true; earned.push('pressure_wins'); }
        let played = JSON.parse(localStorage.getItem('sim_played_scenarios')||'[]');
        if(!played.includes(indirectGame.scenario)) played.push(indirectGame.scenario);
        try { localStorage.setItem('sim_played_scenarios', JSON.stringify(played)); } catch(e) {}
        let indirectScenarios = ['1934_i','1964_i','1974_i','1978_i','1985_i'];
        if(indirectScenarios.every(s=>played.includes(s)) && !achievements['indirect_all']) { achievements['indirect_all']=true; earned.push('indirect_all'); }
        try { localStorage.setItem('sim_achievements', JSON.stringify(achievements)); } catch(e) {}
        if(earned.length>0) {
            let html = earned.map(id=>{let def=achievementDefs.find(d=>d.id===id);return def?`<div style="padding:4px;background:#fff8d0;border:1px solid gold;margin:3px 0;border-radius:3px">${def.emoji} <b>${def.name}</b> ‚Äî ${def.desc}</div>`:'';}).join('');
            setTimeout(()=>showModal('üèÜ CONQUISTAS DESBLOQUEADAS!', html, `<button class="btn" onclick="closeModal()">Fechar</button>`), 800);
        }
    }
}


// === CONTE√öDO PLANEJADO ===
function showPlannedContent() {
    let html = `<div style="max-height:420px;overflow-y:auto;font-size:12px;">
        <b>üîÆ CONTE√öDO PLANEJADO</b><hr>
        <b>‚úÖ PA√çSES DISPON√çVEIS</b>
        <div style="background:#e8ffe8;padding:6px;margin:4px 0;border-left:3px solid #006600;font-size:11px;">
            üá∫üá∏ EUA 2024 ‚úÖ | üá∑üá∫ R√∫ssia 2024 ‚úÖ | üá©üá™ Alemanha 2025 ‚úÖ | üá´üá∑ Fran√ßa 2022 ‚úÖ
        </div>
        <div style="background:#e8ffe8;padding:6px;margin:4px 0;border-left:3px solid #006600;font-size:11px;">
            1938 (sim.) ‚úÖ | 1945 ‚úÖ | 1950 ‚úÖ | 1955 ‚úÖ | 1960 ‚úÖ | 1965 (sim.) ‚úÖ<br>
            1989 ‚úÖ | 1994 ‚úÖ | 1998 ‚úÖ | 2002 ‚úÖ | 2006 ‚úÖ | 2010 ‚úÖ | 2014 ‚úÖ | 2018 ‚úÖ | 2022 ‚úÖ | 2026 ‚úÖ
        </div>
        <b>‚úÖ INDIRETAS DISPON√çVEIS</b>
        <div style="background:#e8ffe8;padding:6px;margin:4px 0;border-left:3px solid #006600;font-size:11px;">
            1934 ‚úÖ | 1964 ‚úÖ | 1974 ‚úÖ | 1978 ‚úÖ | 1985 ‚úÖ
        </div>
        <b>‚úÖ ELEI√á√ïES ESTADUAIS DISPON√çVEIS</b>
        <div style="background:#e8ffe8;padding:6px;margin:4px 0;border-left:3px solid #006600;font-size:11px;">
            MG 2022 ‚úÖ | SP 2022 ‚úÖ
        </div>
        <b>üîí ESTADUAIS PLANEJADAS (1982-2022)</b>
        <div style="background:#f0f0f0;padding:6px;margin:4px 0;border-left:3px solid #888;font-size:11px;">
            SP: 1982, 1986, 1990, 1994, 1998, 2002, 2006, 2010, 2014, 2018<br>
            MG: 1982, 1986, 1990, 1994, 1998, 2002, 2006, 2010, 2014, 2018<br>
            RJ, RS, BA, PE, CE, PR, GO ‚Äî v√°rios anos<br>
            Total planejado: 50+ elei√ß√µes estaduais
        </div>
        <b>üîí SISTEMA DE MANDATO P√ìS-ELEI√á√ÉO</b>
        <div style="background:#e8e8ff;padding:6px;margin:4px 0;border-left:3px solid #000080;font-size:11px;">
            Gerir o mandato: aprova√ß√£o, crises, decis√µes pol√≠ticas, reelei√ß√£o.<br>
            <i>Em planejamento...</i>
        </div>
        <b>üèôÔ∏è PREFEITURAS DE CAPITAIS</b>
        <div style="background:#fff8e8;padding:6px;margin:4px 0;border-left:3px solid #886600;font-size:11px;">
            SP, RJ, BH, Salvador, Manaus, Fortaleza, Recife... <i>Em planejamento...</i>
        </div>
        <hr><small style="color:#666">Sugest√µes s√£o bem-vindas!</small>
    </div>`;
    showModal('üìã CONTE√öDO PLANEJADO', html, `<button class="btn" onclick="closeModal()">Fechar</button>`);
}

function renderRadicalTab() {
    let div = document.getElementById('radical-content');
    if(!div) return;
    let lvl = Math.round(radicalizationLevel);
    let pw = game.partyWings || { moderate: 40, radical: 25, centrao: 35 };
    
    let statusLabel, statusColor, barColor;
    if(lvl >= 80) { statusLabel = 'üî¥ EXTREMA'; statusColor = '#cc0000'; barColor = '#cc0000'; }
    else if(lvl >= 60) { statusLabel = 'üü† ALTA'; statusColor = '#cc6600'; barColor = '#ff8800'; }
    else if(lvl >= 40) { statusLabel = 'üü° MODERADA'; statusColor = '#888800'; barColor = '#ccaa00'; }
    else if(lvl >= 20) { statusLabel = 'üü¢ BAIXA'; statusColor = '#006600'; barColor = '#00aa00'; }
    else { statusLabel = 'üîµ M√çNIMA'; statusColor = '#003388'; barColor = '#3366ff'; }
    
    let radicalParties = game.candidates.filter(c => {
        let cd = candidatesData[c.id];
        if(!cd) return false;
        return ['PCB','UP','PSTU','AIB','PCO','PSOL'].includes(cd.party) || (Math.abs(cd.econ||0) + Math.abs(cd.soc||0) >= 4);
    });
    
    let effectText = '';
    if(lvl > 60) effectText = `<span style="color:#cc0000">‚¨ÜÔ∏è Alta radicaliza√ß√£o: partidos radicais ganham +0.4%/turno</span>`;
    else if(lvl < 30) effectText = `<span style="color:#0000cc">‚¨áÔ∏è Baixa radicaliza√ß√£o: partidos radicais perdem -0.3%/turno</span>`;
    else effectText = `<span style="color:#666">‚öñÔ∏è Radicaliza√ß√£o moderada ‚Äî sem b√¥nus/penalidade</span>`;
    
    div.innerHTML = `
        <div style="background:#f0f0f0;padding:8px;border:1px solid #ccc;margin-bottom:8px;border-radius:2px">
            <b>N√≠vel de Radicaliza√ß√£o:</b> <span style="color:${statusColor};font-weight:bold">${lvl}/100 ‚Äî ${statusLabel}</span><br>
            <div style="width:100%;height:14px;background:#ddd;border:1px solid #aaa;margin:6px 0;border-radius:2px">
                <div style="width:${lvl}%;height:100%;background:${barColor};border-radius:2px;transition:width 0.3s"></div>
            </div>
            ${effectText}
        </div>
        <div style="background:#fffde8;padding:6px;border:1px solid #cc9900;margin-bottom:8px;">
            <b>üèõÔ∏è Alas do Partido:</b><br>
            <div style="margin:3px 0"><span style="color:#3366ff">‚ñ†</span> Ala Moderada: <b>${Math.round(pw.moderate)}%</b></div>
            <div style="margin:3px 0"><span style="color:#cc0000">‚ñ†</span> Ala Radical: <b>${Math.round(pw.radical)}%</b></div>
            <div style="margin:3px 0"><span style="color:#888">‚ñ†</span> Centr√£o: <b>${Math.round(pw.centrao)}%</b></div>
            ${pw.radical > 60 ? '<div style="color:#cc0000;font-weight:bold;margin-top:4px">‚ö†Ô∏è RISCO DE RACHA! Ala radical dominante.</div>' : ''}
            ${pw.centrao > 55 ? '<div style="color:#cc6600;font-weight:bold;margin-top:4px">‚ö†Ô∏è DEPEND√äNCIA DO CENTR√ÉO! Perda de verba por turno.</div>' : ''}
        </div>
        <div style="background:#f0f0f0;padding:6px;border:1px solid #ccc;margin-bottom:8px;">
            <b>üéØ Partidos Radicais Afetados:</b><br>
            ${radicalParties.length === 0 ? '<i style="color:#888">Nenhum partido radical neste cen√°rio.</i>' : 
              radicalParties.map(c => {
                let cd = candidatesData[c.id] || {};
                return `<div style="margin:3px 0">${cd.color ? '<span style="color:'+cd.color+'">' : ''}<b>${c.name}</b> (${cd.party||'?'}) ‚Äî ${c.votes.toFixed(1)}%${cd.color ? '</span>' : ''}</div>`;
              }).join('')}
        </div>
        <div style="background:#e8f0ff;padding:6px;border:1px solid #99aacc;font-size:9px;">
            <b>üìñ Como funciona:</b><br>
            ‚Ä¢ Radicaliza√ß√£o > 60: PCB, UP, PSTU, AIB e similares ganham +0.4%/turno<br>
            ‚Ä¢ Radicaliza√ß√£o &lt; 30: esses partidos perdem -0.3%/turno<br>
            ‚Ä¢ Use <b>Gerenciar Partido</b> para controlar as alas<br>
            ‚Ä¢ A√ß√µes radicais (manifesta√ß√µes, ataques) aumentam o n√≠vel<br>
            ‚Ä¢ A√ß√µes moderadas e di√°logo reduzem o n√≠vel<br>
            ‚Ä¢ Racha do partido: ala radical > 60% com evento ativado causa perda dr√°stica de popularidade
        </div>`;
}

// ============================================================
// V14: CRISES & ESC√ÇNDALOS TAB
// ============================================================
function renderCrisesTab() {
    const div = document.getElementById('crises-content');
    if(!div) return;
    let myScandal = game.scandalLevels[game.player] || 0;
    let playerC = candidatesData[game.player] || {};
    let rivals = game.candidates ? game.candidates.filter(c => c.id !== game.player) : [];
    
    let scandalColor = myScandal >= 7 ? '#cc0000' : myScandal >= 4 ? '#cc6600' : '#006600';
    let scandalLabel = myScandal >= 7 ? 'üö® CR√çTICO' : myScandal >= 4 ? '‚ö†Ô∏è ALTO' : myScandal <= 1 ? '‚úÖ LIMPO' : 'üî∂ MODERADO';
    
    // Aviso de crescimento de esc√¢ndalo por ina√ß√£o
    let lastCrisisVisit = game.lastCrisesTabTurn || 0;
    let turnsSinceCrisis = game.turn - lastCrisisVisit;
    let inactionWarning = '';
    if(myScandal > 0 && turnsSinceCrisis >= 2) {
        let growthRisk = Math.min(85, Math.round(30 + myScandal * 6 + turnsSinceCrisis * 5));
        inactionWarning = `<div style="background:#fff0d0;border:1px solid #cc6600;padding:6px;margin-bottom:6px;border-radius:2px;font-size:10px">
            ‚è∞ <b>Aten√ß√£o!</b> Voc√™ n√£o gerenciou crises h√° ${turnsSinceCrisis} turnos.<br>
            A imprensa est√° mantendo o esc√¢ndalo vivo ‚Äî chance de crescer: <b style="color:#cc0000">${growthRisk}%/turno</b>.<br>
            <i>Plante narrativa ou se defenda para estabilizar!</i>
        </div>`;
    }
    
    let html = `<div style="background:#f0f0f0;padding:8px;border:1px solid #ccc;margin-bottom:8px;border-radius:2px">
        <b>üîç Seu n√≠vel de esc√¢ndalo:</b> <span style="color:${scandalColor};font-weight:bold">${myScandal}/10 ‚Äî ${scandalLabel}</span>
        <div style="width:100%;height:8px;background:#ddd;border:1px solid #aaa;margin:4px 0;border-radius:2px">
            <div style="width:${myScandal*10}%;height:100%;background:${scandalColor};border-radius:2px;transition:width 0.3s"></div>
        </div>
    </div>
    ${inactionWarning}
    <b style="font-size:10px;color:#cc0000">‚öîÔ∏è INVESTIGA√á√ÉO DE RIVAIS</b><hr style="margin:4px 0">`;

    // Investigate rival - by target
    rivals.slice(0, 3).forEach((rival, i) => {
        let cd = candidatesData[rival.id] || {};
        let rivalScandal = game.scandalLevels[rival.id] || 0;
        html += `<button class="btn" style="background:#fff0f0;text-align:left" onclick="actionInvestigarRival('${rival.id}')">
            üîç Investigar <b style="color:${cd.color||'#000'}">${rival.name || cd.name || rival.id}</b> (4p)<br>
            <small style="font-weight:normal;color:#555">Esc√¢ndalo atual: ${rivalScandal}/10 | Exp√µe irregularidades que prejudicam sua campanha</small>
        </button>`;
    });

    html += `<br><b style="font-size:10px;color:#cc6600">üì∞ PLANTAR NARRATIVA</b><hr style="margin:4px 0">
    <button class="btn" style="background:#fff8e8;text-align:left" onclick="actionPlantarNarrativa()">
        üóûÔ∏è Plantar Narrativa na M√≠dia (3p)<br>
        <small style="font-weight:normal;color:#555">Espalha uma narrativa favor√°vel que ganhe tra√ß√£o na imprensa. Risco m√©dio de repercuss√£o negativa.</small>
    </button>
    <button class="btn" style="background:#fff8e8;text-align:left" onclick="actionVazarDocumento()">
        üìÇ Vazar Documento Comprometedor (5p)<br>
        <small style="font-weight:normal;color:#555">Vaza material comprometedor contra o l√≠der advers√°rio. Alto impacto, alto risco.</small>
    </button>
    <button class="btn" style="background:#fff8e8;text-align:left" onclick="actionFakeNews()">
        ü§ñ Campanha de Desinforma√ß√£o (3p, R$5M)<br>
        <small style="font-weight:normal;color:#555">Financia rob√¥s e fake news. Pode dar grande resultado ou explodir negativamente.</small>
    </button>
    <br><b style="font-size:10px;color:#006600">üõ°Ô∏è DEFESA E CONTROLE DE DANOS</b><hr style="margin:4px 0">
    <button class="btn" style="background:#e8ffe8;text-align:left" onclick="actionAbafar()">
        ü§´ Abafar Esc√¢ndalo (R$15M)<br>
        <small style="font-weight:normal;color:#555">Paga para suprimir not√≠cias negativas. Reduz seu esc√¢ndalo em at√© 3 pontos.</small>
    </button>
    <button class="btn" style="background:#e8ffe8;text-align:left" onclick="actionAssumirErro()">
        üôè Assumir Erro Publicamente (2p)<br>
        <small style="font-weight:normal;color:#555">Admite o erro antes que pior√©. Reduz rejei√ß√£o em 5 pts e esc√¢ndalo em 2, mas custa popularidade moment√¢nea.</small>
    </button>
    <button class="btn" style="background:#e8ffe8;text-align:left" onclick="actionContraAtaque()">
        ‚ö° Contra-Ataque Midi√°tico (4p)<br>
        <small style="font-weight:normal;color:#555">Responde a ataques com agressividade. Pode reverter o dano ou piorar a situa√ß√£o.</small>
    </button>
    <button class="btn" style="background:#e8ffe8;text-align:left" onclick="actionCriseMediatica()">
        üõ°Ô∏è Gerenciar Crise Midi√°tica (3p)<br>
        <small style="font-weight:normal;color:#555">Contrata gestores de crise. Reduz dano em andamento e melhora imagem.</small>
    </button>`;

    div.innerHTML = html;
}

function actionInvestigarRival(targetId) {
    if(game.points < 4) { log("Pontos insuficientes para investigar (4p)."); return; }
    game.points -= 4;
    let target = game.candidates.find(c => c.id === targetId);
    if(!target) { updateUI(); return; }
    let cd = candidatesData[targetId] || {};
    game.scandalLevels[targetId] = Math.min(10, (game.scandalLevels[targetId]||0) + 3);
    let dmg = game.scandalLevels[targetId] >= 5 ? 3.5 : 1.5;
    updateNationalVotes(targetId, -dmg);
    addNews(`üîç ESC√ÇNDALO: ${cd.name||targetId}`, `Investiga√ß√£o revela irregularidades na campanha. N√≠vel de esc√¢ndalo: ${game.scandalLevels[targetId]}/10`);
    log(`Investiga√ß√£o exp√¥s ${cd.name||targetId}! Esc√¢ndalo +3, -${dmg}%.`);
    if(game.scandalLevels[targetId] >= 8) {
        addNews(`üö® CPI CONTRA ${cd.name||targetId}`, `Congresso abre comiss√£o de investiga√ß√£o ap√≥s s√©rie de den√∫ncias!`);
        updateNationalVotes(targetId, -2);
    }
    updateUI();
    renderCrisesTab();
}

function actionPlantarNarrativa() {
    if(game.points < 3) { log("Pontos insuficientes (3p)."); return; }
    game.points -= 3;
    let roll = Math.random();
    if(roll > 0.55) {
        let gain = 2 + Math.random() * 2;
        updateNationalVotes(game.player, gain);
        addNews(`üì∞ NARRATIVA: ${candidatesData[game.player]?.name}`, `Campanha domina agenda midi√°tica com narrativa favor√°vel.`);
        log(`üì∞ Narrativa plantada com sucesso! +${gain.toFixed(1)}%`);
        game.narrativeSuccesses = (game.narrativeSuccesses||0)+1;
    } else if(roll > 0.3) {
        updateNationalVotes(game.player, 0.5);
        log(`üì∞ Narrativa teve repercuss√£o m√≠nima. +0.5%`);
    } else {
        let loss = 1 + Math.random() * 2;
        updateNationalVotes(game.player, -loss);
        game.scandalLevels[game.player] = Math.min(10, (game.scandalLevels[game.player]||0)+1);
        addNews(`‚ö†Ô∏è BACKFIRE: ${candidatesData[game.player]?.name}`, `Tentativa de narrativa √© desmascarada pela imprensa.`);
        log(`üì∞ Narrativa saiu pela culatra! -${loss.toFixed(1)}% e +1 esc√¢ndalo.`);
    }
    updateUI(); renderCrisesTab();
}

function actionVazarDocumento() {
    if(game.points < 5) { log("Pontos insuficientes (5p)."); return; }
    game.points -= 5;
    let rivals = game.candidates.filter(c => c.id !== game.player).sort((a,b) => b.votes-a.votes);
    let target = rivals[0];
    if(!target) { updateUI(); return; }
    let cd = candidatesData[target.id] || {};
    let roll = Math.random();
    if(roll > 0.4) {
        let loss = 3 + Math.random() * 3;
        updateNationalVotes(target.id, -loss);
        game.scandalLevels[target.id] = Math.min(10, (game.scandalLevels[target.id]||0)+4);
        addNews(`üí£ BOMBA DOCUMENTAL: ${cd.name}`, `Documentos comprometedores vazam e abalaram a candidatura.`);
        log(`üí£ Vazamento devastou ${cd.name}! -${loss.toFixed(1)}% e +4 esc√¢ndalo.`);
    } else {
        let myLoss = 2 + Math.random() * 2;
        updateNationalVotes(game.player, -myLoss);
        game.scandalLevels[game.player] = Math.min(10, (game.scandalLevels[game.player]||0)+2);
        addNews(`‚ö†Ô∏è VAZAMENTO ATRIBU√çDO A ${candidatesData[game.player]?.name}`, `Imprensa rastreia origem do documento. Esc√¢ndalo recai sobre quem vazou.`);
        log(`üí£ Vazamento foi rastreado at√© voc√™! -${myLoss.toFixed(1)}% e +2 esc√¢ndalo pr√≥prio!`);
    }
    updateUI(); renderCrisesTab();
}

function actionFakeNews() {
    if(game.points < 3 || game.money < 5) { log("Pontos ou verba insuficiente (3p, R$5M)."); return; }
    game.points -= 3; game.money -= 5;
    let roll = Math.random();
    if(roll > 0.5) {
        let gain = 2 + Math.random() * 3;
        updateNationalVotes(game.player, gain);
        log(`ü§ñ Campanha de desinforma√ß√£o viralizou! +${gain.toFixed(1)}%`);
    } else if(roll > 0.25) {
        log(`ü§ñ Desinforma√ß√£o teve alcance limitado. Impacto neutro.`);
    } else {
        let loss = 3 + Math.random() * 2;
        updateNationalVotes(game.player, -loss);
        game.scandalLevels[game.player] = Math.min(10, (game.scandalLevels[game.player]||0)+3);
        addNews(`üö® FAKE NEWS: ${candidatesData[game.player]?.name}`, `Campanha de desinforma√ß√£o √© desmascarada. Imagem gravemente afetada.`);
        log(`ü§ñ Fake news desmascarada! -${loss.toFixed(1)}% e +3 esc√¢ndalo!`);
    }
    updateUI(); renderCrisesTab();
}

function actionAssumirErro() {
    if(game.points < 2) { log("Pontos insuficientes (2p)."); return; }
    let myScandal = game.scandalLevels[game.player] || 0;
    if(myScandal === 0) { log("Nenhum erro/esc√¢ndalo para assumir."); return; }
    game.points -= 2;
    let reduction = Math.min(myScandal, 2);
    game.scandalLevels[game.player] = Math.max(0, myScandal - reduction);
    game.approvals[game.player].rej = Math.max(0, (game.approvals[game.player].rej || 30) - 5);
    updateNationalVotes(game.player, -0.5); // small initial hit
    addNews(`üôè MEIA-CULPA: ${candidatesData[game.player]?.name}`, `Candidato admite erro publicamente. Imprensa divide opini√µes sobre a sinceridade.`);
    log(`üôè Erro assumido: -${reduction} esc√¢ndalo, -5 rejei√ß√£o (pequena queda moment√¢nea -0.5%).`);
    updateUI(); renderCrisesTab();
}

function actionContraAtaque() {
    if(game.points < 4) { log("Pontos insuficientes (4p)."); return; }
    game.points -= 4;
    let roll = Math.random();
    if(roll > 0.45) {
        let gain = 2 + Math.random() * 2;
        updateNationalVotes(game.player, gain);
        game.approvals[game.player].rej = Math.max(0, (game.approvals[game.player].rej||30) - 3);
        addNews(`‚ö° CONTRA-ATAQUE: ${candidatesData[game.player]?.name}`, `Candidato responde com virul√™ncia e ganha terreno.`);
        log(`‚ö° Contra-ataque bem-sucedido! +${gain.toFixed(1)}% e -3 rejei√ß√£o.`);
    } else {
        let loss = 1 + Math.random() * 2;
        updateNationalVotes(game.player, -loss);
        game.approvals[game.player].rej += 4;
        log(`‚ö° Contra-ataque saiu pela culatra! -${loss.toFixed(1)}% e +4 rejei√ß√£o.`);
    }
    updateUI(); renderCrisesTab();
}

// ============================================================
// V14: INTELIG√äNCIA & AN√ÅLISE TAB
// ============================================================
function renderInteligenciaTab() {
    const div = document.getElementById('inteligencia-content');
    if(!div) return;

    let player = game.player;
    let playerC = candidatesData[player] || {};
    let isEC = game.isElectoralCollege;
    let isIntl = !!internationalData[game.scenario];
    let isBR = !isEC && !isIntl;
    
    // Calculate state opportunities
    let opportunities = [];
    let safeStates = [];
    let lostStates = [];
    
    let stateList = isIntl ? (internationalData[game.scenario]?.regions || []) : allStates;
    if(isEC) stateList = (internationalData[game.scenario]?.electoralStates || []);
    
    // Para elei√ß√µes brasileiras, an√°lise especial de mapa
    let natSorted = isBR ? [...(game.candidates||[])].sort((a,b) => b.votes - a.votes) : [];
    let natTop1 = natSorted[0];
    let natTop2 = natSorted[1];
    let isPlayerTop1 = natTop1?.id === player;
    let isPlayerTop2 = natTop2?.id === player;
    
    stateList.forEach(s => {
        let votes = game.stateVotes[s.id];
        if(!votes) return;
        let sorted = Object.entries(votes).sort((a,b)=>b[1]-a[1]);
        let playerVotes = votes[player] || 0;
        let leadVotes = sorted[0][1];
        let secondVotes = sorted[1] ? sorted[1][1] : 0;
        let isLeading = sorted[0][0] === player;
        let margin = isLeading ? (leadVotes - secondVotes) : (playerVotes - leadVotes);
        let pop = s.p || s.ev || 1;
        
        if(isLeading && margin > 15) safeStates.push({...s, margin, playerVotes, leadVotes});
        else if(!isLeading && margin < -20) lostStates.push({...s, margin, playerVotes, leadVotes});
        else opportunities.push({...s, margin, playerVotes, leadVotes, isLeading});
    });
    
    opportunities.sort((a,b) => (b.p||b.ev||1) - (a.p||a.ev||1));
    
    // An√°lise do mapa (s√≥ para elei√ß√µes BR)
    let mapaAnaliseHtml = '';
    if(isBR) {
        let statesWinning = safeStates.length + opportunities.filter(s=>s.isLeading).length;
        let statesLosing = lostStates.length + opportunities.filter(s=>!s.isLeading).length;
        let rivalName = natTop1?.id !== player ? (candidatesData[natTop1?.id]?.name || 'L√≠der') 
                                               : (candidatesData[natTop2?.id]?.name || 'Rival');
        let dominanceMsg = isPlayerTop1 
            ? `Voc√™ lidera a pesquisa nacional (${natTop1.votes.toFixed(1)}%) e deve dominar a maioria dos estados.`
            : isPlayerTop2
            ? `Voc√™ est√° em 2¬∫ lugar (${natTop2.votes.toFixed(1)}%). Os estados est√£o divididos com ${candidatesData[natTop1.id]?.name||'o l√≠der'}.`
            : `Voc√™ est√° fora do top 2 nacional ‚Äî seus votos estaduais s√£o limitados. Foque em crescer nas pesquisas nacionais.`;
        
        mapaAnaliseHtml = `<div style="background:#001a33;color:#88ccff;padding:8px;border-radius:2px;font-size:10px;margin-bottom:6px">
            <b>üó∫Ô∏è AN√ÅLISE DO MAPA ELEITORAL:</b><br>
            ${dominanceMsg}<br>
            Ganhando em: <b style="color:#88ff88">${statesWinning} estados</b> | Perdendo em: <b style="color:#ff8888">${statesLosing} estados</b><br>
            <i style="opacity:0.7">Os estados seguem a pesquisa nacional + ideologia regional (traits)</i>
        </div>`;
    }
    
    let oppHtml = opportunities.slice(0,8).map(s => {
        let statusColor = s.isLeading ? '#006600' : '#cc6600';
        let statusText = s.isLeading ? `‚úÖ Frente por ${s.margin.toFixed(0)}%` : `‚ö†Ô∏è Atr√°s por ${Math.abs(s.margin).toFixed(0)}%`;
        let ev = s.ev ? ` (${s.ev} EV)` : '';
        let traitsHtml = '';
        if(!isEC && !isIntl) {
            let traits = stateTraits[s.id] || [];
            traitsHtml = traits.length ? `<div style="font-size:8px;margin-top:2px">` + 
                traits.map(t=>`<span style="background:${t.side==='E'?'#cc2200':t.side==='D'?'#2200cc':'#555'};color:white;padding:1px 3px;border-radius:2px;margin:1px;display:inline-block">${t.label}</span>`).join('') 
                + '</div>' : '';
        }
        return `<div style="border:1px solid #ccc;padding:5px;margin-bottom:3px;border-radius:2px;background:#fafafa">
            <div style="display:flex;justify-content:space-between;align-items:center">
                <b style="font-size:10px">${s.n}${ev}</b>
                <span style="font-size:9px;color:${statusColor}">${statusText}</span>
            </div>
            <div style="font-size:9px;color:#555">${playerC.name||'Voc√™'}: ${(s.playerVotes||0).toFixed(1)}%</div>
            ${traitsHtml}
            <button class="btn" style="width:auto;font-size:8px;padding:1px 4px;margin-top:2px" onclick="doIntelCampaign('${s.id}')">üéØ Campanha Focada (3p, R$6M)</button>
        </div>`;
    }).join('');

    let html = `${mapaAnaliseHtml}
    <div style="background:#001a33;color:#88ccff;padding:8px;border-radius:2px;font-size:11px;margin-bottom:8px">
        <b>üìä An√°lise Estrat√©gica:</b><br>
        ‚úÖ Estados seguros: <b>${safeStates.length}</b> | ‚ö†Ô∏è Disputados: <b>${opportunities.length}</b> | ‚ùå Perdendo feio: <b>${lostStates.length}</b>
    </div>
    <button class="btn" style="background:#003366;color:white" onclick="actionResearchPoll()">
        üìä Pesquisa de Inten√ß√£o Estadual (2p)<br>
        <small style="font-weight:normal;opacity:0.8">Revela ranking detalhado de todos os estados/regi√µes</small>
    </button>
    <button class="btn" style="background:#003366;color:white" onclick="actionFocusGroup()">
        üë• Focus Group com Eleitores (3p)<br>
        <small style="font-weight:normal;opacity:0.8">Identifica os temas mais relevantes para cada grupo demogr√°fico</small>
    </button>
    <button class="btn" style="background:#003366;color:white" onclick="actionMapearOpiniao()">
        üó∫Ô∏è Mapeamento de Opini√£o (2p, R$4M)<br>
        <small style="font-weight:normal;opacity:0.8">Gera relat√≥rio sobre regi√µes com maior potencial de virada</small>
    </button>
    <hr>
    <b style="font-size:10px">üéØ ESTADOS/REGI√ïES PRIORIT√ÅRIOS (mais disputados):</b>
    <div style="margin-top:4px">${oppHtml || '<div style="color:#888;font-size:10px">Nenhum estado identificado.</div>'}</div>
    <hr>
    <b style="font-size:10px">üî≠ AN√ÅLISE DE RIVAIS:</b>
    <button class="btn" onclick="actionAnalisarRivais()">
        üî≠ Analisar For√ßas e Fraquezas dos Rivais (2p)<br>
        <small style="font-weight:normal;color:#555">Relat√≥rio detalhado de cada candidato advers√°rio</small>
    </button>
    <button class="btn" onclick="actionPreveroResultado()">
        üîÆ Prever Resultado Eleitoral (3p)<br>
        <small style="font-weight:normal;color:#555">Simula√ß√£o estat√≠stica do resultado baseada nas pesquisas atuais</small>
    </button>`;
    
    div.innerHTML = html;
}

function doIntelCampaign(stateId) {
    if(game.points < 3 || game.money < 6) { log("Pontos ou verba insuficiente (3p, R$6M)."); return; }
    game.points -= 3; game.money -= 6;
    if(!game.stateVotes[stateId]) game.stateVotes[stateId] = {};
    game.stateVotes[stateId][game.player] = (game.stateVotes[stateId][game.player]||0) + 8;
    let stateSum = Object.values(game.stateVotes[stateId]).reduce((a,b)=>a+b,0);
    if(stateSum>0) Object.keys(game.stateVotes[stateId]).forEach(cid => game.stateVotes[stateId][cid]=(game.stateVotes[stateId][cid]/stateSum)*100);
    updateNationalVotes(game.player, 1.5);
    log(`üéØ Campanha focada em ${stateId}! +8% local, +1.5% nacional.`);
    updateUI(); renderInteligenciaTab();
}

function actionResearchPoll() {
    if(game.points < 2) { log("Pontos insuficientes (2p)."); return; }
    game.points -= 2;
    let stateList = (game.isElectoralCollege ? (internationalData[game.scenario]?.electoralStates || []) : 
                     (internationalData[game.scenario]?.regions || allStates));
    let rows = stateList.slice(0,12).map(s => {
        let votes = game.stateVotes[s.id] || {};
        let sorted = Object.entries(votes).sort((a,b)=>b[1]-a[1]);
        let leaderId = sorted[0] ? sorted[0][0] : null;
        let cd = leaderId ? (candidatesData[leaderId]||{}) : {};
        let playerVotes = votes[game.player] || 0;
        let ev = s.ev ? ` ${s.ev}EV` : '';
        return `<tr style="border-bottom:1px solid #ddd">
            <td style="padding:2px 4px;font-size:10px">${s.n}${ev}</td>
            <td style="padding:2px 4px;font-size:10px;color:${cd.color||'#000'}">${cd.name||'?'}</td>
            <td style="padding:2px 4px;font-size:10px">${playerVotes.toFixed(1)}%</td>
        </tr>`;
    }).join('');
    let playerName = candidatesData[game.player]?.name || 'Voc√™';
    showModal('üìä PESQUISA ESTADUAL DETALHADA', `<table style="width:100%;border-collapse:collapse">
        <tr style="background:#000080;color:white"><th style="padding:3px">Estado/Regi√£o</th><th>L√≠der</th><th>${playerName}</th></tr>
        ${rows}
    </table>`, `<button class="btn" onclick="closeModal()">Fechar</button>`);
    updateUI();
}

function actionFocusGroup() {
    if(game.points < 3) { log("Pontos insuficientes (3p)."); return; }
    game.points -= 3;
    let cd = candidatesData[game.player] || {};
    let insights = [
        `üìä Eleitores jovens (18-24): Priorizam ${cd.side==='E'?'emprego e habita√ß√£o':'seguran√ßa e tecnologia'}`,
        `üë© Mulheres: Tema mais sens√≠vel √© ${Math.random()>0.5?'seguran√ßa p√∫blica':'sa√∫de e educa√ß√£o'}`,
        `üë¥ Idosos (60+): Preocupa√ß√£o #1 √© ${cd.side==='E'?'previd√™ncia e sa√∫de':'ordem e tradi√ß√£o'}`,
        `üèôÔ∏è Urbanos: Principal driver √© ${Math.random()>0.5?'transporte e mobilidade':'corrup√ß√£o e efici√™ncia'}`,
        `üåæ Rurais: ${cd.side==='D'?'Agroneg√≥cio tem bom aproveitamento (b√¥nus +1% campanha rural)':'Resist√™ncia moderada ‚Äî campanha rural recomendada'}`,
        `üí∞ Classe C: Sens√≠veis a ${cd.econ > 0?'empregos formais e custo de vida':'programas sociais e renda m√≠nima'}`,
    ];
    let insightHtml = insights.map(i => `<div style="background:#f0f8ff;border-left:3px solid #000080;padding:5px;margin-bottom:4px;font-size:11px">${i}</div>`).join('');
    let gain = 0.5 + Math.random();
    updateNationalVotes(game.player, gain);
    showModal('üë• RESULTADO DO FOCUS GROUP', insightHtml + `<div style="background:#e8ffe8;border:1px solid #006600;padding:5px;margin-top:8px;font-size:10px">‚úÖ Focus group gerou insights estrat√©gicos! +${gain.toFixed(1)}% ao aplicar as recomenda√ß√µes.</div>`, `<button class="btn" onclick="closeModal()">Fechar</button>`);
    updateUI();
}

function actionMapearOpiniao() {
    if(game.points < 2 || game.money < 4) { log("Pontos ou verba insuficiente (2p, R$4M)."); return; }
    game.points -= 2; game.money -= 4;
    let stateList = internationalData[game.scenario]?.regions || allStates;
    let viradas = stateList.filter(s => {
        let votes = game.stateVotes[s.id] || {};
        let sorted = Object.entries(votes).sort((a,b)=>b[1]-a[1]);
        let leaderId = sorted[0] ? sorted[0][0] : null;
        let playerVotes = votes[game.player] || 0;
        let leadVotes = sorted[0] ? sorted[0][1] : 0;
        return leaderId !== game.player && (leadVotes - playerVotes) < 8;
    }).slice(0, 5);
    let viradaHtml = viradas.length ? viradas.map(s => {
        let votes = game.stateVotes[s.id] || {};
        let playerVotes = votes[game.player] || 0;
        let sorted = Object.entries(votes).sort((a,b)=>b[1]-a[1]);
        let leadVotes = sorted[0][1];
        return `<div style="background:#fffde8;border-left:3px solid #cc9900;padding:5px;margin-bottom:3px;font-size:11px">
            üéØ <b>${s.n}</b>: ${playerVotes.toFixed(1)}% vs l√≠der ${leadVotes.toFixed(1)}% ‚Äî <b>GAP ${(leadVotes-playerVotes).toFixed(1)}%</b>
        </div>`;
    }).join('') : '<div style="color:#666;font-size:10px">Nenhuma regi√£o com potencial de virada imediata.</div>';
    showModal('üó∫Ô∏è REGI√ïES COM POTENCIAL DE VIRADA', `<p style="font-size:11px">Regi√µes onde voc√™ est√° perdendo por margem pequena (menos de 8%):</p>${viradaHtml}
    <div style="background:#e8ffe8;border:1px solid #006600;padding:5px;margin-top:8px;font-size:10px">üí° Invista campanhas focadas nestas regi√µes para reverter o resultado!</div>`,
    `<button class="btn" onclick="closeModal()">Fechar</button>`);
    updateUI();
}

function actionAnalisarRivais() {
    if(game.points < 2) { log("Pontos insuficientes (2p)."); return; }
    game.points -= 2;
    let rivals = game.candidates ? game.candidates.filter(c => c.id !== game.player).sort((a,b) => b.votes-a.votes) : [];
    let html = rivals.slice(0,4).map(r => {
        let cd = candidatesData[r.id] || {};
        let scandal = game.scandalLevels[r.id] || 0;
        let approval = game.approvals[r.id] || {app:50, rej:30};
        let fraqueza = scandal > 3 ? '‚ö†Ô∏è Esc√¢ndalo alto ‚Äî vulner√°vel a ataques' : 
                       approval.rej > 50 ? '‚ö†Ô∏è Alta rejei√ß√£o ‚Äî eleitorado saturado' :
                       r.votes < 15 ? '‚ö†Ô∏è Baixa base ‚Äî risco de queda' : '‚úÖ Candidato est√°vel';
        return `<div style="border:2px solid ${cd.color||'#888'};padding:8px;margin-bottom:6px;border-radius:3px">
            <b style="color:${cd.color||'#000'}">${cd.name||r.id}</b> (${cd.party||'?'}) ‚Äî ${r.votes.toFixed(1)}%<br>
            <small>üìä Aprova√ß√£o: ${approval.app.toFixed(0)}% | Rejei√ß√£o: ${approval.rej.toFixed(0)}% | Esc√¢ndalo: ${scandal}/10</small><br>
            <small style="color:${scandal>3||approval.rej>50?'#cc0000':'#006600'}">${fraqueza}</small>
        </div>`;
    }).join('');
    showModal('üî≠ AN√ÅLISE DE RIVAIS', html || '<div>Nenhum rival identificado.</div>', `<button class="btn" onclick="closeModal()">Fechar</button>`);
    updateUI();
}

function actionPreveroResultado() {
    if(game.points < 3) { log("Pontos insuficientes (3p)."); return; }
    game.points -= 3;
    let sorted = [...game.candidates].sort((a,b) => b.votes-a.votes);
    let leader = sorted[0];
    let playerC = candidatesData[game.player] || {};
    let isPlayer = leader.id === game.player;
    let playerRank = sorted.findIndex(c => c.id === game.player) + 1;
    let gap = sorted[0].votes - (game.candidates.find(c=>c.id===game.player)||{votes:0}).votes;
    
    let prediction = isPlayer ? '‚úÖ Proje√ß√£o: VIT√ìRIA' : (playerRank <= 2 ? '‚ö†Ô∏è Proje√ß√£o: 2¬∫ TURNO disputado' : '‚ùå Proje√ß√£o: DERROTA');
    let predColor = isPlayer ? '#006600' : playerRank <= 2 ? '#cc8800' : '#cc0000';
    
    let html = `<div style="background:${predColor};color:white;padding:10px;text-align:center;border-radius:4px;margin-bottom:10px;font-size:13px;font-weight:bold">${prediction}</div>`;
    html += sorted.map((c,i) => {
        let cd = candidatesData[c.id] || {};
        let isP = c.id === game.player;
        let variance = (Math.random()*4-2).toFixed(1);
        let projMin = Math.max(0, c.votes - 3).toFixed(1);
        let projMax = Math.min(100, c.votes + 3).toFixed(1);
        return `<div style="display:flex;align-items:center;gap:8px;margin:4px 0;padding:4px;background:${isP?'#ffffcc':'#f9f9f9'};border-left:3px solid ${cd.color||'#888'}">
            <span style="font-size:11px;min-width:20px;font-weight:bold">${i+1}¬∫</span>
            <div style="flex:1">
                <b style="color:${cd.color||'#000'};font-size:11px">${cd.name||c.id}</b><br>
                <small>Proje√ß√£o: ${projMin}%‚Äì${projMax}% (central: ${c.votes.toFixed(1)}%)</small>
            </div>
        </div>`;
    }).join('');
    
    updateNationalVotes(game.player, 0.3);
    showModal('üîÆ PROJE√á√ÉO ELEITORAL', html, `<button class="btn" onclick="closeModal()">Fechar</button>`);
    updateUI();
}

// ============================================================
// V14: CREDITS
// ============================================================
function showCredits() {
    let html = `<div style="text-align:center;padding:20px">
        <div style="background:linear-gradient(135deg,#000080,#4040cc);color:white;padding:20px;border-radius:8px;margin-bottom:16px">
            <div style="font-size:28px;margin-bottom:4px">üåé</div>
            <b style="font-size:16px">SIMULADOR ELEITORAL GLOBAL</b><br>
            <span style="font-size:12px;opacity:0.8">Vers√£o 14 ‚Äî 2026</span>
        </div>
        <div style="background:#fff;border:2px solid #000080;padding:16px;border-radius:6px;margin-bottom:10px">
            <div style="font-size:13px;color:#000080;font-weight:bold;margin-bottom:8px">üëë CRIA√á√ÉO E DESENVOLVIMENTO</div>
            <div style="font-size:18px;font-weight:bold;color:#cc0000;margin:6px 0">Danoni</div>
            <div style="font-size:10px;color:#555">Criador, Programador e Game Designer</div>
        </div>
        <div style="background:#fff;border:2px solid #cc9900;padding:16px;border-radius:6px;margin-bottom:10px">
            <div style="font-size:13px;color:#cc6600;font-weight:bold;margin-bottom:8px">‚≠ê PLAYERS ESPECIAIS</div>
            <div style="font-size:16px;font-weight:bold;color:#884400;margin:4px 0">Zanoni</div>
            <div style="font-size:16px;font-weight:bold;color:#884400;margin:4px 0">Devenerance</div>
            <div style="font-size:10px;color:#555;margin-top:4px">Feedback, testes e inspira√ß√£o</div>
        </div>
        <div style="background:#f0f0f0;border:1px solid #ccc;padding:10px;border-radius:4px;font-size:10px;color:#555">
            Feito com ‚ù§Ô∏è para entusiastas de pol√≠tica e hist√≥ria<br>
            Todos os dados s√£o simulados para fins de entretenimento
        </div>
    </div>`;
    showModal('üëë CR√âDITOS', html, `<button class="btn" onclick="closeModal()">Fechar</button>`);
}

function showChangelog() {
    let html = `<div style="max-height:400px;overflow-y:auto;font-size:11px;">
    <div style="background:#000080;color:white;padding:6px;margin-bottom:8px;font-weight:bold;font-size:12px">
        üåé SIMULADOR ELEITORAL GLOBAL ‚Äî CHANGELOG
    </div>
    <div style="background:#e8ffe8;border:1px solid #009900;padding:6px;margin-bottom:6px;border-left:4px solid #00cc00">
        <b>üÜï VERS√ÉO 14</b> ‚Äî <i>EUA 2000‚Äì2016, M√≠dias por Era, VPs por Pa√≠s, Aba Crises & Intelig√™ncia, Cr√©ditos</i><br>
        <b style="color:#006600">‚úÖ üá∫üá∏ EUA 2000‚Äì2016:</b> Bush vs Gore, Bush vs Kerry, Obama vs McCain, Obama vs Romney, Trump vs Clinton<br>
        <b style="color:#006600">‚úÖ üì∞ M√≠dia por Era:</b> Jornais para 2000‚Äì2008, mix imprensa+Twitter para 2012‚Äì2016<br>
        <b style="color:#006600">‚úÖ üåê Tweets para 10+ pa√≠ses:</b> Ucr√¢nia, Espanha, Jap√£o, Coreia, √Åfrica do Sul, Filipinas, Turquia<br>
        <b style="color:#006600">‚úÖ üëî VP por Pa√≠s:</b> EUA, Argentina, M√©xico, UK, Fran√ßa, Alemanha, Col√¥mbia agora t√™m vices espec√≠ficos<br>
        <b style="color:#006600">‚úÖ üî• Aba CRISES:</b> Investigar rival, Plantar narrativa, Vazar documento, Fake news, Assumir erro, Contra-ataque<br>
        <b style="color:#006600">‚úÖ üß† Aba INTELIG√äNCIA:</b> Campanha focada, Pesquisa estadual, Focus group, Mapeamento, An√°lise rivais, Proje√ß√£o<br>
        <b style="color:#006600">‚úÖ üëë Cr√©ditos:</b> Danoni (criador), Zanoni e Devenerance (players especiais)<br>
    </div>
    <div style="background:#ccffcc;border:1px solid #009900;padding:6px;margin-bottom:6px;border-left:4px solid #009900">
        <b>üì¶ VERS√ÉO 13</b> ‚Äî <i>8 Novos Pa√≠ses, 100 Conquistas, Col√©gio Eleitoral Melhorado, Indiretas Reformuladas, Parlamentos Reais</i><br>
        <b style="color:#006600">‚úÖ üá∫üá¶ Ucr√¢nia 2019:</b> Zelensky vs Poroshenko vs Tymoshenko ‚Äî 2 turnos, 10 regi√µes, contexto do Donbas<br>
        <b style="color:#006600">‚úÖ üá™üá∏ Espanha 2023:</b> Feij√≥o vs S√°nchez vs Abascal vs D√≠az ‚Äî parlamentar, 350 cadeiras, 11 regi√µes<br>
        <b style="color:#006600">‚úÖ üáØüáµ Jap√£o 2026:</b> Takaichi vs Noda vs Yoshimura vs Tamaki vs Kamiya vs Anno ‚Äî parlamentar, 465 cadeiras<br>
        <b style="color:#006600">‚úÖ üá∞üá∑ Coreia do Sul 2025:</b> Lee Jae-myung vs Kim Moon-Soo vs Lee Jun-Seok ‚Äî p√≥s-impeachment Yoon<br>
        <b style="color:#006600">‚úÖ üáøüá¶ √Åfrica do Sul 2024:</b> Ramaphosa vs Steenhuisen vs Zuma vs Malema ‚Äî PR 400 cadeiras, ANC perde maioria<br>
        <b style="color:#006600">‚úÖ üáµüá≠ Filipinas 2022:</b> Marcos vs Robredo vs Pacquiao vs Moreno ‚Äî turno √∫nico, 10 regi√µes<br>
        <b style="color:#006600">‚úÖ üáπüá∑ Turquia 2023:</b> Erdoƒüan vs Kƒ±lƒ±√ßdaroƒülu vs Oƒüan ‚Äî 2 turnos, democracia vs autoritarismo<br>
        <b style="color:#006600">‚úÖ üèõÔ∏è Alemanha 1932:</b> Hindenburg vs Hitler vs Th√§lmann ‚Äî elei√ß√£o hist√≥rica de Weimar, aba Elei√ß√µes Hist√≥ricas<br>
        <b style="color:#006600">‚úÖ üèõÔ∏è Elei√ß√µes Hist√≥ricas:</b> Nova aba com GER1932 + RUS1996 + EUA 2020<br>
        <b style="color:#006600">‚úÖ üåç √Åfrica:</b> Nova aba continental com √Åfrica do Sul 2024<br>
        <b style="color:#006600">‚úÖ üó≥Ô∏è Col√©gio Eleitoral Melhorado:</b> Swing States destacados, estrat√©gia de campanha especial, Ground Game, sondagem estadual, live EV count, opacidade por margem no mapa<br>
        <b style="color:#006600">‚úÖ üèõÔ∏è Elei√ß√µes Parlamentares Reais:</b> UK/√çndia/Espanha/Jap√£o/Canad√°/√Åfrica do Sul agora mostram distribui√ß√£o real de cadeiras no resultado com barra parlamentar<br>
        <b style="color:#006600">‚úÖ ‚öôÔ∏è Indiretas Reformuladas:</b> Novas a√ß√µes (Proposta de Governo, Mobiliza√ß√£o Popular, Apoio Militar), IA mais inteligente, press√£o popular, status de maioria em tempo real<br>
        <b style="color:#006600">‚úÖ üèÜ 100 Conquistas:</b> 16 novas conquistas incluindo Maioria Absoluta, Sweep Eleitoral, Europol√≠tico, conquistas por parlamento e col√©gio eleitoral<br>
        <b style="color:#006600">‚úÖ üì± Redes sociais adicionadas</b> para todos os novos pa√≠ses (2019+)<br>
    </div>
    <div style="background:#ffffcc;border:1px solid #cc9900;padding:6px;margin-bottom:6px;border-left:4px solid #cc9900">
        <b>üì¶ v12</b> ‚Äî 7 Novos Pa√≠ses, Vice-Presid√™ncia, Corrup√ß√£o, Regi√µes e 70 Conquistas<br>
        <small>üáÆüáπ It√°lia | üá¶üá∑ Argentina | üáÆüá≥ √çndia | üá¨üáß UK | üáµüá± Pol√¥nia | üá∫üá∏ EUA 2020 | üá∑üá∫ R√∫ssia 1996</small>
    </div>
    <div style="background:#e8e8ff;border:1px solid #6666cc;padding:6px;margin-bottom:6px;">
        <b>üì¶ v11</b> ‚Äî Portugal, Radicaliza√ß√£o Org√¢nica, Novas M√≠dias, Debates, Balanceamento
    </div>
    <div style="background:#f0f0f0;border:1px solid #ccc;padding:6px;margin-bottom:6px;">
        <b>üì¶ v10</b> ‚Äî Barra de Radicaliza√ß√£o | Gerenciamento de Partido | Coliga√ß√£o com trai√ß√£o | Alemanha e Fran√ßa
    </div>
    <div style="background:#f0f0f0;border:1px solid #ccc;padding:6px;margin-bottom:6px;">
        <b>üì¶ v9.0</b> ‚Äî 11 Elei√ß√µes Rep√∫blica Velha | R√∫ssia 2024 | Aba Municipais | Conquistas | Redes Sociais
    </div>
    <div style="background:#f0f0f0;border:1px solid #ccc;padding:6px;margin-bottom:6px;">
        <b>üì¶ v8.0</b> ‚Äî EUA 2024 com Col√©gio Eleitoral | Conquistas | A√ß√µes por era | Redes sociais
    </div>
    <div style="background:#f0f0f0;border:1px solid #ccc;padding:6px;">
        <b>üì¶ v1-7</b> ‚Äî 1989 a 2026 | Debates | Esc√¢ndalos | Mapa | Congresso | Modo Ca√≥tico | Indiretas | Hist√≥ricos
    </div>
    </div>`;
    showModal('üìã CHANGELOG ‚Äî SIMULADOR ELEITORAL GLOBAL v14', html, `<button class="btn" onclick="closeModal()">Fechar</button>`);
}

init();
</script>
</body>
</html>
